;/*FB_PKG_DELIM*/

__d("BaseToastContentWrapper.react",["BaseTheme.react","BaseView.react","react","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={dark:"__fb-dark-mode ",light:"__fb-light-mode ",type:"CLASSNAMES"};b=i.forwardRef(a);function a(a,b){var d=a.children,e=a.testid;e=a.useInvertedDisplayMode;a=a.xstyle;var f=c("useCurrentDisplayMode")();f=f==="dark"?"light":"dark";return e?i.jsx(c("BaseTheme.react"),{config:j,displayMode:f,ref:b,testid:void 0,xstyle:a,children:d}):i.jsx(c("BaseView.react"),{ref:b,testid:void 0,xstyle:a,children:d})}a.displayName=a.name+" [from "+f.id+"]";e=b;g["default"]=e}),98);
__d("BaseToast.react",["BaseInlinePressable.react","BaseToastContentWrapper.react","BaseView.react","XPlatReactFocusRegion.react","focusScopeQueries","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useId,k=b.useMemo,l={item:{display:"x78zum5",flexDirection:"xdt5ytf",paddingBottom:"x19yoh24",paddingStart:"xrxijuk",paddingEnd:"xpowjs8",paddingLeft:null,paddingRight:null,paddingTop:"x6enp1t",$$css:!0},itemText:{flexGrow:"x1iyjqo2",$$css:!0},link:{wordBreak:"xdnwjd9",$$css:!0},root:{alignItems:"x6s0dn4",backgroundColor:"x1wkzo03",borderTopColor:"xlnzwam",borderEndColor:"x12rs7x4",borderBottomColor:"xm9qwu6",borderStartColor:"xup3dfi",borderTopStartRadius:"x1192kqh",borderTopEndRadius:"xjfsc2c",borderBottomEndRadius:"xg8fqjl",borderBottomStartRadius:"x1kdh5me",borderTopStyle:"xhf2mca",borderEndStyle:"xrf2tuc",borderBottomStyle:"x13y0ya8",borderStartStyle:"x1pyzo2z",borderTopWidth:"xmqxc35",borderEndWidth:"x7gbks2",borderBottomWidth:"x21fg80",borderStartWidth:"x1q3d8fi",boxShadow:"xi1c1fh",display:"x78zum5",flexShrink:"x2lah0s",maxWidth:"x1cs6qxi",minWidth:"x1hqenl9",paddingTop:"x192rfv7",paddingBottom:"x13jxccy",paddingStart:"xuv3zuj",paddingEnd:"xd3owfx",paddingLeft:null,paddingRight:null,$$css:!0},rootFullWidth:{width:"xh8yej3",$$css:!0}};function a(a){var b=a.action,e=a.addOnStart,f=a.closeButton,g=a.linkWrapper,h=a.message,m=a.onDismiss,n=a.size;n=n===void 0?"full-width":n;var o=a.testid;o=a.toastRef;a=a.useInvertedDisplayMode;a=a===void 0?!0:a;var p=j(),q=k(function(){return b!=null?{}:{"aria-atomic":!0,role:"alert"}},[b]);e=i.jsxs(i.Fragment,{children:[e!=null&&i.jsx(c("BaseView.react"),{xstyle:l.item,children:e}),i.jsx(c("BaseView.react"),babelHelpers["extends"]({xstyle:[l.item,l.itemText]},q,{children:h({toastMessageId:p})})),b!=null&&i.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,children:i.jsx(c("BaseView.react"),{xstyle:l.item,children:b.element!=null?b.element:b.labelRenderer&&i.jsx(c("BaseInlinePressable.react"),{onPress:function(a){m(),b.onPress(a)},testid:void 0,xstyle:l.link,children:b.labelRenderer(b.label)})})}),f!=null&&i.jsx(c("BaseView.react"),{xstyle:l.item,children:f})]});e=g!=null?g(e):e;return i.jsx(c("BaseToastContentWrapper.react"),{ref:o,testid:void 0,useInvertedDisplayMode:a,xstyle:[l.root,n==="full-width"&&l.rootFullWidth],children:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("BladeRunnerConfig",["RTISubscriptionManagerConfig","WebDriverConfig","cr:3024","gkx","isEmpty"],(function(a,b,c,d,e,f,g){var h,i="javascript-sandbox",j="OverrideServer",k="www_sandbox",l="www_tier";a=function(){function a(){}var d=a.prototype;d.patchRequestHeaders=function(a){var d={},e=c("RTISubscriptionManagerConfig").bladerunner_www_sandbox,f=c("RTISubscriptionManagerConfig").is_intern;if(!(h||(h=c("isEmpty")))(c("WebDriverConfig").auxiliaryServiceInfo)){var g;g=(g=c("WebDriverConfig").auxiliaryServiceInfo.BladeRunner)!=null?g:c("WebDriverConfig").auxiliaryServiceInfo["BladeRunner-sandcastle"];g!=null?(typeof g.ip_address==="string"?d[j]=g.ip_address+":18295":typeof g.hostname==="string"&&(d[j]=g.hostname+":18295"),typeof c("WebDriverConfig").originHost==="string"&&(d[k]="www."+c("WebDriverConfig").originHost)):e!=null&&(d[i]=e)}else e!=null&&(d[i]=e);f===!0&&(d[l]="intern");if(c("WebDriverConfig").isTestRunning&&c("gkx")("20919")){g=b("cr:3024")==null?void 0:b("cr:3024").get();g!=null&&(d.is_test="true",d.original_request_id=g)}c("gkx")("20929")&&(d["Accept-Ack"]="RSAck");for(e in a)d[e]=a[e];d.http_referer=window.location.href;return d};return a}();d=new a();e=d;g["default"]=e}),98);
__d("BladeRunnerLogger",["FBLogger","ODS"],(function(a,b,c,d,e,f,g){var h,i="bladerunner_js_client",j={info:"info",warning:"warning",exception:"exception"};a=function(){function a(){this.setFBLoggerLevel(1)}var b=a.prototype;b.info=function(a){this.$2>=2&&c("FBLogger")(i).info("BladeRunner info: %s",a),this.$3(j.info,a)};b.warn=function(a){this.$2>=1&&c("FBLogger")(i).warn("BladeRunner warn: %s",a),this.$3(j.warning,a)};b.exception=function(a,b){b===void 0&&(b="");var d=b+" "+a.toString();this.$2>=0&&c("FBLogger")(i).warn("BladeRunner exception: %s, %s",b,a.toString());this.$3(j.exception,d)};b.trimForLogging=function(a){var b=1024;return typeof a==="string"&&a.length>b?"[trimmed]:"+a.substring(0,b)+"...":a};b.bumpCounter=function(a,b){b===void 0&&(b=1),(h||(h=d("ODS"))).bumpEntityKey(2966,"BladeRunnerClient",a,b)};b.setClientSessionId=function(a){this.$1=a};b.setFBLoggerLevel=function(a){this.$2=a};b.$3=function(a,b){};return a}();b=new a();e=b;g["default"]=e}),98);
__d("BladeRunnerTypes",[],(function(a,b,c,d,e,f,g){a={REQUEST:1,DATA:2,DATA_ACK:3,STATUS_UPDATE:4,REWRITE_REQUEST:5,LOG:6};b={BLADE_RUNNER:1,GATEWAY:2};g.StreamFrameType=a;g.StreamRequestType=b}),98);
__d("BladeRunnerTypesInternal",["Base64","BladeRunnerLogger","BladeRunnerTypes"],(function(a,b,c,d,e,f,g){var h=function(){function a(){}var b=a.prototype;b.getHeaders=function(){if(this.headers!=null)return this.headers;throw new Error("Expected headers")};b.getInstrumentationData=function(){if(this.instrumentationData!=null&&this.instrumentationData.length>0)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};b.updateRetryRequestPayload=function(a){a!=null?this.payload=c("Base64").encode(a):this.payload=null};a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.requestType=o(b.requestType);c.payload=r(b.payload);c.headers=u(b.headers);c.extraHeader=r(b.extraHeader);c.requestTarget=r(b.requestTarget);c.instrumentationData=r(b.instrumentationData);return c};return a}(),i=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.dataId=p(b.dataId);c.data=r(b.data);c.shouldAck=w(b.shouldAck);return c};var b=a.prototype;b.rawData=function(){if(this.data==null)throw new Error("Expected data");return this.data};b.rawDataSize=function(){return this.data==null?0:this.data.length};b.decodeData=function(){if(this.data==null)throw new Error("Expected data");return c("Base64").decode(this.data)};b.setData=function(a){this.data=c("Base64").encode(a)};b.getInstrumentationData=function(){if(this.instrumentationData!=null)return JSON.parse(this.instrumentationData);else return null};return a}(),j=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.dataId=o(b.dataId);c.success=v(b.success);c.message=r(b.message);c.code=p(b.code);return c};return a}();j.ACK_CODE_LANDED_AND_ACCEPTED=20;j.ACK_CODE_LANDED_BUT_NOT_ACCEPTED=21;j.ACK_CODE_FAILED_TO_LAND=50;var k=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=p(b.streamId);c.message=r(b.message);return c};return a}(),l=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.status=o(b.status);c.message=r(b.message);c.code=p(b.code);c.shouldRetry=w(b.shouldRetry);c.retryDelayMs=p(b.retryDelayMs);return c};return a}(),m=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.newBody=r(b.newBody);c.newExtraHeader=r(b.newExtraHeader);c.patchExtraHeader=r(b.patchExtraHeader);c.killBody=w(b.killBody);c.temporary=w(b.temporary);return c};return a}(),n=function(){function a(){}var b=a.prototype;b.getRequest=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request;throw new Error("Expected request")};b.getData=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data;throw new Error("Expected data")};b.getDataAck=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck;throw new Error("Expected dataAck")};b.getStatusUpdate=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate;throw new Error("Expected status update")};b.getLog=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log;throw new Error("Expected log")};b.getRewriteRequest=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest;throw new Error("Expected rewrite request")};b.getStreamId=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck.streamId;throw new Error("Frame with unexpected type")};b.isInstrumented=function(){if(this.type===d("BladeRunnerTypes").StreamFrameType.REQUEST)return this.getRequest().instrumentationData!=null;else if(this.type===d("BladeRunnerTypes").StreamFrameType.DATA)return this.getData().instrumentationData!=null;else return!1};a.readObject=function(b){var e=new a();e.type=o(b.type);switch(e.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:e.request=h.readObject(s(b.request));break;case d("BladeRunnerTypes").StreamFrameType.DATA:e.data=i.readObject(s(b.data));break;case d("BladeRunnerTypes").StreamFrameType.DATA_ACK:e.dataAck=j.readObject(s(b.dataAck));break;case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:e.statusUpdate=l.readObject(s(b.statusUpdate));break;case d("BladeRunnerTypes").StreamFrameType.LOG:e.log=k.readObject(s(b.log));break;case d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:e.rewriteRequest=m.readObject(s(b.rewriteRequest));break;default:c("BladeRunnerLogger").warn("Frame with unexpected type: "+e.type);return null}return e};a.newRequestFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.REQUEST;c.request=b;return c};a.newDataFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.DATA;c.data=b;return c};a.newDataAckFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.DATA_ACK;c.dataAck=b;return c};a.newStatusUpdateFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE;c.statusUpdate=b;return c};a.newLogFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.LOG;c.log=b;return c};a.newRewriteRequestFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST;c.rewriteRequest=b;return c};return a}();a=function(){function a(a,b,c){this.batchId=a,this.frames=b,this.instrumentationData=c}var b=a.prototype;b.getFrames=function(){if(this.frames!=null)return this.frames;throw new Error("Expected frames")};b.getInstrumentationData=function(){if(this.instrumentationData!=null)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};b.getInstrumentationDataDfTraceId=function(){if(this.instrumentationData!=null)try{var a=JSON.parse(this.instrumentationData);return(a=a.dataFlowTracingData)==null?void 0:a.traceId}catch(a){return null}else return null};b.write=function(){return JSON.stringify(this)};b.isInstrumented=function(){return this.getFrames().some(function(a){return a.isInstrumented()})};a.read=function(b){b=JSON.parse(b);var c=b.batchId||0,d=[];for(var e=b.frames,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h=n.readObject(h);h!=null&&d.push(h)}h=b.instrumentationData||null;return new a(c,d,h)};return a}();function o(a){if(typeof a==="number")return a;throw new Error("Expected number")}function p(a){return a==null?null:o(a)}function q(a){if(typeof a==="string")return a;throw new Error("Expected string")}function r(a){return a==null?null:q(a)}function s(a){if(typeof a==="object"&&a!=null)return a;throw new Error("Expected object")}function t(a){if(typeof a==="object"&&a!=null){var b=a,c={};Object.keys(b).forEach(function(a){var d=b[a];typeof d==="string"&&d!=null&&(c[a]=d)});return c}throw new Error("Expected string map")}function u(a){return a==null?null:t(a)}function v(a){if(typeof a==="boolean"&&a!=null)return a;throw new Error("Expected boolean")}function w(a){return a==null?null:v(a)}g.GatewayStreamRequest=h;g.GatewayStreamData=i;g.GatewayStreamDataAck=j;g.GatewayStreamLog=k;g.GatewayStreamStatusUpdate=l;g.GatewayStreamRewriteRequest=m;g.GatewayStreamFrame=n;g.GatewayStreamBatch=a}),98);
__d("RequestStreamE2EClientLoggerEvent",[],(function(a,b,c,d,e,f){a=Object.freeze({RECEIVED:"received",SENT:"sent",FAILURE:"failure",PUBACK:"puback"});f["default"]=a}),66);
__d("RequestStreamE2EClientLoggerMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({REQUEST_STREAM:"request_stream",AMENDMENT:"amendment",AMENDMENT_ACK:"amendment_ack",CANCEL:"cancel",RESPONSE:"response",RESPONSE_ACK:"response_ack",TIMED_REQUEST:"timed_request",INTERRUPT:"interrupt"});f["default"]=a}),66);
__d("BladeRunnerEventHandler",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){var h=1e3;a=function(){function a(a,b,c){this.$2=a,this.$1=b,this.$3=c}var b=a.prototype;b.onProxyResponse=function(a){this.$4(a);var b=[];for(var e=a.getFrames(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;this.$2.witnessFrame(h)&&b.push(h)}h=this.$2.getRequest();(g=h.e2eLogger)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").SENT,{},(f=a.getInstrumentationData())==null?void 0:f.auxId,null,a.getInstrumentationDataDfTraceId());b.length>0&&this.$5(new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(a.batchId,b,a.instrumentationData))};b.onDisconnect=function(){this.$2.resetErrors();var a=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();a.streamId=this.$2.getRequest().streamId;a.status=d("BladeRunnerStreamStatus").StreamStatus.CLOSED;a.shouldRetry=!0;a.retryDelayMs=0;a=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a)]);this.onProxyResponse(a)};b.$4=function(a){var b=this;a=a.getFrames().filter(function(a){return a.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE});for(var a=a,e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;g=g.getStatusUpdate();if(g.status==d("BladeRunnerStreamStatus").StreamStatus.CLOSED||g.status==d("BladeRunnerStreamStatus").StreamStatus.REJECTED){this.$2.onError();var i=g.shouldRetry!=null&&g.shouldRetry,j=g.message!=null?g.message:"null";if(i&&this.$2.getErrorCount()<=this.$2.getRetriesAllowed()){g.status=d("BladeRunnerStreamStatus").StreamStatus.STOPPED;var k=h;g.retryDelayMs!=null&&(k=g.retryDelayMs);c("BladeRunnerLogger").info("Can retry: stream "+g.streamId+" closed with status "+g.status+", message "+j+". Error count: "+this.$2.getErrorCount()+", retryDelay "+k+"ms. Already retrying: "+this.$2.getRetryRequestScheduled().toString());this.$2.getRetryRequestScheduled()?c("BladeRunnerLogger").bumpCounter("stream_closed_already_retrying"):(c("BladeRunnerLogger").bumpCounter("stream_closed_will_retry"),this.$2.setRetryRequestScheduled(!0),k>0?c("setTimeoutAcrossTransitions")(function(){return b.$6()},k):this.$6())}else c("BladeRunnerLogger").info("Will not retry: stream "+g.streamId+" closed with status "+g.status+", message "+j+". Error count: "+this.$2.getErrorCount()+", shouldRetry "+i.toString()+". Already retrying: "+this.$2.getRetryRequestScheduled().toString()),i?c("BladeRunnerLogger").bumpCounter("stream_closed_retry_exceeded"):c("BladeRunnerLogger").bumpCounter("stream_closed_no_retry"),this.$3.removeStream(g.streamId)}}};b.$6=function(){this.$2.setRetryRequestScheduled(!1);if(this.$2.isAlive()){var a=this.$1.getUpdatedRequestBody();a!=null&&this.$2.updateRetryRequestPayload(a);this.$3.sendRetryStreamRequest(this.$2)}};b.$5=function(a){c("BladeRunnerLogger").bumpCounter("send_to_handler");var b=[];this.$1.onBatch(a);for(var a=a.getFrames(),e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;try{switch(g.type){case d("BladeRunnerTypes").StreamFrameType.DATA:this.$1.onData(g.getData());b.push(g.getData());break;case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:this.$1.onStatusUpdate(g.getStatusUpdate().status);break;case d("BladeRunnerTypes").StreamFrameType.LOG:g=g.getLog().message;g!=null&&this.$1.onLog(g);break;case d("BladeRunnerTypes").StreamFrameType.DATA_ACK:break;default:throw new Error("Frame with unexpected type")}}catch(a){c("BladeRunnerLogger").bumpCounter("send_to_handler_error"),c("BladeRunnerLogger").exception(a,"Failed sending frame to stream handler")}}this.$7(b)};b.$7=function(a){var b=[];for(var c=0;c<a.length;c++){var e=a[c];if(e.shouldAck===!0&&e.dataId!=null){var f=new(d("BladeRunnerTypesInternal").GatewayStreamDataAck)();f.streamId=e.streamId;f.dataId=e.dataId;f.success=!0;b.push(f)}}this.$3.sendDataAcks(b)};return a}();g["default"]=a}),98);
__d("RtiRequestStreamE2eClientBatchFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("819");b=d("FalcoLoggerInternal").create("rti_request_stream_e2e_client_batch",a);e=b;g["default"]=e}),98);
__d("RtiRequestStreamE2eClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1857112");b=d("FalcoLoggerInternal").create("rti_request_stream_e2e_client",a);e=b;g["default"]=e}),98);
__d("RequestStreamE2ELogger",["ConstUriUtils","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RtiRequestStreamE2eClientBatchFalcoEvent","RtiRequestStreamE2eClientFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";var h=["FBGQLS:COMMENT_CREATE_SUBSCRIBE","FBGQLS:COMMENT_LIKE_SUBSCRIBE","FBGQLS:FEEDBACK_COMMENT_PERMISSION_TOGGLE_SUBSCRIBE","FBGQLS:FEEDBACK_TYPING_SUBSCRIBE","FBLQ:comet_notifications_live_query_experimental"],i=0;function j(){var a=Date.now();i>=a?i+=1:i=a;return i.toString()}var k=function(){function a(a,b,c,e,f,g,h,i,j,k){this.$10=[];this.$11=!1;this.$1=a;this.$2=b;this.$3=c;this.$4=e;this.$5=f;this.$6=g;this.$7=h;this.$8=i;this.$9=j;this.$12=(a=k)!=null?a:!1;b=d("ConstUriUtils").getUri(window.location.href);b&&(this.$13=b.getDomain())}var b=a.prototype;b.logE2EEvent=function(a,b,c,d,e,f){c===void 0&&(c=null);d===void 0&&(d=null);e===void 0&&(e=null);f===void 0&&(f=null);if(this.$3==="Falco")return;e={request_id:this.$1,resume_id:"0",retry_id:e,transport:this.$2,method:this.$3,use_case:this.$4,request_log_context:this.$5,force_log_context:this.$6,e2e_sample_rate:this.$7,message_type:a,event:b,timestamp_ms:j(),aux_id:d,additional_data:c,dgw_stream_group_logging_id:this.$8,dgw_count_prior_streams_in_group:this.$9,domain:this.$13,df_trace_id:f};this.$14(e)};b.$14=function(a){if(!this.$12){c("RtiRequestStreamE2eClientFalcoEvent").log(function(){return a});return}this.$10.push(a);if(this.$11||a.event==c("RequestStreamE2EClientLoggerEvent").FAILURE||a.message_type==c("RequestStreamE2EClientLoggerMessageType").RESPONSE){var b={events:this.$10};c("RtiRequestStreamE2eClientBatchFalcoEvent").log(function(){return b});this.$10=[];this.$11=!0}};b.getRequestId=function(){return this.$1};return a}();function a(a,b,c){if(a==null||a.method==null)return null;var d=!1;h.includes(a.method)&&(d=!0);if(b==null||b.length==0)return null;b=JSON.parse(b);return b.requestId==null?null:new k(b.requestId,c,a.method,l(a.method,a),b.requestLogContext,b.forceLogContext,b.sampleRate,b.dgwStreamGroupLoggingId,b.dgwCountPriorStreamsInGroup,d)}function l(a,b){if(a==="FBLQ"&&b.config_id)return b.config_id;if(a==="SKY"){if(b.topic){var c=b.topic.lastIndexOf("/");return c>0?b.topic.substr(0,c):b.topic}return}return a}function b(a,b,d,e,f,g){f===void 0&&(f=null);g===void 0&&(g=null);if(a==null||a.requestId==null||a.clientLoggingDisabled!=null)return;var h={request_id:a.requestId,resume_id:"0",transport:b,e2e_sample_rate:a.sampleRate,message_type:d,event:e,timestamp_ms:j(),aux_id:a.auxId,additional_data:f,df_trace_id:g};c("RtiRequestStreamE2eClientFalcoEvent").log(function(){return h})}g.RequestStreamE2ELogger=k;g.createStreamLogger=a;g.logRequestStreamE2EEventStatic=b}),98);
__d("RequestStreamTransport",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["WEB_BR_MQTT","WEB_RS_MQTT","WEB_RS_STARGATE"]);f.RequestStreamTransport=a}),66);
__d("BladeRunnerSocket",["BladeRunnerEventHandler","BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","CurrentUser","FBMqttChannel","MqttPublishListener","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamTransport","justknobx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i="Connected",j="Disconnected",k="/br_sr",l="/sr_res",m=null;function n(a){var b;switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:return(b=a.request)==null?void 0:b.getInstrumentationData();case d("BladeRunnerTypes").StreamFrameType.DATA:return(b=a.data)==null?void 0:b.getInstrumentationData()}return null}function o(a){switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:return c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM;case d("BladeRunnerTypes").StreamFrameType.DATA:return c("RequestStreamE2EClientLoggerMessageType").AMENDMENT}return null}function p(a){if(a===null)return null;switch(a){case d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:return"Accepted";case d("BladeRunnerStreamStatus").StreamStatus.REJECTED:return"Rejected";case d("BladeRunnerStreamStatus").StreamStatus.STARTED:return"Started";case d("BladeRunnerStreamStatus").StreamStatus.STOPPED:return"Stopped";case d("BladeRunnerStreamStatus").StreamStatus.CLOSED:return"Closed"}return null}function q(a){var b={};a==null?void 0:(a=a.frames)==null?void 0:a.forEach(function(a){if(a.type===d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE){a=(a=a.statusUpdate)==null?void 0:a.status;a=p(a);a!==null&&(b.flow_status=a)}});return b}function r(a,b){var c;switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:b.data_base64_size=(c=a.request)==null?void 0:(c=c.payload)==null?void 0:(c=c.length)==null?void 0:c.toString();break;case d("BladeRunnerTypes").StreamFrameType.DATA:b.data_base64_size=(c=a.data)==null?void 0:(b=c.rawDataSize())==null?void 0:b.toString();break}return null}function s(a,b,e){var f=n(a);if(f==null)return;var g=o(a);if(g==null)return;var h=null;switch(b){case d("MqttPublishListener").MqttPublishEvent.SENT:h=c("RequestStreamE2EClientLoggerEvent").SENT;break;case d("MqttPublishListener").MqttPublishEvent.ACKED:h=c("RequestStreamE2EClientLoggerEvent").PUBACK;break;case d("MqttPublishListener").MqttPublishEvent.NOT_ACKED:case d("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED:case d("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR:h=c("RequestStreamE2EClientLoggerEvent").FAILURE;e.reason==null&&(e.reason=b);break}if(h==null)return;r(a,e);if(((b=a.request)==null?void 0:b.e2eLogger)!=null&&f.clientLoggingDisabled==null){(b=a.request)==null?void 0:b.e2eLogger.logE2EEvent(g,h,e,f.auxId)}else d("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(f,d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,g,h,e)}a=function(){function a(a){this.$1=[],this.$2=0,this.$3=0,this.$4=null,this.$5=0,this.$6=new Map(),this.$7=a!=null?a:c("FBMqttChannel"),this.$8=new Map(),c("BladeRunnerLogger").setClientSessionId(c("uuidv4")()),this.$9()}a.get=function(){m==null&&(m=new a(c("FBMqttChannel")));return m};var e=a.prototype;e.sendNewStreamRequest=function(b,d){d=new(c("BladeRunnerEventHandler"))(b,d,this);var e=b.getRequest();this.$6.set(e.streamId,d);if(!this.$10()){this.$11(d,e.streamId);return}this.getStreamCount()<=a.maxStreamCount?this.$12(e):(c("BladeRunnerLogger").bumpCounter("socket_request_throttled_max_streams"),c("BladeRunnerLogger").warn("Maximum stream count reached, will not send request: "+JSON.stringify(b.getRequest().getHeaders())),this.$11(d,e.streamId))};e.sendRetryStreamRequest=function(a){this.$12(a.getRequest())};e.sendCancel=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_cancel");var b=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();b.streamId=a.streamId;b.status=d("BladeRunnerStreamStatus").StreamStatus.CLOSED;this.$13(b,a);this.removeStream(a.streamId)};e.sendAmendment=function(a,b,e){c("BladeRunnerLogger").bumpCounter("socket_send_amendment");var f=new(d("BladeRunnerTypesInternal").GatewayStreamData)();f.streamId=a;f.setData(b);e!=null&&(f.instrumentationData=e);this.$14(f)};e.sendAmendmentWithAck=function(a,e,f){var g=this;c("BladeRunnerLogger").bumpCounter("socket_send_amendment");var i=this.$15(),j=new(d("BladeRunnerTypesInternal").GatewayStreamData)();j.streamId=a;j.setData(e);j.shouldAck=!0;j.dataId=i;f!=null&&(j.instrumentationData=f);a=new(h||(h=b("Promise")))(function(a,b){g.$8.set(i,{resolve:a,reject:b})});this.$14(j);return a};e.$14=function(a){this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newDataFrame(a)),this.$16()};e.sendDataAcks=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_data_ack",a.length),this.$17(a)};e.removeStream=function(a){this.$6["delete"](a)};e.getStreamCount=function(){return this.$6.size};e.getNextStreamId=function(){this.$5++;return this.$5};e.onMQTTStateChanged=function(a){this.$16();if(a!=j&&a!=i||this.$4==a)return;this.$4=a;c("BladeRunnerLogger").info("MQTTStateChanged: "+a);a==j?(c("BladeRunnerLogger").bumpCounter("mqtt_state_disconnected"),this.$18()):a==i&&c("BladeRunnerLogger").bumpCounter("mqtt_state_connected")};e.$12=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_request");this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newRequestFrame(a));if(!this.$16()){(a=a.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"MQTT Not Connected"})}};e.$13=function(a,b){this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a));if(this.$16()){(a=b.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").SENT)}};e.$17=function(a){for(var b=0;b<a.length;b++){var c=a[b];this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newDataAckFrame(c))}this.$16()};e.$19=function(){this.$2++;return this.$2};e.$15=function(){this.$3++;return this.$3};e.$16=function(){var a=!1;if(this.$7.getConnectionState()===i&&this.$1.length>0)try{this.$20(this.$1),a=!0}catch(a){}finally{this.$1=[]}return a};e.$20=function(a){var b=this,e=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(this.$19(),a),f=e.write();if(f.length>this.$21()){var g=Math.floor(a.length/2);if(g===0){a.forEach(function(a){return s(a,d("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR,{reason:"too long"})});var h=new Error("Publish is too long: "+f.length);h.stack;this.$22(e,h,"Publish is too long");throw h}this.$20(a.slice(0,g));this.$20(a.slice(g,a.length))}else try{c("BladeRunnerLogger").info("send message to "+k+" ("+f.length+" bytes)");h={qos:1,skipBuffer:!1};if(e.isInstrumented()){var i=Date.now();h.listener={onEvent:function(b){var c=(Date.now()-i).toString();a.forEach(function(a){s(a,b,{latency:c})})}}}this.$7.publish(k,f,h)["catch"](function(a){b.$22(e,a,"Failed publishing to MQTT")});c("BladeRunnerLogger").bumpCounter("mqtt_publish_success")}catch(a){this.$22(e,a,"Failed publishing to MQTT");throw a}};e.$9=function(){var a=this;c("BladeRunnerLogger").info("Starting socket with endpoint "+this.$7.getEndpoint()+" useragent "+navigator.userAgent);this.onMQTTStateChanged(this.$7.getConnectionState());this.$7.subscribeChannelEvents({onMQTTStateChanged:function(b){a.onMQTTStateChanged(b)},onJSError:function(a){var b=a!=null&&typeof a.isRecoverable==="boolean"?a.isRecoverable:!1;b?c("BladeRunnerLogger").bumpCounter("mqtt_channel_recoverable_error"):(c("BladeRunnerLogger").warn("JS error in MQTTChannel: "+(typeof a=="object"&&a!=null?a.toString():"unknown error")+", "+JSON.stringify(a)),c("BladeRunnerLogger").bumpCounter("mqtt_channel_error"))}});this.$7.subscribe(k,function(a){throw new Error("Unexpected response: "+k+" "+a.toString())});this.$7.subscribe(l,function(b){a.$23(b)})};e.$23=function(a){a=d("BladeRunnerTypesInternal").GatewayStreamBatch.read(a);this.processBatch(a)};e.$22=function(a,b,e){for(var a=a.getFrames(),f=Array.isArray(a),g=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=a.length)break;h=a[g++]}else{g=a.next();if(g.done)break;h=g.value}h=h;if(h.type===d("BladeRunnerTypes").StreamFrameType.REQUEST){var i=h.getRequest(),j=this.$6.get(i.streamId);j!=null&&this.$24(j,i.streamId,d("BladeRunnerStreamStatus").StreamStatus.CLOSED,!0,null)}else if(h.type===d("BladeRunnerTypes").StreamFrameType.DATA){j=h.getData();i=j.dataId;if(j.shouldAck!=null&&j.shouldAck&&i!=null){h=new(d("BladeRunnerTypesInternal").GatewayStreamDataAck)();h.streamId=j.streamId;h.dataId=i;h.success=!1;h.code=d("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_FAILED_TO_LAND;h.message=e;this.$25(h)}}}c("BladeRunnerLogger").info("Failed publishing to MQTT: "+b.message);c("BladeRunnerLogger").bumpCounter("mqtt_publish_error")};e.$25=function(a){var b=this.$8.get(a.dataId);b!=null&&(this.$8["delete"](a.dataId),a.success?b.resolve(!0):a.code===d("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_LANDED_BUT_NOT_ACCEPTED?b.resolve(!1):b.reject(a.message))};e.processBatch=function(a){try{d("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(a.getInstrumentationData(),d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").RECEIVED,q(a),a.getInstrumentationDataDfTraceId());c("BladeRunnerLogger").bumpCounter("socket_process_batch");var b=JSON.stringify(a);c("BladeRunnerLogger").info("Received batch ("+b.length+" bytes)");b=null;for(var e=a.getFrames(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;var i=h.getStreamId();b==null&&(b=i);if(i!=null&&b!=i)throw new Error("Received batch with frames for multiple streams");h.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.$25(h.getDataAck())}if(b!=null){i=this.$6.get(b);i!=null?i.onProxyResponse(a):c("BladeRunnerLogger").info("Received batch with frames for unknown stream id: "+b)}else c("BladeRunnerLogger").info("Received batch with no frames")}catch(a){c("BladeRunnerLogger").exception(a,"Failed processing batch from MQTT");c("BladeRunnerLogger").bumpCounter("socket_process_batch_error");throw a}};e.$18=function(){this.$6.forEach(function(a,b,c){a.onDisconnect()})};e.$11=function(a,b){this.$24(a,b,d("BladeRunnerStreamStatus").StreamStatus.REJECTED,!1,0)};e.$24=function(a,b,c,e,f){var g=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();g.streamId=b;g.status=c;g.shouldRetry=e;g.retryDelayMs=f;b=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(g)]);a.onProxyResponse(b)};e.$10=function(){if(!c("CurrentUser").isLoggedIn()){c("BladeRunnerLogger").bumpCounter("request_stream_user_logged_out");return!1}return!0};e.$21=function(){var a=1024*1024,b=512*1024;try{var d=c("justknobx")._("317");b=d*a}catch(a){}return Math.max(b-1024,0)};return a}();a.maxStreamCount=2e3;g["default"]=a}),98);
__d("BladeRunnerStream",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){var g;a=function(){function a(a){this.$1=a}var c=a.prototype;c.getStreamHandler=function(){return this.$1};c.cancel=function(){};c.amendWithAck=function(a){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},null,this)};c.amendFireAndForget=function(a){};c.amendWithoutAck=function(a){};c.start=function(){return(g||(g=b("Promise"))).resolve()};c.isAlive=function(){return!1};c.canAmend=function(){return!1};c.getStatus=function(){return null};c.getStreamId=function(){return 0};return a}();f["default"]=a}),66);
__d("BladeRunnerStreamState",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes"],(function(a,b,c,d,e,f,g){a=function(){function a(a){this.$1=a,this.$2=null,this.$3=0,this.$4=!1,this.$5=0,this.$6=!1}var b=a.prototype;b.getRequest=function(){return this.$1};b.updateRetryRequestPayload=function(a){this.$1.updateRetryRequestPayload(a)};b.isAlive=function(){return!(this.$2==d("BladeRunnerStreamStatus").StreamStatus.CLOSED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.REJECTED)};b.canAmend=function(){return this.$2==d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.STARTED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.STOPPED};b.getLastStatus=function(){return this.$2};b.setLastStatus=function(a){this.$2=a};b.onError=function(){this.$3+=1};b.getErrorCount=function(){return this.$3};b.resetErrors=function(){this.$3=0};b.getRetryRequestScheduled=function(){return this.$6};b.setRetryRequestScheduled=function(a){this.$6=a};b.witnessFrame=function(a){switch(a.type){case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:var b=a.getStatusUpdate(),c=!0;switch(b.status){case d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:c=!this.$4;this.$4||(this.$4=!0);break;case d("BladeRunnerStreamStatus").StreamStatus.STARTED:c=this.getLastStatus()!=d("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case d("BladeRunnerStreamStatus").StreamStatus.STOPPED:c=this.getLastStatus()==d("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case d("BladeRunnerStreamStatus").StreamStatus.CLOSED:case d("BladeRunnerStreamStatus").StreamStatus.REJECTED:default:c=!0}this.setLastStatus(b.status);return c;case d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:this.$7(a.getRewriteRequest());return!1;default:return!0}};b.setRetriesAllowed=function(a){this.$5=a};b.getRetriesAllowed=function(){return this.$5};b.$7=function(a){if(!(a.temporary!=null||a.temporary==!0)){a.newBody!=null&&(this.$1.payload=a.newBody);a.newExtraHeader!=null&&(this.$1.extraHeader=a.newExtraHeader,this.$1.headers=JSON.parse(a.newExtraHeader));if(a.patchExtraHeader!=null)try{var b=JSON.parse(a.patchExtraHeader),d=this.$1.extraHeader!=null?JSON.parse(this.$1.extraHeader):{};this.$1.headers==null&&(this.$1.headers={});var e=Object.keys(b);for(var f=0;f<e.length;f++){var g=e[f];this.$1.headers[g]=b[g];d[g]=b[g]}this.$1.extraHeader=JSON.stringify(d)}catch(b){c("BladeRunnerLogger").warn("Failed to patch header: "+a.patchExtraHeader)}a.killBody!=null&&a.killBody==!0&&(this.$1.payload=null)}};return a}();g["default"]=a}),98);
__d("BladeRunnerSocketStream",["BladeRunnerStream","BladeRunnerStreamState","BladeRunnerStreamStatus","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","regeneratorRuntime","uuidv4"],(function(a,b,c,d,e,f,g){var h,i=4,j={reason:"stream_dead"};a=function(a){babelHelpers.inheritsLoose(e,a);function e(b,d,e){b=a.call(this,b)||this;b.$BladeRunnerSocketStream1=e;b.$BladeRunnerSocketStream2=new(c("BladeRunnerStreamState"))(d);b.$BladeRunnerSocketStream2.setRetriesAllowed(i);return b}var f=e.prototype;f.start=function(){var a=this;return new(h||(h=b("Promise")))(function(b){a.send(),b()})};f.send=function(){var a,b=this.$BladeRunnerSocketStream2.getRequest();(a=b.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_base64_size:(a=b.payload)==null?void 0:(b=a.length)==null?void 0:b.toString()});this.$BladeRunnerSocketStream1.sendNewStreamRequest(this.$BladeRunnerSocketStream2,this.getStreamHandler())};f.amendWithAck=function(a){var d,e,f,g,i,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:e=this.$BladeRunnerSocketStream2.getRequest();f=e.getInstrumentationData();f&&(f.auxId=c("uuidv4")(),(g=e.e2eLogger)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:a==null?void 0:(i=a.length)==null?void 0:i.toString()},f.auxId));if(!this.canAmend()){m.next=6;break}f&&((k=e.e2eLogger)==null?void 0:k.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:a==null?void 0:(l=a.length)==null?void 0:l.toString()},f.auxId));return m.abrupt("return",this.$BladeRunnerSocketStream1.sendAmendmentWithAck(e.streamId,this.$BladeRunnerSocketStream3(a),f==null?null:JSON.stringify(f)));case 6:(d=e.e2eLogger)==null?void 0:d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,j,f==null?void 0:f.auxId);return m.abrupt("return",(h||(h=b("Promise"))).reject("Stream is closed or not accepted"));case 8:case"end":return m.stop()}},null,this)};f.amendFireAndForget=function(a){var b=this.$BladeRunnerSocketStream2.getRequest(),d=b.getInstrumentationData();if(d){var e;d.auxId=c("uuidv4")();(e=b.e2eLogger)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:a==null?void 0:(e=a.length)==null?void 0:e.toString()},d.auxId)}if(this.canAmend()){this.$BladeRunnerSocketStream1.sendAmendment(this.$BladeRunnerSocketStream2.getRequest().streamId,this.$BladeRunnerSocketStream3(a),d==null?null:JSON.stringify(d));if(d){(e=b.e2eLogger)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:a==null?void 0:(e=a.length)==null?void 0:e.toString()},d.auxId)}}else{(a=b.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,j,d==null?void 0:d.auxId);throw new Error("Stream is closed or not accepted")}};f.amendWithoutAck=function(a){this.amendFireAndForget(a)};f.$BladeRunnerSocketStream3=function(a){return typeof a=="object"?btoa(new TextDecoder("utf8").decode(a)):a};f.cancel=function(){var a=this.$BladeRunnerSocketStream2.getRequest();(a=a.e2eLogger)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").RECEIVED);this.isAlive()&&(this.$BladeRunnerSocketStream1.sendCancel(this.$BladeRunnerSocketStream2.getRequest()),this.$BladeRunnerSocketStream2.setLastStatus(d("BladeRunnerStreamStatus").StreamStatus.CLOSED),this.getStreamHandler().onClientCancel())};f.isAlive=function(){return this.$BladeRunnerSocketStream2.isAlive()};f.canAmend=function(){return this.$BladeRunnerSocketStream2.canAmend()};f.getStatus=function(){return this.$BladeRunnerSocketStream2.getLastStatus()};f.getStreamId=function(){return this.$BladeRunnerSocketStream2.getRequest().streamId};return e}(c("BladeRunnerStream"));g["default"]=a}),98);
__d("RequestStreamE2ESampling",["invariant","Random","RequestStreamE2EClientSamplingConfig","uuidv4"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){return a==null?!1:a.requestId!=null&&typeof a.requestId=="string"&&a.forceLogContext!=null&&typeof a.forceLogContext=="string"}function j(a,b){var d=c("RequestStreamE2EClientSamplingConfig").sampleRate;if(d>1&&a!=null){a=c("RequestStreamE2EClientSamplingConfig").methodToSamplingMultiplier[a];a==0?d=0:a!=null&&(d/=a)}return d==1?1:d/b}function k(a,b,d,e){var f=c("uuidv4")();(b.requestId==null||b.requestId===""||typeof b.requestId!="string")&&(a.requestId!=null&&typeof a.requestId=="string"?b.requestId=a.requestId:b.requestId=f);b.requestId+="/_"+f.substring(0,4);b.resumeId="0";d!=null?b.sampleRate=d:b.sampleRate=void 0;f="";e!=null&&e.length>0&&(f=e);f.length>0&&(b.requestLogContext!=null&&b.requestLogContext.length>0?b.requestLogContext+=":":b.requestLogContext="",b.requestLogContext+=f);(a==null?void 0:a.method)==="Falco"&&(b.clientLoggingDisabled="Falco");d={};for(e=Object.keys(b).sort(),f=Array.isArray(e),a=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(f){if(a>=e.length)break;g=e[a++]}else{a=e.next();if(a.done)break;g=a.value}g=g;d[g]=b[g]}return JSON.stringify(d)}function a(a,b,d,e){b&&(!b.requestId.includes("/")&&!b.requestId.includes("#")||h(0,41721));e=j(a.method,(e=e)!=null?e:1);if(c("Random").coinflip(e))return k(a,b||{requestId:""},e,d);return i(b)?k(a,b||{requestId:""},null,d):""}g.isForceLogged=i;g.getSampleRateForLogging=j;g.normalizeInstrumentationData=k;g.validateInstrumentationData=a}),98);
__d("BladeRunnerClient",["Base64","BladeRunnerConfig","BladeRunnerLogger","BladeRunnerSocket","BladeRunnerSocketStream","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamTransport","cr:2046346"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){this.$2=d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,this.$1=a!=null?a:c("BladeRunnerSocket").get(),b&&(this.$2=b)}var e=a.prototype;e.createStream=function(a,b,c,d){return this.$3(a,b,c,d)};e.requestStream=function(a,c,d,e){a=this.$3(a,c,d,e);a.send();b("cr:2046346")!=null&&b("cr:2046346").startPulsarTest();return a};e.logInfo=function(a){c("BladeRunnerLogger").info(a)};e.bumpCounter=function(a){c("BladeRunnerLogger").bumpCounter(a)};e.$3=function(a,b,e,f){var g=new(d("BladeRunnerTypesInternal").GatewayStreamRequest)();g.streamId=this.$1.getNextStreamId();g.requestType=d("BladeRunnerTypes").StreamRequestType.BLADE_RUNNER;g.headers=c("BladeRunnerConfig").patchRequestHeaders(a);g.extraHeader=JSON.stringify(g.headers);g.payload=b!=null?c("Base64").encode(b):null;f!=null&&(f.transport="WEB_RS_MQTT");g.instrumentationData=d("RequestStreamE2ESampling").validateInstrumentationData(g.headers||{},f);g.e2eLogger=d("RequestStreamE2ELogger").createStreamLogger(g.headers,g.instrumentationData,this.$2);return new(c("BladeRunnerSocketStream"))(e,g,this.$1)};return a}();g["default"]=a}),98);
__d("BootloaderEventsPerf",["invariant","Bootloader","BootloaderEvents","ResourceTimingStore","objectEntries","objectValues"],(function(a,b,c,d,e,f,g,h){var i={total_count:0,total_bytes:0,downloaded_count:0,downloaded_bytes:0,cached_count:0,cached_bytes:0,inlined_count:0,inlined_bytes:0,duration:0,missing_count:0};function j(a,b,c){return Math.max(0,((c=c)!=null?c:0)-Math.max(a,(c=b)!=null?c:0))}function k(){return{blocking:babelHelpers["extends"]({},i),nonblocking:babelHelpers["extends"]({},i),"default":babelHelpers["extends"]({},i)}}function l(a,b,c){var e,f;if(c==null)e=0,f="downloaded";else if(c[1])e=c[0].length,f="inlined";else{c=d("ResourceTimingStore").getEntryForURL(c[0]);c?(e=c.encodedBodySize,f=c.transferSize===0?"cached":"downloaded"):(e=0,f="downloaded",a.missing_count++)}a.total_count++;a.total_bytes+=e;if(!b)return;a.duration=Math.max(a.duration,b);switch(f){case"downloaded":a.downloaded_count++;a.downloaded_bytes+=e;break;case"inlined":a.inlined_count++;a.inlined_bytes+=e;break;case"cached":a.cached_count++;a.cached_bytes+=e;break}}function m(a,b,d,e,f){var g=c("Bootloader").getResourceState(b);l(a,j(d,g.loadStart,g.loadEnd),e);g.loadError!=null&&f.add(b)}function n(a,b,d,e){var f=k();for(var a=c("objectEntries")(a),g=Array.isArray(a),i=0,a=g?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(g){if(i>=a.length)break;j=a[i++]}else{i=a.next();if(i.done)break;j=i.value}j=j;var l=j[0];j=j[1];for(var j=j,n=Array.isArray(j),o=0,j=n?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=j.length)break;p=j[o++]}else{o=j.next();if(o.done)break;p=o.value}p=p;var q=p[0];p=p[1];var r=void 0,s=void 0;switch(p.type){case"async":s=null;r=d;break;case"js":case"css":s=[p.src,p.d===1];r=f;break;default:p,h(0,3721)}m(r[l],q,b,s,e)}}return f}function o(a,b){var e={unpredicted:d("BootloaderEvents").newResourceMapSet(),ef:d("BootloaderEvents").newResourceMapSet(),overpredicted:d("BootloaderEvents").newResourceMapSet()};for(var f=c("objectEntries")(b),g=Array.isArray(f),h=0,f=g?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(g){if(h>=f.length)break;i=f[h++]}else{h=f.next();if(h.done)break;i=h.value}i=i;var j=i[0];i=i[1];for(var i=i.entries(),k=Array.isArray(i),l=0,i=k?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=i.length)break;m=i[l++]}else{l=i.next();if(l.done)break;m=l.value}m=m;var n=m[0];m=m[1];a[j].has(n)?e.ef[j].set(n,m):e.overpredicted[j].set(n,m)}}for(n=c("objectEntries")(a),m=Array.isArray(n),l=0,n=m?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(m){if(l>=n.length)break;k=n[l++]}else{l=n.next();if(l.done)break;k=l.value}i=k;j=i[0];h=i[1];for(g=h.entries(),f=Array.isArray(g),a=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(a>=g.length)break;k=g[a++]}else{a=g.next();if(a.done)break;k=a.value}i=k;h=i[0];k=i[1];b[j].has(h)||e.unpredicted[j].set(h,k)}}return e}function a(a){var b=a.efData,c=a.rsrcs,d=a.startTime,e=new Set(),f;if(b){var g=o(c,b.tierOne);f=g.unpredicted;g={ef:n(g.ef,b.fetchRsrcsStart,k(),e),overpredicted:n(g.overpredicted,b.fetchRsrcsStart,k(),e)};b={ef_fetch_predictions:b.fetchPredictionsEnd-b.fetchPredictionsStart,ef_fetch_start_wait:b.fetchPredictionsEnd-b.fetchRsrcsStart,ef_head_start:d-b.fetchRsrcsStart}}else f=c,g={},b={};c=babelHelpers["extends"]({unpredicted:n(f,d,k(),e)},g);return{source:a.source,source_detail:a.sourceDetail,is_first_identical:a.isFirstIdentical,timeslice_context:(f=a.timesliceContext)==null?void 0:f.name,start_time:d,err_count:e.size,resources:c,durations:babelHelpers["extends"]({jsmods_wait:a.jsmodsStart-d,jsmods:a.jsmodsEnd-a.jsmodsStart,jsmods_done_wait:a.jsmodsEnd-d,download_done_wait:a.logTime-d},b),payloadStats:a.payloadStats}}function b(a){var b=a.startTime,e=0,f=0,g=0,h=0;for(var i=a.components,m=Array.isArray(i),o=0,i=m?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(m){if(o>=i.length)break;p=i[o++]}else{o=i.next();if(o.done)break;p=o.value}p=p;p=c("Bootloader").getComponentTiming(p);var q=p.tierTwoStart,r=p.tierTwoEnd,s=p.tierThreeStart;p=p.tierThreeEnd;e=Math.max(e,j(b,q,r));f=Math.max(f,j(b,b,r));g=Math.max(g,j(b,s,p));h=Math.max(h,j(b,b,p))}q=new Set();r=k();s=n(a.tierOne,b,r,q);p=n(a.tierTwo,b,r,q);o=n(a.tierThree,b,r,q);m=r.blocking.downloaded_count!=0;i=k();var t=d("BootloaderEvents").newResourceMapSet(),u=new Set(),v=[a.tierOne,a.tierTwo,a.tierThree];for(var w=0;w<v.length;w++){var x=v[w];for(var x=c("objectValues")(x),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var A;if(y){if(z>=x.length)break;A=x[z++]}else{z=x.next();if(z.done)break;A=z.value}A=A;for(var A=A.keys(),B=Array.isArray(A),C=0,A=B?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var D;if(B){if(C>=A.length)break;D=A[C++]}else{C=A.next();if(C.done)break;D=C.value}D=D;u.add(D)}}}D=0;C=0;B=0;for(A=a.beRequests.values(),z=Array.isArray(A),y=0,A=z?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(z){if(y>=A.length)break;x=A[y++]}else{y=A.next();if(y.done)break;x=y.value}v=x;D+=j(b,b,v.requestStart);C+=v.serverGenTime;B+=v.jsmodsEnd-v.jsmodsStart;l(i[m?"blocking":"nonblocking"],v.responseStart-v.requestStart,[v.uri,!1]);for(w=c("objectEntries")(v.rsrcs),x=Array.isArray(w),v=0,w=x?w:w[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var E;if(x){if(v>=w.length)break;E=w[v++]}else{v=w.next();if(v.done)break;E=v.value}E=E;var F=E[0];E=E[1];for(var E=E,G=Array.isArray(E),H=0,E=G?E:E[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var I;if(G){if(H>=E.length)break;I=E[H++]}else{H=E.next();if(H.done)break;I=H.value}I=I;var J=I[0];I=I[1];u.has(J)||t[F].set(J,I)}}}J=n(t,b,r,q);return{ref:a.ref,components:a.components,timeslice_context:(I=a.timesliceContext)==null?void 0:I.name,start_time:b,err_count:q.size,resources:{t1:s,t2:p,t3:o,be:i,unpredicted:J,async:r},durations:{fetch_start_wait:a.fetchStartTime-b,be_start_wait:D,be_server_gen:C,be_jsmods:B,callback_wait:a.callbackStart-b,callback:a.callbackEnd-a.callbackStart,bootload_done_wait:a.callbackEnd-b,rdfd_requirelazy:e,rdfd_done_wait:f,rd_requirelazy:g,rd_done_wait:h}}}function e(a){a.start_time;var b=a.resources,d=a.durations;a=babelHelpers.objectWithoutPropertiesLoose(a,["start_time","resources","durations"]);for(var b=c("objectEntries")(b),e=Array.isArray(b),f=0,b=e?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=b.length)break;g=b[f++]}else{f=b.next();if(f.done)break;g=f.value}g=g;var h=g[0];g=g[1];for(var g=c("objectEntries")(g),i=Array.isArray(g),j=0,g=i?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=g.length)break;k=g[j++]}else{j=g.next();if(j.done)break;k=j.value}k=k;var l=k[0];k=k[1];for(var k=c("objectEntries")(k),m=Array.isArray(k),n=0,k=m?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var o;if(m){if(n>=k.length)break;o=k[n++]}else{n=k.next();if(n.done)break;o=n.value}o=o;var p=o[0];o=o[1];a[h+"_"+l+"_resources_"+p]=Math.round(Number(o))}}}for(p=c("objectEntries")(d),o=Array.isArray(p),n=0,p=o?p:p[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(o){if(n>=p.length)break;m=p[n++]}else{n=p.next();if(n.done)break;m=n.value}k=m;l=k[0];j=k[1];a[l+"_duration"]=Math.round(Number(j))}if(a.payloadStats){for(i=c("objectEntries")(a.payloadStats),g=Array.isArray(i),h=0,i=g?i:i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(h>=i.length)break;f=i[h++]}else{h=i.next();if(h.done)break;f=h.value}e=f;b=e[0];d=e[1];for(m=c("objectEntries")(d),k=Array.isArray(m),l=0,m=k?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(k){if(l>=m.length)break;j=m[l++]}else{l=m.next();if(l.done)break;j=l.value}n=j;o=n[0];p=n[1];a[b+"_"+o+"_count"]=Math.round(Number(p))}}delete a.payloadStats}return a}g.computeHRData=a;g.computeBLData=b;g.flattenData=e}),98);
__d("BootloaderLoggingStatusEnum",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["SUCCESS","TIMEOUT"]);c=a;f["default"]=c}),66);
__d("CometBootloaderEventsTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:CometBootloaderEventsLoggerConfig")}),null);
__d("HasteResponseFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1823926");b=d("FalcoLoggerInternal").create("haste_response",a);e=b;g["default"]=e}),98);
__d("CometBootloaderLoggerUtil",["BootloaderEvents","BootloaderEventsPerf","CometBootloaderEventsTypedLoggerLite","CometTimeSpentNavigation","HasteResponseFalcoEvent","ResourceTimingStore","SiteData","performanceNavigationStart"],(function(a,b,c,d,e,f,g){"use strict";var h=!1;function a(a){var b=a.bl_sample_rate,e=a.hr_sample_rate,f=a.parent_lid;if(h||!(b||e))return;h=!0;d("ResourceTimingStore").init();var g=function(a){return{ms_since_navstart:Math.round(a-c("performanceNavigationStart")()),parent_lid:f,pkg_cohort:c("SiteData").pkg_cohort,request_path:(a=c("CometTimeSpentNavigation").getPathInfo())==null?void 0:a.name,svn_rev:c("SiteData").client_revision}};e&&d("BootloaderEvents").onHasteResponse(function(a){return c("HasteResponseFalcoEvent").log(function(){var b=d("BootloaderEventsPerf").computeHRData(a),c=d("BootloaderEventsPerf").flattenData(b);return babelHelpers["extends"]({},c,g(b.start_time))})});var i=function(a,b,e){a=d("BootloaderEventsPerf").computeBLData(a);var f=d("BootloaderEventsPerf").flattenData(a);c("CometBootloaderEventsTypedLoggerLite").log(babelHelpers["extends"]({},f,g(a.start_time),{status:b}),{weight:e})};b&&d("BootloaderEvents").onBootload(function(a){return i(a,"SUCCESS",b)});var j=1;d("BootloaderEvents").onBootloaderCallbackTimeout(function(a){return i(a,"TIMEOUT",j)})}g.initLogging=a}),98);
__d("CometSSREntrypoint",["objectValues","relay-runtime/util/withProvidedVariables"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b,d=c("relay-runtime/util/withProvidedVariables")(a.variables,a.parameters.params.providedVariables);return{actor_id:(b=(b=a.environmentProviderOptions)==null?void 0:b.actorID)!=null?b:null,exclude_from_ssr:(b=(b=a.environmentProviderOptions)==null?void 0:b.excludeFromSSR)!=null?b:!1,graphql_env_override_ref:(b=(b=a.environmentProviderOptions)==null?void 0:b.graphQLEnvOverrideRef)!=null?b:null,id:a.parameters.params.id,name:a.parameters.params.name,num_connections_for_ssr:(a=(b=a.environmentProviderOptions)==null?void 0:b.numConnectionsForSSR)!=null?a:null,variables:d}}function i(a,b){b=a.getPreloadProps(b);var d=b.entryPoints;b=b.queries;b=(b=b)!=null?b:{};var e=c("objectValues")(b).filter(function(a){return a!=null}),f=[a.root.getModuleId()];if(d!=null){b=Object.keys(d);b.forEach(function(a){a=d[a];if(a==null)return;var b=a.entryPoint;a=a.entryPointParams;b=i(b,a);e=e.concat(b.queries);f=f.concat(b.roots)})}return{queries:e,roots:f}}function a(a,b){a=i(a,b);b=a.queries;return b.map(h)}function b(a){a=a.map(function(a){return i(a.entryPoint,a.entryPointParams)});return a.map(function(a){var b=a.queries;a=a.roots;return{quries:b.map(h),roots:a}})}function d(a,b){a=i(a,b);b=a.queries;a=a.roots;return{queries:b.map(h),roots:a}}function e(){throw new Error("This function should not be called. It exists solely for the type-generation")}function f(a,b){var d;a=a.map(function(a){return i(a.entryPoint,a.entryPointParams)});a=a.map(function(a){var b=a.queries;a=a.roots;return{queries:b.map(h),roots:a}});d=c("objectValues")((d=b==null?void 0:b.getDisplayQueries())!=null?d:{}).filter(function(a){return a!=null}).map(h);b=c("objectValues")((b=b==null?void 0:b.getDeferredQueries())!=null?b:{}).filter(function(a){return a!=null}).map(h);return{appshellQueries:{deferred:b,display:d},routeObjects:a}}g.processRootEntryPoint=a;g.processRootEntryPoints=b;g.processRootEntryPointData=d;g.preloadQuery=e;g.processServerEntryPoints=f}),98);
__d("CometRouterSSREntrypoint",["CometSSREntrypoint"],(function(a,b,c,d,e,f){"use strict";a=importNamespace("CometSSREntrypoint").processRootEntryPoint;b=importNamespace("CometSSREntrypoint").processRootEntryPointData;f.processRootEntryPoint=a;f.processRootEntryPointData=b}),66);
__d("CometRelayEF",["Bootloader","BootloaderEvents","ClientConsistencyEventEmitter","CometRouterSSREntrypoint","cometAsyncFetch","gkx","performanceAbsoluteNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map();function j(a,b){if(!c("gkx")("26332"))return;a=d("CometRouterSSREntrypoint").processRootEntryPoint(a,b);var e=[];a.forEach(function(a){a=a.name;i.has(a)||(e.push(a),d("BootloaderEvents").notifyHasteResponseEFStart("relay_3d",a))});if(e.length===0)return;var f=(h||(h=c("performanceAbsoluteNow")))(),g=c("cometAsyncFetch")("/ajax/relay-ef/",{data:{queries:e},method:"POST"}).then(function(a){return{fetchPredictionsEnd:(h||(h=c("performanceAbsoluteNow")))(),fetchPredictionsStart:f,payload:a}});e.forEach(function(a){return i.set(a,g)})}function a(a,b){if(!c("gkx")("26332"))return;var e=(h||(h=c("performanceAbsoluteNow")))();j(a,b);a=d("CometRouterSSREntrypoint").processRootEntryPoint(a,b);a.forEach(function(a){var b=a.name,f=i.get(b);f&&f!==!0&&c("promiseDone")(f,function(a){var f=a.fetchPredictionsEnd,g=a.fetchPredictionsStart;a=a.payload;if(a!=null&&typeof a==="object"){var h;c("Bootloader").loadPredictedResourceMap(a.predictions[b],{onLog:function(a){return d("BootloaderEvents").notifyHasteResponseEF("relay_3d",b,{fetchPredictionsEnd:f,fetchPredictionsStart:g,fetchRsrcsStart:e,tierOne:a})}},(h=(h=a.consistency)==null?void 0:h.rev)!=null?h:null);a.consistency!=null&&c("ClientConsistencyEventEmitter").emit("newEntry",a.consistency)}});i.set(a.name,!0)})}b={fetchPredictedResources:a,fetchPredictions:j};g["default"]=b}),98);
__d("CometToast.react",["fbt","ix","BaseToast.react","CometPressable.react","FDSCircleButton.react","FDSText.react","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react")),l=j.useMemo,m={pressable:{alignItems:"x6s0dn4",display:"x78zum5",flexDirection:"x1q0g3np",width:"xh8yej3",$$css:!0}};function a(a){var b=a.action,e=a.href,f=a.icon,g=a.impressionLoggingRef,j=a.message,n=a.onDismiss,o=a.supressCloseButton;o=o===void 0?!1:o;var p=a.target,q=a.testid;q=q===void 0?"Toast":q;q=a.truncateText;var r=q===void 0?!0:q,s=babelHelpers.objectWithoutPropertiesLoose(a,["action","href","icon","impressionLoggingRef","message","onDismiss","supressCloseButton","target","testid","truncateText"]),t=l(function(){return e!=null?{target:p,url:e}:void 0},[e,p]);return k.jsx(c("BaseToast.react"),{action:b!=null?{label:b.label,labelRenderer:function(a){return k.jsx(c("FDSText.react"),{color:"blueLink",numberOfLines:1,type:"bodyLink3",children:a})},onPress:b.onPress,testid:b.testid}:void 0,addOnStart:f,closeButton:o!==!0&&k.jsx(c("FDSCircleButton.react"),{icon:d("fbicon")._(i("478231"),12),label:h._("__JHASH__cCrSTii9yXy__JHASH__"),onPress:n,size:24,testid:void 0}),linkWrapper:s.onPress!=null||t!=null?function(a){return k.jsx(c("CometPressable.react"),babelHelpers["extends"]({},s,{expanding:!0,linkProps:t,xstyle:m.pressable,children:a}))}:void 0,message:function(a){a=a.toastMessageId;return k.jsx(c("FDSText.react"),{color:"primary",id:a,numberOfLines:r?4:void 0,type:"body3",children:j})},onDismiss:n,testid:void 0,toastRef:g})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("jsbi",[],(function(a,b,c,d,e,f){(function(a,b){"object"==typeof f&&"undefined"!=typeof e?e.exports=b():"function"==typeof define&&define.amd?define(b):a.JSBI=b()})(this,function(){"use strict";function a(b){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(b)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&g(a,b)}function f(a){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},f(a)}function g(a,b){return g=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},g(a,b)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function i(){return i=h()?Reflect.construct:function(a,b,c){var d=[null];d.push.apply(d,b);b=Function.bind.apply(a,d);a=new b;return c&&g(a,c.prototype),a},i.apply(null,arguments)}function j(a){return-1!==Function.toString.call(a).indexOf("[native code]")}function k(a){var b="function"==typeof Map?new Map:void 0;return k=function(a){function c(){return i(a,arguments,f(this).constructor)}if(null===a||!j(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!=typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),g(c,a)},k(a)}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:l(a)}var n=function(c){var h=Math.abs,i=Math.max,j=Math.imul,k=Math.clz32;function g(a,c){if(b(this,g),a>g.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return a=m(this,f(g).call(this,a)),a.sign=c,a}return e(g,c),d(g,[{key:"toDebugString",value:function(){var a=["BigInt["],b=!0,c=!1,d=void 0;try{for(var e,e,f=this[Symbol.iterator]();!(b=(e=f.next()).done);b=!0)e=e.value,a.push((e?(e>>>0).toString(16):e)+", ")}catch(a){c=!0,d=a}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}return a.push("]"),a.join("")}},{key:"toString",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>a||36<a)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(a&a-1)?g.__toStringBasePowerOfTwo(this,a):g.__toStringGeneric(this,a,!1)}},{key:"__copy",value:function(){for(var a=new g(this.length,this.sign),b=0;b<this.length;b++)a[b]=this[b];return a}},{key:"__trim",value:function(){for(var a=this.length,b=this[a-1];0===b;)a--,b=this[a-1],this.pop();return 0===a&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var a=0;a<this.length;a++)this[a]=0}},{key:"__clzmsd",value:function(){return k(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(a,b,c){c>this.length&&(c=this.length);for(var d=65535&a,a=a>>>16,e=0,f=65535&b,b=b>>>16,i=0;i<c;i++){var n=this.__digit(i),m=65535&n;n=n>>>16;var o=j(m,d);m=j(m,a);var p=j(n,d);n=j(n,a);var q=f+(65535&o);o=b+e+(q>>>16)+(o>>>16)+(65535&m)+(65535&p);f=(m>>>16)+(p>>>16)+(65535&n)+(o>>>16),e=f>>>16,f&=65535,b=n>>>16;this.__setDigit(i,65535&q|o<<16)}if(0!==e||0!==f||0!==b)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(a,b,c){for(var d,e=0,f=0;f<c;f++)d=this.__halfDigit(b+f)+a.__halfDigit(f)+e,e=d>>>16,this.__setHalfDigit(b+f,d);return e}},{key:"__inplaceSub",value:function(a,b,c){var d=0;if(1&b){b>>=1;for(var e=this.__digit(b),f=65535&e,k=0;k<c-1>>>1;k++){var l=a.__digit(k),m=(e>>>16)-(65535&l)-d;d=1&m>>>16,this.__setDigit(b+k,m<<16|65535&f),e=this.__digit(b+k+1),f=(65535&e)-(l>>>16)-d,d=1&f>>>16}m=a.__digit(k);l=(e>>>16)-(65535&m)-d;d=1&l>>>16,this.__setDigit(b+k,l<<16|65535&f);if(b+k+1>=this.length)throw new RangeError("out of bounds");0==(1&c)&&(e=this.__digit(b+k+1),f=(65535&e)-(m>>>16)-d,d=1&f>>>16,this.__setDigit(b+a.length,4294901760&e|65535&f))}else{b>>=1;for(l=0;l<a.length-1;l++){k=this.__digit(b+l);m=a.__digit(l);e=(65535&k)-(65535&m)-d;d=1&e>>>16;f=(k>>>16)-(m>>>16)-d;d=1&f>>>16,this.__setDigit(b+l,f<<16|65535&e)}k=this.__digit(b+l);m=a.__digit(l);f=(65535&k)-(65535&m)-d;d=1&f>>>16;e=0;0==(1&c)&&(e=(k>>>16)-(m>>>16)-d,d=1&e>>>16),this.__setDigit(b+l,e<<16|65535&f)}return d}},{key:"__inplaceRightShift",value:function(a){if(0!==a){for(var b,c=this.__digit(0)>>>a,d=this.length-1,e=0;e<d;e++)b=this.__digit(e+1),this.__setDigit(e,b<<32-a|c),c=b>>>a;this.__setDigit(d,c)}}},{key:"__digit",value:function(a){return this[a]}},{key:"__unsignedDigit",value:function(a){return this[a]>>>0}},{key:"__setDigit",value:function(a,b){this[a]=0|b}},{key:"__setDigitGrow",value:function(a,b){this[a]=0|b}},{key:"__halfDigitLength",value:function(){var a=this.length;return 65535>=this.__unsignedDigit(a-1)?2*a-1:2*a}},{key:"__halfDigit",value:function(a){return 65535&this[a>>>1]>>>((1&a)<<4)}},{key:"__setHalfDigit",value:function(a,b){var c=a>>>1,d=this.__digit(c);a=1&a?65535&d|b<<16:4294901760&d|65535&b;this.__setDigit(c,a)}}],[{key:"BigInt",value:function(b){var c=Math.floor,d=Number.isFinite;if("number"==typeof b){if(0===b)return g.__zero();if((0|b)===b)return 0>b?g.__oneDigit(-b,!0):g.__oneDigit(b,!1);if(!d(b)||c(b)!==b)throw new RangeError("The number "+b+" cannot be converted to BigInt because it is not an integer");return g.__fromDouble(b)}if("string"==typeof b){d=g.__fromString(b);if(null===d)throw new SyntaxError("Cannot convert "+b+" to a BigInt");return d}if("boolean"==typeof b)return!0===b?g.__oneDigit(1,!1):g.__zero();if("object"===a(b)){if(b.constructor===g)return b;c=g.__toPrimitive(b);return g.BigInt(c)}throw new TypeError("Cannot convert "+b+" to a BigInt")}},{key:"toNumber",value:function(a){var b=a.length;if(0===b)return 0;if(1===b){var c=a.__unsignedDigit(0);return a.sign?-c:c}c=a.__digit(b-1);var d=k(c),e=32*b-d;if(1024<e)return a.sign?-Infinity:1/0;e=e-1;c=c;b=b-1;d=d+1;var f=32===d?0:c<<d;f>>>=12;var h=d-12,i=12<=d?0:c<<20+d;d=20+d;0<h&&0<b&&(b--,c=a.__digit(b),f|=c>>>32-h,i=c<<h,d=h),0<d&&0<b&&(b--,c=a.__digit(b),i|=c>>>32-d,d-=32);h=g.__decideRounding(a,d,b,c);if((1===h||0===h&&1==(1&i))&&(i=i+1>>>0,0===i&&(f++,0!=f>>>20&&(f=0,e++,1023<e))))return a.sign?-Infinity:1/0;d=a.sign?-2147483648:0;return e=e+1023<<20,g.__kBitConversionInts[1]=d|e|f,g.__kBitConversionInts[0]=i,g.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(a){if(0===a.length)return a;var b=a.__copy();return b.sign=!a.sign,b}},{key:"bitwiseNot",value:function(a){return a.sign?g.__absoluteSubOne(a).__trim():g.__absoluteAddOne(a,!0)}},{key:"exponentiate",value:function(a,b){if(b.sign)throw new RangeError("Exponent must be positive");if(0===b.length)return g.__oneDigit(1,!1);if(0===a.length)return a;if(1===a.length&&1===a.__digit(0))return a.sign&&0==(1&b.__digit(0))?g.unaryMinus(a):a;if(1<b.length)throw new RangeError("BigInt too big");b=b.__unsignedDigit(0);if(1===b)return a;if(b>=g.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===a.length&&2===a.__digit(0)){var c=1+(b>>>5),d=a.sign&&0!=(1&b);d=new g(c,d);d.__initializeDigits();var e=1<<(31&b);return d.__setDigit(c-1,e),d}c=null;e=a;for(0!=(1&b)&&(c=a),b>>=1;0!==b;b>>=1)e=g.multiply(e,e),0!=(1&b)&&(null===c?c=e:c=g.multiply(c,e));return c}},{key:"multiply",value:function(a,b){if(0===a.length)return a;if(0===b.length)return b;var c=a.length+b.length;32<=a.__clzmsd()+b.__clzmsd()&&c--;c=new g(c,a.sign!==b.sign);c.__initializeDigits();for(var d=0;d<a.length;d++)g.__multiplyAccumulate(b,a.__digit(d),c,d);return c.__trim()}},{key:"divide",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return g.__zero();var c=a.sign!==b.sign,d=b.__unsignedDigit(0);if(1===b.length&&65535>=d){if(1===d)return c===a.sign?a:g.unaryMinus(a);d=g.__absoluteDivSmall(a,d,null)}else d=g.__absoluteDivLarge(a,b,!0,!1);return d.sign=c,d.__trim()}},{key:"remainder",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return a;var c=b.__unsignedDigit(0);if(1===b.length&&65535>=c){if(1===c)return g.__zero();c=g.__absoluteModSmall(a,c);return 0===c?g.__zero():g.__oneDigit(c,a.sign)}c=g.__absoluteDivLarge(a,b,!1,!0);return c.sign=a.sign,c.__trim()}},{key:"add",value:function(a,b){var c=a.sign;return c===b.sign?g.__absoluteAdd(a,b,c):0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c)}},{key:"subtract",value:function(a,b){var c=a.sign;return c===b.sign?0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c):g.__absoluteAdd(a,b,c)}},{key:"leftShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__rightShiftByAbsolute(a,b):g.__leftShiftByAbsolute(a,b)}},{key:"signedRightShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__leftShiftByAbsolute(a,b):g.__rightShiftByAbsolute(a,b)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(a,b){return 0>g.__compareToBigInt(a,b)}},{key:"lessThanOrEqual",value:function(a,b){return 0>=g.__compareToBigInt(a,b)}},{key:"greaterThan",value:function(a,b){return 0<g.__compareToBigInt(a,b)}},{key:"greaterThanOrEqual",value:function(a,b){return 0<=g.__compareToBigInt(a,b)}},{key:"equal",value:function(a,b){if(a.sign!==b.sign)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a.__digit(c)!==b.__digit(c))return!1;return!0}},{key:"notEqual",value:function(a,b){return!g.equal(a,b)}},{key:"bitwiseAnd",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteAnd(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length)+1;c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return c=g.__absoluteOr(c,d,c),g.__absoluteAddOne(c,!0,c).__trim()}if(a.sign){d=[b,a];a=d[0],b=d[1]}return g.__absoluteAndNot(a,g.__absoluteSubOne(b)).__trim()}},{key:"bitwiseXor",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteXor(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length);c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return g.__absoluteXor(c,d,c).__trim()}d=i(a.length,b.length)+1;if(a.sign){c=[b,a];a=c[0],b=c[1]}c=g.__absoluteSubOne(b,d);return c=g.__absoluteXor(c,a,c),g.__absoluteAddOne(c,!0,c).__trim()}},{key:"bitwiseOr",value:function(a,b){var c=i(a.length,b.length);if(!a.sign&&!b.sign)return g.__absoluteOr(a,b).__trim();if(a.sign&&b.sign){var d=g.__absoluteSubOne(a,c),e=g.__absoluteSubOne(b);return d=g.__absoluteAnd(d,e,d),g.__absoluteAddOne(d,!0,d).__trim()}if(a.sign){e=[b,a];a=e[0],b=e[1]}d=g.__absoluteSubOne(b,c);return d=g.__absoluteAndNot(d,a,d),g.__absoluteAddOne(d,!0,d).__trim()}},{key:"asIntN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=b.__unsignedDigit(c-1),e=1<<(31&a-1);if(b.length===c&&d<e)return b;if(!((d&e)===e))return g.__truncateToNBits(a,b);if(!b.sign)return g.__truncateAndSubFromPowerOfTwo(a,b,!0);if(0==(d&e-1)){for(var f=c-2;0<=f;f--)if(0!==b.__digit(f))return g.__truncateAndSubFromPowerOfTwo(a,b,!1);return b.length===c&&d===e?b:g.__truncateToNBits(a,b)}return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}},{key:"asUintN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(b.sign){if(a>g.__kMaxLengthBits)throw new RangeError("BigInt too big");return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=31&a;if(b.length==c){if(0==d)return b;c=b.__digit(c-1);if(0==c>>>d)return b}return g.__truncateToNBits(a,b)}},{key:"ADD",value:function(a,b){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a)return"string"!=typeof b&&(b=b.toString()),a+b;if("string"==typeof b)return a.toString()+b;if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)&&g.__isBigInt(b))return g.add(a,b);if("number"==typeof a&&"number"==typeof b)return a+b;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(a,b){return g.__compare(a,b,0)}},{key:"LE",value:function(a,b){return g.__compare(a,b,1)}},{key:"GT",value:function(a,b){return g.__compare(a,b,2)}},{key:"GE",value:function(a,b){return g.__compare(a,b,3)}},{key:"EQ",value:function(b,c){for(;;){if(g.__isBigInt(b))return g.__isBigInt(c)?g.equal(b,c):g.EQ(c,b);if("number"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("string"==typeof b){if(g.__isBigInt(c))return b=g.__fromString(b),null!==b&&g.equal(b,c);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("boolean"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,+b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("symbol"===a(b)){if(g.__isBigInt(c))return!1;if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("object"===a(b)){if("object"===a(c)&&c.constructor!==g)return b==c;b=g.__toPrimitive(b)}else return b==c}}},{key:"NE",value:function(a,b){return!g.EQ(a,b)}},{key:"__zero",value:function(){return new g(0,!1)}},{key:"__oneDigit",value:function(a,b){b=new g(1,b);return b.__setDigit(0,a),b}},{key:"__decideRounding",value:function(a,b,c,d){if(0<b)return-1;if(0>b)b=-b-1;else{if(0===c)return-1;c--,d=a.__digit(c),b=31}b=1<<b;if(0==(d&b))return-1;if(b-=1,0!=(d&b))return 1;for(;0<c;)if(c--,0!==a.__digit(c))return 1;return 0}},{key:"__fromDouble",value:function(a){g.__kBitConversionDouble[0]=a;var b,c=2047&g.__kBitConversionInts[1]>>>20;c=c-1023;var d=(c>>>5)+1;a=new g(d,0>a);var e=1048575&g.__kBitConversionInts[1]|1048576,f=g.__kBitConversionInts[0],k=20;c=31&c;var n=0;if(c<k){var m=k-c;n=m+32,b=e>>>m,e=e<<32-m|f>>>m,f<<=32-m}else if(c===k)n=32,b=e,e=f;else{m=c-k;n=32-m,b=e<<m|f>>>32-m,e=f<<m}a.__setDigit(d-1,b);for(c=d-2;0<=c;c--)0<n?(n-=32,b=e,e=f):b=0,a.__setDigit(c,b);return a.__trim()}},{key:"__isWhitespace",value:function(a){return!!(13>=a&&9<=a)||(159>=a?32==a:131071>=a?160==a||5760==a:196607>=a?(a&=131071,10>=a||40==a||41==a||47==a||95==a||4096==a):65279==a)}},{key:"__fromString",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=0,d=a.length,e=0;if(e===d)return g.__zero();for(var f=a.charCodeAt(e);g.__isWhitespace(f);){if(++e===d)return g.__zero();f=a.charCodeAt(e)}if(43===f){if(++e===d)return null;f=a.charCodeAt(e),c=1}else if(45===f){if(++e===d)return null;f=a.charCodeAt(e),c=-1}if(0===b){if(b=10,48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(b=16,++e===d)return null;f=a.charCodeAt(e)}else if(79===f||111===f){if(b=8,++e===d)return null;f=a.charCodeAt(e)}else if(66===f||98===f){if(b=2,++e===d)return null;f=a.charCodeAt(e)}}}else if(16===b&&48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(++e===d)return null;f=a.charCodeAt(e)}}for(;48===f;){if(++e===d)return g.__zero();f=a.charCodeAt(e)}var m=d-e,i=g.__kMaxBitsPerChar[b],j=g.__kBitsPerCharTableMultiplier-1;if(m>1073741824/i)return null;var k=i*m+j>>>g.__kBitsPerCharTableShift,l=new g(k+31>>>5,!1),n=10>b?b:10,o=10<b?b-10:0;if(0==(b&b-1)){i>>=g.__kBitsPerCharTableShift;var p=[],q=[],r=!1;do{for(var s,t=0,u=0;;){if(void 0,f-48>>>0<n)s=f-48;else if((32|f)-97>>>0<o)s=(32|f)-87;else{r=!0;break}if(u+=i,t=t<<i|s,++e===d){r=!0;break}if(f=a.charCodeAt(e),32<u+i)break}p.push(t),q.push(u)}while(!r);g.__fillFromParts(l,p,q)}else{l.__initializeDigits();var v=!1,w=0;do{for(var x,y=0,z=1;;){if(void 0,f-48>>>0<n)x=f-48;else if((32|f)-97>>>0<o)x=(32|f)-87;else{v=!0;break}var A=z*b;if(4294967295<A)break;if(z=A,y=y*b+x,w++,++e===d){v=!0;break}f=a.charCodeAt(e)}j=32*g.__kBitsPerCharTableMultiplier-1;var B=i*w+j>>>g.__kBitsPerCharTableShift+5;l.__inplaceMultiplyAdd(z,y,B)}while(!v)}if(e!==d){if(!g.__isWhitespace(f))return null;for(e++;e<d;e++)if(f=a.charCodeAt(e),!g.__isWhitespace(f))return null}return 0!==c&&10!==b?null:(l.sign=-1===c,l.__trim())}},{key:"__fillFromParts",value:function(a,b,c){for(var d=0,e=0,f=0,k=b.length-1;0<=k;k--){var l=b[k],m=c[k];e|=l<<f,f+=m,32===f?(a.__setDigit(d++,e),f=0,e=0):32<f&&(a.__setDigit(d++,e),f-=32,e=l>>>m-f)}if(0!==e){if(d>=a.length)throw new Error("implementation bug");a.__setDigit(d++,e)}for(;d<a.length;d++)a.__setDigit(d,0)}},{key:"__toStringBasePowerOfTwo",value:function(a,b){var c=a.length,d=b-1;d=(85&d>>>1)+(85&d),d=(51&d>>>2)+(51&d),d=(15&d>>>4)+(15&d);d=d;b=b-1;var e=a.__digit(c-1),f=k(e);f=0|(32*c-f+d-1)/d;if(a.sign&&f++,268435456<f)throw new Error("string too long");for(var h=Array(f),f=f-1,l=0,n=0,o=0;o<c-1;o++){var p=a.__digit(o),q=(l|p<<n)&b;h[f--]=g.__kConversionChars[q];q=d-n;for(l=p>>>q,n=32-q;n>=d;)h[f--]=g.__kConversionChars[l&b],l>>>=d,n-=d}p=(l|e<<n)&b;for(h[f--]=g.__kConversionChars[p],l=e>>>d-n;0!==l;)h[f--]=g.__kConversionChars[l&b],l>>>=d;if(a.sign&&(h[f--]="-"),-1!==f)throw new Error("implementation bug");return h.join("")}},{key:"__toStringGeneric",value:function(a,b,c){var d=a.length;if(0===d)return"";if(1===d){var e=a.__unsignedDigit(0).toString(b);return!1===c&&a.sign&&(e="-"+e),e}e=32*d-k(a.__digit(d-1));d=g.__kMaxBitsPerChar[b];d=d-1;e=e*g.__kBitsPerCharTableMultiplier;e+=d-1,e=0|e/d;var f;d=e+1>>1;e=g.exponentiate(g.__oneDigit(b,!1),g.__oneDigit(d,!1));var h=e.__unsignedDigit(0);if(1===e.length&&65535>=h){f=new g(a.length,!1),f.__initializeDigits();for(var i,j=0,l=2*a.length-1;0<=l;l--)i=j<<16|a.__halfDigit(l),f.__setHalfDigit(l,0|i/h),j=0|i%h;i=j.toString(b)}else{h=g.__absoluteDivLarge(a,e,!0,!0);f=h.quotient;l=h.remainder.__trim();i=g.__toStringGeneric(l,b,!0)}f.__trim();for(j=g.__toStringGeneric(f,b,!0);i.length<d;)i="0"+i;return!1===c&&a.sign&&(j="-"+j),j+i}},{key:"__unequalSign",value:function(a){return a?-1:1}},{key:"__absoluteGreater",value:function(a){return a?-1:1}},{key:"__absoluteLess",value:function(a){return a?1:-1}},{key:"__compareToBigInt",value:function(a,b){var c=a.sign;if(c!==b.sign)return g.__unequalSign(c);a=g.__absoluteCompare(a,b);return 0<a?g.__absoluteGreater(c):0>a?g.__absoluteLess(c):0}},{key:"__compareToNumber",value:function(a,b){if(!0|b){var c=a.sign,d=0>b;if(c!==d)return g.__unequalSign(c);if(0===a.length){if(d)throw new Error("implementation bug");return 0===b?0:-1}if(1<a.length)return g.__absoluteGreater(c);d=h(b);var e=a.__unsignedDigit(0);return e>d?g.__absoluteGreater(c):e<d?g.__absoluteLess(c):0}return g.__compareToDouble(a,b)}},{key:"__compareToDouble",value:function(a,b){if(b!==b)return b;if(b===1/0)return-1;if(b===-Infinity)return 1;var c=a.sign;if(c!==0>b)return g.__unequalSign(c);if(0===b)throw new Error("implementation bug: should be handled elsewhere");if(0===a.length)return-1;g.__kBitConversionDouble[0]=b;b=2047&g.__kBitConversionInts[1]>>>20;if(2047==b)throw new Error("implementation bug: handled elsewhere");b=b-1023;if(0>b)return g.__absoluteGreater(c);var d=a.length,e=a.__digit(d-1),f=k(e),l=32*d-f;b=b+1;if(l<b)return g.__absoluteLess(c);if(l>b)return g.__absoluteGreater(c);b=1048576|1048575&g.__kBitConversionInts[1];var m=g.__kBitConversionInts[0],o=20;f=31-f;if(f!==(l-1)%31)throw new Error("implementation bug");var p;l=0;if(f<o){var q=o-f;l=q+32,p=b>>>q,b=b<<32-q|m>>>q,m<<=32-q}else if(f===o)l=32,p=b,b=m;else{q=f-o;l=32-q,p=b<<q|m>>>32-q,b=m<<q}if(e>>>=0,p>>>=0,e>p)return g.__absoluteGreater(c);if(e<p)return g.__absoluteLess(c);for(f=d-2;0<=f;f--){0<l?(l-=32,p=b>>>0,b=m,m=0):p=0;o=a.__unsignedDigit(f);if(o>p)return g.__absoluteGreater(c);if(o<p)return g.__absoluteLess(c)}if(0!==b||0!==m){if(0===l)throw new Error("implementation bug");return g.__absoluteLess(c)}return 0}},{key:"__equalToNumber",value:function(a,b){return b|0===b?0===b?0===a.length:1===a.length&&a.sign===0>b&&a.__unsignedDigit(0)===h(b):0===g.__compareToDouble(a,b)}},{key:"__comparisonResultToBool",value:function(a,b){switch(b){case 0:return 0>a;case 1:return 0>=a;case 2:return 0<a;case 3:return 0<=a}throw new Error("unreachable")}},{key:"__compare",value:function(a,b,c){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a&&"string"==typeof b)switch(c){case 0:return a<b;case 1:return a<=b;case 2:return a>b;case 3:return a>=b}if(g.__isBigInt(a)&&"string"==typeof b)return b=g.__fromString(b),null!==b&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("string"==typeof a&&g.__isBigInt(b))return a=g.__fromString(a),null!==a&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)){if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("number"!=typeof b)throw new Error("implementation bug");return g.__comparisonResultToBool(g.__compareToNumber(a,b),c)}if("number"!=typeof a)throw new Error("implementation bug");if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToNumber(b,a),2^c);if("number"!=typeof b)throw new Error("implementation bug");return 0===c?a<b:1===c?a<=b:2===c?a>b:3===c?a>=b:void 0}},{key:"__absoluteAdd",value:function(a,b,c){if(a.length<b.length)return g.__absoluteAdd(b,a,c);if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);var d=a.length;(0===a.__clzmsd()||b.length===a.length&&0===b.__clzmsd())&&d++;for(var d=new g(d,c),c=0,e=0;e<b.length;e++){var f=b.__digit(e),h=a.__digit(e),m=(65535&h)+(65535&f)+c;h=(h>>>16)+(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}for(;e<a.length;e++){f=a.__digit(e);m=(65535&f)+c;h=(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}return e<d.length&&d.__setDigit(e,c),d.__trim()}},{key:"__absoluteSub",value:function(a,b,c){if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);for(var c=new g(a.length,c),d=0,e=0;e<b.length;e++){var f=a.__digit(e),l=b.__digit(e),m=(65535&f)-(65535&l)-d;d=1&m>>>16;f=(f>>>16)-(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}for(;e<a.length;e++){l=a.__digit(e);m=(65535&l)-d;d=1&m>>>16;f=(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}return c.__trim()}},{key:"__absoluteAddOne",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length;null===c?c=new g(d,b):c.sign=b;for(var e=!0,f=0;f<d;f++){var k=a.__digit(f),l=-1===k;e&&(k=0|k+1),e=l,c.__setDigit(f,k)}return e&&c.__setDigitGrow(d,1),c}},{key:"__absoluteSubOne",value:function(a,b){var c=a.length;b=b||c;for(var d=new g(b,!1),e=!0,f=0;f<c;f++){var k=a.__digit(f),l=0===k;e&&(k=0|k-1),e=l,d.__setDigit(f,k)}for(l=c;l<b;l++)d.__setDigit(l,0);return d}},{key:"__absoluteAnd",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,e,b=m,n}var k=f;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&b.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteAndNot",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;d<e&&(f=d);var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&~b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteOr",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)|b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteXor",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)^b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteCompare",value:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(c=a.length-1;0<=c&&a.__digit(c)===b.__digit(c);)c--;return 0>c?0:a.__unsignedDigit(c)>b.__unsignedDigit(c)?1:-1}},{key:"__multiplyAccumulate",value:function(a,b,c,d){if(0!==b){for(var e=65535&b,b=b>>>16,f=0,g=0,k=0,l=0;l<a.length;l++,d++){var m=c.__digit(d),n=65535&m,o=m>>>16,p=a.__digit(l),q=65535&p;p=p>>>16;var r=j(q,e);q=j(q,b);var s=j(p,e);p=j(p,b);n+=g+(65535&r),o+=k+f+(n>>>16)+(r>>>16)+(65535&q)+(65535&s),f=o>>>16,g=(q>>>16)+(s>>>16)+(65535&p)+f,f=g>>>16,g&=65535,k=p>>>16,m=65535&n|o<<16,c.__setDigit(d,m)}for(;0!==f||0!==g||0!==k;d++){r=c.__digit(d);q=(65535&r)+g;s=(r>>>16)+(q>>>16)+k+f;g=0,k=0,f=s>>>16,r=65535&q|s<<16,c.__setDigit(d,r)}}}},{key:"__internalMultiplyAdd",value:function(a,b,c,d,e){for(var c=c,f=0,h=0;h<d;h++){var l=a.__digit(h),m=j(65535&l,b),n=(65535&m)+f+c;c=n>>>16;l=j(l>>>16,b);m=(65535&l)+(m>>>16)+c;c=m>>>16,f=l>>>16,e.__setDigit(h,m<<16|65535&n)}if(e.length>d)for(e.__setDigit(d++,c+f);d<e.length;)e.__setDigit(d++,0);else if(0!==c+f)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(a,b,c){null===c&&(c=new g(a.length,!1));for(var d=0,e=2*a.length-1;0<=e;e-=2){var f=(d<<16|a.__halfDigit(e))>>>0,k=0|f/b;d=0|f%b,f=(d<<16|a.__halfDigit(e-1))>>>0;var l=0|f/b;d=0|f%b,c.__setDigit(e>>>1,k<<16|l)}return c}},{key:"__absoluteModSmall",value:function(a,b){for(var c,d=0,e=2*a.length-1;0<=e;e--)c=(d<<16|a.__halfDigit(e))>>>0,d=0|c%b;return d}},{key:"__absoluteDivLarge",value:function(a,b,c,d){var f=b.__halfDigitLength(),e=b.length,n=a.__halfDigitLength()-f,i=null;c&&(i=new g(n+2>>>1,!1),i.__initializeDigits());var l=new g(f+2>>>1,!1);l.__initializeDigits();var m=g.__clz16(b.__halfDigit(f-1));0<m&&(b=g.__specialLeftShift(b,m,0));for(var a=g.__specialLeftShift(a,m,1),k=b.__halfDigit(f-1),o=0,n=n;0<=n;n--){var p=65535,q=a.__halfDigit(n+f);if(q!==k){q=(q<<16|a.__halfDigit(n+f-1))>>>0;p=0|q/k;for(var q=0|q%k,r=b.__halfDigit(f-2),s=a.__halfDigit(n+f-2);j(p,r)>>>0>(q<<16|s)>>>0&&(p--,q+=k,!(65535<q)););}g.__internalMultiplyAdd(b,p,0,e,l);r=a.__inplaceSub(l,n,f+1);0!==r&&(r=a.__inplaceAdd(b,n,f),a.__setHalfDigit(n+f,a.__halfDigit(n+f)+r),p--),c&&(1&n?o=p<<16:i.__setDigit(n>>>1,o|p))}return d?(a.__inplaceRightShift(m),c?{quotient:i,remainder:a}:a):c?i:void 0}},{key:"__clz16",value:function(a){return k(a)-16}},{key:"__specialLeftShift",value:function(a,b,c){var e=a.length,d=new g(e+c,!1);if(0===b){for(var f=0;f<e;f++)d.__setDigit(f,a.__digit(f));return 0<c&&d.__setDigit(e,0),d}for(var j,f=0,l=0;l<e;l++)j=a.__digit(l),d.__setDigit(l,j<<b|f),f=j>>>32-b;return 0<c&&d.__setDigit(e,f),d}},{key:"__leftShiftByAbsolute",value:function(a,b){b=g.__toShiftAmount(b);if(0>b)throw new RangeError("BigInt too big");var c=b>>>5;b=31&b;var d=a.length,e=0!==b&&0!=a.__digit(d-1)>>>32-b,f=d+c+(e?1:0),m=new g(f,a.sign);if(0===b){for(var n=0;n<c;n++)m.__setDigit(n,0);for(;n<f;n++)m.__setDigit(n,a.__digit(n-c))}else{for(n=0,f=0;f<c;f++)m.__setDigit(f,0);for(var o,f=0;f<d;f++)o=a.__digit(f),m.__setDigit(f+c,o<<b|n),n=o>>>32-b;if(e)m.__setDigit(d+c,n);else if(0!==n)throw new Error("implementation bug")}return m.__trim()}},{key:"__rightShiftByAbsolute",value:function(a,b){var c=a.length,d=a.sign;b=g.__toShiftAmount(b);if(0>b)return g.__rightShiftByMaximum(d);var e=b>>>5;b=31&b;var f=c-e;if(0>=f)return g.__rightShiftByMaximum(d);var i=!1;if(d)if(0!=(a.__digit(e)&(1<<b)-1))i=!0;else for(var m=0;m<e;m++)if(0!==a.__digit(m)){i=!0;break}if(i&&0===b){m=a.__digit(c-1);0==~m&&f++}m=new g(f,d);if(0===b)for(f=e;f<c;f++)m.__setDigit(f-e,a.__digit(f));else{for(var n,d=a.__digit(e)>>>b,f=c-e-1,c=0;c<f;c++)n=a.__digit(c+e+1),m.__setDigit(c,n<<32-b|d),d=n>>>b;m.__setDigit(f,d)}return i&&(m=g.__absoluteAddOne(m,!0,m)),m.__trim()}},{key:"__rightShiftByMaximum",value:function(a){return a?g.__oneDigit(1,!0):g.__zero()}},{key:"__toShiftAmount",value:function(a){if(1<a.length)return-1;a=a.__unsignedDigit(0);return a>g.__kMaxLengthBits?-1:a}},{key:"__toPrimitive",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==a(b))return b;if(b.constructor===g)return b;var d=b[Symbol.toPrimitive];if(d){var e=d(c);if("object"!==a(e))return e;throw new TypeError("Cannot convert object to primitive value")}var f=b.valueOf;if(f){var k=f.call(b);if("object"!==a(k))return k}var l=b.toString;if(l){var m=l.call(b);if("object"!==a(m))return m}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(a){return g.__isBigInt(a)?a:+a}},{key:"__isBigInt",value:function(b){return"object"===a(b)&&b.constructor===g}},{key:"__truncateToNBits",value:function(a,b){for(var c=a+31>>>5,d=new g(c,b.sign),c=c-1,e=0;e<c;e++)d.__setDigit(e,b.__digit(e));e=b.__digit(c);if(0!=(31&a)){b=32-(31&a);e=e<<b>>>b}return d.__setDigit(c,e),d.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(a,b,c){for(var d=Math.min,e=a+31>>>5,c=new g(e,c),f=0,e=e-1,h=0,d=d(e,b.length);f<d;f++){var j=b.__digit(f),l=0-(65535&j)-h;h=1&l>>>16;j=0-(j>>>16)-h;h=1&j>>>16,c.__setDigit(f,65535&l|j<<16)}for(;f<e;f++)c.__setDigit(f,0|-h);l=e<b.length?b.__digit(e):0;j=31&a;if(0===j){d=0-(65535&l)-h;h=1&d>>>16;f=0-(l>>>16)-h;b=65535&d|f<<16}else{a=32-j;l=l<<a>>>a;d=1<<32-a;f=(65535&d)-(65535&l)-h;h=1&f>>>16;j=(d>>>16)-(l>>>16)-h;b=65535&f|j<<16,b&=d-1}return c.__setDigit(e,b),c.__trim()}},{key:"__digitPow",value:function(a,b){for(var c=1;0<b;)1&b&&(c*=a),b>>>=1,a*=a;return c}}]),g}(k(Array));return n.__kMaxLength=33554432,n.__kMaxLengthBits=n.__kMaxLength<<5,n.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],n.__kBitsPerCharTableShift=5,n.__kBitsPerCharTableMultiplier=1<<n.__kBitsPerCharTableShift,n.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n.__kBitConversionBuffer=new ArrayBuffer(8),n.__kBitConversionDouble=new Float64Array(n.__kBitConversionBuffer),n.__kBitConversionInts=new Int32Array(n.__kBitConversionBuffer),n})}),null);
__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],(function(a,b,c,d,e,f,g){var h,i=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),j=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:i.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:i.CT_BOOLEAN_FALSE}),k=[i.CT_STOP,0,i.CT_BOOLEAN_TRUE,i.CT_BYTE,i.CT_DOUBLE,0,i.CT_I16,0,i.CT_I32,0,i.CT_I64,i.CT_BINARY,i.CT_STRUCT,i.CT_MAP,i.CT_SET,i.CT_LIST,0,0,0,i.CT_FLOAT],l=Math.pow(2,7)-1,m=-1*Math.pow(2,7),n=Math.pow(2,15)-1,o=-1*Math.pow(2,15),p=Math.pow(2,31)-1,q=-1*Math.pow(2,31),r=Math.pow(2,32)-1,s=(a=c("jsbi")).BigInt("9223372036854775807"),t=a.BigInt("-9223372036854775808"),u=a.BigInt("18446744073709551615"),v=a.BigInt(63),w=a.BigInt(1),x=a.BigInt(0),y=a.BigInt(7),z=a.BigInt(70),A=a.BigInt(127),B=a.BigInt(128),C=Math.pow(2,4);b=function(){function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var b=a.prototype;b.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};b.readStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};b.writeStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeFieldBegin=function(a){if(a.ftype===(h||(h=c("ThriftTypes"))).BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,j.NONE)};b.writeListBegin=function(a){return this.$8(a)};b.writeListEnd=function(){return 0};b.writeSetBegin=function(a){return this.$8(a)};b.writeSetEnd=function(){return 0};b.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};b.writeMapEnd=function(){return 0};b.$7=function(a,b){var c=0;b=b===j.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=C-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};b.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=C-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};b.readFieldBegin=function(){var a=this.$1.readByte(),b=a&15;if(b===(h||(h=c("ThriftTypes"))).STOP)return{ftype:(h||(h=c("ThriftTypes"))).STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(b);(b===i.CT_BOOLEAN_TRUE||b===i.CT_BOOLEAN_FALSE)&&(this.$5=b===i.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};b.readListBegin=function(){return this.$11()};b.readListEnd=function(){return 0};b.readSetBegin=function(){return this.$11()};b.readSetEnd=function(){return 0};b.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};b.readMapEnd=function(){return 0};b.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};b.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};b.readFieldEnd=function(){return 0};b.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};b.writeByte=function(a){if(a<m||a>l)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};b.readFloat=function(){return this.$1.readFloatBE()};b.writeFloat=function(a){return this.$1.writeFloatBE(a)};b.readDouble=function(){return this.$1.readDoubleBE()};b.writeDouble=function(a){return this.$1.writeDoubleBE(a)};b.writeString=function(a){return this.writeBinary(d("StringToUtf8").StringToUtf8(a))};b.skip=function(a){switch(a){case(h||(h=c("ThriftTypes"))).STOP:return;case(h||(h=c("ThriftTypes"))).BOOL:this.readBool();break;case(h||(h=c("ThriftTypes"))).BYTE:this.readByte();break;case(h||(h=c("ThriftTypes"))).DOUBLE:this.readDouble();break;case(h||(h=c("ThriftTypes"))).I16:this.readI16();break;case(h||(h=c("ThriftTypes"))).I32:this.readI32();break;case(h||(h=c("ThriftTypes"))).I64:this.readI64();break;case(h||(h=c("ThriftTypes"))).STRING:this.readString();break;case(h||(h=c("ThriftTypes"))).STRUCT:this.readStructBegin();var b;while(!0){b=this.readFieldBegin();if(b.ftype===(h||(h=c("ThriftTypes"))).STOP)break;this.skip(b.ftype)}this.readStructEnd();break;case(h||(h=c("ThriftTypes"))).MAP:b=this.readMapBegin();if(b.size>0&&b.ktype!=null&&b.vtype!=null){var d=b.ktype,e=b.vtype;for(var f=0;f<b.size;f++)this.skip(d),this.skip(e)}break;case(h||(h=c("ThriftTypes"))).SET:case(h||(h=c("ThriftTypes"))).LIST:f=this.$11();for(d=0;d<f.size;d++)this.skip(f.etype);break;case(h||(h=c("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};b.toByteArray=function(){return this.$1.toByteArray()};b.writeFieldEnd=function(){return 0};b.writeFieldStop=function(){return this.$1.writeByte((h||(h=c("ThriftTypes"))).STOP)};b.writeI16=function(a){if(a<o||a>n)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<o||a>n)throw new Error("read invalid i16: "+a);return a};b.writeI32=function(a){if(a<q||a>p)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI32=function(){return this.zigzagToI32(this.readVarint32())};b.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};b.readI64=function(){return this.zigzagToI64(this.readVarint64())};b.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===i.CT_BOOLEAN_TRUE;return a};b.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?j.CT_BOOLEAN_TRUE:j.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?i.CT_BOOLEAN_TRUE:i.CT_BOOLEAN_FALSE);return b};b.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};b.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};b.i32ToZigzag=function(a){if(a<q||a>p)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};b.zigzagToI32=function(a){if(a<0||a>r)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};b.i64ToZigzag=function(a){if(c("jsbi").greaterThan(a,s)||c("jsbi").lessThan(a,t))throw new Error("i64 out of range: "+a.toString());return c("jsbi").bitwiseXor(c("jsbi").signedRightShift(a,v),c("jsbi").leftShift(a,w))};b.zigzagToI64=function(a){if(c("jsbi").lessThan(a,0)||c("jsbi").greaterThan(a,u))throw new Error("invalid uint64: "+a.toString());return c("jsbi").equal(c("jsbi").bitwiseAnd(a,w),w)?c("jsbi").bitwiseNot(c("jsbi").signedRightShift(a,w)):c("jsbi").signedRightShift(a,w)};b.writeVarint32=function(a){if(a<0||a>r)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};b.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};b.writeVarint64=function(a){if(c("jsbi").lessThan(a,x)||c("jsbi").greaterThan(a,u))throw new Error("invalid uint64: "+a.toString());a=a;var b=0;while(!0)if(c("jsbi").equal(c("jsbi").signedRightShift(a,y),x)){this.$1.writeByte(c("jsbi").toNumber(a));b++;break}else{var d,e=(d=c("jsbi")).toNumber(d.bitwiseOr(d.bitwiseAnd(a,A),B));this.$1.writeByte(e);b++;a=d.signedRightShift(a,y)}return b};b.readVarint64=function(){var a=x,b=x,d;while(!0){var e;d=(e=c("jsbi")).BigInt(this.$1.readByte());a=e.bitwiseOr(a,e.leftShift(e.bitwiseAnd(d,A),b));b=e.add(b,y);if(c("jsbi").equal(c("jsbi").bitwiseAnd(d,B),x)){if(c("jsbi").equal(b,z)&&c("jsbi").notEqual(d,w))throw new Error("result exceeded 64 bit limit");break}if(c("jsbi").greaterThan(b,v))throw new Error("result exceeded 64 bit limit")}return a};b.readString=function(){return d("Utf8ToString").Utf8ToString(this.readBinary())};b.getLastFieldId=function(){return this.$3};b.getLastField=function(){return this.$2};b.getBooleanFieldInfo=function(){return this.$4};b.getBooleanValue=function(){return this.$5};b.$9=function(a){return k[a]};b.$10=function(a){switch(a){case i.CT_STOP:return(h||(h=c("ThriftTypes"))).STOP;case i.CT_BOOLEAN_FALSE:case i.CT_BOOLEAN_TRUE:return(h||(h=c("ThriftTypes"))).BOOL;case i.CT_BYTE:return(h||(h=c("ThriftTypes"))).BYTE;case i.CT_I16:return(h||(h=c("ThriftTypes"))).I16;case i.CT_I32:return(h||(h=c("ThriftTypes"))).I32;case i.CT_I64:return(h||(h=c("ThriftTypes"))).I64;case i.CT_DOUBLE:return(h||(h=c("ThriftTypes"))).DOUBLE;case i.CT_FLOAT:return(h||(h=c("ThriftTypes"))).FLOAT;case i.CT_BINARY:return(h||(h=c("ThriftTypes"))).STRING;case i.CT_LIST:return(h||(h=c("ThriftTypes"))).LIST;case i.CT_SET:return(h||(h=c("ThriftTypes"))).SET;case i.CT_MAP:return(h||(h=c("ThriftTypes"))).MAP;case i.CT_STRUCT:return(h||(h=c("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}};return a}();g["default"]=b}),98);
__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){a=new(c("TReadBuffer"))(a);a=new(c("TCompactProtocolPolyfill"))(a);return b(a)}function a(a,b,c){try{return h(a,b)}catch(a){c!=null&&c(a)}return null}function i(a,b,d){d===void 0&&(d=!1);if(d){d=new(c("TNoOpWriteBuffer"))();var e=new(c("TCompactProtocolPolyfill"))(d);b(a,e);e=new(c("TWriteBuffer"))(d.currentSize())}else e=new(c("TWriteBuffer"))();d=new(c("TCompactProtocolPolyfill"))(e);b(a,d);return d.toByteArray()}function b(a,b,c,d){c===void 0&&(c=!1);try{return i(a,b,c)}catch(a){d!=null&&d(a)}return null}g.deserialize=h;g.deserializeNoThrow=a;g.serialize=i;g.serializeNoThrow=b}),98);
__d("ContextualConfigConstants",[],(function(a,b,c,d,e,f){"use strict";a=1e3;b=", ";c={SAME:"same",NULL:"null",NNULL:"nnull",CATCH_ALL:"catch_all",EQ:"eq",NEQ:"neq",LT:"lt",LTE:"lte",GT:"gt",GTE:"gte",COR:"cor",CONTAINS:"contains",REGEX:"regex",IN:"in",NIN:"nin"};d={DENSE:"dense",MULTI_OUTPUT_RESOLVED:"multi-output-resolved",TABLE:"table"};e=[];var g=[],h=[],i={BAD_BOOLEAN_FORMAT:"Bad boolean format",BAD_CONFIG:"Bad config",BAD_CONTEXT_IDENTIFIER:"Bad context identifier",BAD_CONTEXT_VALUE:"Bad context value",BAD_MONITORED_CONTEXTS:"Bad monitored contexts",BAD_NUMBER_FORMAT:"Bad number format",BAD_OUTPUT_NAME:"Bad output name",BAD_OUTPUT_TYPE:"Bad output type",BAD_VALUE_ORDER:"Bad values order",DUPLICATE_OUTPUT_NAME:"Duplicate output name",ILLEGAL_BOOLEAN_STRATEGY:"Illegal boolean strategy",ILLEGAL_BUCKET_VALUES:"Illegal bucket values",ILLEGAL_NUMERIC_STRATEGY:"Illegal numeric strategy",ILLEGAL_STRING_STRATEGY:"Illegal string strategy",INVALID_BOOLEAN:"Invalid boolean",INVALID_FLOAT:"Invalid float",INVALID_INTEGER:"Invalid integer",INVALID_STRING:"Invalid string",INVALID_VALUE_TYPE:"Invalid value type",MISMATCH_NUMBER_OF_VALUES:"Mismatching number of values",MISSING_BUCKETS:"Missing buckets",MISSING_BUCKET_MATCH:"Missing bucket match",MISSING_BUCKET_NAME:"Missing bucket name",MISSING_BUCKET_STRATEGY:"Missing bucket strategy",MISSING_CONTEXT_IN_CONFIG:"Missing context in config",MISSING_DEFAULT_VALUE:"Missing default value",MISSING_OUTPUTS_DEFINITION:"Missing outputs field definition",MISSING_RESULTS:"Missing results",MISSING_TABLE:"Missing table",MISSING_TABLE_ITEM_BUCKET:"Missing table item bucket",MISSING_TABLE_ITEM_VALUES:"Missing table item values",MISSING_VECTOR:"Missing vector",REGEX_SYNTAX_ERROR:"Regex syntax error",REQUESTED_PARAM_NOT_FOUND:"Requested param not found",RESULTS_VECTOR_SIZE_MISMATCH:"Results vector size mismatch",UNDECLARED_OUTPUT_PARAM:"Undeclared output param",UNKNOWN_BUCKET_DEFINITION:"Unknown bucket definition",UNKNOWN_CONFIG_TYPE:"Unknown config type",UNSUPPORTED_CONFIG_VERSION:"Unsupported config version"},j=10,k=", ",l={BOOL:"BOOL",FLOAT:"FLOAT",INT:"INT",STRING:"STRING"};f.ANALYTICS_SAMPLE_RATE=a;f.BUCKET_DELIMITER=b;f.CONTEXT_BUCKET_STRATEGY=c;f.CONFIG_TYPE=d;f.EMPTY_RESOLVED_CONTEXTS=e;f.EMPTY_RESOLVED_MONITORS=g;f.EMPTY_RESULT_PARAMS=h;f.ERROR=i;f.JSON_SUB_SAMPLE_RATE=j;f.LIST_DELIMITER=k;f.TYPE=l}),66);
__d("ContextualConfigResolvedContextsUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e.bucketIndex;if(e==void 0)break;b.push(e)}return b};b=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e.bucketName;if(e===void 0)break;b.push(e)}return b};var g=function(a){return a.name};c=function(a){return a.map(g)};d=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e.value;if(e===void 0)break;b.push(e)}return b};f.getBucketIndices=a;f.getBucketNames=b;f.getContextNames=c;f.getContextValues=d}),66);
__d("ContextualConfigCollateExposureData",["ContextualConfigConstants","ContextualConfigResolvedContextsUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=["cfg_ver_timestamp","policy_id","version","sample_rate"],i=function(a){return a.join(d("ContextualConfigConstants").LIST_DELIMITER)},j=function(a,b){for(var c=0;c<h.length;c++){var d=h[c];b[d]!=null&&(a[d]=b[d])}b.name&&(a.config_name=b.name)},k=function(a,b){var c=b[0],e=b[1],f=b[2];b=b[3];c!=null&&(a.exception=c.message);a.result=i(e.map(function(a){return a.value}))||"INVALID";a.context=i(d("ContextualConfigResolvedContextsUtils").getContextNames(f));a.context_value=i(d("ContextualConfigResolvedContextsUtils").getContextValues(f));a.bucket_name=i(d("ContextualConfigResolvedContextsUtils").getBucketNames(f));a.monitor=i(d("ContextualConfigResolvedContextsUtils").getContextNames(b));a.monitor_value=i(d("ContextualConfigResolvedContextsUtils").getContextValues(b))};function a(a,b,c){var e={sample_rate:d("ContextualConfigConstants").ANALYTICS_SAMPLE_RATE};j(e,a);k(e,b);c&&(e.config_contents=JSON.stringify(a));return e}g["default"]=a}),98);
__d("ContextualConfigExposureEvent",["Random"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){this.$2=a,this.$4=d("Random").random()<1/a.sample_rate,this.$3=b,this.$1=c}var b=a.prototype;b.getData=function(){return this.$2};b.log=function(a){var b=this.$2,c=this.$3,d=this.$4;a&&c(b);d&&this.$1(b);return this};b.isSampled=function(){return this.$4};return a}();g["default"]=a}),98);
__d("ContextualConfigExposureLoggerFactory",["ContextualConfigExposureEvent"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(a,b){this.$2=a,this.$1=b}var b=a.prototype;b.createEvent=function(a){var b=this.$1,d=this.$2;a=new(c("ContextualConfigExposureEvent"))(a,d,b);return a};return a}();function a(a,b){return new h(a,b)}g["default"]=a}),98);
__d("MarauderLogger",["Banzai","CacheStorage","MarauderConfig"],(function(a,b,c,d,e,f){var g="client_event",h="navigation",i=18e4,j="marauder",k="marauder_last_event_time",l="marauder_last_session_id",m={},n=[],o=!1,p=null,q=null,r=null,s=0,t,u,v=!1,w=null;function a(){F().set(k,x())}b("Banzai").subscribe(b("Banzai").SHUTDOWN,a);function x(){t=t||F().get(k)||0;return t}function y(){v||(u=F().get(l),v=!0);var a=Date.now();(!u||a-i>x())&&(u=a.toString(16)+"-"+(~~(Math.random()*16777215)).toString(16),F().set(l,u));return u}function z(){return{user_agent:window.navigator.userAgent,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,density:window.screen.devicePixelRatio||null,platform:window.navigator.platform||null,locale:window.navigator.language||null}}function A(){return{locale:navigator.language}}function B(a,b,c,d,e,f,g){var h=g!=null&&g!=0?g:Date.now();t=g!=null&&g!=0?Date.now():h;g=b!=null&&b!=""?b:p;return{name:a,time:h/1e3,module:g,obj_type:d,obj_id:e,uuid:f,extra:c}}function C(a,b,c){return B("content",null,{flags:b},null,null,a,c)}function D(a){var b=window.__mrdr;if(b)for(var c in b){var d=b[c];if(d[3]!==0){delete b[c];if(c==="1")if(r!==null)c=r;else continue;a.push(C(c,1,d[1]));a.push(C(c,2,d[2]));a.push(C(c,3,d[3]))}}}function E(a,c){D(a);if(a.length===0)return;o&&a.push(B("counters",null,m));var d=b("Banzai").BASIC;c==="vital"&&(d=b("Banzai").VITAL);var e=b("MarauderConfig").gk_enabled;s===0&&e&&(a.push(B("device_status",null,A())),d={delay:5e3});c==="signal"&&(d={signal:!0});e&&Math.random()<.01&&a.push(B("device_info",null,z()));if(r!==null)for(c=0;c<a.length;c++){e=a[c];(e.uuid===null||e.uuid===void 0)&&(e.uuid=r)}e={app_ver:b("MarauderConfig").app_version,data:a,device_id:void 0,log_type:g,seq:s++,session_id:y()};c=F().get("device_id");c&&(e.device_id=c);m={};o=!1;b("Banzai").post(j,e,d)}function F(){w||(w=new(b("CacheStorage"))("localstorage",""));return w}function c(a){m[a]||(m[a]=0),m[a]++,o=!0}function G(b,a,c,d,f,g,h,i){E([B(b,a,c,d,f,g,h)],i)}function H(a,b){p!==b&&(n.push(B(h,p,{dest_module:b,source_url:q,destination_url:a})),p=b,q=a)}function d(a,b){p!==b&&(r=null,H(a,b))}function f(a,b,c){G(b?"show_module":"hide_module",a,c)}function I(a){p=a}function J(){return p}function K(a){r===null&&(r=a,a!==null&&(E(n),n=[]))}e.exports={count:c,log:G,navigateTo:d,navigateWithinSession:H,toggleModule:f,setUUID:K,setNavigationModule:I,getNavigationModule:J}}),null);
__d("ContextualConfigExposureLogger",["ContextualConfigExposureLoggerFactory","MarauderLogger"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){};b=function(a){d("MarauderLogger").log("contextual_config_exposure","",a)};e=c("ContextualConfigExposureLoggerFactory")(a,b);g["default"]=e}),98);
__d("ContextualConfigAssert",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){if(a===!1)throw new Error(b)}f["default"]=a}),66);
__d("ContextualConfigValidators",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return Array.isArray(a)};b=function(a){return typeof a==="boolean"};c=function(a){return a!=null};e=function(a){return function(b){return Object.prototype.hasOwnProperty.call(a,b)}};f=function(a){return i(a)&&a%1===0};var h=function(a){return j(a)&&a.length>0},i=function(a){return typeof a==="number"&&!isNaN(a)&&a!==Infinity&&a!==-Infinity},j=function(a){return typeof a==="string"},k=function(a){switch(a){case d("ContextualConfigConstants").TYPE.BOOL:case d("ContextualConfigConstants").TYPE.FLOAT:case d("ContextualConfigConstants").TYPE.INT:case d("ContextualConfigConstants").TYPE.STRING:return!0;default:return!1}};g.isArray=a;g.isBoolean=b;g.isDefined=c;g.isKey=e;g.isInteger=f;g.isNonEmptyString=h;g.isNumber=i;g.isString=j;g.isType=k}),98);
__d("ContextualConfigParseBoolean",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.toUpperCase()){case"TRUE":return!0;case"FALSE":return!1;default:throw new Error(d("ContextualConfigConstants").ERROR.BAD_BOOLEAN_FORMAT)}}g["default"]=a}),98);
__d("ContextualConfigParsePredBoolean",["ContextualConfigConstants","ContextualConfigParseBoolean"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var f=c("ContextualConfigParseBoolean")(a);e=function(a){return a===f};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:e=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:e=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:e=function(a){return!0};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_BOOLEAN_STRATEGY)}return function(a){return e(a)}}g["default"]=a}),98);
__d("ContextualConfigParseFloat",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=/^[-\+]?([1-9]\d*|0)(\.\d+)?$/,j=function(a){return i.test(a)};function a(a){(h||(h=c("ContextualConfigAssert")))(j(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);a=parseFloat(a);h(d("ContextualConfigValidators").isNumber(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);return a}g["default"]=a}),98);
__d("ContextualConfigParseInteger",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=/^[-\+]?([1-9]\d*|0)$/,j=function(a){return i.test(a)};function a(a){(h||(h=c("ContextualConfigAssert")))(j(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);a=parseInt(a,10);h(d("ContextualConfigValidators").isNumber(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);return a}g["default"]=a}),98);
__d("ContextualConfigPredAssertions",["ContextualConfigAssert","ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){return(h||(h=c("ContextualConfigAssert")))(a>0,d("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)};b=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a===b,d("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)};e=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a<b,d("ContextualConfigConstants").ERROR.BAD_VALUE_ORDER)};g.assertHasValues=a;g.assertNumberOfValues=b;g.assertValueOrder=e}),98);
__d("ContextualConfigParsePredNumeric",["ContextualConfigConstants","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigPredAssertions","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e,f){var g=e.map(f?c("ContextualConfigParseInteger"):h||(h=c("ContextualConfigParseFloat"))),i;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var j=f?c("ContextualConfigParseInteger")(a):(h||(h=c("ContextualConfigParseFloat")))(a);i=function(a){return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a===j};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:i=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:i=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:i=function(a){return!0};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.COR:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,2);d("ContextualConfigPredAssertions").assertValueOrder(g[0],g[1]);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>=g[0]&&a<g[1]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LT:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a<g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LTE:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a<=g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.EQ:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a===g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NEQ:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a!==g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GT:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GTE:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>=g[0]};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_NUMERIC_STRATEGY)}return function(a){return i(a)}}g["default"]=a}),98);
__d("ContextualConfigParseRegExp",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h=/^\/(.+)\/(.*)$/;function a(a){try{var b=a.match(h);if(b!=null)return new RegExp(b[1],b[2]);else return new RegExp(a)}catch(a){throw new Error(d("ContextualConfigConstants").ERROR.REGEX_SYNTAX_ERROR)}}g["default"]=a}),98);
__d("ContextualConfigParsePredString",["ContextualConfigConstants","ContextualConfigParseRegExp","ContextualConfigPredAssertions"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){if(typeof a!=="string")throw new Error(d("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE);return a},i=function(a){var b=[];for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;b.push(h(e))}return b};function a(a,b,e){var f=i(e),g;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:g=function(b){return typeof b!=="string"?!1:b===a};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:g=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:g=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:g=function(a){return!0};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.IN:d("ContextualConfigPredAssertions").assertHasValues(f.length);g=function(a){return typeof a!=="string"?!1:f.indexOf(a)!==-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NIN:d("ContextualConfigPredAssertions").assertHasValues(f.length);g=function(a){return typeof a!=="string"?!1:f.indexOf(a)===-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CONTAINS:d("ContextualConfigPredAssertions").assertNumberOfValues(f.length,1);g=function(a){return typeof a!=="string"?!1:a.indexOf(f[0])!==-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.REGEX:d("ContextualConfigPredAssertions").assertNumberOfValues(f.length,1);var h=c("ContextualConfigParseRegExp")(f[0]);g=function(a){return typeof a!=="string"?!1:h.test(a)};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_STRING_STRATEGY)}return function(a){return g(a)}}g["default"]=a}),98);
__d("ContextualConfigParseContextBuckets",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParsePredBoolean","ContextualConfigParsePredNumeric","ContextualConfigParsePredString","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},k=d("ContextualConfigValidators").isKey(d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY),l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isString(a)&&k(a.toUpperCase()),d("ContextualConfigConstants").ERROR.MISSING_BUCKET_STRATEGY)},m=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.ILLEGAL_BUCKET_VALUES)},n=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKET_NAME)},o=function(a,b){var e=b.name;n(e);var f=b.strategy;l(f);b=b.values||[];m(b);switch(a){case d("ContextualConfigConstants").TYPE.BOOL:return c("ContextualConfigParsePredBoolean")(e,f);case d("ContextualConfigConstants").TYPE.FLOAT:return c("ContextualConfigParsePredNumeric")(e,f,b,!1);case d("ContextualConfigConstants").TYPE.INT:return c("ContextualConfigParsePredNumeric")(e,f,b,!0);case d("ContextualConfigConstants").TYPE.STRING:return c("ContextualConfigParsePredString")(e,f,b);default:throw new Error(d("ContextualConfigConstants").ERROR.UNKNOWN_BUCKET_DEFINITION)}},p=function(a,b){i(b);var c=b.name;n(c);return{name:c,pred:o(a,b)}};function a(a,b){j(b);return b.map(function(b){return p(a,b)})}g["default"]=a}),98);
__d("ContextualConfigParseContexts",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContextBuckets","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a)&&a.length>0,d("ContextualConfigConstants").ERROR.MISSING_CONTEXT_IN_CONFIG)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(a){i(a);var b=a.name,d=a.type;a=a.buckets;k(b);l(d);return{name:b,type:d,buckets:c("ContextualConfigParseContextBuckets")(d,a)}};function a(a){j(a);return a.map(m)}g["default"]=a}),98);
__d("ContextualConfigIsEqualParams",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c+=1){var d=a[c],e=b[c];if(d.name!==e.name||d.type!==e.type)return!1}return!0}f["default"]=a}),66);
__d("ContextualConfigParseResultParamValue",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseBoolean","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isString(a),d("ContextualConfigConstants").ERROR.INVALID_STRING)};function a(a,b){j(b);switch(a){case d("ContextualConfigConstants").TYPE.BOOL:return c("ContextualConfigParseBoolean")(b);case d("ContextualConfigConstants").TYPE.FLOAT:return(i||(i=c("ContextualConfigParseFloat")))(b);case d("ContextualConfigConstants").TYPE.INT:return c("ContextualConfigParseInteger")(b);case d("ContextualConfigConstants").TYPE.STRING:return b;default:throw new Error(d("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE)}}g["default"]=a}),98);
__d("ContextualConfigParseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_RESULTS)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},m=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},n=function(a,b){for(var a=a,c=Array.isArray(a),e=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;if(f.name===b)return f.type}throw new Error(d("ContextualConfigConstants").ERROR.UNDECLARED_OUTPUT_PARAM)},o=function(a){return function(b){k(b);var d=b.name;l(d);var e=n(a,d);m(e);b=(i||(i=c("ContextualConfigParseResultParamValue")))(e,b.value);return{name:d,type:e,value:b}}};function a(a,b){j(b);return b.map(o(a))}g["default"]=a}),98);
__d("ContextualConfigParseDenseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b){return(h||(h=c("ContextualConfigAssert")))(c("ContextualConfigIsEqualParams")(a,b),d("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)};function a(a,b){b=c("ContextualConfigParseResultParams")(a,b.map(function(b,c){return{name:a[c].name,value:b}}));i(a,b);return b}g["default"]=a}),98);
__d("ContextualConfigParseDenseDefaults",["ContextualConfigConstants","ContextualConfigParseDenseResultParams"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){try{return c("ContextualConfigParseDenseResultParams")(a,b)}catch(a){throw new Error(d("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)}}g["default"]=a}),98);
__d("ContextualConfigParseMonitors",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.BAD_MONITORED_CONTEXTS)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(a){i(a);var b=a.name;a=a.type;k(b);l(a);return{name:b,type:a}};function a(a){j(a);return a.map(m)}g["default"]=a}),98);
__d("ContextualConfigParseOutputParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_OUTPUTS_DEFINITION)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_OUTPUT_TYPE)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_OUTPUT_NAME)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(m(a),d("ContextualConfigConstants").ERROR.DUPLICATE_OUTPUT_NAME)},m=function(a){var b={};for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(b[e.name])return!1;b[e.name]=!0}return!0},n=function(a){k(a.name);j(a.type);return a};function a(a){i(a);a=a.map(n);l(a);return a}g["default"]=a}),98);
__d("ContextualConfigParseVector",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_VECTOR)},k=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a===b,d("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)},l=function(a,b){k(a.length,b.length);for(var d=0;d<a.length;d+=1){var e=a[d].type,f=b[d];(i||(i=c("ContextualConfigParseResultParamValue")))(e,f)}},m=function(a){return a.reduce(function(a,b){b=b.buckets;return a*b.length},1)};function a(a,b,c){j(c);b=m(b);var d=a.length;k(b*d,c.length);for(var e=0;e<b;e+=1){var f=e*d;l(a,c.slice(f,f+d))}return c}g["default"]=a}),98);
__d("ContextualConfigResolveContexts",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b){for(var c=0;c<a.length;c+=1){var d=a[c];try{if(d.pred(b))return[d.name,c]}catch(a){return null}}return null};function a(a,b,c){var e=null;a=a.map(function(a){var f=a.name,g={name:f};if(e!=null)return g;var i;c[f]!=null?i=c[f]:b[f]!=null?i=b[f]():i=null;g.value=i;if(a.buckets!=null){f=h(a.buckets,i);if(f==null){e=new Error(d("ContextualConfigConstants").ERROR.MISSING_BUCKET_MATCH);return g}a=f[0];i=f[1];g.bucketName=a;g.bucketIndex=i}return g});return[e,a]}g["default"]=a}),98);
__d("DenseContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContexts","ContextualConfigParseDenseDefaults","ContextualConfigParseDenseResultParams","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseVector","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)},j=function(a){var b=[],c=1;for(var d=a.length-1;d>=0;d-=1)b.push(c),c*=a[d].buckets.length;return b.reverse()},k=function(a,b,d,e){try{b=b.slice(d,d+a.length);return[null,c("ContextualConfigParseDenseResultParams")(a,b)]}catch(a){return[a,e]}},l=function(a,b,d){try{d=d.reduce(function(b,d,e){(h||(h=c("ContextualConfigAssert")))(e<a.length,"Auxillery index out of range.");return b+a[e]*d},0);return[null,d*b]}catch(a){return[a,-1]}};a=function(){function a(a,b){i(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);var d=c("ContextualConfigParseContexts")(a.contexts);this.aux=j(d);this.contexts=d;this.defaults=c("ContextualConfigParseDenseDefaults")(b,a.vectorDefaults);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.outputs=b;this.vector=c("ContextualConfigParseVector")(b,d,a.vector)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.defaults,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.aux,e=this.globalContextProviders,f=this.contexts,g=this.defaults,h=this.monitors,i=this.outputs,j=this.vector;f=c("ContextualConfigResolveContexts")(f,e,a);var m=f[0];f=f[1];if(m!=null)return[m,g,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];m=l(b,i.length,d("ContextualConfigResolvedContextsUtils").getBucketIndices(f));b=m[0];m=m[1];if(b!=null)return[b,g,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];b=k(i,j,m,g);i=b[0];j=b[1];if(i!=null)return[i,j,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];m=c("ContextualConfigResolveContexts")(h,e,a);g=m[0];b=m[1];return g!=null?[g,j,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,j,f,b]};return a}();g["default"]=a}),98);
__d("MultiOutputResolvedContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseResultParams","ContextualConfigResolveContexts","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)};a=function(){function a(a,b){i(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.values=c("ContextualConfigParseResultParams")(b,a.values)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.values,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.globalContextProviders,e=this.monitors,f=this.values;e=c("ContextualConfigResolveContexts")(e,b,a);b=e[0];a=e[1];return b!=null?[b,f,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,f,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,a]};return a}();g["default"]=a}),98);
__d("ContextualConfigMergePartialResultParams",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c={};for(var b=b,d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;c[f.name]=f}f=[];for(e=a,d=Array.isArray(e),b=0,e=d?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(d){if(b>=e.length)break;a=e[b++]}else{b=e.next();if(b.done)break;a=b.value}a=a;var g=c[a.name];f.push(g!=null&&g.name===a.name&&g.type===a.type?g:a)}return f}f["default"]=a}),66);
__d("ContextualConfigParseDefaults",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b){return(h||(h=c("ContextualConfigAssert")))(c("ContextualConfigIsEqualParams")(a,b),d("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)};function a(a,b){b=c("ContextualConfigParseResultParams")(a,b);i(a,b);return b}g["default"]=a}),98);
__d("ContextualConfigParseTable",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParams","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_BUCKET)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_VALUES)},m=function(a,b){j(b);var d=b.bucket;b=b.values;k(d);l(b);return{bucket:d,values:c("ContextualConfigParseResultParams")(a,b)}};function a(a,b){i(b);return b.reduce(function(b,c){c=m(a,c);b[c.bucket]=c.values;return b},{})}g["default"]=a}),98);
__d("TableContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigMergePartialResultParams","ContextualConfigParseContexts","ContextualConfigParseDefaults","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseTable","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[],j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)};a=function(){function a(a,b){j(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);this.contexts=c("ContextualConfigParseContexts")(a.contexts);this.defaults=c("ContextualConfigParseDefaults")(b,a.defaults);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.table=c("ContextualConfigParseTable")(b,a.table)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.defaults,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.globalContextProviders,e=this.contexts,f=this.defaults,g=this.monitors,h=this.table;e=c("ContextualConfigResolveContexts")(e,b,a);var j=e[0];e=e[1];if(j!=null)return[j,f,e,[]];j=d("ContextualConfigResolvedContextsUtils").getBucketNames(e).join(d("ContextualConfigConstants").BUCKET_DELIMITER);h=h[j]||i;j=c("ContextualConfigMergePartialResultParams")(f,h);f=c("ContextualConfigResolveContexts")(g,b,a);h=f[0];g=f[1];return h!=null?[h,j,e,[]]:[null,j,e,g]};return a}();g["default"]=a}),98);
__d("ContextualConfigParseConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators","DenseContextualConfig","MultiOutputResolvedContextualConfig","TableContextualConfig"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[1],j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a)&&d("ContextualConfigValidators").isDefined(a.version),d("ContextualConfigConstants").ERROR.BAD_CONFIG)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(i.indexOf(a)!==-1,d("ContextualConfigConstants").ERROR.UNSUPPORTED_CONFIG_VERSION)};function a(a,b){j(a);k(a.version);switch(a.cctype){case d("ContextualConfigConstants").CONFIG_TYPE.DENSE:return new(c("DenseContextualConfig"))(a,b);case d("ContextualConfigConstants").CONFIG_TYPE.MULTI_OUTPUT_RESOLVED:return new(c("MultiOutputResolvedContextualConfig"))(a,b);case d("ContextualConfigConstants").CONFIG_TYPE.TABLE:return new(c("TableContextualConfig"))(a,b);default:throw new Error(d("ContextualConfigConstants").ERROR.UNKNOWN_CONFIG_TYPE)}}g["default"]=a}),98);
__d("ContextualConfigWarn",[],(function(a,b,c,d,e,f){"use strict";function a(a){}f["default"]=a}),66);
__d("ContextualConfigResult",["ContextualConfigConstants","ContextualConfigWarn"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a.reduce(function(a,b){var c=b.name;b=b.value;a[c]=b;return a},{}),this.$2=a}var b=a.prototype;b.get=function(a,b){try{a=this.$1[a];if(typeof a!==typeof b){c("ContextualConfigWarn")(d("ContextualConfigConstants").ERROR.REQUESTED_PARAM_NOT_FOUND);return b}return a}catch(a){c("ContextualConfigWarn")(a.message);return b}};b.getParams=function(){return this.$2};return a}();g["default"]=a}),98);
__d("ErrorContextualConfig",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.error=a}var b=a.prototype;b.resolve=function(a){return[this.error,d("ContextualConfigConstants").EMPTY_RESULT_PARAMS,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]};return a}();g["default"]=a}),98);
__d("ContextualConfig",["ContextualConfigCollateExposureData","ContextualConfigConstants","ContextualConfigExposureLogger","ContextualConfigParseConfig","ContextualConfigResult","ErrorContextualConfig","Random"],(function(a,b,c,d,e,f,g){"use strict";var h=1/d("ContextualConfigConstants").JSON_SUB_SAMPLE_RATE,i=1;a=function(){function a(a,b){b===void 0&&(b={}),this.isDebugLoggingEnabled=!1,this.$3=!1,this.$4=a,this.$2=b}var b=a.prototype;b.$5=function(){if(this.$1)return this.$1;var a=this.$2,b=this.$4;try{b=c("ContextualConfigParseConfig")(b,a)}catch(a){b=new(c("ErrorContextualConfig"))(a)}this.$1=b;return b};b.$6=function(a){var b=this.isDebugLoggingEnabled,e=this.$4,f=this.$3;f=!f&&d("Random").random()<h;f&&(this.$3=!0);e=c("ContextualConfigCollateExposureData")(e,a,f);a=c("ContextualConfigExposureLogger").createEvent(e);a.log(b)};b.resolve=function(a){a===void 0&&(a={});var b=this.$1||this.$5();b=b.resolve(a);this.$6(b);return new(c("ContextualConfigResult"))(b[i])};return a}();g["default"]=a}),98);
__d("DgwClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1755537");b=d("FalcoLoggerInternal").create("dgw_client",a);e=b;g["default"]=e}),98);
__d("DGWLoggingContext",["$InternalEnum","DgwClientFalcoEvent","ODS","Random"],(function(a,b,c,d,e,f,g){"use strict";var h;a="dgw_client";var i=b("$InternalEnum")({STREAM_GROUP_COMPONENT:"WebStreamGroup",GROUPED_STREAM_COMPONENT:"GroupedWebStream",WEBSOCKET_TRANSPORT_COMPONENT:"WebSocketTransport",ACK_MANAGER_COMPONENT:"WebStreamAckManager",CODEC_COMPONENT:"WebCodec",RAW_CLIENT:"RAWDGWClient",PINGER:"DGWPinger"}),j={VERBOSE:-1,INFO:0,WARNING:1,ERROR:2,FATAL:3};function k(a){switch(a){case i.GROUPED_STREAM_COMPONENT:case i.ACK_MANAGER_COMPONENT:return!0;default:return!1}}e=function(){function a(a,b,c,d,e,f,g){f===void 0&&(f=!1),g===void 0&&(g=!1),this.$5=""+a,this.$1=b,this.$4=c,this.$3=d,this.$6=e,this.$2=f,this.$7=g}a.bumpODSKey=function(a,b,c){c===void 0&&(c=1);if(!d("Random").coinflip(c))return;a=a+"."+b;(h||(h=d("ODS"))).bumpEntityKey(3589,"dgw_web_client",a,c)};var b=a.prototype;b.bumpODSKey=function(a,b,c){c===void 0&&(c=1);if(!d("Random").coinflip(c))return;a=this.$4+"."+a+"."+b;(h||(h=d("ODS"))).bumpEntityKey(3589,"dgw_web_client",a,c)};b.logEvent=function(a,b,c,d,e){d===void 0&&(d=!1),this.$2||this.$8(a,b,null,j.INFO,c,d,e)};b.$8=function(a,b,d,e,f,g,h){var i=this;g===void 0&&(g=!1);if(g&&!this.$7)return;(k(a)&&this.$1!=null||!k(a)&&this.$6!=null)&&c("DgwClientFalcoEvent").log(function(){var c;return{event:b,logging_id:(c=h)!=null?c:i.$1,dgw_version:i.$5,message:d,severity:e,uuid:i.$3,dgw_component:a,extra_info:f,destination_tier:i.$4,sg_transport_id:i.$6,source:2}})};b.logError=function(a,b,c,d,e,f){e===void 0&&(e=!1),this.$2||this.$8(a,b,c,j.ERROR,d,e,f)};b.logWarn=function(a,b,c,d,e){e===void 0&&(e=!1),this.$2||this.$8(a,b,c,j.WARNING,d,e)};return a}();g.DGW_MODULE=a;g.DGWLoggingComponent=i;g.DGWLoggingContext=e}),98);
__d("DGWAckManager",["DGWLoggingContext","Promise","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(){var b=a.prototype;b.stopTracking=function(a){window.clearTimeout(this.$1),this.$3(a)};function a(a,b,c){var d=this;this.$3=c;this.sendId=a;this.$2=b;this.handleAckReceived=function(){d.stopTracking(!0)};this.$1=window.setTimeout(function(){d.stopTracking(!1)},b)}return a}();a=function(){function a(a){this.$1=new Map(),this.$2=a}var c=a.prototype;c.waitForAck=function(a,c){var e,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_expected");e=this.$1;g.prev=2;g.next=5;return b("regeneratorRuntime").awrap(new(h||(h=b("Promise")))(function(b,d){e.set(a,new i(a,c,b))}));case 5:f=g.sent;f===!0?this.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Received ACK","sendId:"+a,!0):(this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_timeout"),this.$2.logWarn(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ACK timeout","Request "+a+" timed out after "+c+"ms"));e["delete"](a);return g.abrupt("return",f);case 11:g.prev=11;g.t0=g["catch"](2);this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_error");e["delete"](a);throw g.t0;case 16:case"end":return g.stop()}},null,this,[[2,11]])};c.handleAckReceived=function(a){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received");var b=this.$1.get(a);if(b===void 0){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received.not_tracked");this.$2.logWarn(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"untracked ACK","Received ACK for ackId "+a+" which was not being tracked");return}b.handleAckReceived()};c.clearPendingAcks=function(){var a=this;this.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending acks","ACKs cleared size: "+this.$1.size);this.$1.forEach(function(b,c,e){a.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending ACK with ackId "+b.sendId,null,!0),b.stopTracking(!1),e["delete"](c)})};return a}();g.DGWAckManager=a}),98);
__d("DGWAuth",["$InternalEnum","err"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({TEST:"0:0",FACEBOOK:"1:0",INTERNALFB:"2:0",OCULUS:"3:0",ENTERPRISEFB:"7:0",RECRUITINGFB:"8:0",INSTAGRAM:"6:0",HORIZON_WEB:"12:0",SPARK_WEB:"13:0",ABRA:"15:0"});function a(a){if(a==="TEST")return h.TEST;else if(a==="FACEBOOK")return h.FACEBOOK;else if(a==="INTERNALFB")return h.INTERNALFB;else if(a==="OCULUS")return h.OCULUS;else if(a==="ENTERPRISEFB")return h.ENTERPRISEFB;else if(a==="RECRUITINGFB")return h.RECRUITINGFB;else if(a==="INSTAGRAM")return h.INSTAGRAM;else if(a==="HORIZON_WEB")return h.HORIZON_WEB;else if(a==="SPARK_WEB")return h.SPARK_WEB;else if(a==="ABRA")return h.ABRA;else throw c("err")("failed to convert string ("+a+") to DGWAuth Type")}function d(a){if(a===h.FACEBOOK)return"FACEBOOK";else if(a===h.INTERNALFB)return"INTERNALFB";else if(a===h.OCULUS)return"OCULUS";else if(a===h.ENTERPRISEFB)return"ENTERPRISEFB";else if(a===h.RECRUITINGFB)return"RECRUITINGFB";else if(a===h.INSTAGRAM)return"INSTAGRAM";else if(a===h.HORIZON_WEB)return"HORIZON_WEB";else if(a===h.SPARK_WEB)return"SPARK_WEB";else if(a===h.ABRA)return"ABRA";else return"TEST"}g.DGWAuth=h;g.fromStringToDGWAuth=a;g.fromDGWAuthToString=d}),98);
__d("DGWStream",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["ABNORMAL_CLOSURE","GOING_AWAY","SERVER_INTERNAL_ERROR","PREMATURE_CLOSE","UNKNOWN_ERROR","KEEPALIVE_TIMEOUT","TRANSPORT_CLOSED_BEFORE_STREAM_INIT","ESTABLISHMENT_TIMEOUT","UNAUTHENTICATED","UNAUTHORIZED","REJECTED","BAD_REQUEST","DGW_SERVER_ERROR","ESTABLISHMENT_ERROR"]);function a(a){switch(a){case g.UNAUTHENTICATED:case g.UNAUTHORIZED:case g.REJECTED:case g.BAD_REQUEST:case g.UNKNOWN_ERROR:case g.SERVER_INTERNAL_ERROR:return!1;default:return!0}}f.StreamError=g;f.isRetryableError=a}),66);
__d("DGWCppBridge",[],(function(l,m,n,o,p,q){var r=function(){var l=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:void 0;return function(m){m=m||{};var m=typeof m!=="undefined"?m:{},n=function(){function m(){}function n(l,m){return function(){l.apply(m,arguments)}}function l(m){if(!(this instanceof l))throw new TypeError("Promises must be constructed via new");if(typeof m!=="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];t(m,this)}function o(m,n){while(m._state===3)m=m._value;if(m._state===0){m._deferreds.push(n);return}m._handled=!0;l._immediateFn(function(){var l=m._state===1?n.onFulfilled:n.onRejected;if(l===null){(m._state===1?p:q)(n.promise,m._value);return}var o;try{o=l(m._value)}catch(l){q(n.promise,l);return}p(n.promise,o)})}function p(m,o){try{if(o===m)throw new TypeError("A promise cannot be resolved with itself.");if(o&&(typeof o==="object"||typeof o==="function")){var p=o.then;if(o instanceof l){m._state=3;m._value=o;r(m);return}else if(typeof p==="function"){t(n(p,o),m);return}}m._state=1;m._value=o;r(m)}catch(l){q(m,l)}}function q(l,m){l._state=2,l._value=m,r(l)}function r(m){m._state===2&&m._deferreds.length===0&&l._immediateFn(function(){m._handled||l._unhandledRejectionFn(m._value)});for(var n=0,p=m._deferreds.length;n<p;n++)o(m,m._deferreds[n]);m._deferreds=null}function s(l,m,n){this.onFulfilled=typeof l==="function"?l:null,this.onRejected=typeof m==="function"?m:null,this.promise=n}function t(l,m){var n=!1;try{l(function(l){if(n)return;n=!0;p(m,l)},function(l){if(n)return;n=!0;q(m,l)})}catch(l){if(n)return;n=!0;q(m,l)}}l.prototype["catch"]=function(l){return this.then(null,l)};l.prototype.then=function(l,n){var p=new this.constructor(m);o(this,new s(l,n,p));return p};l.all=function(m){return new l(function(l,n){if(!Array.isArray(m))return n(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(m);if(o.length===0)return l([]);var p=o.length;function q(m,r){try{if(r&&(typeof r==="object"||typeof r==="function")){var s=r.then;if(typeof s==="function"){s.call(r,function(l){q(m,l)},n);return}}o[m]=r;--p===0&&l(o)}catch(l){n(l)}}for(var r=0;r<o.length;r++)q(r,o[r])})};l.resolve=function(m){return m&&typeof m==="object"&&m.constructor===l?m:new l(function(l){l(m)})};l.reject=function(m){return new l(function(l,n){n(m)})};l.race=function(m){return new l(function(n,o){if(!Array.isArray(m))return o(new TypeError("Promise.race accepts an array"));for(var p=0,q=m.length;p<q;p++)l.resolve(m[p]).then(n,o)})};l._immediateFn=typeof setImmediate==="function"&&function(l){setImmediate(l)}||function(l){setTimeout(l,0)};l._unhandledRejectionFn=function(l){typeof console!=="undefined"&&console};return l}(),o,s;m.ready=new n(function(l,m){o=l,s=m});var t={},u;for(u in m)Object.prototype.hasOwnProperty.call(m,u)&&(t[u]=m[u]);var v=[];(function(l,m){throw m});var w=!0,x=!1,y="";function z(l){return m.locateFile?m.locateFile(l,y):y+l}var A;(w||x)&&(x?y=self.location.href:typeof document!=="undefined"&&document.currentScript&&(y=document.currentScript.src),l&&(y=l),y.indexOf("blob:")!==0?y=y.substr(0,y.lastIndexOf("/")+1):y="",(function(l){try{var m=new XMLHttpRequest();m.open("GET",l,!1);m.send(null);return m.responseText}catch(n){m=ga(l);if(m)return fa(m);throw n}},x&&(A=function(l){try{var m=new XMLHttpRequest();m.open("GET",l,!1);m.responseType="arraybuffer";m.send(null);return new Uint8Array(m.response)}catch(n){m=ga(l);if(m)return m;throw n}}),function(l,m,n){var o=new XMLHttpRequest();o.open("GET",l,!0);o.responseType="arraybuffer";o.onload=function(){if(o.status==200||o.status==0&&o.response){m(o.response);return}var p=ga(l);if(p){m(p.buffer);return}n()};o.onerror=n;o.send(null)}),function(l){document.title=l});m.print||emptyFunction.bind(console);var B=m.printErr||emptyFunction.bind(console);for(u in t)Object.prototype.hasOwnProperty.call(t,u)&&(m[u]=t[u]);t=null;m.arguments&&(v=m.arguments);m.thisProgram&&m.thisProgram;m.quit&&m.quit;var C;m.wasmBinary&&(C=m.wasmBinary);m.noExitRuntime||!0;var D={Memory:function(l){this.buffer=new ArrayBuffer(l.initial*65536)},Module:function(l){},Instance:function(l,m){this.exports=function(l){function m(l){l.set=function(l,m){this[l]=m};l.get=function(l){return this[l]};return l}var n,o=new Uint8Array(123);for(var p=25;p>=0;--p)o[48+p]=52+p,o[65+p]=p,o[97+p]=26+p;o[43]=62;o[47]=63;function q(m,n,p){var q,r,l=0,s=n,t=p.length;n=n+(t*3>>2)-(p[t-2]=="=")-(p[t-1]=="=");for(;l<t;l+=4)q=o[p.charCodeAt(l+1)],r=o[p.charCodeAt(l+2)],m[s++]=o[p.charCodeAt(l)]<<2|q>>4,s<n&&(m[s++]=q<<4|r>>2),s<n&&(m[s++]=r<<6|o[p.charCodeAt(l+3)])}function r(l){q(n,1024,"U3Q5dHlwZV9pbmZvAAAAAOAEAAAABAAATjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UAAAAACAUAABgEAAAQBAAATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAAAACAUAAEgEAAA8BAAATjEwX19jeHhhYml2MTE3X19wYmFzZV90eXBlX2luZm9FAAAACAUAAHgEAAA8BAAATjEwX19jeHhhYml2MTE5X19wb2ludGVyX3R5cGVfaW5mb0UACAUAAKgEAACcBAAAAAAAAGwEAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAAAAABQBQAAAQAAAAkAAAADAAAABAAAAAUAAAAKAAAACwAAAAwAAABOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UAAAAACAUAACgFAABsBA=="),q(n,1372,"gAkQ")}function s(l){var o=l.a,p=o.buffer;o.grow=xa;var q=new Int8Array(p),s=new Int16Array(p),t=new Int32Array(p),u=new Uint8Array(p),v=new Uint16Array(p),w=new Uint32Array(p);new Float32Array(p);new Float64Array(p);var x=Math.imul;Math.fround;Math.abs;var y=Math.clz32;Math.min;Math.max;Math.floor;Math.ceil;Math.trunc;Math.sqrt;l.abort;NaN;Infinity;var z=l.b,A=1051008,B;function C(o,p,l,r,m,n){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;n=n|0;var y=0,z=0,B;y=A-80|0;A=y;t[y+72>>2]=o;t[y+68>>2]=p;t[y+64>>2]=l;t[y+60>>2]=r;t[y+56>>2]=m;t[y+52>>2]=n;a:{if(t[y+52>>2]?!t[y+56>>2]|(!t[y+72>>2]|!t[y+68>>2]|(!t[y+64>>2]|!t[y+60>>2])):1){t[y+76>>2]=5;break a}t[t[y+64>>2]>>2]=0;t[t[y+60>>2]>>2]=0;p=t[y+68>>2];l=t[y+56>>2];r=t[y+52>>2];o=A+-64|0;A=o;t[o+56>>2]=t[y+72>>2];t[o+52>>2]=p;t[o+48>>2]=l;t[o+44>>2]=r;t[o+40>>2]=0;t[o+36>>2]=t[o+56>>2];b:{c:{d:{while(1){if(!t[o+52>>2])break c;t[o+32>>2]=t[o+36>>2];q[o+31|0]=u[t[o+36>>2]];t[o+52>>2]=t[o+52>>2]-1;t[o+36>>2]=t[o+36>>2]+1;if(u[o+31|0]!=10?u[o+31|0]==2|u[o+31|0]==4|u[o+31|0]==9:1){t[o+40>>2]=t[o+40>>2]+1;continue}t[o+24>>2]=1;if(V(u[o+31|0])&1){z=o,B=X(u[o+31|0])&1,q[z+23|0]=B;t[o+16>>2]=q[o+23|0]&1?1:2;if(w[o+52>>2]<w[o+16>>2]){t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[o+52>>2]=t[o+52>>2]-t[o+16>>2];t[o+24>>2]=t[o+16>>2]+t[o+24>>2];t[o+36>>2]=t[o+16>>2]+t[o+36>>2];if(!(u[o+31|0]!=14?u[o+31|0]!=8:0)){t[o+40>>2]=t[o+40>>2]+1;continue}}if(w[o+52>>2]<3)break d;t[o+12>>2]=0;p=t[o+36>>2];l=u[p|0]|u[p+1|0]<<8;q[o+12|0]=l;q[o+13|0]=l>>>8;q[o+14|0]=u[p+2|0];t[o+52>>2]=t[o+52>>2]-3;t[o+24>>2]=t[o+24>>2]+3;t[o+36>>2]=t[o+36>>2]+3;if(w[o+12>>2]<=w[o+52>>2]){t[o+40>>2]=t[o+40>>2]+1;t[o+36>>2]=t[o+12>>2]+t[o+36>>2];t[o+52>>2]=t[o+52>>2]-t[o+12>>2];continue}break}t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[t[o+44>>2]>>2]=t[o+52>>2]}t[o+60>>2]=t[o+40>>2];A=o- -64|0;t[y+48>>2]=t[o+60>>2];if(!t[y+48>>2]){t[y+76>>2]=0;break a}z=y,B=D(x(t[y+48>>2],20)),t[z+44>>2]=B;if(!t[y+44>>2]){t[y+76>>2]=3;break a}t[y+40>>2]=t[y+44>>2];t[y+36>>2]=t[y+72>>2];t[y+32>>2]=t[y+68>>2]-t[t[y+52>>2]>>2];t[y+28>>2]=0;while(1){if(w[y+28>>2]<w[y+48>>2]){if(w[y+32>>2]<1){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=1;break a}q[y+27|0]=u[t[y+36>>2]];t[y+36>>2]=t[y+36>>2]+1;t[y+32>>2]=t[y+32>>2]-1;e:{if(!u[y+27|0]|u[y+27|0]==1|(u[y+27|0]==2|u[y+27|0]==3)|(u[y+27|0]==4|u[y+27|0]==9|u[y+27|0]==10))break e;if(V(u[y+27|0])&1)break e;O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=6;break a}o=t[y+40>>2];t[o>>2]=u[y+27|0]&15|t[o>>2]&-16;f:{if(u[y+27|0]!=10?u[y+27|0]==2|u[y+27|0]==4|u[y+27|0]==9:1){o=t[y+40>>2];t[o>>2]=t[o>>2]&-268435441;t[y+40>>2]=t[y+40>>2]+20;break f}if(V(u[y+27|0])&1){o=A-48|0;A=o;t[o+40>>2]=t[y+40>>2];t[o+36>>2]=y+36;t[o+32>>2]=y+32;g:{if(!(V(t[t[o+40>>2]>>2]&15)&1)){t[o+44>>2]=1;break g}z=o,B=X(t[t[o+40>>2]>>2]&15)&1,q[z+31|0]=B;t[o+24>>2]=q[o+31|0]&1?1:2;if(w[t[o+32>>2]>>2]<w[o+24>>2]){t[o+44>>2]=1;break g}ba(t[o+40>>2]+4|0,t[t[o+36>>2]>>2],t[o+24>>2]);p=t[o+36>>2];t[p>>2]=t[o+24>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+24>>2];if((t[t[o+40>>2]>>2]&15)==8){p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==14){p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441;t[o+44>>2]=0;break g}if(w[t[o+32>>2]>>2]<3){t[o+44>>2]=11;break g}t[o+20>>2]=0;p=t[t[o+36>>2]>>2];l=u[p|0]|u[p+1|0]<<8;q[o+20|0]=l;q[o+21|0]=l>>>8;q[o+22|0]=u[p+2|0];p=t[o+36>>2];t[p>>2]=t[p>>2]+3;p=t[o+32>>2];t[p>>2]=t[p>>2]-3;p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441|(t[o+20>>2]&16777215)<<4;if(w[t[o+32>>2]>>2]<w[o+20>>2]){t[o+44>>2]=11;break g}if((t[t[o+40>>2]>>2]&15)==15){t[t[o+40>>2]+12>>2]=t[o+20>>2];p=D(t[o+20>>2]);t[t[o+40>>2]+8>>2]=p;if(!t[t[o+40>>2]+8>>2]){t[o+44>>2]=3;break g}ba(t[t[o+40>>2]+8>>2],t[t[o+36>>2]>>2],t[o+20>>2]);p=t[o+36>>2];t[p>>2]=t[o+20>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+20>>2];t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==5){t[t[o+40>>2]+12>>2]=t[o+20>>2];p=D(t[o+20>>2]);t[t[o+40>>2]+8>>2]=p;if(!t[t[o+40>>2]+8>>2]){t[o+44>>2]=3;break g}ba(t[t[o+40>>2]+8>>2],t[t[o+36>>2]>>2],t[o+20>>2]);p=t[o+36>>2];t[p>>2]=t[o+20>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+20>>2];t[o+44>>2]=0;break g}h:{if(!((t[t[o+40>>2]>>2]&15)!=6?(t[t[o+40>>2]>>2]&15)!=7:0)){z=o,B=Q(t[o+36>>2],t[o+32>>2],o+19|0,o+18|0),t[z+12>>2]=B;if(t[o+12>>2]){t[o+44>>2]=t[o+12>>2];break g}break h}if(!((t[t[o+40>>2]>>2]&15)!=13?(t[t[o+40>>2]>>2]&15)!=12:0)){l=t[o+32>>2];p=A-32|0;t[p+24>>2]=t[o+36>>2];t[p+20>>2]=l;t[p+16>>2]=o+19;t[p+12>>2]=o+16;s[p+10>>1]=0;i:{if(w[t[p+20>>2]>>2]<2){t[p+28>>2]=1;break i}l=t[t[p+24>>2]>>2];l=u[l|0]|u[l+1|0]<<8;q[p+10|0]=l;q[p+11|0]=l>>>8;l=t[p+24>>2];t[l>>2]=t[l>>2]+2;l=t[p+20>>2];t[l>>2]=t[l>>2]-2;q[t[p+16>>2]]=(v[p+10>>1]&32768)==32768;s[t[p+12>>2]>>1]=v[p+10>>1]&32767;t[p+28>>2]=0}t[o+12>>2]=t[p+28>>2];if(t[o+12>>2]){t[o+44>>2]=t[o+12>>2];break g}}}if((t[t[o+40>>2]>>2]&15)==12){p=t[o+40>>2];s[p+8>>1]=s[p+8>>1]&1|v[o+16>>1]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==7){p=t[o+40>>2];q[p+8|0]=q[p+8|0]&1|u[o+18|0]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==13){l=t[o+32>>2];r=t[o+20>>2];m=t[o+40>>2]+12|0;n=t[o+40>>2];p=A-32|0;A=p;t[p+24>>2]=t[o+36>>2];t[p+20>>2]=l;t[p+16>>2]=r;t[p+12>>2]=m;t[p+8>>2]=n+16;j:{if(w[p+16>>2]<2){t[p+28>>2]=9;break j}t[t[p+8>>2]>>2]=t[p+16>>2]-2;if(w[t[p+20>>2]>>2]<w[t[p+8>>2]>>2]){t[p+28>>2]=1;break j}l=D(t[t[p+8>>2]>>2]);t[t[p+12>>2]>>2]=l;if(!t[t[p+12>>2]>>2]){t[p+28>>2]=3;break j}ba(t[t[p+12>>2]>>2],t[t[p+24>>2]>>2],t[t[p+8>>2]>>2]);l=t[p+24>>2];t[l>>2]=t[t[p+8>>2]>>2]+t[l>>2];l=t[p+20>>2];t[l>>2]=t[l>>2]-t[t[p+8>>2]>>2];t[p+28>>2]=0}A=p+32|0;t[o+8>>2]=t[p+28>>2];if(t[o+8>>2]){t[o+44>>2]=t[o+8>>2];break g}p=t[o+40>>2];s[p+8>>1]=q[o+19|0]&1|v[p+8>>1]&65534;p=t[o+40>>2];s[p+8>>1]=s[p+8>>1]&1|v[o+16>>1]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==6){z=o,B=M(t[o+36>>2],t[o+32>>2],t[o+20>>2],t[o+40>>2]+12|0,t[o+40>>2]+16|0),t[z+4>>2]=B;if(t[o+4>>2]){t[o+44>>2]=t[o+4>>2];break g}p=t[o+40>>2];q[p+8|0]=q[o+19|0]&1|u[p+8|0]&254;p=t[o+40>>2];q[p+8|0]=q[p+8|0]&1|u[o+18|0]<<1;t[o+44>>2]=0;break g}t[o+44>>2]=1}A=o+48|0;t[y+20>>2]=t[o+44>>2];if(!t[y+20>>2]){t[y+40>>2]=t[y+40>>2]+20;break f}O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+20>>2];break a}t[y+16>>2]=0;if(w[y+32>>2]<3){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=1;break a}o=t[y+36>>2];p=u[o|0]|u[o+1|0]<<8;q[y+16|0]=p;q[y+17|0]=p>>>8;q[y+18|0]=u[o+2|0];t[y+36>>2]=t[y+36>>2]+3;t[y+32>>2]=t[y+32>>2]-3;if(!(t[y+16>>2]==1|u[y+27|0]!=1)){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=7;break a}o=t[y+40>>2];t[o>>2]=t[o>>2]&-268435441|(t[y+16>>2]&16777215)<<4;if(u[y+27|0]==3){if(t[y+16>>2]!=1){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=10;break a}q[y+15|0]=0;if(w[y+32>>2]<1){J(t[y+44>>2]);t[y+76>>2]=1;break a}q[y+15|0]=u[t[y+36>>2]];t[y+36>>2]=t[y+36>>2]+1;t[y+32>>2]=t[y+32>>2]-1;k:{if(u[y+15|0]<=4){q[t[y+40>>2]+4|0]=u[y+15|0];break k}q[t[y+40>>2]+4|0]=4}t[y+40>>2]=t[y+40>>2]+20;break f}z=y,B=Q(y+36|0,y+32|0,y+14|0,y+13|0),t[z+8>>2]=B;if(t[y+8>>2]){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+8>>2];break a}if(u[y+27|0]==1){o=t[y+40>>2];q[o+4|0]=q[o+4|0]&1|u[y+13|0]<<1;t[y+40>>2]=t[y+40>>2]+20;break f}if(!u[y+27|0]){z=y,B=M(y+36|0,y+32|0,t[y+16>>2],t[y+40>>2]+8|0,t[y+40>>2]+12|0),t[z+4>>2]=B;if(t[y+4>>2]){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+4>>2];break a}o=t[y+40>>2];q[o+4|0]=q[y+14|0]&1|u[o+4|0]&254;o=t[y+40>>2];q[o+4|0]=q[o+4|0]&1|u[y+13|0]<<1;t[y+40>>2]=t[y+40>>2]+20}}t[y+28>>2]=t[y+28>>2]+1;continue}break}if(t[y+32>>2]){O(t[y+44>>2],t[y+48>>2]);t[y+76>>2]=1;break a}t[t[y+64>>2]>>2]=t[y+44>>2];t[t[y+60>>2]>>2]=t[y+48>>2];t[y+76>>2]=0}A=y+80|0;return t[y+76>>2]}function D(o){var q=0,l=0,r=0,m=0,n=0,s=0,u=0,v,w=0,x,p;w=8;a:{b:{if(o>>>0>4294967239)break b;while(1){w=w>>>0>8?w:8;l=t[603];n=l;m=t[602];u=m;o=o>>>0>8?o+3&-4:8;c:{if(o>>>0<=127){s=(o>>>3|0)-1|0;break c}r=y(o);s=((o>>>29-r^4)-(r<<2)|0)+110|0;if(o>>>0<=4095)break c;r=((o>>>30-r^2)-(r<<1)|0)+71|0;s=r>>>0<63?r:63}q=s;r=q&31;(q&63)>>>0>=32?(q=0,l=l>>>r|0):(q=l>>>r|0,l=((1<<r)-1&l)<<32-r|u>>>r);r=q;if(l|q){while(1){n=l;q=r;d:{if(q|l){m=q-1|0;v=m+1|0;u=m;m=l-1|0;u=(m|0)!=-1?v:u;m=y(l^m)+32|0;l=y(q^u);l=(l|0)==32?m:l;q=63-l|0;0-(l>>>0>63)|0;break d}q=64}m=q;q=m;l=q&31;(q&63)>>>0>=32?(q=0,u=r>>>l|0):(q=r>>>l|0,u=((1<<l)-1&r)<<32-l|n>>>l);r=q;s=m+s|0;n=s<<4;q=t[n+1384>>2];m=n+1376|0;e:{if((q|0)!=(m|0)){l=I(q,w,o);if(l)break b;l=t[q+4>>2];t[l+8>>2]=t[q+8>>2];t[t[q+8>>2]+4>>2]=l;t[q+8>>2]=m;l=n+1380|0;t[q+4>>2]=t[l>>2];t[l>>2]=q;t[t[q+4>>2]+8>>2]=q;s=s+1|0;l=(r&1)<<31|u>>>1;r=r>>>1|0;break e}x=t[603];q=s;v=q&63;l=v;n=l&31;l>>>0>=32?(l=0,m=-1>>>n|0):(l=-1>>>n|0,m=(1<<n)-1<<32-n|-1>>>n);m=m&-2;n=v&31;v>>>0>=32?(l=m<<n,v=0):(l=(1<<n)-1&m>>>32-n|l<<n,v=m<<n);n=l;m=0-q&63;l=m;q=l&31;l>>>0>=32?(l=-1<<q,q=0):(l=(1<<q)-1&-1>>>32-q|-1<<q,q=-1<<q);p=q&-2;q=m&31;m>>>0>=32?(m=0,q=l>>>q|0):(m=l>>>q|0,q=((1<<q)-1&l)<<32-q|p>>>q);l=q|v;B=n|m;t[602]=t[602]&l;t[603]=B&x;l=u^1}if(l|r)continue;break}m=t[602];n=t[603]}f:{if(n|m){r=y(n);r=63-((r|0)==32?y(m)+32|0:r)<<4;q=r+1376|0;r=t[r+1384>>2];g:{if(!n&m>>>0<1073741824)break g;s=98;if((q|0)==(r|0))break g;while(1){l=I(r,w,o);if(l)break b;r=t[r+8>>2];if(!s)break g;s=s-1|0;if((q|0)!=(r|0))continue;break}}if(G(o+48|0))break f;if(!r|(q|0)==(r|0))break a;while(1){l=I(r,w,o);if(l)break b;r=t[r+8>>2];if((q|0)!=(r|0))continue;break}break a}if(!G(o+48|0))break a}l=0;if(o>>>0>4294967239)break b;r=w;q=0;while(1){s=q;if(r){r=r-1&r;q=q+1|0;continue}break}if(s>>>0<=1)continue;break}}return l}return 0}function E(o,p,l,r,m,n,x){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;n=n|0;x=x|0;var y=0,z=0;y=A-32|0;A=y;s[y+26>>1]=o;t[y+20>>2]=p;t[y+16>>2]=l;q[y+15|0]=r;s[y+12>>1]=m;t[y+8>>2]=n;t[y+4>>2]=x;a:{if(!(!(q[y+15|0]&1)|v[y+12>>1]<=32767)){t[y+28>>2]=4;break a}p=t[y+20>>2];l=t[y+16>>2];r=t[y+8>>2];m=t[y+4>>2];n=q[y+15|0]&1;o=A+-64|0;A=o;t[o+56>>2]=y+26;t[o+52>>2]=p;t[o+48>>2]=l;t[o+44>>2]=r;t[o+40>>2]=m;q[o+39|0]=2;q[o+38|0]=13;t[o+32>>2]=y+12;q[o+31|0]=n;q[o+30|0]=2;b:{c:{if(!(!t[o+52>>2]|(!t[o+44>>2]|!t[o+40>>2]))&&w[o+48>>2]<=16777215)break c;t[o+60>>2]=5;break b}t[o+24>>2]=t[o+48>>2]+(u[o+39|0]+(u[o+30|0]+4|0)|0);z=o,x=D(t[o+24>>2]),t[z+20>>2]=x;if(!t[o+20>>2]){t[o+60>>2]=3;break b}t[o+16>>2]=t[o+20>>2];q[t[o+16>>2]]=u[o+38|0];t[o+16>>2]=t[o+16>>2]+1;ba(t[o+16>>2],t[o+56>>2],u[o+30|0]);t[o+16>>2]=u[o+30|0]+t[o+16>>2];t[o+12>>2]=u[o+39|0]+t[o+48>>2];if(w[o+12>>2]<w[o+48>>2]){J(t[o+20>>2]);t[o+60>>2]=9;break b}p=t[o+16>>2];l=u[o+12|0]|u[o+13|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+14|0];t[o+16>>2]=t[o+16>>2]+3;if(q[o+31|0]&1)d:{if(u[o+38|0]==6){p=t[o+32>>2];q[p|0]=u[p|0]|128;break d}e:{if(u[o+38|0]==13){p=t[o+32>>2];s[p>>1]=v[p>>1]|32768;break e}J(t[o+20>>2]);t[o+60>>2]=1;break b}}ba(t[o+16>>2],t[o+32>>2],u[o+39|0]);t[o+16>>2]=u[o+39|0]+t[o+16>>2];ba(t[o+16>>2],t[o+52>>2],t[o+48>>2]);t[t[o+44>>2]>>2]=t[o+20>>2];t[t[o+40>>2]>>2]=t[o+24>>2];t[o+60>>2]=0}A=o- -64|0;t[y+28>>2]=t[o+60>>2]}A=y+32|0;return t[y+28>>2]}function F(o,p,l,r,m){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;var n=0,v=0;n=A-32|0;A=n;s[n+30>>1]=o;t[n+24>>2]=p;t[n+20>>2]=l;t[n+16>>2]=r;t[n+12>>2]=m;p=t[n+24>>2];l=t[n+20>>2];r=t[n+16>>2];m=t[n+12>>2];o=A-48|0;A=o;t[o+40>>2]=n+30;t[o+36>>2]=p;t[o+32>>2]=l;t[o+28>>2]=r;t[o+24>>2]=m;q[o+23|0]=2;q[o+22|0]=15;a:{if(!(t[o+24>>2]?t[o+28>>2]:0)){t[o+44>>2]=5;break a}t[t[o+28>>2]>>2]=0;t[t[o+24>>2]>>2]=0;if(!(w[o+32>>2]<=16777215?t[o+36>>2]:0)){t[o+44>>2]=5;break a}t[o+16>>2]=t[o+32>>2]+(u[o+23|0]+4|0);v=o,r=D(t[o+16>>2]),t[v+12>>2]=r;if(!t[o+12>>2]){t[o+44>>2]=3;break a}t[o+8>>2]=t[o+12>>2];q[t[o+8>>2]]=u[o+22|0];t[o+8>>2]=t[o+8>>2]+1;ba(t[o+8>>2],t[o+40>>2],u[o+23|0]);t[o+8>>2]=u[o+23|0]+t[o+8>>2];p=t[o+8>>2];l=u[o+32|0]|u[o+33|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+34|0];t[o+8>>2]=t[o+8>>2]+3;ba(t[o+8>>2],t[o+36>>2],t[o+32>>2]);t[o+8>>2]=t[o+32>>2]+t[o+8>>2];t[t[o+28>>2]>>2]=t[o+12>>2];t[t[o+24>>2]>>2]=t[o+16>>2];t[o+44>>2]=0}A=o+48|0;A=n+32|0;return t[o+44>>2]}function G(o){var p=0,l,r=0,m=0,n,s=0;r=t[343];l=o+3&-4;p=r+l|0;a:{b:{if(p>>>0<=r>>>0?l:0)break b;if(p>>>0>wa()<<16>>>0&&!(z(p|0)|0))break b;t[343]=p;break a}t[604]=48;r=-1}if((r|0)!=-1){l=o+r|0;p=l-16|0;t[p+12>>2]=16;t[p>>2]=16;o=t[600];o?s=t[o+8>>2]:s=0;c:{d:{if((s|0)==(r|0)){m=r-(t[r-4>>2]&-2)|0;n=t[m-4>>2];t[o+8>>2]=l;o=m-(n&-2)|0;l=-16;if(!(q[(o+t[o>>2]|0)-4|0]&1))break d;l=t[o+4>>2];t[l+8>>2]=t[o+8>>2];t[t[o+8>>2]+4>>2]=l;p=p-o|0;t[o>>2]=p;break c}t[r+12>>2]=16;t[r>>2]=16;t[r+8>>2]=l;t[r+4>>2]=o;t[600]=r;l=16}o=r+l|0;p=p-o|0;t[o>>2]=p}t[((p&-4)+o|0)-4>>2]=p|1;s=o;m=t[o>>2]-8|0;e:{if(m>>>0<=127){p=(m>>>3|0)-1|0;break e}n=y(m);p=((m>>>29-n^4)-(n<<2)|0)+110|0;if(m>>>0<=4095)break e;p=((m>>>30-n^2)-(n<<1)|0)+71|0;p=p>>>0<63?p:63}l=p<<4;t[s+4>>2]=l+1376;l=l+1384|0;t[o+8>>2]=t[l>>2];t[l>>2]=o;t[t[o+8>>2]+4>>2]=o;l=t[603];o=p&31;(p&63)>>>0>=32?(p=1<<o,o=0):(p=(1<<o)-1&1>>>32-o,o=1<<o);t[602]=o|t[602];t[603]=p|l}return(r|0)!=-1}function la(o,p,l,r){o=o|0;p=p|0;l=l|0;r=r|0;var m=0,n=0;m=A-16|0;A=m;s[m+10>>1]=o;s[m+8>>1]=p;t[m+4>>2]=l;t[m>>2]=r;a:{if(v[m+8>>1]>32767){t[m+12>>2]=4;break a}p=t[m+4>>2];l=t[m>>2];o=A-48|0;A=o;t[o+40>>2]=m+10;t[o+36>>2]=p;t[o+32>>2]=l;q[o+31|0]=2;q[o+30|0]=12;t[o+24>>2]=m+8;q[o+23|0]=2;b:{if(!(t[o+32>>2]?t[o+36>>2]:0)){t[o+44>>2]=5;break b}t[o+16>>2]=u[o+31|0]+(u[o+23|0]+4|0);n=o,r=D(t[o+16>>2]),t[n+12>>2]=r;if(!t[o+12>>2]){t[o+44>>2]=3;break b}t[o+8>>2]=t[o+12>>2];q[t[o+8>>2]]=u[o+30|0];t[o+8>>2]=t[o+8>>2]+1;ba(t[o+8>>2],t[o+40>>2],u[o+23|0]);t[o+8>>2]=u[o+23|0]+t[o+8>>2];t[o+4>>2]=u[o+31|0];p=t[o+8>>2];l=u[o+4|0]|u[o+5|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+6|0];t[o+8>>2]=t[o+8>>2]+3;ba(t[o+8>>2],t[o+24>>2],u[o+31|0]);t[t[o+32>>2]>>2]=t[o+16>>2];t[t[o+36>>2]>>2]=t[o+12>>2];t[o+44>>2]=0}A=o+48|0;t[m+12>>2]=t[o+44>>2]}A=m+16|0;return t[m+12>>2]}function H(o,p,l){o=o|0;p=p|0;l=l|0;var q=0,m=0,n=0,r=0,s=0;n=A+-64|0;A=n;m=1;a:{if(R(o,p,0))break a;m=0;if(!p)break a;q=A+-64|0;A=q;m=t[p>>2];r=t[m-4>>2];s=t[m-8>>2];t[q+20>>2]=0;t[q+16>>2]=1084;t[q+12>>2]=p;t[q+8>>2]=1132;m=0;ca(q+24|0,39);p=p+s|0;b:{if(R(r,1132,0)){t[q+56>>2]=1;ka[t[t[r>>2]+20>>2]](r,q+8|0,p,p,1,0);m=t[q+32>>2]==1?p:0;break b}ka[t[t[r>>2]+24>>2]](r,q+8|0,p,1,0);c:switch(t[q+44>>2]){case 0:m=t[q+48>>2]==1?t[q+36>>2]==1?t[q+40>>2]==1?t[q+28>>2]:0:0:0;break b;case 1:break c;default:break b}if(t[q+48>>2]|t[q+36>>2]!=1|t[q+40>>2]!=1?t[q+32>>2]!=1:0)break b;m=t[q+24>>2]}A=q- -64|0;p=m;m=0;if(!p)break a;ca(n+8|4,52);t[n+56>>2]=1;t[n+20>>2]=-1;t[n+16>>2]=o;t[n+8>>2]=p;ka[t[t[p>>2]+28>>2]](p,n+8|0,t[l>>2],1);o=t[n+32>>2];(o|0)==1&&(t[l>>2]=t[n+24>>2]);m=(o|0)==1}o=m;A=n- -64|0;return o|0}function I(o,p,l){var q=0,m,n=0,r=0;q=o+4|0;m=(q+p|0)-1&0-p;p=t[o>>2];if(m+l>>>0<=(p+o|0)-4>>>0){n=t[o+4>>2];t[n+8>>2]=t[o+8>>2];t[t[o+8>>2]+4>>2]=n;(q|0)!=(m|0)&&(m=m-q|0,n=o-(t[o-4>>2]&-2)|0,q=m+t[n>>2]|0,t[n>>2]=q,t[(n+(q&-4)|0)-4>>2]=q,o=o+m|0,p=p-m|0,t[o>>2]=p);a:{if(l+24>>>0<=p>>>0){q=(o+l|0)+8|0;p=(p-l|0)-8|0;t[q>>2]=p;t[(q+(p&-4)|0)-4>>2]=p|1;r=q;n=t[q>>2]-8|0;b:{if(n>>>0<=127){m=(n>>>3|0)-1|0;break b}p=y(n);m=((n>>>29-p^4)-(p<<2)|0)+110|0;if(n>>>0<=4095)break b;p=((n>>>30-p^2)-(p<<1)|0)+71|0;m=p>>>0<63?p:63}p=m;m=p<<4;t[r+4>>2]=m+1376;m=m+1384|0;t[q+8>>2]=t[m>>2];t[m>>2]=q;t[t[q+8>>2]+4>>2]=q;m=t[603];q=p&31;(p&63)>>>0>=32?(p=1<<q,r=0):(p=(1<<q)-1&1>>>32-q,r=1<<q);t[602]=r|t[602];t[603]=p|m;p=l+8|0;t[o>>2]=p;t[((p&-4)+o|0)-4>>2]=p;break a}t[(o+p|0)-4>>2]=p}o=o+4|0}else o=0;return o}function J(o){var p=0,l,q=0,m,n=0;if(o){l=o-4|0;m=t[l>>2];q=m;p=l;n=t[o-8>>2];o=n&-2;(o|0)!=(n|0)&&(p=l-o|0,q=t[p+4>>2],t[q+8>>2]=t[p+8>>2],t[t[p+8>>2]+4>>2]=q,q=o+m|0);o=l+m|0;l=t[o>>2];(l|0)!=t[(o+l|0)-4>>2]&&(m=t[o+4>>2],t[m+8>>2]=t[o+8>>2],t[t[o+8>>2]+4>>2]=m,q=q+l|0);t[p>>2]=q;t[((q&-4)+p|0)-4>>2]=q|1;n=p;q=t[p>>2]-8|0;a:{if(q>>>0<=127){o=(q>>>3|0)-1|0;break a}m=y(q);o=((q>>>29-m^4)-(m<<2)|0)+110|0;if(q>>>0<=4095)break a;o=((q>>>30-m^2)-(m<<1)|0)+71|0;o=o>>>0<63?o:63}l=o<<4;t[n+4>>2]=l+1376;l=l+1384|0;t[p+8>>2]=t[l>>2];t[l>>2]=p;t[t[p+8>>2]+4>>2]=p;l=t[603];p=o&31;(o&63)>>>0>=32?(o=1<<p,p=0):(o=(1<<p)-1&1>>>32-p,p=1<<p);t[602]=p|t[602];t[603]=o|l}}function K(n,o,l){n=n|0;o=o|0;l=l|0;var p=0,m=0;p=A-48|0;A=p;t[p+40>>2]=n;t[p+36>>2]=o;t[p+32>>2]=l;a:{if(!(t[p+32>>2]?t[p+36>>2]:0)){t[p+44>>2]=5;break a}if(w[p+40>>2]>4){t[p+44>>2]=8;break a}t[p+28>>2]=5;m=p,l=D(t[p+28>>2]),t[m+24>>2]=l;if(!t[p+24>>2]){t[p+44>>2]=3;break a}t[p+20>>2]=t[p+24>>2];q[p+19|0]=3;q[t[p+20>>2]]=u[p+19|0];t[p+20>>2]=t[p+20>>2]+1;t[p+12>>2]=1;n=t[p+20>>2];o=u[p+12|0]|u[p+13|0]<<8;q[n|0]=o;q[n+1|0]=o>>>8;q[n+2|0]=u[p+14|0];t[p+20>>2]=t[p+20>>2]+3;q[p+11|0]=t[p+40>>2];q[t[p+20>>2]]=u[p+11|0];t[t[p+36>>2]>>2]=t[p+24>>2];t[t[p+32>>2]>>2]=t[p+28>>2];t[p+44>>2]=0}A=p+48|0;return t[p+44>>2]}function L(n,o,l,p,m){n=n|0;o=o|0;l=l|0;p=p|0;m=m|0;if(R(n,t[o+8>>2],m)){da(o,l,p);return}a:{if(R(n,t[o>>2],m)){if(!(t[o+20>>2]!=(l|0)?t[o+16>>2]!=(l|0):0)){if((p|0)!=1)break a;t[o+32>>2]=1;return}t[o+32>>2]=p;b:{if(t[o+44>>2]==4)break b;s[o+52>>1]=0;n=t[n+8>>2];ka[t[t[n>>2]+20>>2]](n,o,l,l,1,m);if(u[o+53|0]){t[o+44>>2]=3;if(!u[o+52|0])break b;break a}t[o+44>>2]=4}t[o+20>>2]=l;t[o+40>>2]=t[o+40>>2]+1;if(t[o+36>>2]!=1|t[o+24>>2]!=2)break a;q[o+54|0]=1;return}n=t[n+8>>2];ka[t[t[n>>2]+24>>2]](n,o,l,p,m)}}function M(o,p,l,q,m){var n=0;n=A-32|0;A=n;t[n+24>>2]=o;t[n+20>>2]=p;t[n+16>>2]=l;t[n+12>>2]=q;t[n+8>>2]=m;a:{if(w[n+16>>2]<1){t[n+28>>2]=9;break a}t[t[n+8>>2]>>2]=t[n+16>>2]-1;if(w[t[n+20>>2]>>2]<w[t[n+8>>2]>>2]){t[n+28>>2]=1;break a}o=D(t[t[n+8>>2]>>2]);t[t[n+12>>2]>>2]=o;if(!t[t[n+12>>2]>>2]){t[n+28>>2]=3;break a}ba(t[t[n+12>>2]>>2],t[t[n+24>>2]>>2],t[t[n+8>>2]>>2]);o=t[n+24>>2];t[o>>2]=t[t[n+8>>2]>>2]+t[o>>2];o=t[n+20>>2];t[o>>2]=t[o>>2]-t[t[n+8>>2]>>2];t[n+28>>2]=0}A=n+32|0;return t[n+28>>2]}function N(n,o,l){n=n|0;o=o|0;l=l|0;var p=0,m=0;p=A-32|0;A=p;s[p+26>>1]=n;t[p+20>>2]=o;t[p+16>>2]=l;t[t[p+16>>2]>>2]=3;m=p,l=D(t[t[p+16>>2]>>2]),t[m+12>>2]=l;a:{if(!t[p+12>>2]){t[p+28>>2]=3;break a}t[t[p+20>>2]>>2]=t[p+12>>2];q[p+11|0]=14;q[t[p+12>>2]]=u[p+11|0];t[p+12>>2]=t[p+12>>2]+1;n=t[p+12>>2];o=u[p+26|0]|u[p+27|0]<<8;q[n|0]=o;q[n+1|0]=o>>>8;t[p+28>>2]=0}A=p+32|0;return t[p+28>>2]}function O(m,n){var l=0;l=A-16|0;A=l;t[l+12>>2]=m;t[l+8>>2]=n;t[l+4>>2]=0;while(1){if(w[l+4>>2]<w[l+8>>2]){t[l>>2]=t[l+12>>2]+x(t[l+4>>2],20);a:{if(!(t[t[l>>2]>>2]&15)){J(t[t[l>>2]+8>>2]);break a}b:{if((t[t[l>>2]>>2]&15)==5){J(t[t[l>>2]+8>>2]);break b}(t[t[l>>2]>>2]&15)==6&&J(t[t[l>>2]+12>>2])}}t[l+4>>2]=t[l+4>>2]+1;continue}break}J(t[l+12>>2]);A=l+16|0}function P(m,n,l,o){q[m+53|0]=1;a:{if(t[m+4>>2]!=(l|0))break a;q[m+52|0]=1;l=t[m+16>>2];if(!l){t[m+36>>2]=1;t[m+24>>2]=o;t[m+16>>2]=n;if((o|0)!=1|t[m+48>>2]!=1)break a;q[m+54|0]=1;return}if((n|0)==(l|0)){l=t[m+24>>2];(l|0)==2&&(t[m+24>>2]=o,l=o);if(t[m+48>>2]!=1|(l|0)!=1)break a;q[m+54|0]=1;return}q[m+54|0]=1;t[m+36>>2]=t[m+36>>2]+1}}function Q(n,o,l,p){var m;m=A-32|0;t[m+24>>2]=n;t[m+20>>2]=o;t[m+16>>2]=l;t[m+12>>2]=p;q[m+11|0]=0;a:{if(w[t[m+20>>2]>>2]<1){t[m+28>>2]=1;break a}q[m+11|0]=u[t[t[m+24>>2]>>2]];n=t[m+24>>2];t[n>>2]=t[n>>2]+1;n=t[m+20>>2];t[n>>2]=t[n>>2]-1;q[t[m+16>>2]]=(u[m+11|0]&128)==128;q[t[m+12>>2]]=u[m+11|0]&127;t[m+28>>2]=0}return t[m+28>>2]}function ma(n,o,l,p,m){n=n|0;o=o|0;l=l|0;p=p|0;m=m|0;if(R(n,t[o+8>>2],m)){da(o,l,p);return}a:{if(!R(n,t[o>>2],m))break a;if(!(t[o+20>>2]!=(l|0)?t[o+16>>2]!=(l|0):0)){if((p|0)!=1)break a;t[o+32>>2]=1;return}t[o+20>>2]=l;t[o+32>>2]=p;t[o+40>>2]=t[o+40>>2]+1;t[o+36>>2]!=1|t[o+24>>2]!=2||(q[o+54|0]=1);t[o+44>>2]=4}}function R(m,n,l){var o;if(!l)return t[m+4>>2]==t[n+4>>2];if((m|0)==(n|0))return 1;l=t[m+4>>2];m=u[l|0];n=t[n+4>>2];o=u[n|0];a:{if(!m|(o|0)!=(m|0))break a;while(1){o=u[n+1|0];m=u[l+1|0];if(!m)break a;n=n+1|0;l=l+1|0;if((m|0)==(o|0))continue;break}}return(m|0)==(o|0)}function na(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=9;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function S(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=10;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function T(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=2;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function U(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=4;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function V(l){var m=0;m=A-16|0;A=m;t[m+12>>2]=l;l=1;a:{if(X(t[m+12>>2])&1)break a;l=1;if(t[m+12>>2]==15)break a;l=1;if(t[m+12>>2]==13)break a;l=1;if(t[m+12>>2]==12)break a;l=t[m+12>>2]==14}A=m+16|0;return l}function W(m,n,l){var o;o=t[m+16>>2];if(!o){t[m+36>>2]=1;t[m+24>>2]=l;t[m+16>>2]=n;return}a:{if((n|0)==(o|0)){if(t[m+24>>2]!=2)break a;t[m+24>>2]=l;return}q[m+54|0]=1;t[m+24>>2]=2;t[m+36>>2]=t[m+36>>2]+1}}function X(l){var m;m=A-16|0;t[m+12>>2]=l;l=1;a:{if(t[m+12>>2]==5)break a;l=1;if(t[m+12>>2]==6)break a;l=1;if(t[m+12>>2]==7)break a;l=t[m+12>>2]==8}return l}function Y(o,p,l,q,m,n){o=o|0;p=p|0;l=l|0;q=q|0;m=m|0;n=n|0;if(R(o,t[p+8>>2],n)){P(p,l,q,m);return}o=t[o+8>>2];ka[t[t[o>>2]+20>>2]](o,p,l,q,m,n)}function Z(){var m=0,n,l;while(1){n=m<<4;l=n+1376|0;t[n+1380>>2]=l;t[n+1384>>2]=l;m=m+1|0;if((m|0)!=64)continue;break}G(48)}function $(m,n,l,o){m=m|0;n=n|0;l=l|0;o=o|0;if(R(m,t[n+8>>2],0)){W(n,l,o);return}m=t[m+8>>2];ka[t[t[m>>2]+28>>2]](m,n,l,o)}function aa(o,p,l,q,m,n){o=o|0,p=p|0,l=l|0,q=q|0,m=m|0,n=n|0,R(o,t[p+8>>2],n)&&P(p,l,q,m)}function ba(m,n,l){if(l)while(1){q[m|0]=u[n|0];m=m+1|0;n=n+1|0;l=l-1|0;if(l)continue;break}}function ca(l,m){if(m)while(1){q[l|0]=0;l=l+1|0;m=m-1|0;if(m)continue;break}}function oa(m,n,l,o){m=m|0,n=n|0,l=l|0,o=o|0,R(m,t[n+8>>2],0)&&W(n,l,o)}function da(m,n,l){t[m+28>>2]==1|t[m+4>>2]!=(n|0)||(t[m+28>>2]=l)}function pa(l,m){l=l|0;m=m|0;return x(m,20)+l|0}function ea(l){l=l|0;return v[l+8>>1]>>>1|0}function qa(l){l=l|0;return s[l+8>>1]&1}function fa(l){l=l|0;return t[l+12>>2]}function ra(l){l=l|0;return t[l>>2]&15}function sa(l){l=l|0;return t[l+16>>2]}function ga(l){l=l|0;return v[l+4>>1]}function ha(l){l=l|0;return t[l+8>>2]}function ia(l){l=l|0;return u[l+4|0]}function ja(l){l=l|0;return l|0}function ta(l){return D(l)}function ua(l){l=l|0,J(l)}function va(l){l|0}n=u;r(l);var ka=m([null,ja,ua,va,va,H,aa,ma,oa,ua,Y,L,$]);function wa(){return p.byteLength/65536|0}function xa(l){l=l|0;var m=wa()|0;l=m+l|0;if(m<l&&l<65536){l=new ArrayBuffer(x(l,65536));var r=new Int8Array(l);r.set(q);q=new Int8Array(l);s=new Int16Array(l);t=new Int32Array(l);u=new Uint8Array(l);v=new Uint16Array(l);w=new Uint32Array(l);new Float32Array(l);new Float64Array(l);p=l;o.buffer=p;n=u}return m}return{c:Z,d:ta,e:ua,f:T,g:U,h:K,i:F,j:N,k:E,l:la,m:na,n:S,o:C,p:ra,q:ia,r:pa,s:ga,t:ha,u:fa,v:fa,w:sa,x:ea,y:qa,z:ea,A:ka}}return s(l)}(ha)},instantiate:function(l,m){return{then:function(n){var m=new D.Module(l);n({instance:new D.Instance(m)})}}},RuntimeError:Error};C=[];typeof D!=="object"&&Y("no native wasm support detected");var E,F=!1;function G(l,m){l||Y("Assertion failed: "+m)}function la(l,m){l%m>0&&(l+=m-l%m);return l}var H,I;function J(l){H=l,m.HEAP8=new Int8Array(l),m.HEAP16=new Int16Array(l),m.HEAP32=new Int32Array(l),m.HEAPU8=I=new Uint8Array(l),m.HEAPU16=new Uint16Array(l),m.HEAPU32=new Uint32Array(l),m.HEAPF32=new Float32Array(l),m.HEAPF64=new Float64Array(l)}u=m.INITIAL_MEMORY||2097152;m.wasmMemory?E=m.wasmMemory:E=new D.Memory({initial:u/65536,maximum:2147483648/65536});E&&(H=E.buffer);H.byteLength;J(H);var K,L=[],M=[],N=[];function O(){if(m.preRun){typeof m.preRun=="function"&&(m.preRun=[m.preRun]);while(m.preRun.length)ma(m.preRun.shift())}da(L)}function P(){da(M)}function Q(){if(m.postRun){typeof m.postRun=="function"&&(m.postRun=[m.postRun]);while(m.postRun.length)na(m.postRun.shift())}da(N)}function ma(l){L.unshift(l)}function R(l){M.unshift(l)}function na(l){N.unshift(l)}(!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=function(l,m){var n=l>>>16;l=l&65535;var o=m>>>16;m=m&65535;return l*m+(n*m+l*o<<16)|0});if(!Math.fround){var S=new Float32Array(1);Math.fround=function(l){S[0]=l;return S[0]}}Math.clz32||(Math.clz32=function(l){var m=32,n=l>>16;n&&(m-=16,l=n);n=l>>8;n&&(m-=8,l=n);n=l>>4;n&&(m-=4,l=n);n=l>>2;n&&(m-=2,l=n);n=l>>1;return n?m-2:m-l});Math.trunc||(Math.trunc=function(l){return l<0?Math.ceil(l):Math.floor(l)});var T=0,U=null,V=null;function W(l){T++,m.monitorRunDependencies&&m.monitorRunDependencies(T)}function X(l){T--;m.monitorRunDependencies&&m.monitorRunDependencies(T);if(T==0){U!==null&&(clearInterval(U),U=null);if(V){l=V;V=null;l()}}}m.preloadedImages={};m.preloadedAudios={};function Y(l){m.onAbort&&m.onAbort(l);l+="";B(l);F=!0;l="abort("+l+"). Build with -s ASSERTIONS=1 for more info.";l=new D.RuntimeError(l);s(l);throw l}var Z="data:application/octet-stream;base64,";function $(l){return l.startsWith(Z)}var aa="dgwcppbridge.wasm";$(aa)||(aa=z(aa));function ba(l){try{if(l==aa&&C)return new Uint8Array(C);var m=ga(l);if(m)return m;if(A)return A(l);else throw"both async and sync fetching of the wasm failed"}catch(l){Y(l)}}function ca(){return!C&&(w||x)&&typeof fetch==="function"?fetch(aa,{credentials:"same-origin"}).then(function(l){if(!l.ok)throw"failed to load wasm binary file at '"+aa+"'";return l.arrayBuffer()})["catch"](function(){return ba(aa)}):n.resolve().then(function(){return ba(aa)})}function oa(){var n={a:ha};function o(n,l){l=n.exports;m.asm=l;K=m.asm.A;R(m.asm.c);X("wasm-instantiate")}W("wasm-instantiate");function r(l){o(l.instance)}function t(l){return ca().then(function(l){l=D.instantiate(l,n);return l}).then(l,function(l){B("failed to asynchronously prepare wasm: "+l),Y(l)})}function u(){if(!C&&typeof D.instantiateStreaming==="function"&&!$(aa)&&typeof fetch==="function")return fetch(aa,{credentials:"same-origin"}).then(function(l){l=D.instantiateStreaming(l,n);return l.then(r,function(l){B("wasm streaming compile failed: "+l);B("falling back to ArrayBuffer instantiation");return t(r)})});else return t(r)}if(m.instantiateWasm)try{var l=m.instantiateWasm(n,o);return l}catch(l){B("Module.instantiateWasm callback failed with error: "+l);return!1}u()["catch"](s);return{}}function da(l){while(l.length>0){var n=l.shift();if(typeof n=="function"){n(m);continue}var o=n.func;typeof o==="number"?n.arg===void 0?K.get(o)():K.get(o)(n.arg):o(n.arg===void 0?null:n.arg)}}function pa(l){try{E.grow(l-H.byteLength+65535>>>16);J(E.buffer);return 1}catch(l){}}function ea(l){var m=I.length;l=l>>>0;var n=2147483648;if(l>n)return!1;for(var o=1;o<=4;o*=2){var p=m*(1+.2/o);p=Math.min(p,l+100663296);p=Math.min(n,la(Math.max(l,p),65536));p=pa(p);if(p)return!0}return!1}var qa=!1;function fa(l){var m=[];for(var n=0;n<l.length;n++){var o=l[n];o>255&&(qa&&G(!1,"Character code "+o+" ("+String.fromCharCode(o)+")  at offset "+n+" not in 0x00-0xFF."),o&=255);m.push(String.fromCharCode(o))}return m.join("")}var ra=typeof atob==="function"?atob:function(l){var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",o,p,q,r,s,t=0;l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");do p=m.indexOf(l.charAt(t++)),q=m.indexOf(l.charAt(t++)),r=m.indexOf(l.charAt(t++)),s=m.indexOf(l.charAt(t++)),p=p<<2|q>>4,q=(q&15)<<4|r>>2,o=(r&3)<<6|s,n=n+String.fromCharCode(p),r!==64&&(n=n+String.fromCharCode(q)),s!==64&&(n=n+String.fromCharCode(o));while(t<l.length);return n};function sa(l){try{l=ra(l);var m=new Uint8Array(l.length);for(var n=0;n<l.length;++n)m[n]=l.charCodeAt(n);return m}catch(l){throw new Error("Converting base64 string to bytes failed.")}}function ga(l){if(!$(l))return;return sa(l.slice(Z.length))}var ha={b:ea,a:E};oa();m.___wasm_call_ctors=function(){return(m.___wasm_call_ctors=m.asm.c).apply(null,arguments)};m.__malloc=function(){return(m.__malloc=m.asm.d).apply(null,arguments)};m.__free=function(){return(m.__free=m.asm.e).apply(null,arguments)};m.__DgwCodecEncodeEmpty=function(){return(m.__DgwCodecEncodeEmpty=m.asm.f).apply(null,arguments)};m.__DgwCodecEncodeDeauth=function(){return(m.__DgwCodecEncodeDeauth=m.asm.g).apply(null,arguments)};m.__DgwCodecEncodeDrain=function(){return(m.__DgwCodecEncodeDrain=m.asm.h).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_EstabStream=function(){return(m.__DgwCodecEncodeStreamGroup_EstabStream=m.asm.i).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_EndOfData=function(){return(m.__DgwCodecEncodeStreamGroup_EndOfData=m.asm.j).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_Data=function(){return(m.__DgwCodecEncodeStreamGroup_Data=m.asm.k).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_Ack=function(){return(m.__DgwCodecEncodeStreamGroup_Ack=m.asm.l).apply(null,arguments)};m.__DgwCodecEncodePing=function(){return(m.__DgwCodecEncodePing=m.asm.m).apply(null,arguments)};m.__DgwCodecEncodePong=function(){return(m.__DgwCodecEncodePong=m.asm.n).apply(null,arguments)};m.__DgwCodecDecode=function(){return(m.__DgwCodecDecode=m.asm.o).apply(null,arguments)};m.__getFrameType=function(){return(m.__getFrameType=m.asm.p).apply(null,arguments)};m.__getDrainReasonFromDrainFrame=function(){return(m.__getDrainReasonFromDrainFrame=m.asm.q).apply(null,arguments)};m.__getDGWFramePtr=function(){return(m.__getDGWFramePtr=m.asm.r).apply(null,arguments)};m.__getStreamIdFromStreamGroupFrame=function(){return(m.__getStreamIdFromStreamGroupFrame=m.asm.s).apply(null,arguments)};m.__getEncodedParamsFromEstablishStreamFrame=function(){return(m.__getEncodedParamsFromEstablishStreamFrame=m.asm.t).apply(null,arguments)};m.__getEncodedParamsSizeFromEstablishStreamFrame=function(){return(m.__getEncodedParamsSizeFromEstablishStreamFrame=m.asm.u).apply(null,arguments)};m.__getDataFromGroupedStreamDataFrame=function(){return(m.__getDataFromGroupedStreamDataFrame=m.asm.v).apply(null,arguments)};m.__getDataSizeFromGroupedStreamDataFrame=function(){return(m.__getDataSizeFromGroupedStreamDataFrame=m.asm.w).apply(null,arguments)};m.__getAckIdFromGroupedStreamDataFrame=function(){return(m.__getAckIdFromGroupedStreamDataFrame=m.asm.x).apply(null,arguments)};m.__getRequiresAckFromGroupedStreamDataFrame=function(){return(m.__getRequiresAckFromGroupedStreamDataFrame=m.asm.y).apply(null,arguments)};m.__getAckIdFromGroupedStreamAckFrame=function(){return(m.__getAckIdFromGroupedStreamAckFrame=m.asm.z).apply(null,arguments)};var ia;V=function l(){ia||ja(),ia||(V=l)};function ja(l){l||v;if(T>0)return;O();if(T>0)return;function n(){if(ia)return;ia=!0;m.calledRun=!0;if(F)return;P();o(m);m.onRuntimeInitialized&&m.onRuntimeInitialized();Q()}m.setStatus?(m.setStatus("Running..."),setTimeout(function(){setTimeout(function(){m.setStatus("")},1),n()},1)):n()}m.run=ja;if(m.preInit){typeof m.preInit=="function"&&(m.preInit=[m.preInit]);while(m.preInit.length>0)m.preInit.pop()()}ja();return m.ready}}();typeof q==="object"&&typeof p==="object"?p.exports=r:typeof define==="function"&&define.amd?define([],function(){return r}):typeof q==="object"&&(q.Module=r)}),null);
__d("DGWUtils",["Base64","DGWConstants","DGWCppBridge","DGWLoggingContext","Promise","Random","URI","gkx","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=4;function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=d("Random").random()*16|0;a=a==="x"?b:b&3|8;return a.toString(16)})}function k(a){var b=new TextDecoder();b=b.decode(a);a=c("Base64").encode(b);b=a.replace(/\+/gi,"-").replace(/\//gi,"_").replace(/=/gi,"");return b}var l=null,m=null;function n(){m==null&&(m=(i||(i=b("Promise"))).resolve().then(function(){return c("DGWCppBridge")()}).then(function(a){l=a}));return m}e=function(){function a(){}a.initialize=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!c("gkx")("9999")){a.next=4;break}return a.abrupt("return",n());case 4:if(!(l!=null)){a.next=6;break}return a.abrupt("return");case 6:a.next=8;return b("regeneratorRuntime").awrap(c("DGWCppBridge")());case 8:l=a.sent;case 9:case"end":return a.stop()}},null,this)};a.constructConnectUrl=function(a){var b,e,f=a.appId,g=a.appVersion,i=a.authType,j=a.deviceId,l=a.dgwVersion,m=a.fbId,n=a.tier,o=a.loggingId,p=a.headers,q=a.endpoint,r=a.serviceId,s=a.regionHint;a=a.establishStreamFrame;var t=(b={},b[(e=d("DGWConstants")).HEADER_CONSTANTS.HEADER_APPID]=f,b[e.HEADER_CONSTANTS.HEADER_APPVERSION]=g,b[e.HEADER_CONSTANTS.HEADER_AUTHTYPE]=i,b[e.HEADER_CONSTANTS.HEADER_DGW_VERSION]=""+l,b[e.HEADER_CONSTANTS.HEADER_UUID]=m,b[e.HEADER_CONSTANTS.HEADER_TARGET_TIER]=n,b);a!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64]=k(a));o!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_LOGGING_ID]=o);s!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_REGIONHINT]=s);j!==void 0&&(t[d("DGWConstants").HEADER_CONSTANTS.HEADER_DEVICE_ID]=j);Object.keys(p).forEach(function(a){var b=d("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+a;Object.prototype.hasOwnProperty.call(t,b)||(t[b]=p[a])});f=new(h||(h=c("URI")))(q);f.setQueryData(t);f.setPath(f.getPath()+"/"+r);f.toString().length>2e3&&(delete t[d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64],f.setQueryData(t));return f.toString()};return a}();f=function(){function a(a,b,c){this.$1=null,this.$2=a,this.$3=b,this.$4=c}a.initialize=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!c("gkx")("9999")){a.next=4;break}return a.abrupt("return",n());case 4:if(!(l!=null)){a.next=6;break}return a.abrupt("return");case 6:a.next=8;return b("regeneratorRuntime").awrap(c("DGWCppBridge")());case 8:l=a.sent;case 9:case"end":return a.stop()}},null,this)};var e=a.prototype;e.malloc=function(a){try{a=l.__malloc(a);if(a===0){var b;(b=this.$2)==null?void 0:b.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","malloc returned 0");return-1}return a}catch(a){(b=this.$2)==null?void 0:b.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","exception during malloc",a.toString());return-1}};e.free=function(a){l.__free(a)};e.append=function(a){if(this.$1==null){this.$1=a;return}var b=this.$1.length,c=new Uint8Array(b+a.length);c.set(this.$1,0);c.set(a,b);this.$1=c};e.processData=function(){var a=this;if(this.$1==null)return;var b=this.$1.length,c=this.malloc(b);if(c===-1)return;var e=l.HEAPU8.subarray(c,c+b);if(this.$1)for(var f=0;f<e.length;++f)e[f]=this.$1[f];f=this.malloc(j*4);if(f===-1)return;e=f;var g=e+j,h=g+j,i=h+j;b=l.__DgwCodecDecode(c,b,e,g,h,i);this.free(c);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){this.free(f);(h=this.$2)==null?void 0:h.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Codec Decode Failure","Failed to decode Frame(s). Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b));return}c=l.HEAPU32.subarray(i/j,i/j+1)[0];if(this.$1==null){this.free(f);return}h=this.$1.length-c;if(this.$1&&this.$1.length>h){this.$1=new Uint8Array(((b=this.$1)==null?void 0:b.subarray(h))||[])}else this.$1=null;i=l.HEAPU32.subarray(g/j,g/j+1)[0];c=l.HEAPU32.subarray(e/j,e/j+1)[0];var k=[];for(b=0;b<i;++b){var m=l.__getDGWFramePtr(c,b);h=l.__getFrameType(m);switch(h){case d("DGWConstants").DgwFrameType.DgwFrameType_Drain:g=function(){var b=l.__getDrainReasonFromDrainFrame(m),c=d("DGWConstants").drainReasonToDrainReasonString(b);(b=a.$2)==null?void 0:b.logEvent(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received Drain Frame from server","DrainReason: "+c);k.push(function(){var b;return(b=a.$3)==null?void 0:b.receivedDrainSignal(c)});return"break"}();if(g==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EstabStream:e=function(){var b=l.__getStreamIdFromStreamGroupFrame(m),c=l.__getEncodedParamsFromEstablishStreamFrame(m),d=new Uint8Array(l.HEAPU8.subarray(c,c+l.__getEncodedParamsSizeFromEstablishStreamFrame(m)));a.free(c);k.push(function(){var c;return(c=a.$3)==null?void 0:c.onGroupedStreamEstablishStreamReceived(b,d)});return"break"}();if(e==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Data:h=function(){var b=l.__getStreamIdFromStreamGroupFrame(m),c=l.__getDataFromGroupedStreamDataFrame(m),d=new Uint8Array(l.HEAPU8.subarray(c,c+l.__getDataSizeFromGroupedStreamDataFrame(m)));a.free(c);var e=l.__getRequiresAckFromGroupedStreamDataFrame(m)?l.__getAckIdFromGroupedStreamDataFrame(m):null;k.push(function(){var c;return(c=a.$3)==null?void 0:c.onGroupedStreamDataReceived(b,d,e)});return"break"}();if(h==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Ack:g=function(){var b=l.__getStreamIdFromStreamGroupFrame(m),c=l.__getAckIdFromGroupedStreamAckFrame(m);k.push(function(){var d;return(d=a.$3)==null?void 0:d.onGroupedStreamAckReceived(b,c)});return"break"}();if(g==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EndOfData:e=function(){var b=l.__getStreamIdFromStreamGroupFrame(m);k.push(function(){var c;return(c=a.$3)==null?void 0:c.onGroupedStreamEndOfDataReceived(b)});return"break"}();if(e==="break")break;case d("DGWConstants").DgwFrameType.DgwFrameType_Ping:k.push(function(){var b;return(b=a.$3)==null?void 0:b.onPingReceived()});break;case d("DGWConstants").DgwFrameType.DgwFrameType_Pong:k.push(function(){var b;return(b=a.$3)==null?void 0:b.onPongReceived()});break;default:break}this.free(m)}this.free(f);for(h=0;h<k.length;h++)k[h]()};e.encodeData=function(a,b,c,e){var f=this.malloc(a.length);if(f===-1)return null;var g=l.HEAPU8.subarray(f,f+a.length);for(var h=0;h<g.length;++h)g[h]=a[h];a=this.malloc(j*2);h=a;var i=a+j;e=l.__DgwCodecEncodeStreamGroup_Data(e,f,g.length,b,c,h,i);this.free(f);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(g=this.$2)==null?void 0:g.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Data Frame encode failure","Failed to decode DGW Data Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}b=l.HEAPU32.subarray(h/j,h/j+1)[0];c=l.HEAPU32.subarray(i/j,i/j+1)[0];f=new Uint8Array(l.HEAPU8.subarray(b,b+c));this.free(b);this.free(a);return f};e.encodeAck=function(a,b){var c=this.malloc(j*2);if(c===-1)return null;var e=c,f=c+j;b=l.__DgwCodecEncodeStreamGroup_Ack(b,a,e,f);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(a=this.$2)==null?void 0:a.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"ACK Frame encode failure","Failed to encode ACK Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b));return null}a=l.HEAPU32.subarray(e/j,e/j+1)[0];b=l.HEAPU32.subarray(f/j,f/j+1)[0];e=new Uint8Array(l.HEAPU8.subarray(a,a+b));this.free(a);this.free(c);return e};e.encodeDrain=function(a){var b=this.malloc(j*2);if(b===-1)return null;var c=b,e=b+j;a=l.__DgwCodecEncodeDrain(a,c,e);if(a!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Drain Frame encode failure","Failed to encode Drain Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(a));return null}f=l.HEAPU32.subarray(c/j,c/j+1)[0];a=l.HEAPU32.subarray(e/j,e/j+1)[0];c=new Uint8Array(l.HEAPU8.subarray(f,f+a));this.free(f);this.free(b);return c};e.encodeEstablishStream=function(a,b){var c=this.malloc(b.length);if(c===-1)return null;var e=l.HEAPU8.subarray(c,c+b.length);for(var f=0;f<b.length;++f)e[f]=b[f];e=this.malloc(j*2);f=e;var g=e+j;b=l.__DgwCodecEncodeStreamGroup_EstabStream(a,c,b.length,f,g);this.free(c);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(c=this.$2)==null?void 0:c.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EstablishStream Frame encode failure","Failed to encode EstablishStream Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b)+" for StreamId "+a);return null}c=l.HEAPU32.subarray(f/j,f/j+1)[0];b=l.HEAPU32.subarray(g/j,g/j+1)[0];a=new Uint8Array(l.HEAPU8.subarray(c,c+b));this.free(c);this.free(e);return a};e.encodeEndOfData=function(a){var b=this.malloc(j*2);if(b===-1)return null;var c=b,e=b+j;a=l.__DgwCodecEncodeStreamGroup_EndOfData(a,c,e);if(a!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EndOfData Frame encode failure","Failed to encode EndOfData Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(a));return null}f=l.HEAPU32.subarray(c/j,c/j+1)[0];a=l.HEAPU32.subarray(e/j,e/j+1)[0];c=new Uint8Array(l.HEAPU8.subarray(f,f+a));this.free(f);this.free(b);return c};e.encodePing=function(){if(this.$5!=null)return this.$5;var a=this.malloc(j*2);if(a===-1)return null;var b=a,c=a+j,e=l.__DgwCodecEncodePing(b,c);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Ping Frame encode failure","Failed to encode Ping Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}f=l.HEAPU32.subarray(b/j,b/j+1)[0];e=l.HEAPU32.subarray(c/j,c/j+1)[0];b=new Uint8Array(l.HEAPU8.subarray(f,f+e));this.free(f);this.free(a);this.$5=b;return b};e.encodePong=function(){if(this.$6!=null)return this.$6;var a=this.malloc(j*2);if(a===-1)return null;var b=a,c=a+j,e=l.__DgwCodecEncodePong(b,c);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null?void 0:f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Pong Frame encode failure","Failed to encode Pong Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}f=l.HEAPU32.subarray(b/j,b/j+1)[0];e=l.HEAPU32.subarray(c/j,c/j+1)[0];b=new Uint8Array(l.HEAPU8.subarray(f,f+e));this.free(f);this.free(a);this.$6=b;return b};return a}();g.uuidv4=a;g.Uint8ArrayToBase64UrlStr=k;g.DGWUtils=e;g.DGWCodec=f}),98);
__d("DGWExponentialBackoff",["Promise","regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g,h={maxRetries:5,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},i=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.errors=c;return a}return a}(babelHelpers.wrapNativeSuper(Error));function a(a,c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:c===void 0&&(c=h);d.prev=1;d.next=4;return b("regeneratorRuntime").awrap(j(a,c));case 4:return d.abrupt("return",d.sent);case 7:d.prev=7;d.t0=d["catch"](1);throw d.t0.errors[d.t0.errors.length-1];case 10:case"end":return d.stop()}},null,this,[[1,7]])}function j(a,c){var d,e,f,g,h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:d=0,e=[],f=c.baseRetryInterval,g=c.backoffFactor;case 4:if(!(d<=c.maxRetries)){j.next=20;break}j.prev=5;j.next=8;return b("regeneratorRuntime").awrap(a());case 8:h=j.sent;return j.abrupt("return",h);case 12:j.prev=12,j.t0=j["catch"](5),e.push(j.t0);case 15:j.next=17;return b("regeneratorRuntime").awrap(k(f*Math.pow(g,d)));case 17:++d;j.next=4;break;case 20:throw new i("Max call count exceeded",e);case 21:case"end":return j.stop()}},null,this,[[5,12]])}function k(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(new(g||(g=b("Promise")))(function(b){return window.setTimeout(b,a)}));case 2:case"end":return c.stop()}},null,this)}f.callWithExponentialBackoff=a}),66);
__d("DGWPinger",["DGWLoggingContext"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){this.$1=a,this.$4=b,this.$5=c,this.$3=!1}var b=a.prototype;b.$6=function(){var a=this;if(this.$3){var b;(b=d("DGWLoggingContext")).DGWLoggingContext.bumpODSKey(b.DGWLoggingComponent.PINGER,"timeout_fired.reset");this.$3=!1;this.$4();b.DGWLoggingContext.bumpODSKey(b.DGWLoggingComponent.PINGER,"timeout.newtimeout");this.$2=window.setTimeout(function(){a.$6()},this.$1)}else d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"timeout_fired.disconnect"),this.$5()};b.reset=function(){var a=this;this.$3=!0;this.$2&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset"),window.clearTimeout(this.$2),this.$2=null);this.$1>0&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset.newtimeout"),this.$2=window.setTimeout(function(){a.$6()},this.$1))};b.cancel=function(){this.$2&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"canceled"),window.clearTimeout(this.$2),this.$2=null)};return a}();g.DGWPinger=a}),98);
__d("DGWStreamGroupCallbacks",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum")({TRANSPORT_SERVER_INTERNAL_ERROR:0,TRANSPORT_ABNORMAL_CLOSURE:1,TRANSPORT_GOING_AWAY:2,TRANSPORT_UNKNOWN_ERROR:3,TRANSPORT_KEEPALIVE_TIMEOUT:4,TRANSPORT_UNAUTHORIZED:5,TRANSPORT_REJECTED:6,TRANSPORT_BAD_REQUEST:7,TRANSPORT_DGW_SERVER_ERROR:8});function a(a){switch(a){case g.TRANSPORT_UNAUTHORIZED:return!1;default:return!0}}c=function(){function a(){}var b=a.prototype;b.onStreamGroupError=function(){};b.onStreamGroupMustDrain=function(){};b.onStreamGroupTransportClose=function(){};return a}();f.DGWStreamGroupError=g;f.isRetryableError=a;f.NoOpDGWStreamGroupCallbacks=c}),66);
__d("DGWTransportEvents",["DGWLoggingContext","NetworkStatus"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$3=a}var b=a.prototype;b.transportEstablished=function(){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"open"),this.$2=Date.now(),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_success")};b.transportEstablishmentPending=function(){this.$1=Date.now(),this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transportPending",null,!0),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_pending")};b.transportClosed=function(a,b){this.$4=Date.now(),a?(this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_graceful"),this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed gracefully",null,!0)):(this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_with_error"),this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed abnormally",b))};b.transportEstablishmentFailure=function(a){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"WebSocket transport establishment failure","WebSocket close code: "+a+" onLine:"+String(c("NetworkStatus").isOnline())),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_failure")};b.streamEstablishmentTimeout=function(a,b,e){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment timeout",a,"streamId:"+b+", onLine:"+String(c("NetworkStatus").isOnline()),!1,e),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_timeout")};b.streamEstablishmentPending=function(a,b){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment pending","streamId:"+a,!0,b),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_pending")};b.streamEstablishmentSuccess=function(a,b){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment success","streamId:"+a,!0,b),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_success")};b.transportError=function(a,b,c){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,a,b,c)};b.receivedFrameForInactiveStream=function(a,b,c){this.$3.logWarn(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Frame received for inactive stream","frameType: "+a+", streamID: "+b,c)};b.ranOutOfStreamIds=function(a){this.$3.logWarn(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Hit max StreamId limit","Hit max StreamId limit",a)};return a}();g.DGWTransportEvents=a}),98);
__d("DGWWebSocketTransport",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=new WebSocket(a);a.binaryType="arraybuffer";a.onopen=function(){};a.onclose=function(){};a.onerror=function(){};return a}f.getWebSocketConnection=a}),66);
__d("DGWStreamEvents",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c){this.$4=new Map(),this.$5=new Map(),this.$6=a,this.$1=b,c!=null&&(this.$8="streamId:"+c+"::")}var b=a.prototype;b.dataSent=function(a,b,c){var d=c?"sendWithAckRequested":"sendWithoutAckRequested";this.$6.logEvent(this.$1,d,((d=this.$8)!=null?d:"")+"sendId:"+a+", payloadSize:"+b,!0);this.$4.set(a,{ackRequested:c,payloadSize:b,sendTimestamp:Date.now()})};b.ackReceived=function(a){var b;this.$6.logEvent(this.$1,"AckReceived",((b=this.$8)!=null?b:"")+"sendId:"+a,!0);this.$6.bumpODSKey(this.$1,"ack_received");b=this.$4.get(a);b!=null&&(b.ackReceivedTimestamp=Date.now())};b.ackSent=function(a){var b;this.$6.bumpODSKey(this.$1,"ack_sent");this.$6.logEvent(this.$1,"ACK sent",((b=this.$8)!=null?b:"")+"ackId:"+a,!0)};b.drainSent=function(a){var b;this.$6.logEvent(this.$1,"Drain sent",((b=this.$8)!=null?b:"")+"drainReason: "+a)};b.dataReceived=function(a,b,c){var d;this.$6.bumpODSKey(this.$1,"data_received");this.$6.logEvent(this.$1,"Data received",((d=this.$8)!=null?d:"")+"sendId:"+((d=c)!=null?d:"null")+", ackRequested:"+b.toString()+", payloadSize:"+a,!0);c!=null&&this.$5.set(c,{ackRequested:b,payloadSize:a,receiveTimestamp:Date.now()})};b.endOfDataReceived=function(){this.$6.bumpODSKey(this.$1,"end_of_data_received"),this.$6.logEvent(this.$1,"EndOfDataReceived",this.$8,!0)};b.endOfDataSent=function(){this.$6.bumpODSKey(this.$1,"end_of_data_sent"),this.$6.logEvent(this.$1,"EndOfDataSent",this.$8,!0)};b.streamClosed=function(a,b){this.$7=Date.now();var c=this.$9();if(a){this.$6.bumpODSKey(this.$1,"stream_closed_gracefully");this.$6.logEvent(this.$1,"Stream closed gracefully",""+((a=this.$8)!=null?a:"")+c)}else{this.$6.bumpODSKey(this.$1,"stream_closed_with_error");this.$6.logError(this.$1,"Stream closed abnormally",b,""+((a=this.$8)!=null?a:"")+c)}};b.connectionEstablishmentFailure=function(a){this.$6.logEvent(this.$1,"WebSocket connection establishment failure","WebSocket close code: "+a)};b.streamEstablishmentFailure=function(a,b){this.$6.logError(this.$1,"Failed to establish DGW Stream","Last seen error: "+a.toString(),""+((a=this.$8)!=null?a:"")+b);this.$6.bumpODSKey(this.$1,"stream_establishment_failure")};b.error=function(a,b){b={msg:b,state:this.$9()};this.$6.logError(this.$1,a,JSON.stringify(b),this.$8)};b.$9=function(){var a={currentNetworkCondition:window.navigator&&window.navigator.onLine===!0,establishRequestTimestamp:this.$2,establishedTimestamp:this.$3,streamClosedTimestamp:this.$7,sendHistory:JSON.stringify(Array.from(this.$4.entries())),receiveHistory:JSON.stringify(Array.from(this.$5.entries()))};return JSON.stringify(a)};return a}();f.DGWStreamEvents=a}),66);
__d("GroupedStream",["DGWAckManager","DGWConstants","DGWLoggingContext","DGWStream","DGWStreamEvents","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,e,f,g,h){this.$1=a,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=b,this.$7=c,this.$8=e,this.$2=g,this.$9=f,this.$10=new(d("DGWAckManager").DGWAckManager)(this.$9),this.$12=new(d("DGWStreamEvents").DGWStreamEvents)(this.$9,d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,this.$1),this.$11=0,this.$13=h}var c=a.prototype;c.send=function(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:f=this.$11++%d("DGWConstants").MAX_ACK_ID;if(this.$14(a,!0,f)){h.next=3;break}return h.abrupt("return",!1);case 3:h.next=5;return b("regeneratorRuntime").awrap(this.$10.waitForAck(f,(e=c)!=null?e:d("DGWConstants").DEFAULT_ACK_TIMEOUT_MS));case 5:g=h.sent;return h.abrupt("return",g);case 7:case"end":return h.stop()}},null,this)};c.sendAndForget=function(a){return this.$14(a,!1)};c.close=function(){var a=this.$2.encodeEndOfData(this.$1);if(a==null){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode EndOfData","streamId: "+this.$1);return}a=this.$8.send(a);if(!a){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send EndOfData","streamId: "+this.$1+". StreamGroupTransport not open during send");return}this.$12.endOfDataSent();this.$5=!0;this.$4&&this.$15()};c.loggingContext=function(){return this.$9};c.__sendDrain=function(a){var b=d("DGWConstants").drainReasonToDrainReasonString(a);if(this.$5)return!1;a=this.$2.encodeDrain(a);if(a==null)return!1;this.$12.drainSent(b);b=this.$8.send(a);return b};c.__transportCloseHook=function(a){this.$13(),this.$10.clearPendingAcks(),a?(this.$12.error("Received StreamError","StreamErrorType: "+a),this.$6.onError(a)):this.$5&&this.$4?this.$15():(this.$12.streamClosed(!1,"Stream closed: ClosedLocally: "+this.$5.toString()+", EndOfDataReceived: "+this.$4.toString()),this.$6.onError(d("DGWStream").StreamError.PREMATURE_CLOSE))};c.$15=function(){this.$13(),this.$12.streamClosed(!0,"Graceful close"),this.$6.onClose(this)};c.__dataReceivedHook=function(a,b){this.$12.dataReceived(a.length,b!=null,b),b!=null&&this.$16(b),this.$6.onDataReceived(a)};c.__ackReceivedHook=function(a){this.$12.ackReceived(a),this.$10.handleAckReceived(a)};c.__drainReceivedHook=function(a){this.$3===!1&&(this.$6.onStreamMustDrain(this,a),this.$3=!0)};c.__endOfDataHook=function(){this.$12.endOfDataReceived(),this.$4=!0,this.$5?this.$15():this.$6.onServerHasFinishedSendingData(this)};c.$14=function(a,b,c){b===void 0&&(b=!1);c===void 0&&(c=0);if(this.$5){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","Stream closed locally");return!1}a=this.$2.encodeData(a,b,c,this.$1);if(a==null)return!1;var e=this.$8.send(a);if(!e){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","ClosedLocally: "+this.$5.toString());return!1}this.$12.dataSent(c,a.length,b);return!0};c.$16=function(a){var b=this.$2.encodeAck(a,this.$1);if(b==null){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode ACK","ackId: "+a);return!1}b=this.$8.send(b);if(!b){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send ACK","ackId: "+a);return!1}this.$12.ackSent(a);return!0};return a}();g.GroupedStream=a}),98);
__d("StreamIdGenerator",["err"],(function(a,b,c,d,e,f,g){"use strict";var h=65535;a=function(){function a(){this.$1=new Set(),this.$2=-1}var b=a.prototype;b.getNextStreamId=function(){if(!this.streamIdAvailable())throw c("err")("Max number of stream IDs reached");return++this.$2};b.putBackStreamId=function(a){this.$1.add(a)};b.streamIdAvailable=function(){return this.$2<h};return a}();g.MAX_STREAM_ID=h;g.StreamIdGeneratorImpl=a}),98);
__d("StreamGroupWebSocketTransport",["DGWConstants","DGWExponentialBackoff","DGWLoggingContext","DGWPinger","DGWStream","DGWStreamGroupCallbacks","DGWTransportEvents","DGWUtils","DGWWebSocketTransport","GroupedStream","Promise","StreamIdGenerator","err","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b,c,e,f){var g=this;this.groupedStream=a;this.$1=window.setTimeout(function(){c(d("DGWStream").StreamError.ESTABLISHMENT_TIMEOUT)},e);this.handleEstablishFrameReceived=function(){window.clearTimeout(g.$1),b(g.groupedStream)};this.abortStream=function(a){f(),c(a)}};a=function(){function a(b,e,f,g,h,i,j,k){var l=this;this.$14=h;this.$16=this.__getStreamIdGenerator();this.$5=new Map();this.$6=new Map();this.$7=g.keepAliveMs;this.$8=!1;this.$3=!0;this.$4=!1;this.$12=f;this.$10=new TextEncoder();this.$11=new TextDecoder();this.$13=g;h={onDataReceived:function(){},handleAckReceived:function(){},receivedDrainSignal:function(a){l.$13.streamGroupCallbacks.onStreamGroupMustDrain(a),l.$5.forEach(function(b){b.__drainReceivedHook(a)})},onGroupedStreamDataReceived:function(a,b,c){if(l.$5.has(a)){var d=l.$5.get(a);d==null?void 0:d.__dataReceivedHook(b,c)}else{l.$12.receivedFrameForInactiveStream("Data",a,"sendAckID: "+((d=c)!=null?d:"null"))}},onGroupedStreamAckReceived:function(a,b){if(l.$5.has(a)){var c=l.$5.get(a);c==null?void 0:c.__ackReceivedHook(b)}else{l.$12.receivedFrameForInactiveStream("ACK",a,"ackId: "+((c=b)!=null?c:"null"))}},onGroupedStreamEndOfDataReceived:function(a){if(l.$5.has(a)){var b=l.$5.get(a);b==null?void 0:b.__endOfDataHook()}else l.$12.receivedFrameForInactiveStream("EndOfData",a)},onGroupedStreamEstablishStreamReceived:function(a,b){if(l.$6.has(a)){var c=l.$6.get(a);l.$6["delete"](a);b=JSON.parse(l.$11.decode(b));(b.code===void 0||b.code!==200)&&(c==null?void 0:c.abortStream(d("DGWStream").StreamError.ABNORMAL_CLOSURE));c==null?void 0:c.handleEstablishFrameReceived()}else l.$12.receivedFrameForInactiveStream("EstablishStream",a,"EstablishStream received for non-inflight stream")},onPingReceived:function(){var a=l.$2.encodePing();if(a==null)return;l.send(a)},onPongReceived:function(){}};this.$2=new(d("DGWUtils").DGWCodec)(i,h,g.dgwVersion);if(g.enableFirstStreamOnWsHandshake){if(j===void 0)throw c("err")("Missing grouped stream options");if(k===void 0)throw c("err")("Missing grouped stream callbacks");var m=this.$16.getNextStreamId();f=this.createEstablishStreamFrame(m,j);h=d("DGWUtils").DGWUtils.constructConnectUrl({appId:g.appId,appVersion:g.appVersion,authType:g.authType,deviceId:(i=g.deviceId)!=null?i:void 0,dgwVersion:g.dgwVersion,fbId:g.fbId,tier:g.tier,loggingId:(h=g.loggingId)!=null?h:void 0,headers:a.__prefixAppHeaders(g.headers),endpoint:g.connectEndpoint,serviceId:g.serviceId,regionHint:(i=g.regionHint)!=null?i:void 0,establishStreamFrame:f});this.$1=e(h);if(!h.includes(d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64))return;this.$15=this.waitForEstablishStream(m,k,j,new(d("DGWLoggingContext").DGWLoggingContext)(this.$13.dgwVersion,j.loggingId,this.$13.serviceId,this.$13.fbId,this.$13.loggingId,j.disableFalcoLogging),function(a){l.$5.set(m,a)},function(){l.$16.putBackStreamId(m)})}else this.$1=e(b)}var e=a.prototype;e.send=function(a){try{this.$1.send(a);return!0}catch(a){this.$12.transportError("Failed to send over transport","readyState: "+this.$1.readyState,a.toString());return!1}};e.close=function(){this.$1.close(d("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE)};e.abort=function(a,b,c,d){this.$8=!0,this.$12.transportClosed(!1,d),this.$5.forEach(function(a){a.__transportCloseHook(b)}),this.$6.forEach(function(a){a.abortStream(b)}),this.$13.streamGroupCallbacks.onStreamGroupError(a),this.$5.clear(),this.$6.clear(),this.$1.close(c)};e.cleanup=function(){var a;(a=this.$9)==null?void 0:a.cancel();this.$1!=null&&(this.$1.onopen=function(a){},this.$1.onmessage=function(a){},this.$1.onerror=function(a){},this.$1.onclose=function(a){},this.$1.close())};a.getTransportWithInitialStream=function(c,e,f,g,h){var i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b("regeneratorRuntime").awrap(d("DGWUtils").DGWCodec.initialize());case 2:i=new(d("DGWTransportEvents").DGWTransportEvents)(g);i.transportEstablishmentPending();j=function(){return a.$17("",f,i,h,g,c,e)};m.prev=5;m.next=8;return b("regeneratorRuntime").awrap(d("DGWExponentialBackoff").callWithExponentialBackoff(j));case 8:k=m.sent;l=k.$15!=null?k.$15:k.establishGroupedStream(e,c,new(d("DGWLoggingContext").DGWLoggingContext)(f.dgwVersion,c.loggingId,f.serviceId,f.fbId,f.loggingId,c.disableFalcoLogging));return m.abrupt("return",{transport:k,streamPromise:l});case 13:m.prev=13;m.t0=m["catch"](5);throw m.t0;case 16:case"end":return m.stop()}},null,this,[[5,13]])};a.getTransport_DEPRECATED=function(c,e,f,g,h){var i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:k.next=2;return b("regeneratorRuntime").awrap(d("DGWUtils").DGWCodec.initialize());case 2:i=new(d("DGWTransportEvents").DGWTransportEvents)(f);i.transportEstablishmentPending();j=function(){return a.$17(c,e,i,g,f)};k.prev=5;k.next=8;return b("regeneratorRuntime").awrap(d("DGWExponentialBackoff").callWithExponentialBackoff(j,h));case 8:return k.abrupt("return",k.sent);case 11:k.prev=11;k.t0=k["catch"](5);throw k.t0;case 14:case"end":return k.stop()}},null,this,[[5,11]])};e.establishGroupedStream=function(a,d,e){var f=this,g,h,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:g=this.getStreamId();h=this.createEstablishStreamFrame(g,d);i=this.waitForEstablishStream(g,a,d,e,function(a){f.$5.set(g,a)},function(){f.$16.putBackStreamId(g)});if(this.send(h)){k.next=5;break}throw c("err")("Websocket connection closed before stream established");case 5:k.next=7;return b("regeneratorRuntime").awrap(i);case 7:j=k.sent;return k.abrupt("return",j);case 9:case"end":return k.stop()}},null,this)};a.__prefixAppHeaders=function(a){return Object.keys(a).reduce(function(b,c){b[""+d("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+c]=a[c];return b},{})};e.waitForEstablishStream=function(a,c,d,e,f,g){var j=this,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:this.$12.streamEstablishmentPending(a,d.loggingId);k=this.__createGroupedStream(a,c,d,e);m.prev=2;m.next=5;return b("regeneratorRuntime").awrap(new(h||(h=b("Promise")))(function(b,c){j.$6.set(a,new i(k,b,c,3e4,function(){j.streamEndCallback(a)}))}));case 5:l=m.sent;f(k);this.$12.streamEstablishmentSuccess(a,d.loggingId);return m.abrupt("return",l);case 11:m.prev=11;m.t0=m["catch"](2);g();this.$12.streamEstablishmentTimeout("Stream establishment timeout",a,d.loggingId);throw m.t0;case 16:case"end":return m.stop()}},null,this,[[2,11]])};a.$17=function(c,e,f,g,h,i,j){var k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:k=new a(c,d("DGWWebSocketTransport").getWebSocketConnection,f,e,g,h,i,j);k.$1.onmessage=a.$18(k);k.$1.onopen=function(){f.transportEstablished(),k.$3=!1,k.$7!=null&&(k.$9=new(d("DGWPinger").DGWPinger)(k.$7,function(){k.$19()},function(){k.abort(d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_KEEPALIVE_TIMEOUT,d("DGWStream").StreamError.KEEPALIVE_TIMEOUT,d("DGWConstants").WebsocketCloseCodes.KEEPALIVE_TIMEOUT,"Aborting transport because of keepalive timeout")}))};k.$1.onerror=function(){};k.$1.onclose=a.$20(k);m.next=7;return b("regeneratorRuntime").awrap(a.getTransportPromise(k));case 7:l=m.sent;return m.abrupt("return",l);case 9:case"end":return m.stop()}},null,this)};a.getTransportPromise=function(a){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(new(h||(h=b("Promise")))(function(b,c){var e=a.$1.onerror,f=a.$1.onopen;a.$1.onerror=function(){window.clearTimeout(g),e(),c(d("DGWStream").StreamError.ESTABLISHMENT_ERROR)};a.$1.onopen=function(){window.clearTimeout(g),f(),b(a)};var g=window.setTimeout(function(){a.cleanup(),c(d("DGWStream").StreamError.ESTABLISHMENT_TIMEOUT)},2e4)}));case 2:c=e.sent;return e.abrupt("return",c);case 4:case"end":return e.stop()}},null,this)};a.$18=function(a){return function(b){var c;(c=a.$9)==null?void 0:c.reset();if(!(b.data instanceof ArrayBuffer)){a.$12.transportError("Incorrect Data Protocol","Received "+typeof b.data+" instead of ArrayBuffer");return}a.$2.append(new Uint8Array(b.data));a.$2.processData()}};a.$20=function(a){return function(b){var c;(c=a.$9)==null?void 0:c.cancel();if(a.$8===!0||a.$4)return;if(a.$3===!0){a.$12.transportEstablishmentFailure(b.code);a.$5.clear();a.$14();return}a.$14();a.$3=!0;if(b.code!==d("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE){a.$12.transportClosed(!1,"Websocket connection failure with code "+b.code);c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR;var e=d("DGWStream").StreamError.UNKNOWN_ERROR;switch(b.code){case d("DGWConstants").WebsocketCloseCodes.NORMAL_CLOSURE:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_ABNORMAL_CLOSURE;e=d("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case d("DGWConstants").WebsocketCloseCodes.ABNORMAL_CLOSURE:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_ABNORMAL_CLOSURE;e=d("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case d("DGWConstants").WebsocketCloseCodes.SERVER_INTERNAL_ERROR:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR;e=d("DGWStream").StreamError.SERVER_INTERNAL_ERROR;break;case d("DGWConstants").WebsocketCloseCodes.GOING_AWAY:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_GOING_AWAY;e=d("DGWStream").StreamError.GOING_AWAY;break;case d("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNAUTHORIZED;e=d("DGWStream").StreamError.UNAUTHORIZED;break;case d("DGWConstants").WebsocketCloseCodes.REJECTED:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_REJECTED;e=d("DGWStream").StreamError.REJECTED;break;case d("DGWConstants").WebsocketCloseCodes.BAD_REQUEST:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_BAD_REQUEST;e=d("DGWStream").StreamError.BAD_REQUEST;break;case d("DGWConstants").WebsocketCloseCodes.DGW_SERVER_ERROR:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR;e=d("DGWStream").StreamError.DGW_SERVER_ERROR;c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_DGW_SERVER_ERROR;break;default:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR;e=d("DGWStream").StreamError.UNKNOWN_ERROR;break}a.$13.streamGroupCallbacks.onStreamGroupError(c);a.$5.forEach(function(a){a.__transportCloseHook(e)});a.$6.forEach(function(a){a.abortStream(e)})}else a.$12.transportClosed(!0,""),a.$13.streamGroupCallbacks.onStreamGroupTransportClose(),a.$5.forEach(function(a){a.__transportCloseHook()}),a.$6.forEach(function(a){a.abortStream(d("DGWStream").StreamError.TRANSPORT_CLOSED_BEFORE_STREAM_INIT)});a.$5.clear();a.$6.clear()}};e.$19=function(){var a=this.$2.encodePing();if(a==null)throw c("err")("Failed to encode Ping Frame");this.send(a)};e.isClosedLocally=function(){return this.$3||this.$8||this.$4};e.streamEndCallback=function(a){this.$5["delete"](a),this.$6["delete"](a),this.$16.putBackStreamId(a)};e.canCreateGroupedStream=function(){return this.$16.streamIdAvailable()};e.createEstablishStreamFrame=function(b,d){d=this.$2.encodeEstablishStream(b,new Uint8Array(this.$10.encode(JSON.stringify(a.__prefixAppHeaders(d.groupedStreamHeaders)))));if(d==null){this.$16.putBackStreamId(b);throw c("err")("Failed to encode EstablishStreamFrame")}return d};e.getStreamId=function(){try{return this.$16.getNextStreamId()}catch(a){this.$12.ranOutOfStreamIds("inFlightGroupedStreamSize: "+this.$6.size+" groupedStreamSize: "+this.$5.size);throw a}};e.__createGroupedStream=function(a,b,c,e){var f=this;return new(d("GroupedStream").GroupedStream)(a,b,c,this,e,this.$2,function(){f.streamEndCallback(a)})};e.__getStreamIdGenerator=function(){return new(d("StreamIdGenerator").StreamIdGeneratorImpl)()};return a}();g.StreamGroupWebSocketTransport=a}),98);
__d("StreamGroup",["DGWConstants","DGWLoggingContext","DGWUtils","StreamGroupWebSocketTransport","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,e,f,g,h,i,j){this.$2=j;this.$1=j.getNewStreamGroupId();j=(j=h.overrideUrl)!=null?j:f;this.$5=null;this.$3={appId:a,appVersion:b,authType:c,deviceId:h.deviceId,dgwVersion:e,headers:h.streamGroupAppHeaders,tier:(f=h.serviceTier)!=null?f:d("DGWConstants").DEFAULT_SERVICE_TIER,connectEndpoint:j,fbId:g,loggingId:h.loggingId,serviceId:h.serviceId,streamGroupCallbacks:i,keepAliveMs:h.keepAliveMs,regionHint:h.regionHint,enableFirstStreamOnWsHandshake:!1};this.$4=h;this.streamGroupLoggingContext=new(d("DGWLoggingContext").DGWLoggingContext)(this.$3.dgwVersion,null,this.$3.serviceId,this.$3.fbId,this.$4.loggingId,!1,(a=h.verboseLoggingEnabled)!=null?a:!1);this.$6=d("DGWUtils").DGWUtils.constructConnectUrl({appId:this.$3.appId,appVersion:this.$3.appVersion,authType:this.$3.authType,deviceId:(b=this.$3.deviceId)!=null?b:void 0,dgwVersion:this.$3.dgwVersion,fbId:this.$3.fbId,headers:babelHelpers["extends"]({},this.$3.headers),loggingId:(c=this.$3.loggingId)!=null?c:void 0,tier:this.$3.tier,serviceId:this.$3.serviceId,endpoint:this.$3.connectEndpoint,regionHint:(e=this.$3.regionHint)!=null?e:void 0})}var c=a.prototype;c.initTransport=function(){var a=this,c,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c={maxRetries:0,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)};this.$5=this.$5||d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){a.$2.removeStreamGroupAndTransport(a.$1)},c);f.prev=2;f.next=5;return b("regeneratorRuntime").awrap(this.$5);case 5:e=f.sent;this.$5=null;f.next=13;break;case 9:f.prev=9;f.t0=f["catch"](2);this.$5=null;throw f.t0;case 13:this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,e);return f.abrupt("return",e);case 15:case"end":return f.stop()}},null,this,[[2,9]])};c.establishStream=function(a,c){var e=this,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:if(!(this.$2.containsStreamGroup(this.$1)===!1)){h.next=23;break}this.streamGroupLoggingContext.logEvent(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"createTransportWhenEstablishStream");if(this.$3.enableFirstStreamOnWsHandshake){h.next=18;break}this.$5=this.$5||d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){e.$2.removeStreamGroupAndTransport(e.$1)});h.prev=4;h.next=7;return b("regeneratorRuntime").awrap(this.$5);case 7:f=h.sent;this.$5=null;h.next=15;break;case 11:h.prev=11;h.t0=h["catch"](4);this.$5=null;throw h.t0;case 15:this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,f);h.next=23;break;case 18:h.next=20;return b("regeneratorRuntime").awrap(d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransportWithInitialStream(a,c,this.$3,this.streamGroupLoggingContext,function(){e.$2.removeStreamGroupAndTransport(e.$1)}));case 20:g=h.sent;this.$2.setStreamGroupAndTransport(this.$1,g.transport);return h.abrupt("return",g.streamPromise);case 23:return h.abrupt("return",this.establishStreamWithTransport(a,c));case 24:case"end":return h.stop()}},null,this,[[4,11]])};c.establishStreamWithTransport=function(a,c){var e,f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:f=a.loggingId;this.streamGroupLoggingContext.logEvent(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"Establishing Grouped Stream",null,!0,f);h.next=4;return b("regeneratorRuntime").awrap(this.$2.getStreamGroupTransport(this.$1).establishGroupedStream(c,a,new(d("DGWLoggingContext").DGWLoggingContext)(this.$3.dgwVersion,f,this.$3.serviceId,this.$3.fbId,this.$3.loggingId,a.disableFalcoLogging,(e=a.verboseLoggingEnabled)!=null?e:!1)));case 4:g=h.sent;return h.abrupt("return",g);case 6:case"end":return h.stop()}},null,this)};c.canCreateGroupedStream=function(){var a=!0;if(this.$2.containsStreamGroup(this.$1)!==!1){var b=this.$2.getStreamGroupTransport(this.$1);a=b.canCreateGroupedStream()}d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,a?"can_create":"cannot_create");return a};c.close=function(){var a=this.$2.getStreamGroupTransport(this.$1);a.close()};return a}();g.StreamGroup=a}),98);
__d("StreamGroupRegistry",["Random","err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new Map(),this.$2=new Set()}var b=a.prototype;b.setStreamGroupAndTransport=function(a,b){this.$1.set(a,b)};b.containsStreamGroup=function(a){return this.$1.has(a)};b.removeStreamGroupAndTransport=function(a){this.$1["delete"](a)};b.getStreamGroupTransport=function(a){a=this.$1.get(a);if(a==null)throw c("err")("No stream group transport");return a};b.getNewStreamGroupId=function(){var a=d("Random").uint32();while(this.$2.has(a))a=d("Random").uint32();this.$2.add(a);return a};return a}();g.StreamGroupRegistry=a}),98);
__d("RawDGWClient",["CurrentUser","DGWLoggingContext","DGWStream","StreamGroup","StreamGroupRegistry","isFastRefreshEnabledForCurrentDomain","justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.appId,c=a.appVersion,e=a.authType,f=a.dgwVersion,g=a.endpoint;a=a.fbId;this.$1=b;this.$2=c;this.$3=e;this.$4=f;this.$5=g;this.$6=a;this.$7=new(d("StreamGroupRegistry").StreamGroupRegistry)()}var b=a.prototype;b.createStreamGroup=function(a,b){c("justknobx")._("1023")&&this.handleUserChecks();return new(d("StreamGroup").StreamGroup)(this.$1,this.$2,this.$3,this.$4,this.$5,this.$6,b,a,this.$7)};b.handleUserChecks=function(){if(!c("CurrentUser").isLoggedInNow()&&!c("isFastRefreshEnabledForCurrentDomain")()){d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.RAW_CLIENT,"unauthenticated");throw d("DGWStream").StreamError.UNAUTHENTICATED}};return a}();g.RawDGWClient=a}),98);
__d("DGWClient",["DGWAuth","DGWEnvUtil","DGWWebConfig","RawDGWClient","err"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("RawDGWClient").RawDGWClient)({appId:c("DGWWebConfig").appId,appVersion:c("DGWWebConfig").appVersion,authType:d("DGWAuth").fromStringToDGWAuth(c("DGWEnvUtil").getDGWAuthType()),dgwVersion:c("DGWEnvUtil").getDGWVersion(),endpoint:c("DGWEnvUtil").getDGWEndpoint(),fbId:c("DGWWebConfig").fbId});function a(){if(c("DGWEnvUtil").isDGWEnvCompatible())return h;else throw c("err")("unsupported_environment_retry_with_mqtt")}g["default"]=a}),98);
__d("DGWRequestStreamUtils",["Base64","WebDriverConfig","cr:3024","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,d,e,f){var g={};a=Object.entries(a);for(var h=0;h<a.length;h++){var i=a[h],j=i[0];i=i[1];typeof i=="string"?g["XRSS-"+j]=i:typeof i=="number"?g["XRSN-"+j]=i.toString():typeof i=="boolean"?g["XRSB-"+j]=i.toString():typeof i=="object"&&i!=null&&(g["XRSO-"+j]=c("Base64").encode(JSON.stringify(i)))}d&&(g["xrs-body"]="true");e!=null&&e.length>0&&(g["xrs-instrumentation"]=c("Base64").encode(e));g["XRS-Accept-Ack"]="RSAck";f!=null&&f.ackTimeoutSec!=null&&(g["XRS-SRAck-Timeout"]=f.ackTimeoutSec.toString());g["XRSS-http_referer"]=window.location.href;if(c("WebDriverConfig").isTestRunning&&c("gkx")("20919")){j=b("cr:3024")==null?void 0:b("cr:3024").get();j!=null&&(g["XRSB-is_test"]="true",g["XRSS-original_request_id"]=j)}return g}function h(a){return Object.keys(a).reduce(function(b,c){(typeof a[c]==="string"||typeof a[c]==="boolean"||typeof a[c]==="number"||typeof a[c]==="object")&&(b[c]=a[c]);return b},{})}function d(a){if(a.response&&a.response.instrumentation_data!=null&&a.response.instrumentation_data.length>0)try{a=JSON.parse(new TextDecoder("utf-8").decode(a.response.instrumentation_data));return{auxId:a.auxId,dfTraceId:(a=a.dataFlowTracingData)==null?void 0:a.traceId}}catch(a){}return null}function e(a,b){var c=a.headers;a=a.body;b.kill_body===!0&&(a=null);b.new_body!=null&&(a=b.new_body);if(b.new_headers!=null)try{c=h(JSON.parse(b.new_headers))}catch(a){}if(b.patch_headers!=null)try{c=babelHelpers["extends"]({},c,h(JSON.parse(b.patch_headers)))}catch(a){}return{headers:c,body:a}}g.convertHeaders=a;g.cleanHeaders=h;g.getInstrumentationDataFieldsFromPayload=d;g.transformContextWithRewriteDelta=e}),98);
__d("DGWStreamHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c,d,e){this.$2=a,this.$3=b,this.$4=c,this.$5=d,this.$6=e,this.$1=!0}var b=a.prototype;b.onClose=function(a){if(!this.$1)return;this.$2(a)};b.onDataReceived=function(a){if(!this.$1)return;this.$3(a)};b.onError=function(a){if(!this.$1)return;this.$4(a)};b.onStreamMustDrain=function(a,b){if(!this.$1)return;this.$5(a,b)};b.onServerHasFinishedSendingData=function(a){if(!this.$1)return;this.$6(a)};b.stop=function(){this.$1=!1};b.isStopped=function(){return!this.$1};return a}();f["default"]=a}),66);
__d("InflightAmends",["Deferred","err"],(function(a,b,c,d,e,f,g){"use strict";var h="inflight_amends_timeout",i="inflight_amends_duplicate_id";a=function(){function a(a,b,c){this.$1=a,this.$3=b,this.$4=c,this.$2=new Map()}var b=a.prototype;b.add=function(a){var b=this;if(this.$2.has(a))throw c("err")(i);var d=new(c("Deferred"))(),e=Date.now(),f=setTimeout(function(){b.$2.has(a)&&b.reject(a,c("err")(h))},this.$1);this.$2.set(a,{id:a,deferred:d,createdTimestampMs:e,timeoutId:f});return d.getPromise()};b.getPromise=function(a){return(a=this.$5(a))==null?void 0:a.deferred.getPromise()};b.resolve=function(a,b){a=this.$5(a);a&&(a.deferred.resolve==null?void 0:a.deferred.resolve(b),this.$3(a.id,Date.now()-a.createdTimestampMs),this.$6(a))};b.reject=function(a,b){a=this.$5(a);a&&(a.deferred.reject==null?void 0:a.deferred.reject(b),this.$4(a.id,b),this.$6(a))};b.rejectAll=function(a){for(var b=this.$2.entries(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;var f=e[0];e[1];this.reject(f,a)}};b.getSize=function(){return this.$2.size};b.getAllPromises=function(){var a=[];for(var b=this.$2.values(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;a.push(e.deferred.getPromise())}return a};b.$6=function(a){clearTimeout(a.timeoutId),this.$2["delete"](a.id)};b.$5=function(a){return this.$2.get(a)};return a}();g["default"]=a}),98);
__d("RequestStreamCloseReason",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["UserIntention","StartStreamFailure","StreamError","RemoteTermination","ServerDataEnd","ServerDrain","ReestablishError","ClientError"]);f.RequestStreamCloseReason=a}),66);
__d("RequestStreamCommonRequestStreamCommonSerializers",["RequestStreamCommonRequestStreamCommonTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{expected_existing_headers:"",patch_headers_if_match:""}}function e(){return{bytes:Uint8Array.of()}}function f(){return{message:""}}function i(){return{reason:d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)}}function j(){return{}}function k(){return{stream_id:"0",last_sequencer:0,amendment_count:0,last_status:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)}}function l(){return{caller_timestamp_ms:"0"}}function m(){return{original_ping_timestamp_ms:"0"}}function n(){return{}}function o(a,b){b.writeStructBegin("ResponseRewriteRequest"),a.new_headers!=null&&(b.writeFieldBegin({fname:"new_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.new_headers),b.writeFieldEnd()),a.new_body!=null&&(b.writeFieldBegin({fname:"new_body",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.new_body),b.writeFieldEnd()),a.patch_headers!=null&&(b.writeFieldBegin({fname:"patch_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.patch_headers),b.writeFieldEnd()),a.kill_body!=null&&(b.writeFieldBegin({fname:"kill_body",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:4}),b.writeBool(a.kill_body),b.writeFieldEnd()),a.temporary!=null&&(b.writeFieldBegin({fname:"temporary",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:5}),b.writeBool(a.temporary),b.writeFieldEnd()),a.conditional_patch_headers!=null&&(b.writeFieldBegin({fname:"conditional_patch_headers",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),p(a.conditional_patch_headers,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function p(a,b){b.writeStructBegin("ResponseRewriteConditionalPatchHeaders");b.writeFieldBegin({fname:"expected_existing_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.expected_existing_headers!=null)b.writeString(a.expected_existing_headers);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"patch_headers_if_match",ftype:h.STRING,fid:2});if(a.patch_headers_if_match!=null)b.writeString(a.patch_headers_if_match);else{d="";b.writeString(d)}b.writeFieldEnd();a.patch_headers_otherwise!=null&&(b.writeFieldBegin({fname:"patch_headers_otherwise",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.patch_headers_otherwise),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function q(a,b){b.writeStructBegin("ResponseData");b.writeFieldBegin({fname:"bytes",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.bytes!=null)b.writeBinary(a.bytes);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.metadata!=null&&(b.writeFieldBegin({fname:"metadata",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.metadata),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function r(a,b){b.writeStructBegin("LogMessage");b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.message!=null)b.writeString(a.message);else{a="";b.writeString(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function s(a,b){b.writeStructBegin("Termination");b.writeFieldBegin({fname:"reason",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.reason!=null){var e;b.writeI32((e=a.reason)!=null?e:0)}else{e=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.message!=null&&(b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.message),b.writeFieldEnd());a.retry_delay_ms!=null&&(b.writeFieldBegin({fname:"retry_delay_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(c("jsbi").BigInt(a.retry_delay_ms)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function t(a,b){b.writeStructBegin("AmendStreamAck"),a.amendment_id!=null&&(b.writeFieldBegin({fname:"amendment_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.amendment_id)),b.writeFieldEnd()),a.accepted!=null&&(b.writeFieldBegin({fname:"accepted",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:2}),b.writeBool(a.accepted),b.writeFieldEnd()),a.result!=null&&(b.writeFieldBegin({fname:"result",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.result),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function u(a,b){b.writeStructBegin("StreamCheck");b.writeFieldBegin({fname:"stream_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.stream_id!=null)b.writeI64(c("jsbi").BigInt(a.stream_id));else{var e="0";b.writeI64(c("jsbi").BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"last_sequencer",ftype:h.I32,fid:2});if(a.last_sequencer!=null)b.writeI32(a.last_sequencer);else{e=0;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"amendment_count",ftype:h.I32,fid:4});if(a.amendment_count!=null)b.writeI32(a.amendment_count);else{e=0;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"last_status",ftype:h.I32,fid:3});if(a.last_status!=null){b.writeI32((e=a.last_status)!=null?e:0)}else{a=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0);b.writeI32((e=a)!=null?e:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function v(a,b){b.writeStructBegin("Ping");b.writeFieldBegin({fname:"caller_timestamp_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.caller_timestamp_ms!=null)b.writeI64(c("jsbi").BigInt(a.caller_timestamp_ms));else{var d="0";b.writeI64(c("jsbi").BigInt(d))}b.writeFieldEnd();if(a.streams_to_check!=null){b.writeFieldBegin({fname:"streams_to_check",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.streams_to_check.length});for(var d=a.streams_to_check,a=Array.isArray(d),e=0,d=a?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(a){if(e>=d.length)break;f=d[e++]}else{e=d.next();if(e.done)break;f=e.value}f=f;u(f,b)}b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function w(a,b){b.writeStructBegin("Pong");b.writeFieldBegin({fname:"original_ping_timestamp_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.original_ping_timestamp_ms!=null)b.writeI64(c("jsbi").BigInt(a.original_ping_timestamp_ms));else{var d="0";b.writeI64(c("jsbi").BigInt(d))}b.writeFieldEnd();if(a.stream_ids_missing!=null){b.writeFieldBegin({fname:"stream_ids_missing",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.I64,size:a.stream_ids_missing.length});for(var d=a.stream_ids_missing,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b.writeI64(c("jsbi").BigInt(g))}b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_behind!=null){b.writeFieldBegin({fname:"stream_ids_behind",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:3});b.writeListBegin({etype:h.I64,size:a.stream_ids_behind.length});for(g=a.stream_ids_behind,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;d=g[e++]}else{e=g.next();if(e.done)break;d=e.value}d=d;b.writeI64(c("jsbi").BigInt(d))}b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_with_lost_amendments!=null){b.writeFieldBegin({fname:"stream_ids_with_lost_amendments",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:4});b.writeListBegin({etype:h.I64,size:a.stream_ids_with_lost_amendments.length});for(d=a.stream_ids_with_lost_amendments,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b.writeI64(c("jsbi").BigInt(g))}b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_with_wrong_status!=null){b.writeFieldBegin({fname:"stream_ids_with_wrong_status",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:5});b.writeListBegin({etype:h.I64,size:a.stream_ids_with_wrong_status.length});for(g=a.stream_ids_with_wrong_status,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;d=g[e++]}else{e=g.next();if(e.done)break;d=e.value}a=d;b.writeI64(c("jsbi").BigInt(a))}b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function x(a,b){b.writeStructBegin("StreamResponseDelta");if(a.flow_status!=null){var d;b.writeFieldBegin({fname:"flow_status",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((d=a.flow_status)!=null?d:0);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.log!=null){b.writeFieldBegin({fname:"log",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2});r(a.log,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.rewrite!=null){b.writeFieldBegin({fname:"rewrite",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3});o(a.rewrite,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.data!=null){b.writeFieldBegin({fname:"data",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4});q(a.data,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.termination!=null){b.writeFieldBegin({fname:"termination",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5});s(a.termination,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.amend_ack!=null){b.writeFieldBegin({fname:"amend_ack",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6});t(a.amend_ack,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function y(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.new_headers=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.new_body=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).BOOL?b.kill_body=a.readBool():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).BOOL?b.temporary=a.readBool():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRUCT?b.conditional_patch_headers=z(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function z(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.expected_existing_headers=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers_if_match=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers_otherwise=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.expected_existing_headers===void 0&&(b.expected_existing_headers="");b.patch_headers_if_match===void 0&&(b.patch_headers_if_match="");return b}function A(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.bytes=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.metadata=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.bytes===void 0&&(b.bytes=Uint8Array.of());return b}function B(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.message=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.message===void 0&&(b.message="");return b}function C(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.reason=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.message=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I64?b.retry_delay_ms=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.reason===void 0&&(b.reason=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0));return b}function D(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).BOOL?b.accepted=a.readBool():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.result=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function E(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.stream_id=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.last_sequencer=a.readI32():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.amendment_count=a.readI32():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.last_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.stream_id===void 0&&(b.stream_id="0");b.last_sequencer===void 0&&(b.last_sequencer=0);b.amendment_count===void 0&&(b.amendment_count=0);b.last_status===void 0&&(b.last_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0));return b}function F(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.caller_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.streams_to_check=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=E(a);b.streams_to_check.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.caller_timestamp_ms===void 0&&(b.caller_timestamp_ms="0");return b}function G(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.original_ping_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_missing=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString();b.stream_ids_missing.push(g)}}else a.skip(e);break;case 3:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_behind=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readI64().toString();b.stream_ids_behind.push(d)}}else a.skip(e);break;case 4:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_with_lost_amendments=[];d=a.readListBegin();for(f=0;f<d.size;f++){g=a.readI64().toString();b.stream_ids_with_lost_amendments.push(g)}}else a.skip(e);break;case 5:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_with_wrong_status=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readI64().toString();b.stream_ids_with_wrong_status.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.original_ping_timestamp_ms===void 0&&(b.original_ping_timestamp_ms="0");return b}function H(a){var b,e={};a.readStructBegin();while(!0){var f=a.readFieldBegin(),g=f.ftype;f=f.fid;if(g===(h||(h=c("ThriftTypes"))).STOP)break;switch(f){case 1:if(g===(h||(h=c("ThriftTypes"))).I32)if(b==null)e.flow_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()),b="flow_status";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: flow_status, previous deserialized field: "+b);else a.skip(g);break;case 2:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.log=B(a),b="log";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: log, previous deserialized field: "+b);else a.skip(g);break;case 3:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.rewrite=y(a),b="rewrite";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: rewrite, previous deserialized field: "+b);else a.skip(g);break;case 4:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.data=A(a),b="data";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: data, previous deserialized field: "+b);else a.skip(g);break;case 5:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.termination=C(a),b="termination";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: termination, previous deserialized field: "+b);else a.skip(g);break;case 6:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.amend_ack=D(a),b="amend_ack";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: amend_ack, previous deserialized field: "+b);else a.skip(g);break;default:a.skip(g)}a.readFieldEnd()}a.readStructEnd();return e}g.ResponseRewriteRequest$DefaultConstructor=a;g.ResponseRewriteConditionalPatchHeaders$DefaultConstructor=b;g.ResponseData$DefaultConstructor=e;g.LogMessage$DefaultConstructor=f;g.Termination$DefaultConstructor=i;g.AmendStreamAck$DefaultConstructor=j;g.StreamCheck$DefaultConstructor=k;g.Ping$DefaultConstructor=l;g.Pong$DefaultConstructor=m;g.StreamResponseDelta$DefaultConstructor=n;g.serializeResponseRewriteRequest=o;g.serializeResponseRewriteConditionalPatchHeaders=p;g.serializeResponseData=q;g.serializeLogMessage=r;g.serializeTermination=s;g.serializeAmendStreamAck=t;g.serializeStreamCheck=u;g.serializePing=v;g.serializePong=w;g.serializeStreamResponseDelta=x;g.deserializeResponseRewriteRequest=y;g.deserializeResponseRewriteConditionalPatchHeaders=z;g.deserializeResponseData=A;g.deserializeLogMessage=B;g.deserializeTermination=C;g.deserializeAmendStreamAck=D;g.deserializeStreamCheck=E;g.deserializePing=F;g.deserializePong=G;g.deserializeStreamResponseDelta=H}),98);
__d("RequestStreamSingleChannelSingleChannelRequestStreamTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Ignored:100,Success:200,Queued:250,UnknownStream:400,HandledUnknownResult:450,Failure:500});c=b("$InternalEnum")({Request_headers:"request_headers",Request_body:"request_body",Amend:"amend",Ack:"ack",Response:"response",Ping:"ping",Pong:"pong"});e.exports={Ack:a,Payload$Types:c}}),null);
__d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers",["RequestStreamCommonRequestStreamCommonSerializers","RequestStreamCommonRequestStreamCommonTypes","RequestStreamSingleChannelSingleChannelRequestStreamTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{body:Uint8Array.of()}}function e(){return{amendment:Uint8Array.of()}}function f(){return{ack:d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)}}function i(){return{delta:[]}}function j(){return{}}function k(a,b){b.writeStructBegin("RequestStreamHeaders"),a.headers!=null&&(b.writeFieldBegin({fname:"headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeBinary(a.headers),b.writeFieldEnd()),a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function l(a,b){b.writeStructBegin("RequestStreamBody");b.writeFieldBegin({fname:"body",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.body!=null)b.writeBinary(a.body);else{a=Uint8Array.of();b.writeBinary(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function m(a,b){b.writeStructBegin("AmendStream");a.amendment_id!=null&&(b.writeFieldBegin({fname:"amendment_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.amendment_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"amendment",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});if(a.amendment!=null)b.writeBinary(a.amendment);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.is_query!=null&&(b.writeFieldBegin({fname:"is_query",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:3}),b.writeBool(a.is_query),b.writeFieldEnd());a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function n(a,b){b.writeStructBegin("StreamResponseAck");a.response_id!=null&&(b.writeFieldBegin({fname:"response_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.response_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"ack",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});if(a.ack!=null){var e;b.writeI32((e=a.ack)!=null?e:0)}else{e=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0);b.writeI32((e=e)!=null?e:0)}b.writeFieldEnd();a.query_result!=null&&(b.writeFieldBegin({fname:"query_result",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.query_result),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function o(a,b){b.writeStructBegin("StreamResponse");a.response_id!=null&&(b.writeFieldBegin({fname:"response_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.response_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"delta",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});if(a.delta!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.delta.length});for(var e=a.delta,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(f){if(g>=e.length)break;i=e[g++]}else{g=e.next();if(g.done)break;i=g.value}i=i;d("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(i,b)}b.writeListEnd()}else{i=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:i.length});for(g=0;g<i.length;g++){f=i[g];d("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(f,b)}b.writeListEnd()}b.writeFieldEnd();if(a.ack_level!=null){b.writeFieldBegin({fname:"ack_level",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3});b.writeI32((e=a.ack_level)!=null?e:0);b.writeFieldEnd()}a.query_request!=null&&(b.writeFieldBegin({fname:"query_request",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.query_request),b.writeFieldEnd());a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function p(a,b){b.writeStructBegin("Payload");if(a.request_headers!=null){b.writeFieldBegin({fname:"request_headers",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});k(a.request_headers,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.request_body!=null){b.writeFieldBegin({fname:"request_body",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2});l(a.request_body,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.amend!=null){b.writeFieldBegin({fname:"amend",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3});m(a.amend,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ack!=null){b.writeFieldBegin({fname:"ack",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4});n(a.ack,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.response!=null){b.writeFieldBegin({fname:"response",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5});o(a.response,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ping!=null){b.writeFieldBegin({fname:"ping",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6});d("RequestStreamCommonRequestStreamCommonSerializers").serializePing(a.ping,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.pong!=null){b.writeFieldBegin({fname:"pong",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7});d("RequestStreamCommonRequestStreamCommonSerializers").serializePong(a.pong,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function q(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.headers=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function r(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.body=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.body===void 0&&(b.body=Uint8Array.of());return b}function s(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.amendment=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).BOOL?b.is_query=a.readBool():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.amendment===void 0&&(b.amendment=Uint8Array.of());return b}function t(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.response_id=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.ack=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.query_result=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.ack===void 0&&(b.ack=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0));return b}function u(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.response_id=a.readI64().toString():a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).LIST){b.delta=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=d("RequestStreamCommonRequestStreamCommonSerializers").deserializeStreamResponseDelta(a);b.delta.push(i)}}else a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.ack_level=d("RequestStreamCommonRequestStreamCommonTypes").AckLevel.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.query_request=a.readBinary():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.delta===void 0&&(b.delta=[]);return b}function v(a){var b,e={};a.readStructBegin();while(!0){var f=a.readFieldBegin(),g=f.ftype;f=f.fid;if(g===(h||(h=c("ThriftTypes"))).STOP)break;switch(f){case 1:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.request_headers=q(a),b="request_headers";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_headers, previous deserialized field: "+b);else a.skip(g);break;case 2:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.request_body=r(a),b="request_body";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_body, previous deserialized field: "+b);else a.skip(g);break;case 3:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.amend=s(a),b="amend";else throw new Error("more than one field have been deserialized in union type: Payload; current field: amend, previous deserialized field: "+b);else a.skip(g);break;case 4:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.ack=t(a),b="ack";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ack, previous deserialized field: "+b);else a.skip(g);break;case 5:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.response=u(a),b="response";else throw new Error("more than one field have been deserialized in union type: Payload; current field: response, previous deserialized field: "+b);else a.skip(g);break;case 6:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.ping=d("RequestStreamCommonRequestStreamCommonSerializers").deserializePing(a),b="ping";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ping, previous deserialized field: "+b);else a.skip(g);break;case 7:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.pong=d("RequestStreamCommonRequestStreamCommonSerializers").deserializePong(a),b="pong";else throw new Error("more than one field have been deserialized in union type: Payload; current field: pong, previous deserialized field: "+b);else a.skip(g);break;default:a.skip(g)}a.readFieldEnd()}a.readStructEnd();return e}g.RequestStreamHeaders$DefaultConstructor=a;g.RequestStreamBody$DefaultConstructor=b;g.AmendStream$DefaultConstructor=e;g.StreamResponseAck$DefaultConstructor=f;g.StreamResponse$DefaultConstructor=i;g.Payload$DefaultConstructor=j;g.serializeRequestStreamHeaders=k;g.serializeRequestStreamBody=l;g.serializeAmendStream=m;g.serializeStreamResponseAck=n;g.serializeStreamResponse=o;g.serializePayload=p;g.deserializeRequestStreamHeaders=q;g.deserializeRequestStreamBody=r;g.deserializeAmendStream=s;g.deserializeStreamResponseAck=t;g.deserializeStreamResponse=u;g.deserializePayload=v}),98);
__d("RequestStreamState",["RequestStreamCommonRequestStreamCommonTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){switch(b){case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:return a.seenAccepted?a:{flowStatus:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted,seenAccepted:!0};default:if(!a.seenAccepted||a.flowStatus===b)return a;else return{flowStatus:b,seenAccepted:!0}}}g.getNextState=a}),98);
__d("StreamRetryState",[],(function(a,b,c,d,e,f){"use strict";var g=1e3,h=2*60*1e3;a=function(){function a(){this.$1=0}var b=a.prototype;b.resetErrorAndRetryCount=function(){this.$1=0};b.onRetry=function(){this.$1+=1};b.getRetryCount=function(){return this.$1};b.getBackoffDelayMs=function(){if(this.$1<=1)return 0;if(this.$1===2)return g*Math.random();var a=g*Math.pow(2,this.$1-3),b=a*Math.random();a=a+b;return Math.min(a,h)};return a}();f["default"]=a}),66);
__d("DGWRequestStreamRef",["CompactSerializerPolyfill","DGWRequestStreamUtils","DGWStream","DGWStreamHandler","InflightAmends","Promise","RequestStreamCloseReason","RequestStreamCommonRequestStreamCommonTypes","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamSingleChannelSingleChannelRequestStreamSerializers","RequestStreamSingleChannelSingleChannelRequestStreamTypes","RequestStreamState","RequestStreamTransport","RtiWebRequestStreamClient","StreamRetryState","err","gkx","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=4,j=0,k=1e3,l=2,m=c("gkx")("20915")?3e4:5e3,n="dgw_stream_send_ack_failure";function o(a){if(!a){a=c("err")(n);a.stack;throw a}}function p(a,b){if(a==null||a.length===0)return null;a=JSON.parse(a);a.auxId=b;return new TextEncoder().encode(JSON.stringify(a))}function q(a){var b={};a=a.delta;a.forEach(function(a){if(a.flow_status){b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Flow_status;switch(a.flow_status){case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:b.flow_status="Accepted";break;case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started:b.flow_status="Started";break;case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped:b.flow_status="Stopped";break}}else a.log?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Log:a.rewrite?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Rewrite:a.data?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Data:a.termination?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Termination:a.amend_ack&&(b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Amend_ack)});return b}a=function(){function a(a,b,e,f,g,h){var j=this;this.$6=null;this.$7={};this.$10=!1;this.$15=new(c("StreamRetryState"))();this.$16=0;this.$17=0;this.$18=0;this.$21=0;var k=null;typeof b=="string"?k=new TextEncoder().encode(b):typeof b=="object"&&(k=b);this.$1={headers:a,body:k};this.$3=e;this.$4=f;this.$12=i;this.$9=!1;this.$14=!1;this.$20=h;g!=null&&(this.$22()||(g.dgwStreamGroupLoggingId=this.$20.getStreamGroupLoggingId()),g.dgwCountPriorStreamsInGroup=this.$20.guessStreamGroupPriorStreamCount(),g.transport="WEB_RS_STARGATE");this.$5=d("RequestStreamE2ESampling").validateInstrumentationData(a,g,f==null?void 0:f.requestLogContext,f==null?void 0:f.upsampleMultiplier);!this.$22()?this.$6=d("RequestStreamE2ELogger").createStreamLogger(a,this.$5,d("RequestStreamTransport").RequestStreamTransport.WEB_RS_STARGATE):this.$7.disableFalcoLogging=!0;(f==null?void 0:f.deviceId)!=null&&(this.$7.deviceId=f.deviceId);this.$6&&(this.$7.loggingId=this.$6.getRequestId());f&&f.overrideUrl!=null&&(this.$7.overrideUrl=f.overrideUrl);this.$8={flowStatus:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped,seenAccepted:!1};this.$19=new(c("InflightAmends"))(m,function(a,b){var d;(d=j.$6)==null?void 0:d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,c("RequestStreamE2EClientLoggerEvent").RECEIVED,babelHelpers["extends"]({},j.$23(),{latency:b.toString()}),a)},function(a,b){if(b.message!==n){var d;(d=j.$6)==null?void 0:d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,c("RequestStreamE2EClientLoggerEvent").FAILURE,babelHelpers["extends"]({},j.$23(),{reason:b.message}),a)}});(k=this.$6)==null?void 0:k.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:(h=b==null?void 0:(e=b.length)==null?void 0:e.toString())!=null?h:"0"},"0","0")}var e=a.prototype;e.getInstrumentationData=function(){return this.$5};e.getE2EClientLogger=function(){return this.$6};e.amendWithAck=function(a){a=this.$24(a,!0);return a===null||a===void 0?(h||(h=b("Promise"))).resolve(!1):this.$19.getPromise(a)||(h||(h=b("Promise"))).resolve(!1)};e.amendWithoutAck=function(a){this.$24(a,!1)};e.cancel=function(){var a;(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").RECEIVED);this.$9=!0;this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)};e.start=function(a){var e=this;a===void 0&&(a=!1);var f=String(this.$16++),g=Date.now();return this.$26(f).then(function(){var a;e.$14=!1;e.$21=0;var b=(Date.now()-g).toString();(a=e.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:b},f,String(e.$18))})["catch"](function(g){g.stack;if(g.message===n&&e.$10)return;e.$14=!1;if(g!==d("DGWStream").StreamError.ESTABLISHMENT_ERROR){var i,j=g.message;g===d("DGWStream").StreamError.UNAUTHENTICATED?j="UNAUTHENTICATED":g===d("DGWStream").StreamError.UNAUTHORIZED&&(j="UNAUTHORIZED");(i=e.$6)==null?void 0:i.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:j},f,String(e.$18));e.$25(a?d("RequestStreamCloseReason").RequestStreamCloseReason.ReestablishError:d("RequestStreamCloseReason").RequestStreamCloseReason.StartStreamFailure,j,!0);if(g===d("DGWStream").StreamError.UNAUTHENTICATED||g===d("DGWStream").StreamError.UNAUTHORIZED)return;throw g}else{(i=e.$6)==null?void 0:i.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:(j=g.message)!=null?j:g},f,String(e.$18));e.$15.onRetry();var m=c("gkx")("20916")?e.$15.getBackoffDelayMs():k*Math.pow(l,e.$21);return new(h||(h=b("Promise")))(function(a){return window.setTimeout(a,m)}).then(function(){e.$21++;e.$18++;return e.start()})}})};e.getFlowStatus=function(){return this.$8.flowStatus};e.shouldTerminateOrRetry=function(a,e,f,g){var i=this;if(this.$14)return;var k=e;this.$12||(k="cannot retry for error: "+e+" because of hit max retry limitation");if(a!==d("RequestStreamCloseReason").RequestStreamCloseReason.ClientError){(e=this.$6)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:k},null,String(this.$18))}e=f&&(c("gkx")("20916")||this.$12);this.$25(a,k,!e);if(e){var l=c("gkx")("20916")?Math.max((f=g)!=null?f:0,this.$15.getBackoffDelayMs()):(a=g)!=null?a:j;this.$14=!0;return new(h||(h=b("Promise")))(function(a){return window.setTimeout(a,l)}).then(function(){return i.$27()})["catch"](function(a){})}};e.$28=function(){return this.$11!=null};e.$24=function(a,b){var e,f=this,g=typeof a=="string"?new TextEncoder().encode(a):a,h=String(this.$17++);(e=this.$6)==null?void 0:e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{},h);e=p(this.$5,h);g={amend:{amendment:g,instrumentation_data:e}};b&&g.amend&&(g.amend.amendment_id=h);e=d("CompactSerializerPolyfill").serialize(g,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);var i=Date.now();if(this.$29()&&this.$11!=null){b&&this.$19.add(h);this.$11.send(e).then(function(a){var b;o(a);a=(Date.now()-i).toString();(b=f.$6)==null?void 0:b.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:a},h)})["catch"](function(a){var b;(b=f.$6)==null?void 0:b.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:a.message},h);f.$19.reject(h,a)});(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:(e=a==null?void 0:(b=a.length)==null?void 0:b.toString())!=null?e:"0"},h);return h}else{(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},h)}};e.$26=function(a){var e=this,f,g,h,j,k,l,m,n,p;return b("regeneratorRuntime").async(function(q){while(1)switch(q.prev=q.next){case 0:if(this.$9){q.next=39;break}g=this.$2||this.$1;q.prev=2;h=this.$30();this.$13=h;j=g.headers.www_sandbox;k=babelHelpers["extends"]({},g.headers,this.$31());j!=null&&(k=babelHelpers["extends"]({},k,{www_sandbox:j}));l=d("DGWRequestStreamUtils").convertHeaders(k,g.body!=null,this.$5);q.next=11;return b("regeneratorRuntime").awrap(this.$20.establishStream(l,h,this.$7));case 11:this.$11=q.sent;q.next=26;break;case 14:q.prev=14;q.t0=q["catch"](2);if(!(q.t0===d("DGWStream").StreamError.ESTABLISHMENT_ERROR)){q.next=18;break}throw q.t0;case 18:if(!(d("DGWStream").StreamError.isValid(q.t0)&&!d("DGWStream").isRetryableError(q.t0))){q.next=22;break}throw q.t0;case 22:if(!(d("DGWStream").StreamError.isValid(q.t0)&&d("DGWStream").isRetryableError(q.t0))){q.next=25;break}this.$32(q.t0);return q.abrupt("return");case 25:throw q.t0;case 26:if(!this.$9){q.next=29;break}this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0);return q.abrupt("return");case 29:m=new Uint8Array([]);g.body!=null&&(n={request_body:{body:g.body}},m=d("CompactSerializerPolyfill").serialize(n,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload));if(this.$11){q.next=33;break}throw new Error("dgwstream_is_null");case 33:p=this.$11.send(m).then(function(a){o(a),e.$9&&e.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)});(f=this.$6)==null?void 0:f.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").SENT,{},a,String(this.$18));this.$12=i;return q.abrupt("return",p);case 39:throw new Error("stream_already_canceled");case 40:case"end":return q.stop()}},null,this,[[2,14]])};e.$29=function(){return this.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started||this.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted};e.$25=function(a,b,e){var f;this.$11&&a!==d("RequestStreamCloseReason").RequestStreamCloseReason.StreamError&&a!==d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination&&this.$11.close();c("gkx")("20917")&&this.$19.rejectAll(c("err")("stream terminating: "+b));(f=this.$13)==null?void 0:f.stop();this.$11=null;this.$10=!0;this.$33(d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped)&&this.$3.onFlowStatus(d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped);e&&!this.$9&&this.$3.onTermination("terminate stream because "+a+" with msg : "+b)};e.$33=function(a){var b=this.$8;this.$8=d("RequestStreamState").getNextState(b,a);return b!==this.$8};e.$27=function(){this.$12--;this.$18++;this.$15.onRetry();return this.start(!0)};e.$34=function(a){var b=this;a=d("CompactSerializerPolyfill").deserialize(a,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").deserializePayload);if(a.response){var e=d("DGWRequestStreamUtils").getInstrumentationDataFieldsFromPayload(a),f=e==null?void 0:e.auxId;e=e==null?void 0:e.dfTraceId;if(!this.$28()){var g;(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"response_received_after_close"},f,String(this.$18),e);return}(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").RECEIVED,q(a.response),f,String(this.$18),e);g=a.response.delta;g.forEach(function(a){if(a.data)b.$15.resetErrorAndRetryCount(),b.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&b.$3.onData(new TextDecoder("utf-8").decode(a.data.bytes));else if(a.flow_status){var c=a.flow_status;c===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&b.$15.resetErrorAndRetryCount();b.$33(c)&&b.$3.onFlowStatus(c)}else if(a.termination){c=(c=a.termination.message)!=null?c:"unknown termination msg";b.$2=null;b.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,c,a.termination.reason===d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.TryAgain,a.termination.retry_delay_ms!=null?parseInt(a.termination.retry_delay_ms,10):null)}else if(a.log)b.$3.onLog(a.log.message);else if(a.amend_ack){c=a.amend_ack.amendment_id;if(c!=null){var e=a.amend_ack.accepted||!1;b.$19.resolve(c,e)}}else if(a.rewrite){c=d("DGWRequestStreamUtils").transformContextWithRewriteDelta(b.$1,a.rewrite);a.rewrite.temporary===!0?b.$2=c:b.$1=c}});(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").SENT,q(a.response),f,String(this.$18),e);a.response.ack_level===d("RequestStreamCommonRequestStreamCommonTypes").AckLevel.Device&&a.response.response_id!=null&&this.$35(a.response.response_id,f)}else{(g=this.$6)==null?void 0:g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"unexpected_payload_type"},null,String(this.$18))}};e.$35=function(a,b){a={ack:{response_id:a,ack:d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.Success}};a=d("CompactSerializerPolyfill").serialize(a,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);if(this.$11!=null){this.$11.send(a);(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,c("RequestStreamE2EClientLoggerEvent").SENT,{},b,String(this.$18))}else{(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},b,String(this.$18))}};e.$22=function(){return this.$1.headers.method==="Falco"};e.$30=function(){return new(c("DGWStreamHandler"))(this.$36.bind(this),this.$37.bind(this),this.$32.bind(this),this.$38.bind(this),this.$39.bind(this))};e.$39=function(a){(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Has FinishedSendingData"},null,String(this.$18));this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.ServerDataEnd,"Client receive OnServerHasFinishedSendingData and Server will not send more data",!0)};e.$36=function(a){(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Close Connection"},null,String(this.$18));this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,"Client receive OnClose and Server will not send more data",!0)};e.$37=function(a){try{this.$34(a)}catch(b){(a=this.$6)==null?void 0:a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:b.message},null,String(this.$18));this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.ClientError,b.message,!1)}};e.$32=function(a){var b="",c=d("DGWStream").isRetryableError(a);b="StreamError: Received "+a;this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.StreamError,b,c)};e.$38=function(a,b){this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.ServerDrain,b,!0)};e.$31=function(){return c("RtiWebRequestStreamClient").overrideHeaders};e.$23=function(){var a={};c("gkx")("20918")&&(a.pending_amendments_size=this.$19.getSize().toString());return a};return a}();g["default"]=a}),98);
__d("DGWStreamGroupHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c){this.$1=a,this.$2=b,this.$3=c}var b=a.prototype;b.onStreamGroupError=function(a){this.$1(a)};b.onStreamGroupMustDrain=function(a){this.$2(a)};b.onStreamGroupTransportClose=function(){this.$3()};return a}();f["default"]=a}),66);
__d("DGWStreamFactory",["DGWClient","DGWStreamGroupHandler","Promise","gkx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i="realtime",j=1e4,k=null;a=function(){function a(){this.$3=0,this.$1=null,c("gkx")("20920")&&(this.$2=c("uuidv4")())}a.get=function(){k==null&&(k=new a());return k};var d=a.prototype;d.getStreamGroupLoggingId=function(){return this.$2};d.guessStreamGroupPriorStreamCount=function(){return this.$3};d.establishStream=function(a,d,e){var f=this;if(this.$1==null||!this.$1.canCreateGroupedStream()){var g={deviceId:e.deviceId,serviceId:i,disableFalcoLogging:e.disableFalcoLogging,streamGroupAppHeaders:{"stream-group":"group1"}};e.overrideUrl!=null&&(g.overrideUrl=e.overrideUrl);g.keepAliveMs=j;c("gkx")("20920")?(this.$2=c("uuidv4")(),g.loggingId=this.$2):this.$2=null;this.$3=0;try{this.$1=c("DGWClient")().createStreamGroup(new(c("DGWStreamGroupHandler"))(function(){f.$1=null},function(){f.$1=null},function(){f.$1=null}),g)}catch(a){return(h||(h=b("Promise"))).reject(a)}}this.$3++;return this.$1.establishStream({loggingId:e.loggingId,disableFalcoLogging:e.disableFalcoLogging,groupedStreamHeaders:a},d)};return a}();g["default"]=a}),98);
__d("DGWRequestStreamClient",["DGWRequestStreamRef","DGWStreamFactory","Promise","cr:2046346"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.$1=a!=null?a:c("DGWStreamFactory").get()}var d=a.prototype;d.createStream=function(a,d,e,f,g){b("cr:2046346")!=null&&b("cr:2046346").startPulsarTest();return(h||(h=b("Promise"))).resolve(new(c("DGWRequestStreamRef"))(a,d,f,g,e,this.$1))};return a}();g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("AggregateError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(c,d){var e;d=(d=d)!=null?d:g(c);e=a.call(this,d)||this;e.name="AggregateError";e.errors=c;e.message=d;Error.captureStackTrace&&Error.captureStackTrace(babelHelpers.assertThisInitialized(e),b);return e}return b}(babelHelpers.wrapNativeSuper(Error));function g(a){if(a.length===0)return"No errors";return a.length===1?a[0].message:a.map(function(a){return"- "+a.message}).join("\n")}f["default"]=a}),66);
__d("StructuredConfigBase",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getBool=function(a){return this.$1.getValue(a)>0};b.getInt=function(a){return this.$1.getValue(a)};return a}();f["default"]=a}),66);
__d("Configs",["StructuredConfigBase"],(function(a,b,c,d,e,f){"use strict";c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ExampleConfig1=c.getBool(0),c.$ExampleConfig2=c.getBool(2),c.$ExampleConfig3=c.getBool(1724),c.$ExampleConfig4=c.getBool(2044),c.$ExampleConfig5=c.getInt(1),c.$ExampleConfig6=c.getInt(3),c.$ExampleConfig7=c.getInt(2011),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ExampleConfig1=this.getBool(0),this.$ExampleConfig2=this.getBool(2),this.$ExampleConfig3=this.getBool(1724),this.$ExampleConfig4=this.getBool(2044),this.$ExampleConfig5=this.getInt(1),this.$ExampleConfig6=this.getInt(3),this.$ExampleConfig7=this.getInt(2011)};c.isEnabled=function(){return this.$ExampleConfig1};c.isSomeBoolean=function(){return this.$ExampleConfig2};c.isSomeOtherIntegerHasValue=function(){return this.$ExampleConfig3};c.isSomeOtherBoolean=function(){return this.$ExampleConfig4};c.getSomeInteger=function(){return this.$ExampleConfig5};c.getSomeOtherInteger=function(){return this.$ExampleConfig6};c.getSomeDouble=function(){return this.$ExampleConfig7};return b}(a=b("StructuredConfigBase"));d=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$SimulcastOverSignalingConfig1=c.getBool(651),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$SimulcastOverSignalingConfig1=this.getBool(651)};c.isSimulcastOverSignalingEnabled=function(){return this.$SimulcastOverSignalingConfig1};return b}(a);f=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$PreferredCaptureConfig1=c.getBool(173),c.$PreferredCaptureConfig2=c.getBool(3919),c.$PreferredCaptureConfig3=c.getBool(4478),c.$PreferredCaptureConfig4=c.getInt(174),c.$PreferredCaptureConfig5=c.getInt(175),c.$PreferredCaptureConfig6=c.getInt(176),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$PreferredCaptureConfig1=this.getBool(173),this.$PreferredCaptureConfig2=this.getBool(3919),this.$PreferredCaptureConfig3=this.getBool(4478),this.$PreferredCaptureConfig4=this.getInt(174),this.$PreferredCaptureConfig5=this.getInt(175),this.$PreferredCaptureConfig6=this.getInt(176)};c.isEnabled=function(){return this.$PreferredCaptureConfig1};c.isPreferStableFps=function(){return this.$PreferredCaptureConfig2};c.isEnabledForZenon=function(){return this.$PreferredCaptureConfig3};c.getWidthPx=function(){return this.$PreferredCaptureConfig4};c.getHeightPx=function(){return this.$PreferredCaptureConfig5};c.getFps=function(){return this.$PreferredCaptureConfig6};return b}(a);b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonSdpTransformConfig1=c.getBool(244),c.$ZenonSdpTransformConfig2=c.getBool(420),c.$ZenonSdpTransformConfig3=c.getBool(421),c.$ZenonSdpTransformConfig4=c.getBool(245),c.$ZenonSdpTransformConfig5=c.getBool(246),c.$ZenonSdpTransformConfig6=c.getBool(248),c.$ZenonSdpTransformConfig7=c.getBool(1448),c.$ZenonSdpTransformConfig8=c.getBool(1444),c.$ZenonSdpTransformConfig9=c.getBool(1445),c.$ZenonSdpTransformConfig10=c.getInt(1446),c.$ZenonSdpTransformConfig11=c.getInt(1447),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$ZenonSdpTransformConfig1=this.getBool(244),this.$ZenonSdpTransformConfig2=this.getBool(420),this.$ZenonSdpTransformConfig3=this.getBool(421),this.$ZenonSdpTransformConfig4=this.getBool(245),this.$ZenonSdpTransformConfig5=this.getBool(246),this.$ZenonSdpTransformConfig6=this.getBool(248),this.$ZenonSdpTransformConfig7=this.getBool(1448),this.$ZenonSdpTransformConfig8=this.getBool(1444),this.$ZenonSdpTransformConfig9=this.getBool(1445),this.$ZenonSdpTransformConfig10=this.getInt(1446),this.$ZenonSdpTransformConfig11=this.getInt(1447)};c.isPreserveH264=function(){return this.$ZenonSdpTransformConfig1};c.isPreferH264ForMwCall=function(){return this.$ZenonSdpTransformConfig2};c.isPreferSwH264=function(){return this.$ZenonSdpTransformConfig3};c.isAddAudioNack=function(){return this.$ZenonSdpTransformConfig4};c.isDisableOpusStereo=function(){return this.$ZenonSdpTransformConfig5};c.isPreferIsacForGroupAudio=function(){return this.$ZenonSdpTransformConfig6};c.isEnableOpusFmtpMunging=function(){return this.$ZenonSdpTransformConfig7};c.isSetOpusUsedtx=function(){return this.$ZenonSdpTransformConfig8};c.isSetOpusUseinbandfec=function(){return this.$ZenonSdpTransformConfig9};c.getSetOpusMaxplaybackrate=function(){return this.$ZenonSdpTransformConfig10};c.getSetOpusMaxaveragebitrate=function(){return this.$ZenonSdpTransformConfig11};return b}(a);var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonPeerConnectionConfig1=c.getBool(302),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonPeerConnectionConfig1=this.getBool(302)};c.isRtpDataChannels=function(){return this.$ZenonPeerConnectionConfig1};return a}(a),h=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonStartCallImmediatelyConfig1=c.getBool(308),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonStartCallImmediatelyConfig1=this.getBool(308)};c.isEnabled=function(){return this.$ZenonStartCallImmediatelyConfig1};return a}(a),i=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonGeneralizedIdentityConfig1=c.getInt(1891),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonGeneralizedIdentityConfig1=this.getInt(1891)};c.getDuplicatedParticipantsProcessingMode=function(){return this.$ZenonGeneralizedIdentityConfig1};return a}(a),j=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonMultiCallSupportConfig1=c.getInt(309),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonMultiCallSupportConfig1=this.getInt(309)};c.getMaxConnectedCalls=function(){return this.$ZenonMultiCallSupportConfig1};return a}(a),k=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonPlatformSupportConfig1=c.getBool(316),c.$ZenonPlatformSupportConfig2=c.getBool(318),c.$ZenonPlatformSupportConfig3=c.getBool(2251),c.$ZenonPlatformSupportConfig4=c.getBool(1900),c.$ZenonPlatformSupportConfig5=c.getInt(317),c.$ZenonPlatformSupportConfig6=c.getInt(319),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonPlatformSupportConfig1=this.getBool(316),this.$ZenonPlatformSupportConfig2=this.getBool(318),this.$ZenonPlatformSupportConfig3=this.getBool(2251),this.$ZenonPlatformSupportConfig4=this.getBool(1900),this.$ZenonPlatformSupportConfig5=this.getInt(317),this.$ZenonPlatformSupportConfig6=this.getInt(319)};c.isSupportsZenonPlatform=function(){return this.$ZenonPlatformSupportConfig1};c.isStartImmediatelyEnabled=function(){return this.$ZenonPlatformSupportConfig2};c.isUploadSummaryOnCallEnded=function(){return this.$ZenonPlatformSupportConfig3};c.isMultiwayAvEscalationEnabled=function(){return this.$ZenonPlatformSupportConfig4};c.getMaxConnectedCalls=function(){return this.$ZenonPlatformSupportConfig5};c.getParentWindowConnectionTimeoutMs=function(){return this.$ZenonPlatformSupportConfig6};return a}(a),l=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$ZenonSimulcastConfig1=c.getBool(453),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$ZenonSimulcastConfig1=this.getBool(453)};c.isSimulcastEnabled=function(){return this.$ZenonSimulcastConfig1};return a}(a),m=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.$DynamicRuleConfig1=c.getBool(1342),c.$DynamicRuleConfig2=c.getBool(1597),c.$DynamicRuleConfig3=c.getInt(1359),c.$DynamicRuleConfig4=c.getInt(1510),c.$DynamicRuleConfig5=c.getInt(1612),a)||babelHelpers.assertThisInitialized(c)}var c=a.prototype;c.updateParams=function(){this.$DynamicRuleConfig1=this.getBool(1342),this.$DynamicRuleConfig2=this.getBool(1597),this.$DynamicRuleConfig3=this.getInt(1359),this.$DynamicRuleConfig4=this.getInt(1510),this.$DynamicRuleConfig5=this.getInt(1612)};c.isEnabled=function(){return this.$DynamicRuleConfig1};c.isDebugLoggingEnabled=function(){return this.$DynamicRuleConfig2};c.getProcessIntervalMs=function(){return this.$DynamicRuleConfig3};c.getNetworkProcessIntervalMs=function(){return this.$DynamicRuleConfig4};c.getDebugLoggingIntervalMs=function(){return this.$DynamicRuleConfig5};return a}(a);a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$SignalingPingConfig1=c.getInt(1470),b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateParams=function(){this.$SignalingPingConfig1=this.getInt(1470)};c.getPingIntervalMs=function(){return this.$SignalingPingConfig1};return b}(a);e.exports={ExampleConfig:c,SimulcastOverSignalingConfig:d,PreferredCaptureConfig:f,ZenonSdpTransformConfig:b,ZenonPeerConnectionConfig:g,ZenonStartCallImmediatelyConfig:h,ZenonGeneralizedIdentityConfig:i,ZenonMultiCallSupportConfig:j,ZenonPlatformSupportConfig:k,ZenonSimulcastConfig:l,DynamicRuleConfig:m,SignalingPingConfig:a}}),null);
__d("E2eeMetricsSerializers",["ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){return{}}function j(){return{}}function a(){return{p2p_e2ee:i(),group_e2ee:j()}}function k(a,b){b.writeStructBegin("P2pE2eeMetrics");a.engine_type!=null&&(b.writeFieldBegin({fname:"engine_type",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(BigInt(a.engine_type)),b.writeFieldEnd());a.status!=null&&(b.writeFieldBegin({fname:"status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.status)),b.writeFieldEnd());a.version!=null&&(b.writeFieldBegin({fname:"version",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(BigInt(a.version)),b.writeFieldEnd());a.gen_prekey_bundle_time_ms!=null&&(b.writeFieldBegin({fname:"gen_prekey_bundle_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:4}),b.writeI64(BigInt(a.gen_prekey_bundle_time_ms)),b.writeFieldEnd());a.encrypted_msg_time_ms!=null&&(b.writeFieldBegin({fname:"encrypted_msg_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:5}),b.writeI64(BigInt(a.encrypted_msg_time_ms)),b.writeFieldEnd());a.decrypted_msg_time_ms!=null&&(b.writeFieldBegin({fname:"decrypted_msg_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:6}),b.writeI64(BigInt(a.decrypted_msg_time_ms)),b.writeFieldEnd());a.process_sdp_crypto_time_ms!=null&&(b.writeFieldBegin({fname:"process_sdp_crypto_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:7}),b.writeI64(BigInt(a.process_sdp_crypto_time_ms)),b.writeFieldEnd());a.create_crypto_offer_time_ms!=null&&(b.writeFieldBegin({fname:"create_crypto_offer_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:8}),b.writeI64(BigInt(a.create_crypto_offer_time_ms)),b.writeFieldEnd());a.create_crypto_answer_time_ms!=null&&(b.writeFieldBegin({fname:"create_crypto_answer_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:9}),b.writeI64(BigInt(a.create_crypto_answer_time_ms)),b.writeFieldEnd());a.get_ik_time_ms!=null&&(b.writeFieldBegin({fname:"get_ik_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:10}),b.writeI64(BigInt(a.get_ik_time_ms)),b.writeFieldEnd());a.peer_id!=null&&(b.writeFieldBegin({fname:"peer_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:11}),b.writeI64(BigInt(a.peer_id)),b.writeFieldEnd());a.peer_connection_index!=null&&(b.writeFieldBegin({fname:"peer_connection_index",ftype:(h||(h=c("ThriftTypes"))).I64,fid:12}),b.writeI64(BigInt(a.peer_connection_index)),b.writeFieldEnd());a.srtp_crypto_suite!=null&&(b.writeFieldBegin({fname:"srtp_crypto_suite",ftype:(h||(h=c("ThriftTypes"))).I64,fid:13}),b.writeI64(BigInt(a.srtp_crypto_suite)),b.writeFieldEnd());a.engine_error!=null&&(b.writeFieldBegin({fname:"engine_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:14}),b.writeI64(BigInt(a.engine_error)),b.writeFieldEnd());a.libsignal_error!=null&&(b.writeFieldBegin({fname:"libsignal_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:15}),b.writeI64(BigInt(a.libsignal_error)),b.writeFieldEnd());a.identity_key_mode!=null&&(b.writeFieldBegin({fname:"identity_key_mode",ftype:(h||(h=c("ThriftTypes"))).I64,fid:16}),b.writeI64(BigInt(a.identity_key_mode)),b.writeFieldEnd());a.identity_key_num_persistent!=null&&(b.writeFieldBegin({fname:"identity_key_num_persistent",ftype:(h||(h=c("ThriftTypes"))).I64,fid:17}),b.writeI64(BigInt(a.identity_key_num_persistent)),b.writeFieldEnd());a.identity_key_num_validated!=null&&(b.writeFieldBegin({fname:"identity_key_num_validated",ftype:(h||(h=c("ThriftTypes"))).I64,fid:18}),b.writeI64(BigInt(a.identity_key_num_validated)),b.writeFieldEnd());a.identity_key_num_saved!=null&&(b.writeFieldBegin({fname:"identity_key_num_saved",ftype:(h||(h=c("ThriftTypes"))).I64,fid:19}),b.writeI64(BigInt(a.identity_key_num_saved)),b.writeFieldEnd());a.identity_key_num_existing!=null&&(b.writeFieldBegin({fname:"identity_key_num_existing",ftype:(h||(h=c("ThriftTypes"))).I64,fid:20}),b.writeI64(BigInt(a.identity_key_num_existing)),b.writeFieldEnd());a.is_e2ee_mandated!=null&&(b.writeFieldBegin({fname:"is_e2ee_mandated",ftype:(h||(h=c("ThriftTypes"))).I64,fid:21}),b.writeI64(BigInt(a.is_e2ee_mandated)),b.writeFieldEnd());a.local_trace_id!=null&&(b.writeFieldBegin({fname:"local_trace_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:22}),b.writeI64(BigInt(a.local_trace_id)),b.writeFieldEnd());a.remote_trace_id!=null&&(b.writeFieldBegin({fname:"remote_trace_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:23}),b.writeI64(BigInt(a.remote_trace_id)),b.writeFieldEnd());a.local_device_id!=null&&(b.writeFieldBegin({fname:"local_device_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:24}),b.writeI64(BigInt(a.local_device_id)),b.writeFieldEnd());a.remote_device_id!=null&&(b.writeFieldBegin({fname:"remote_device_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:25}),b.writeI64(BigInt(a.remote_device_id)),b.writeFieldEnd());if(a.events!=null){b.writeFieldBegin({fname:"events",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:26});b.writeListBegin({etype:h.I64,size:a.events.length});for(var d=a.events,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b.writeI64(BigInt(g))}b.writeListEnd();b.writeFieldEnd()}a.gen_dtls_auth_info_status!=null&&(b.writeFieldBegin({fname:"gen_dtls_auth_info_status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:27}),b.writeI64(BigInt(a.gen_dtls_auth_info_status)),b.writeFieldEnd());a.gen_dtls_auth_info_libsignal_status!=null&&(b.writeFieldBegin({fname:"gen_dtls_auth_info_libsignal_status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:28}),b.writeI64(BigInt(a.gen_dtls_auth_info_libsignal_status)),b.writeFieldEnd());a.gen_dtls_auth_info_time_ms!=null&&(b.writeFieldBegin({fname:"gen_dtls_auth_info_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:29}),b.writeI64(BigInt(a.gen_dtls_auth_info_time_ms)),b.writeFieldEnd());a.verify_dtls_auth_info_status!=null&&(b.writeFieldBegin({fname:"verify_dtls_auth_info_status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:30}),b.writeI64(BigInt(a.verify_dtls_auth_info_status)),b.writeFieldEnd());a.verify_dtls_auth_info_libsignal_status!=null&&(b.writeFieldBegin({fname:"verify_dtls_auth_info_libsignal_status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:31}),b.writeI64(BigInt(a.verify_dtls_auth_info_libsignal_status)),b.writeFieldEnd());a.verify_dtls_auth_info_time_ms!=null&&(b.writeFieldBegin({fname:"verify_dtls_auth_info_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:32}),b.writeI64(BigInt(a.verify_dtls_auth_info_time_ms)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function l(a,b){b.writeStructBegin("GroupE2eeMetrics");a.received_key_message_counter!=null&&(b.writeFieldBegin({fname:"received_key_message_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(BigInt(a.received_key_message_counter)),b.writeFieldEnd());a.sent_key_message_counter!=null&&(b.writeFieldBegin({fname:"sent_key_message_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.sent_key_message_counter)),b.writeFieldEnd());a.cached_key_message_counter!=null&&(b.writeFieldBegin({fname:"cached_key_message_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(BigInt(a.cached_key_message_counter)),b.writeFieldEnd());a.used_cached_key_counter!=null&&(b.writeFieldBegin({fname:"used_cached_key_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:4}),b.writeI64(BigInt(a.used_cached_key_counter)),b.writeFieldEnd());a.unused_smu_counter!=null&&(b.writeFieldBegin({fname:"unused_smu_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:5}),b.writeI64(BigInt(a.unused_smu_counter)),b.writeFieldEnd());a.missing_key_message_counter!=null&&(b.writeFieldBegin({fname:"missing_key_message_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:6}),b.writeI64(BigInt(a.missing_key_message_counter)),b.writeFieldEnd());a.negotiate_off_status!=null&&(b.writeFieldBegin({fname:"negotiate_off_status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:7}),b.writeI64(BigInt(a.negotiate_off_status)),b.writeFieldEnd());a.cipher_suite_status!=null&&(b.writeFieldBegin({fname:"cipher_suite_status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:8}),b.writeI64(BigInt(a.cipher_suite_status)),b.writeFieldEnd());a.decrypt_used_cached_session_counter!=null&&(b.writeFieldBegin({fname:"decrypt_used_cached_session_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:9}),b.writeI64(BigInt(a.decrypt_used_cached_session_counter)),b.writeFieldEnd());a.encrypt_used_cached_session_counter!=null&&(b.writeFieldBegin({fname:"encrypt_used_cached_session_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:10}),b.writeI64(BigInt(a.encrypt_used_cached_session_counter)),b.writeFieldEnd());a.sent_ack_message_counter!=null&&(b.writeFieldBegin({fname:"sent_ack_message_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:11}),b.writeI64(BigInt(a.sent_ack_message_counter)),b.writeFieldEnd());a.reuse_ackd_uid_counter!=null&&(b.writeFieldBegin({fname:"reuse_ackd_uid_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:12}),b.writeI64(BigInt(a.reuse_ackd_uid_counter)),b.writeFieldEnd());a.total_uids_created_counter!=null&&(b.writeFieldBegin({fname:"total_uids_created_counter",ftype:(h||(h=c("ThriftTypes"))).I64,fid:13}),b.writeI64(BigInt(a.total_uids_created_counter)),b.writeFieldEnd());a.generate_chain_key_failed_error!=null&&(b.writeFieldBegin({fname:"generate_chain_key_failed_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:14}),b.writeI64(BigInt(a.generate_chain_key_failed_error)),b.writeFieldEnd());a.set_chain_key_failed_error!=null&&(b.writeFieldBegin({fname:"set_chain_key_failed_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:15}),b.writeI64(BigInt(a.set_chain_key_failed_error)),b.writeFieldEnd());a.key_provider_not_found_error!=null&&(b.writeFieldBegin({fname:"key_provider_not_found_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:16}),b.writeI64(BigInt(a.key_provider_not_found_error)),b.writeFieldEnd());a.key_message_parse_failed_error!=null&&(b.writeFieldBegin({fname:"key_message_parse_failed_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:17}),b.writeI64(BigInt(a.key_message_parse_failed_error)),b.writeFieldEnd());a.empty_pkb_result_error!=null&&(b.writeFieldBegin({fname:"empty_pkb_result_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:18}),b.writeI64(BigInt(a.empty_pkb_result_error)),b.writeFieldEnd());a.empty_encrypt_result_error!=null&&(b.writeFieldBegin({fname:"empty_encrypt_result_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:19}),b.writeI64(BigInt(a.empty_encrypt_result_error)),b.writeFieldEnd());a.empty_decrypt_result_error!=null&&(b.writeFieldBegin({fname:"empty_decrypt_result_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:20}),b.writeI64(BigInt(a.empty_decrypt_result_error)),b.writeFieldEnd());a.empty_version_error!=null&&(b.writeFieldBegin({fname:"empty_version_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:21}),b.writeI64(BigInt(a.empty_version_error)),b.writeFieldEnd());a.unsupported_version_error!=null&&(b.writeFieldBegin({fname:"unsupported_version_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:22}),b.writeI64(BigInt(a.unsupported_version_error)),b.writeFieldEnd());a.midcall_version_change_error!=null&&(b.writeFieldBegin({fname:"midcall_version_change_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:23}),b.writeI64(BigInt(a.midcall_version_change_error)),b.writeFieldEnd());a.inconsistent_remote_maps_error!=null&&(b.writeFieldBegin({fname:"inconsistent_remote_maps_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:24}),b.writeI64(BigInt(a.inconsistent_remote_maps_error)),b.writeFieldEnd());a.key_message_pkb_mismatch_error!=null&&(b.writeFieldBegin({fname:"key_message_pkb_mismatch_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:25}),b.writeI64(BigInt(a.key_message_pkb_mismatch_error)),b.writeFieldEnd());a.no_key_or_ack_in_e2ee_message_error!=null&&(b.writeFieldBegin({fname:"no_key_or_ack_in_e2ee_message_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:26}),b.writeI64(BigInt(a.no_key_or_ack_in_e2ee_message_error)),b.writeFieldEnd());a.receiver_key_provider_not_found_error!=null&&(b.writeFieldBegin({fname:"receiver_key_provider_not_found_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:27}),b.writeI64(BigInt(a.receiver_key_provider_not_found_error)),b.writeFieldEnd());a.pkb_parse_failed_error!=null&&(b.writeFieldBegin({fname:"pkb_parse_failed_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:28}),b.writeI64(BigInt(a.pkb_parse_failed_error)),b.writeFieldEnd());a.message_deserialized_failed_error!=null&&(b.writeFieldBegin({fname:"message_deserialized_failed_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:29}),b.writeI64(BigInt(a.message_deserialized_failed_error)),b.writeFieldEnd());a.decrypt_no_identity_key_and_cached_session_not_used_error!=null&&(b.writeFieldBegin({fname:"decrypt_no_identity_key_and_cached_session_not_used_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:30}),b.writeI64(BigInt(a.decrypt_no_identity_key_and_cached_session_not_used_error)),b.writeFieldEnd());a.encrypt_no_identity_key_and_cached_session_not_used_error!=null&&(b.writeFieldBegin({fname:"encrypt_no_identity_key_and_cached_session_not_used_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:31}),b.writeI64(BigInt(a.encrypt_no_identity_key_and_cached_session_not_used_error)),b.writeFieldEnd());a.decrypt_ack_wrong_message_error!=null&&(b.writeFieldBegin({fname:"decrypt_ack_wrong_message_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:32}),b.writeI64(BigInt(a.decrypt_ack_wrong_message_error)),b.writeFieldEnd());a.invalid_uid_received_error!=null&&(b.writeFieldBegin({fname:"invalid_uid_received_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:33}),b.writeI64(BigInt(a.invalid_uid_received_error)),b.writeFieldEnd());a.ack_for_absent_user!=null&&(b.writeFieldBegin({fname:"ack_for_absent_user",ftype:(h||(h=c("ThriftTypes"))).I64,fid:34}),b.writeI64(BigInt(a.ack_for_absent_user)),b.writeFieldEnd());a.uid_not_awaiting_ack_error!=null&&(b.writeFieldBegin({fname:"uid_not_awaiting_ack_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:35}),b.writeI64(BigInt(a.uid_not_awaiting_ack_error)),b.writeFieldEnd());a.decrypt_ack_error!=null&&(b.writeFieldBegin({fname:"decrypt_ack_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:36}),b.writeI64(BigInt(a.decrypt_ack_error)),b.writeFieldEnd());a.empty_decrypt_result_ack_error!=null&&(b.writeFieldBegin({fname:"empty_decrypt_result_ack_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:37}),b.writeI64(BigInt(a.empty_decrypt_result_ack_error)),b.writeFieldEnd());a.decrypt_ack_cached_session_not_used_error!=null&&(b.writeFieldBegin({fname:"decrypt_ack_cached_session_not_used_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:38}),b.writeI64(BigInt(a.decrypt_ack_cached_session_not_used_error)),b.writeFieldEnd());a.encrypt_ack_error!=null&&(b.writeFieldBegin({fname:"encrypt_ack_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:39}),b.writeI64(BigInt(a.encrypt_ack_error)),b.writeFieldEnd());a.empty_encrypt_result_ack_error!=null&&(b.writeFieldBegin({fname:"empty_encrypt_result_ack_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:40}),b.writeI64(BigInt(a.empty_encrypt_result_ack_error)),b.writeFieldEnd());a.invalid_message_type_error!=null&&(b.writeFieldBegin({fname:"invalid_message_type_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:41}),b.writeI64(BigInt(a.invalid_message_type_error)),b.writeFieldEnd());a.server_state_deserialized_failed_error!=null&&(b.writeFieldBegin({fname:"server_state_deserialized_failed_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:42}),b.writeI64(BigInt(a.server_state_deserialized_failed_error)),b.writeFieldEnd());a.crypto_engine_failure_error!=null&&(b.writeFieldBegin({fname:"crypto_engine_failure_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:43}),b.writeI64(BigInt(a.crypto_engine_failure_error)),b.writeFieldEnd());a.empty_e2ee_client_state_error!=null&&(b.writeFieldBegin({fname:"empty_e2ee_client_state_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:44}),b.writeI64(BigInt(a.empty_e2ee_client_state_error)),b.writeFieldEnd());a.group_e2ee_negotiated!=null&&(b.writeFieldBegin({fname:"group_e2ee_negotiated",ftype:(h||(h=c("ThriftTypes"))).I64,fid:45}),b.writeI64(BigInt(a.group_e2ee_negotiated)),b.writeFieldEnd());a.negotiation_mode_kn!=null&&(b.writeFieldBegin({fname:"negotiation_mode_kn",ftype:(h||(h=c("ThriftTypes"))).I64,fid:46}),b.writeI64(BigInt(a.negotiation_mode_kn)),b.writeFieldEnd());a.group_e2ee_setup_status!=null&&(b.writeFieldBegin({fname:"group_e2ee_setup_status",ftype:(h||(h=c("ThriftTypes"))).I64,fid:47}),b.writeI64(BigInt(a.group_e2ee_setup_status)),b.writeFieldEnd());a.enable_group_e2ee!=null&&(b.writeFieldBegin({fname:"enable_group_e2ee",ftype:(h||(h=c("ThriftTypes"))).I64,fid:48}),b.writeI64(BigInt(a.enable_group_e2ee)),b.writeFieldEnd());a.identity_key_mode_group!=null&&(b.writeFieldBegin({fname:"identity_key_mode_group",ftype:(h||(h=c("ThriftTypes"))).I64,fid:49}),b.writeI64(BigInt(a.identity_key_mode_group)),b.writeFieldEnd());a.identity_key_num_persistent_group!=null&&(b.writeFieldBegin({fname:"identity_key_num_persistent_group",ftype:(h||(h=c("ThriftTypes"))).I64,fid:50}),b.writeI64(BigInt(a.identity_key_num_persistent_group)),b.writeFieldEnd());a.identity_key_num_validated_group!=null&&(b.writeFieldBegin({fname:"identity_key_num_validated_group",ftype:(h||(h=c("ThriftTypes"))).I64,fid:51}),b.writeI64(BigInt(a.identity_key_num_validated_group)),b.writeFieldEnd());a.identity_key_num_saved_group!=null&&(b.writeFieldBegin({fname:"identity_key_num_saved_group",ftype:(h||(h=c("ThriftTypes"))).I64,fid:52}),b.writeI64(BigInt(a.identity_key_num_saved_group)),b.writeFieldEnd());a.identity_key_num_existing_group!=null&&(b.writeFieldBegin({fname:"identity_key_num_existing_group",ftype:(h||(h=c("ThriftTypes"))).I64,fid:53}),b.writeI64(BigInt(a.identity_key_num_existing_group)),b.writeFieldEnd());a.max_key_message_latency_ms!=null&&(b.writeFieldBegin({fname:"max_key_message_latency_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:54}),b.writeI64(BigInt(a.max_key_message_latency_ms)),b.writeFieldEnd());a.max_key_message_latency_ms_joiner!=null&&(b.writeFieldBegin({fname:"max_key_message_latency_ms_joiner",ftype:(h||(h=c("ThriftTypes"))).I64,fid:55}),b.writeI64(BigInt(a.max_key_message_latency_ms_joiner)),b.writeFieldEnd());a.max_smu_to_key_message_latency_ms!=null&&(b.writeFieldBegin({fname:"max_smu_to_key_message_latency_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:56}),b.writeI64(BigInt(a.max_smu_to_key_message_latency_ms)),b.writeFieldEnd());a.process_smu_time_ms!=null&&(b.writeFieldBegin({fname:"process_smu_time_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:57}),b.writeI64(BigInt(a.process_smu_time_ms)),b.writeFieldEnd());a.decryption_total_frames!=null&&(b.writeFieldBegin({fname:"decryption_total_frames",ftype:(h||(h=c("ThriftTypes"))).I64,fid:58}),b.writeI64(BigInt(a.decryption_total_frames)),b.writeFieldEnd());a.decryption_total_error_frames!=null&&(b.writeFieldBegin({fname:"decryption_total_error_frames",ftype:(h||(h=c("ThriftTypes"))).I64,fid:59}),b.writeI64(BigInt(a.decryption_total_error_frames)),b.writeFieldEnd());a.decryption_error_frames_alloc!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_alloc",ftype:(h||(h=c("ThriftTypes"))).I64,fid:60}),b.writeI64(BigInt(a.decryption_error_frames_alloc)),b.writeFieldEnd());a.decryption_error_frames_invalid_params!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_invalid_params",ftype:(h||(h=c("ThriftTypes"))).I64,fid:61}),b.writeI64(BigInt(a.decryption_error_frames_invalid_params)),b.writeFieldEnd());a.decryption_error_frames_cipher!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_cipher",ftype:(h||(h=c("ThriftTypes"))).I64,fid:62}),b.writeI64(BigInt(a.decryption_error_frames_cipher)),b.writeFieldEnd());a.decryption_error_frames_parse!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_parse",ftype:(h||(h=c("ThriftTypes"))).I64,fid:63}),b.writeI64(BigInt(a.decryption_error_frames_parse)),b.writeFieldEnd());a.decryption_error_frames_invalid_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_invalid_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:64}),b.writeI64(BigInt(a.decryption_error_frames_invalid_key)),b.writeFieldEnd());a.decryption_error_frames_missing_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_missing_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:65}),b.writeI64(BigInt(a.decryption_error_frames_missing_key)),b.writeFieldEnd());a.decryption_error_frames_out_of_ratchet_space!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_out_of_ratchet_space",ftype:(h||(h=c("ThriftTypes"))).I64,fid:66}),b.writeI64(BigInt(a.decryption_error_frames_out_of_ratchet_space)),b.writeFieldEnd());a.decryption_error_frames_cipher_auth!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_cipher_auth",ftype:(h||(h=c("ThriftTypes"))).I64,fid:67}),b.writeI64(BigInt(a.decryption_error_frames_cipher_auth)),b.writeFieldEnd());a.decryption_error_frames_frame_too_old!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_frame_too_old",ftype:(h||(h=c("ThriftTypes"))).I64,fid:68}),b.writeI64(BigInt(a.decryption_error_frames_frame_too_old)),b.writeFieldEnd());a.decryption_error_frames_seen_frame!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_seen_frame",ftype:(h||(h=c("ThriftTypes"))).I64,fid:69}),b.writeI64(BigInt(a.decryption_error_frames_seen_frame)),b.writeFieldEnd());a.decryption_error_frames_invalid_frame!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_invalid_frame",ftype:(h||(h=c("ThriftTypes"))).I64,fid:70}),b.writeI64(BigInt(a.decryption_error_frames_invalid_frame)),b.writeFieldEnd());a.decryption_error_frames_setting_invalid_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_setting_invalid_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:71}),b.writeI64(BigInt(a.decryption_error_frames_setting_invalid_key)),b.writeFieldEnd());a.decryption_error_frames_setting_existing_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_setting_existing_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:72}),b.writeI64(BigInt(a.decryption_error_frames_setting_existing_key)),b.writeFieldEnd());a.decryption_error_frames_escape_data!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_escape_data",ftype:(h||(h=c("ThriftTypes"))).I64,fid:73}),b.writeI64(BigInt(a.decryption_error_frames_escape_data)),b.writeFieldEnd());a.decryption_error_frames_deescape_data!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_deescape_data",ftype:(h||(h=c("ThriftTypes"))).I64,fid:74}),b.writeI64(BigInt(a.decryption_error_frames_deescape_data)),b.writeFieldEnd());a.decryption_error_frames_parse_frame_or_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_parse_frame_or_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:75}),b.writeI64(BigInt(a.decryption_error_frames_parse_frame_or_key)),b.writeFieldEnd());a.decryption_error_frames_unknown!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_unknown",ftype:(h||(h=c("ThriftTypes"))).I64,fid:76}),b.writeI64(BigInt(a.decryption_error_frames_unknown)),b.writeFieldEnd());a.decryption_unencrypted_frames!=null&&(b.writeFieldBegin({fname:"decryption_unencrypted_frames",ftype:(h||(h=c("ThriftTypes"))).I64,fid:77}),b.writeI64(BigInt(a.decryption_unencrypted_frames)),b.writeFieldEnd());a.encryption_total_frames!=null&&(b.writeFieldBegin({fname:"encryption_total_frames",ftype:(h||(h=c("ThriftTypes"))).I64,fid:78}),b.writeI64(BigInt(a.encryption_total_frames)),b.writeFieldEnd());a.encryption_error_frames!=null&&(b.writeFieldBegin({fname:"encryption_error_frames",ftype:(h||(h=c("ThriftTypes"))).I64,fid:79}),b.writeI64(BigInt(a.encryption_error_frames)),b.writeFieldEnd());a.encryption_escape_bytes!=null&&(b.writeFieldBegin({fname:"encryption_escape_bytes",ftype:(h||(h=c("ThriftTypes"))).I64,fid:80}),b.writeI64(BigInt(a.encryption_escape_bytes)),b.writeFieldEnd());a.encryption_total_error_frames!=null&&(b.writeFieldBegin({fname:"encryption_total_error_frames",ftype:(h||(h=c("ThriftTypes"))).I64,fid:81}),b.writeI64(BigInt(a.encryption_total_error_frames)),b.writeFieldEnd());a.encryption_error_frames_alloc!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_alloc",ftype:(h||(h=c("ThriftTypes"))).I64,fid:82}),b.writeI64(BigInt(a.encryption_error_frames_alloc)),b.writeFieldEnd());a.encryption_error_frames_invalid_params!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_invalid_params",ftype:(h||(h=c("ThriftTypes"))).I64,fid:83}),b.writeI64(BigInt(a.encryption_error_frames_invalid_params)),b.writeFieldEnd());a.encryption_error_frames_cipher!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_cipher",ftype:(h||(h=c("ThriftTypes"))).I64,fid:84}),b.writeI64(BigInt(a.encryption_error_frames_cipher)),b.writeFieldEnd());a.encryption_error_frames_parse!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_parse",ftype:(h||(h=c("ThriftTypes"))).I64,fid:85}),b.writeI64(BigInt(a.encryption_error_frames_parse)),b.writeFieldEnd());a.encryption_error_frames_invalid_key!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_invalid_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:86}),b.writeI64(BigInt(a.encryption_error_frames_invalid_key)),b.writeFieldEnd());a.encryption_error_frames_cipher_auth!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_cipher_auth",ftype:(h||(h=c("ThriftTypes"))).I64,fid:87}),b.writeI64(BigInt(a.encryption_error_frames_cipher_auth)),b.writeFieldEnd());a.encryption_error_frames_escape_data!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_escape_data",ftype:(h||(h=c("ThriftTypes"))).I64,fid:88}),b.writeI64(BigInt(a.encryption_error_frames_escape_data)),b.writeFieldEnd());a.encryption_error_frames_unsupported_codec!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_unsupported_codec",ftype:(h||(h=c("ThriftTypes"))).I64,fid:89}),b.writeI64(BigInt(a.encryption_error_frames_unsupported_codec)),b.writeFieldEnd());a.encryption_error_frames_unknown!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_unknown",ftype:(h||(h=c("ThriftTypes"))).I64,fid:90}),b.writeI64(BigInt(a.encryption_error_frames_unknown)),b.writeFieldEnd());a.decryption_total_frames_data_channel!=null&&(b.writeFieldBegin({fname:"decryption_total_frames_data_channel",ftype:(h||(h=c("ThriftTypes"))).I64,fid:91}),b.writeI64(BigInt(a.decryption_total_frames_data_channel)),b.writeFieldEnd());a.decryption_total_error_frames_data_channel!=null&&(b.writeFieldBegin({fname:"decryption_total_error_frames_data_channel",ftype:(h||(h=c("ThriftTypes"))).I64,fid:92}),b.writeI64(BigInt(a.decryption_total_error_frames_data_channel)),b.writeFieldEnd());a.decryption_error_frames_data_channel_alloc!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_alloc",ftype:(h||(h=c("ThriftTypes"))).I64,fid:93}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_alloc)),b.writeFieldEnd());a.decryption_error_frames_data_channel_invalid_params!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_invalid_params",ftype:(h||(h=c("ThriftTypes"))).I64,fid:94}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_invalid_params)),b.writeFieldEnd());a.decryption_error_frames_data_channel_cipher!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_cipher",ftype:(h||(h=c("ThriftTypes"))).I64,fid:95}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_cipher)),b.writeFieldEnd());a.decryption_error_frames_data_channel_parse!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_parse",ftype:(h||(h=c("ThriftTypes"))).I64,fid:96}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_parse)),b.writeFieldEnd());a.decryption_error_frames_data_channel_invalid_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_invalid_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:97}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_invalid_key)),b.writeFieldEnd());a.decryption_error_frames_data_channel_missing_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_missing_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:98}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_missing_key)),b.writeFieldEnd());a.decryption_error_frames_data_channel_out_of_ratchet_space!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_out_of_ratchet_space",ftype:(h||(h=c("ThriftTypes"))).I64,fid:99}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_out_of_ratchet_space)),b.writeFieldEnd());a.decryption_error_frames_data_channel_cipher_auth!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_cipher_auth",ftype:(h||(h=c("ThriftTypes"))).I64,fid:100}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_cipher_auth)),b.writeFieldEnd());a.decryption_error_frames_data_channel_frame_too_old!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_frame_too_old",ftype:(h||(h=c("ThriftTypes"))).I64,fid:101}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_frame_too_old)),b.writeFieldEnd());a.decryption_error_frames_data_channel_seen_frame!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_seen_frame",ftype:(h||(h=c("ThriftTypes"))).I64,fid:102}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_seen_frame)),b.writeFieldEnd());a.decryption_error_frames_data_channel_invalid_frame!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_invalid_frame",ftype:(h||(h=c("ThriftTypes"))).I64,fid:103}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_invalid_frame)),b.writeFieldEnd());a.decryption_error_frames_data_channel_setting_invalid_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_setting_invalid_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:104}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_setting_invalid_key)),b.writeFieldEnd());a.decryption_error_frames_data_channel_setting_existing_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_setting_existing_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:105}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_setting_existing_key)),b.writeFieldEnd());a.decryption_error_frames_data_channel_escape_data!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_escape_data",ftype:(h||(h=c("ThriftTypes"))).I64,fid:106}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_escape_data)),b.writeFieldEnd());a.decryption_error_frames_data_channel_deescape_data!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_deescape_data",ftype:(h||(h=c("ThriftTypes"))).I64,fid:107}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_deescape_data)),b.writeFieldEnd());a.decryption_error_frames_data_channel_parse_frame_or_key!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_parse_frame_or_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:108}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_parse_frame_or_key)),b.writeFieldEnd());a.decryption_error_frames_data_channel_unknown!=null&&(b.writeFieldBegin({fname:"decryption_error_frames_data_channel_unknown",ftype:(h||(h=c("ThriftTypes"))).I64,fid:109}),b.writeI64(BigInt(a.decryption_error_frames_data_channel_unknown)),b.writeFieldEnd());a.decryption_unencrypted_frames_data_channel!=null&&(b.writeFieldBegin({fname:"decryption_unencrypted_frames_data_channel",ftype:(h||(h=c("ThriftTypes"))).I64,fid:110}),b.writeI64(BigInt(a.decryption_unencrypted_frames_data_channel)),b.writeFieldEnd());a.encryption_total_frames_data_channel!=null&&(b.writeFieldBegin({fname:"encryption_total_frames_data_channel",ftype:(h||(h=c("ThriftTypes"))).I64,fid:111}),b.writeI64(BigInt(a.encryption_total_frames_data_channel)),b.writeFieldEnd());a.encryption_error_frames_data_channel!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel",ftype:(h||(h=c("ThriftTypes"))).I64,fid:112}),b.writeI64(BigInt(a.encryption_error_frames_data_channel)),b.writeFieldEnd());a.encryption_total_error_frames_data_channel!=null&&(b.writeFieldBegin({fname:"encryption_total_error_frames_data_channel",ftype:(h||(h=c("ThriftTypes"))).I64,fid:113}),b.writeI64(BigInt(a.encryption_total_error_frames_data_channel)),b.writeFieldEnd());a.encryption_error_frames_data_channel_alloc!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_alloc",ftype:(h||(h=c("ThriftTypes"))).I64,fid:114}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_alloc)),b.writeFieldEnd());a.encryption_error_frames_data_channel_invalid_params!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_invalid_params",ftype:(h||(h=c("ThriftTypes"))).I64,fid:115}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_invalid_params)),b.writeFieldEnd());a.encryption_error_frames_data_channel_cipher!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_cipher",ftype:(h||(h=c("ThriftTypes"))).I64,fid:116}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_cipher)),b.writeFieldEnd());a.encryption_error_frames_data_channel_parse!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_parse",ftype:(h||(h=c("ThriftTypes"))).I64,fid:117}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_parse)),b.writeFieldEnd());a.encryption_error_frames_data_channel_invalid_key!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_invalid_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:118}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_invalid_key)),b.writeFieldEnd());a.encryption_error_frames_data_channel_cipher_auth!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_cipher_auth",ftype:(h||(h=c("ThriftTypes"))).I64,fid:119}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_cipher_auth)),b.writeFieldEnd());a.encryption_error_frames_data_channel_escape_data!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_escape_data",ftype:(h||(h=c("ThriftTypes"))).I64,fid:120}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_escape_data)),b.writeFieldEnd());a.encryption_error_frames_data_channel_unsupported_codec!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_unsupported_codec",ftype:(h||(h=c("ThriftTypes"))).I64,fid:121}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_unsupported_codec)),b.writeFieldEnd());a.encryption_error_frames_data_channel_unknown!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_data_channel_unknown",ftype:(h||(h=c("ThriftTypes"))).I64,fid:122}),b.writeI64(BigInt(a.encryption_error_frames_data_channel_unknown)),b.writeFieldEnd());a.num_removed_data_decryptors!=null&&(b.writeFieldBegin({fname:"num_removed_data_decryptors",ftype:(h||(h=c("ThriftTypes"))).I64,fid:123}),b.writeI64(BigInt(a.num_removed_data_decryptors)),b.writeFieldEnd());a.num_frame_decryptor_with_unencrypted_data!=null&&(b.writeFieldBegin({fname:"num_frame_decryptor_with_unencrypted_data",ftype:(h||(h=c("ThriftTypes"))).I64,fid:124}),b.writeI64(BigInt(a.num_frame_decryptor_with_unencrypted_data)),b.writeFieldEnd());a.num_removed_decryptors!=null&&(b.writeFieldBegin({fname:"num_removed_decryptors",ftype:(h||(h=c("ThriftTypes"))).I64,fid:125}),b.writeI64(BigInt(a.num_removed_decryptors)),b.writeFieldEnd());a.data_channel_encryption_not_ready_in_mandated_calls_error!=null&&(b.writeFieldBegin({fname:"data_channel_encryption_not_ready_in_mandated_calls_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:126}),b.writeI64(BigInt(a.data_channel_encryption_not_ready_in_mandated_calls_error)),b.writeFieldEnd());a.num_e2ee_message_total_encrypt!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_total_encrypt",ftype:(h||(h=c("ThriftTypes"))).I64,fid:127}),b.writeI64(BigInt(a.num_e2ee_message_total_encrypt)),b.writeFieldEnd());a.num_e2ee_message_error_encrypt!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_error_encrypt",ftype:(h||(h=c("ThriftTypes"))).I64,fid:128}),b.writeI64(BigInt(a.num_e2ee_message_error_encrypt)),b.writeFieldEnd());a.num_e2ee_message_total_decrypt!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_total_decrypt",ftype:(h||(h=c("ThriftTypes"))).I64,fid:129}),b.writeI64(BigInt(a.num_e2ee_message_total_decrypt)),b.writeFieldEnd());a.num_e2ee_message_error_decrypt!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_error_decrypt",ftype:(h||(h=c("ThriftTypes"))).I64,fid:130}),b.writeI64(BigInt(a.num_e2ee_message_error_decrypt)),b.writeFieldEnd());a.negotiate_off_time!=null&&(b.writeFieldBegin({fname:"negotiate_off_time",ftype:(h||(h=c("ThriftTypes"))).I64,fid:131}),b.writeI64(BigInt(a.negotiate_off_time)),b.writeFieldEnd());a.negotiated_version!=null&&(b.writeFieldBegin({fname:"negotiated_version",ftype:(h||(h=c("ThriftTypes"))).I64,fid:132}),b.writeI64(BigInt(a.negotiated_version)),b.writeFieldEnd());a.decryptor_removed_time!=null&&(b.writeFieldBegin({fname:"decryptor_removed_time",ftype:(h||(h=c("ThriftTypes"))).I64,fid:133}),b.writeI64(BigInt(a.decryptor_removed_time)),b.writeFieldEnd());a.is_e2ee_mandated_group!=null&&(b.writeFieldBegin({fname:"is_e2ee_mandated_group",ftype:(h||(h=c("ThriftTypes"))).I64,fid:134}),b.writeI64(BigInt(a.is_e2ee_mandated_group)),b.writeFieldEnd());if(a.events!=null){b.writeFieldBegin({fname:"events",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:135});b.writeListBegin({etype:h.I64,size:a.events.length});for(var d=a.events,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b.writeI64(BigInt(g))}b.writeListEnd();b.writeFieldEnd()}a.num_e2ee_message_received!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_received",ftype:(h||(h=c("ThriftTypes"))).I64,fid:136}),b.writeI64(BigInt(a.num_e2ee_message_received)),b.writeFieldEnd());a.num_e2ee_message_error_decrypt_non_e2ee_received!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_error_decrypt_non_e2ee_received",ftype:(h||(h=c("ThriftTypes"))).I64,fid:137}),b.writeI64(BigInt(a.num_e2ee_message_error_decrypt_non_e2ee_received)),b.writeFieldEnd());a.num_e2ee_message_error_decrypt_missing_sender!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_error_decrypt_missing_sender",ftype:(h||(h=c("ThriftTypes"))).I64,fid:138}),b.writeI64(BigInt(a.num_e2ee_message_error_decrypt_missing_sender)),b.writeFieldEnd());a.num_e2ee_message_error_decrypt_exceeding_retry!=null&&(b.writeFieldBegin({fname:"num_e2ee_message_error_decrypt_exceeding_retry",ftype:(h||(h=c("ThriftTypes"))).I64,fid:139}),b.writeI64(BigInt(a.num_e2ee_message_error_decrypt_exceeding_retry)),b.writeFieldEnd());a.max_media_channel_key_message_retry_count!=null&&(b.writeFieldBegin({fname:"max_media_channel_key_message_retry_count",ftype:(h||(h=c("ThriftTypes"))).I64,fid:140}),b.writeI64(BigInt(a.max_media_channel_key_message_retry_count)),b.writeFieldEnd());a.g_e2ee_total_count_of_extra_decryptions!=null&&(b.writeFieldBegin({fname:"g_e2ee_total_count_of_extra_decryptions",ftype:(h||(h=c("ThriftTypes"))).I64,fid:141}),b.writeI64(BigInt(a.g_e2ee_total_count_of_extra_decryptions)),b.writeFieldEnd());a.g_e2ee_total_count_of_extra_decryptions_failures!=null&&(b.writeFieldBegin({fname:"g_e2ee_total_count_of_extra_decryptions_failures",ftype:(h||(h=c("ThriftTypes"))).I64,fid:142}),b.writeI64(BigInt(a.g_e2ee_total_count_of_extra_decryptions_failures)),b.writeFieldEnd());a.g_e2ee_total_count_of_extra_decryptions_failures_due_to_missing_key!=null&&(b.writeFieldBegin({fname:"g_e2ee_total_count_of_extra_decryptions_failures_due_to_missing_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:143}),b.writeI64(BigInt(a.g_e2ee_total_count_of_extra_decryptions_failures_due_to_missing_key)),b.writeFieldEnd());a.g_e2ee_decryption_error_frames_empty_supported_codes!=null&&(b.writeFieldBegin({fname:"g_e2ee_decryption_error_frames_empty_supported_codes",ftype:(h||(h=c("ThriftTypes"))).I64,fid:144}),b.writeI64(BigInt(a.g_e2ee_decryption_error_frames_empty_supported_codes)),b.writeFieldEnd());a.g_e2ee_encryption_error_frames_empty!=null&&(b.writeFieldBegin({fname:"g_e2ee_encryption_error_frames_empty",ftype:(h||(h=c("ThriftTypes"))).I64,fid:146}),b.writeI64(BigInt(a.g_e2ee_encryption_error_frames_empty)),b.writeFieldEnd());a.g_e2ee_encryption_error_frames_empty_nalu_blocks!=null&&(b.writeFieldBegin({fname:"g_e2ee_encryption_error_frames_empty_nalu_blocks",ftype:(h||(h=c("ThriftTypes"))).I64,fid:147}),b.writeI64(BigInt(a.g_e2ee_encryption_error_frames_empty_nalu_blocks)),b.writeFieldEnd());a.g_e2ee_encryption_error_frames_invalid_h264!=null&&(b.writeFieldBegin({fname:"g_e2ee_encryption_error_frames_invalid_h264",ftype:(h||(h=c("ThriftTypes"))).I64,fid:148}),b.writeI64(BigInt(a.g_e2ee_encryption_error_frames_invalid_h264)),b.writeFieldEnd());a.g_e2ee_encryption_error_frames_invalid_h265!=null&&(b.writeFieldBegin({fname:"g_e2ee_encryption_error_frames_invalid_h265",ftype:(h||(h=c("ThriftTypes"))).I64,fid:149}),b.writeI64(BigInt(a.g_e2ee_encryption_error_frames_invalid_h265)),b.writeFieldEnd());a.g_e2ee_encryption_error_frames_invalid_h265_nalu_block!=null&&(b.writeFieldBegin({fname:"g_e2ee_encryption_error_frames_invalid_h265_nalu_block",ftype:(h||(h=c("ThriftTypes"))).I64,fid:150}),b.writeI64(BigInt(a.g_e2ee_encryption_error_frames_invalid_h265_nalu_block)),b.writeFieldEnd());a.g_e2ee_total_count_of_extra_encryptions!=null&&(b.writeFieldBegin({fname:"g_e2ee_total_count_of_extra_encryptions",ftype:(h||(h=c("ThriftTypes"))).I64,fid:151}),b.writeI64(BigInt(a.g_e2ee_total_count_of_extra_encryptions)),b.writeFieldEnd());a.g_e2ee_total_count_of_extra_encryptions_failures!=null&&(b.writeFieldBegin({fname:"g_e2ee_total_count_of_extra_encryptions_failures",ftype:(h||(h=c("ThriftTypes"))).I64,fid:152}),b.writeI64(BigInt(a.g_e2ee_total_count_of_extra_encryptions_failures)),b.writeFieldEnd());a.encryption_error_frames_no_active_key!=null&&(b.writeFieldBegin({fname:"encryption_error_frames_no_active_key",ftype:(h||(h=c("ThriftTypes"))).I64,fid:153}),b.writeI64(BigInt(a.encryption_error_frames_no_active_key)),b.writeFieldEnd());a.key_negotiation_protocol!=null&&(b.writeFieldBegin({fname:"key_negotiation_protocol",ftype:(h||(h=c("ThriftTypes"))).I64,fid:154}),b.writeI64(BigInt(a.key_negotiation_protocol)),b.writeFieldEnd());a.key_messages_received_via_signaling!=null&&(b.writeFieldBegin({fname:"key_messages_received_via_signaling",ftype:(h||(h=c("ThriftTypes"))).I64,fid:155}),b.writeI64(BigInt(a.key_messages_received_via_signaling)),b.writeFieldEnd());a.key_messages_received_via_media!=null&&(b.writeFieldBegin({fname:"key_messages_received_via_media",ftype:(h||(h=c("ThriftTypes"))).I64,fid:156}),b.writeI64(BigInt(a.key_messages_received_via_media)),b.writeFieldEnd());a.key_messages_received_via_signaling_joiner!=null&&(b.writeFieldBegin({fname:"key_messages_received_via_signaling_joiner",ftype:(h||(h=c("ThriftTypes"))).I64,fid:157}),b.writeI64(BigInt(a.key_messages_received_via_signaling_joiner)),b.writeFieldEnd());a.key_messages_received_via_media_joiner!=null&&(b.writeFieldBegin({fname:"key_messages_received_via_media_joiner",ftype:(h||(h=c("ThriftTypes"))).I64,fid:158}),b.writeI64(BigInt(a.key_messages_received_via_media_joiner)),b.writeFieldEnd());a.g_e2ee_participant_hash_verification_failed_error!=null&&(b.writeFieldBegin({fname:"g_e2ee_participant_hash_verification_failed_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:159}),b.writeI64(BigInt(a.g_e2ee_participant_hash_verification_failed_error)),b.writeFieldEnd());a.g_e2ee_invalid_key_distributor_id_error!=null&&(b.writeFieldBegin({fname:"g_e2ee_invalid_key_distributor_id_error",ftype:(h||(h=c("ThriftTypes"))).I64,fid:160}),b.writeI64(BigInt(a.g_e2ee_invalid_key_distributor_id_error)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function b(a,b){b.writeStructBegin("E2eeMetrics");b.writeFieldBegin({fname:"p2p_e2ee",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.p2p_e2ee!=null)k(a.p2p_e2ee,b);else{var d=i();k(d,b)}b.writeFieldEnd();b.writeFieldBegin({fname:"group_e2ee",ftype:h.STRUCT,fid:2});if(a.group_e2ee!=null)l(a.group_e2ee,b);else{d=j();l(d,b)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function m(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.engine_type=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.status=a.readI64().toString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I64?b.version=a.readI64().toString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I64?b.gen_prekey_bundle_time_ms=a.readI64().toString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).I64?b.encrypted_msg_time_ms=a.readI64().toString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).I64?b.decrypted_msg_time_ms=a.readI64().toString():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).I64?b.process_sdp_crypto_time_ms=a.readI64().toString():a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).I64?b.create_crypto_offer_time_ms=a.readI64().toString():a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).I64?b.create_crypto_answer_time_ms=a.readI64().toString():a.skip(e);break;case 10:e===(h||(h=c("ThriftTypes"))).I64?b.get_ik_time_ms=a.readI64().toString():a.skip(e);break;case 11:e===(h||(h=c("ThriftTypes"))).I64?b.peer_id=a.readI64().toString():a.skip(e);break;case 12:e===(h||(h=c("ThriftTypes"))).I64?b.peer_connection_index=a.readI64().toString():a.skip(e);break;case 13:e===(h||(h=c("ThriftTypes"))).I64?b.srtp_crypto_suite=a.readI64().toString():a.skip(e);break;case 14:e===(h||(h=c("ThriftTypes"))).I64?b.engine_error=a.readI64().toString():a.skip(e);break;case 15:e===(h||(h=c("ThriftTypes"))).I64?b.libsignal_error=a.readI64().toString():a.skip(e);break;case 16:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_mode=a.readI64().toString():a.skip(e);break;case 17:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_persistent=a.readI64().toString():a.skip(e);break;case 18:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_validated=a.readI64().toString():a.skip(e);break;case 19:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_saved=a.readI64().toString():a.skip(e);break;case 20:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_existing=a.readI64().toString():a.skip(e);break;case 21:e===(h||(h=c("ThriftTypes"))).I64?b.is_e2ee_mandated=a.readI64().toString():a.skip(e);break;case 22:e===(h||(h=c("ThriftTypes"))).I64?b.local_trace_id=a.readI64().toString():a.skip(e);break;case 23:e===(h||(h=c("ThriftTypes"))).I64?b.remote_trace_id=a.readI64().toString():a.skip(e);break;case 24:e===(h||(h=c("ThriftTypes"))).I64?b.local_device_id=a.readI64().toString():a.skip(e);break;case 25:e===(h||(h=c("ThriftTypes"))).I64?b.remote_device_id=a.readI64().toString():a.skip(e);break;case 26:if(e===(h||(h=c("ThriftTypes"))).LIST){b.events=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString();b.events.push(g)}}else a.skip(e);break;case 27:e===(h||(h=c("ThriftTypes"))).I64?b.gen_dtls_auth_info_status=a.readI64().toString():a.skip(e);break;case 28:e===(h||(h=c("ThriftTypes"))).I64?b.gen_dtls_auth_info_libsignal_status=a.readI64().toString():a.skip(e);break;case 29:e===(h||(h=c("ThriftTypes"))).I64?b.gen_dtls_auth_info_time_ms=a.readI64().toString():a.skip(e);break;case 30:e===(h||(h=c("ThriftTypes"))).I64?b.verify_dtls_auth_info_status=a.readI64().toString():a.skip(e);break;case 31:e===(h||(h=c("ThriftTypes"))).I64?b.verify_dtls_auth_info_libsignal_status=a.readI64().toString():a.skip(e);break;case 32:e===(h||(h=c("ThriftTypes"))).I64?b.verify_dtls_auth_info_time_ms=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function n(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.received_key_message_counter=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.sent_key_message_counter=a.readI64().toString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I64?b.cached_key_message_counter=a.readI64().toString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I64?b.used_cached_key_counter=a.readI64().toString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).I64?b.unused_smu_counter=a.readI64().toString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).I64?b.missing_key_message_counter=a.readI64().toString():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).I64?b.negotiate_off_status=a.readI64().toString():a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).I64?b.cipher_suite_status=a.readI64().toString():a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).I64?b.decrypt_used_cached_session_counter=a.readI64().toString():a.skip(e);break;case 10:e===(h||(h=c("ThriftTypes"))).I64?b.encrypt_used_cached_session_counter=a.readI64().toString():a.skip(e);break;case 11:e===(h||(h=c("ThriftTypes"))).I64?b.sent_ack_message_counter=a.readI64().toString():a.skip(e);break;case 12:e===(h||(h=c("ThriftTypes"))).I64?b.reuse_ackd_uid_counter=a.readI64().toString():a.skip(e);break;case 13:e===(h||(h=c("ThriftTypes"))).I64?b.total_uids_created_counter=a.readI64().toString():a.skip(e);break;case 14:e===(h||(h=c("ThriftTypes"))).I64?b.generate_chain_key_failed_error=a.readI64().toString():a.skip(e);break;case 15:e===(h||(h=c("ThriftTypes"))).I64?b.set_chain_key_failed_error=a.readI64().toString():a.skip(e);break;case 16:e===(h||(h=c("ThriftTypes"))).I64?b.key_provider_not_found_error=a.readI64().toString():a.skip(e);break;case 17:e===(h||(h=c("ThriftTypes"))).I64?b.key_message_parse_failed_error=a.readI64().toString():a.skip(e);break;case 18:e===(h||(h=c("ThriftTypes"))).I64?b.empty_pkb_result_error=a.readI64().toString():a.skip(e);break;case 19:e===(h||(h=c("ThriftTypes"))).I64?b.empty_encrypt_result_error=a.readI64().toString():a.skip(e);break;case 20:e===(h||(h=c("ThriftTypes"))).I64?b.empty_decrypt_result_error=a.readI64().toString():a.skip(e);break;case 21:e===(h||(h=c("ThriftTypes"))).I64?b.empty_version_error=a.readI64().toString():a.skip(e);break;case 22:e===(h||(h=c("ThriftTypes"))).I64?b.unsupported_version_error=a.readI64().toString():a.skip(e);break;case 23:e===(h||(h=c("ThriftTypes"))).I64?b.midcall_version_change_error=a.readI64().toString():a.skip(e);break;case 24:e===(h||(h=c("ThriftTypes"))).I64?b.inconsistent_remote_maps_error=a.readI64().toString():a.skip(e);break;case 25:e===(h||(h=c("ThriftTypes"))).I64?b.key_message_pkb_mismatch_error=a.readI64().toString():a.skip(e);break;case 26:e===(h||(h=c("ThriftTypes"))).I64?b.no_key_or_ack_in_e2ee_message_error=a.readI64().toString():a.skip(e);break;case 27:e===(h||(h=c("ThriftTypes"))).I64?b.receiver_key_provider_not_found_error=a.readI64().toString():a.skip(e);break;case 28:e===(h||(h=c("ThriftTypes"))).I64?b.pkb_parse_failed_error=a.readI64().toString():a.skip(e);break;case 29:e===(h||(h=c("ThriftTypes"))).I64?b.message_deserialized_failed_error=a.readI64().toString():a.skip(e);break;case 30:e===(h||(h=c("ThriftTypes"))).I64?b.decrypt_no_identity_key_and_cached_session_not_used_error=a.readI64().toString():a.skip(e);break;case 31:e===(h||(h=c("ThriftTypes"))).I64?b.encrypt_no_identity_key_and_cached_session_not_used_error=a.readI64().toString():a.skip(e);break;case 32:e===(h||(h=c("ThriftTypes"))).I64?b.decrypt_ack_wrong_message_error=a.readI64().toString():a.skip(e);break;case 33:e===(h||(h=c("ThriftTypes"))).I64?b.invalid_uid_received_error=a.readI64().toString():a.skip(e);break;case 34:e===(h||(h=c("ThriftTypes"))).I64?b.ack_for_absent_user=a.readI64().toString():a.skip(e);break;case 35:e===(h||(h=c("ThriftTypes"))).I64?b.uid_not_awaiting_ack_error=a.readI64().toString():a.skip(e);break;case 36:e===(h||(h=c("ThriftTypes"))).I64?b.decrypt_ack_error=a.readI64().toString():a.skip(e);break;case 37:e===(h||(h=c("ThriftTypes"))).I64?b.empty_decrypt_result_ack_error=a.readI64().toString():a.skip(e);break;case 38:e===(h||(h=c("ThriftTypes"))).I64?b.decrypt_ack_cached_session_not_used_error=a.readI64().toString():a.skip(e);break;case 39:e===(h||(h=c("ThriftTypes"))).I64?b.encrypt_ack_error=a.readI64().toString():a.skip(e);break;case 40:e===(h||(h=c("ThriftTypes"))).I64?b.empty_encrypt_result_ack_error=a.readI64().toString():a.skip(e);break;case 41:e===(h||(h=c("ThriftTypes"))).I64?b.invalid_message_type_error=a.readI64().toString():a.skip(e);break;case 42:e===(h||(h=c("ThriftTypes"))).I64?b.server_state_deserialized_failed_error=a.readI64().toString():a.skip(e);break;case 43:e===(h||(h=c("ThriftTypes"))).I64?b.crypto_engine_failure_error=a.readI64().toString():a.skip(e);break;case 44:e===(h||(h=c("ThriftTypes"))).I64?b.empty_e2ee_client_state_error=a.readI64().toString():a.skip(e);break;case 45:e===(h||(h=c("ThriftTypes"))).I64?b.group_e2ee_negotiated=a.readI64().toString():a.skip(e);break;case 46:e===(h||(h=c("ThriftTypes"))).I64?b.negotiation_mode_kn=a.readI64().toString():a.skip(e);break;case 47:e===(h||(h=c("ThriftTypes"))).I64?b.group_e2ee_setup_status=a.readI64().toString():a.skip(e);break;case 48:e===(h||(h=c("ThriftTypes"))).I64?b.enable_group_e2ee=a.readI64().toString():a.skip(e);break;case 49:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_mode_group=a.readI64().toString():a.skip(e);break;case 50:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_persistent_group=a.readI64().toString():a.skip(e);break;case 51:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_validated_group=a.readI64().toString():a.skip(e);break;case 52:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_saved_group=a.readI64().toString():a.skip(e);break;case 53:e===(h||(h=c("ThriftTypes"))).I64?b.identity_key_num_existing_group=a.readI64().toString():a.skip(e);break;case 54:e===(h||(h=c("ThriftTypes"))).I64?b.max_key_message_latency_ms=a.readI64().toString():a.skip(e);break;case 55:e===(h||(h=c("ThriftTypes"))).I64?b.max_key_message_latency_ms_joiner=a.readI64().toString():a.skip(e);break;case 56:e===(h||(h=c("ThriftTypes"))).I64?b.max_smu_to_key_message_latency_ms=a.readI64().toString():a.skip(e);break;case 57:e===(h||(h=c("ThriftTypes"))).I64?b.process_smu_time_ms=a.readI64().toString():a.skip(e);break;case 58:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_total_frames=a.readI64().toString():a.skip(e);break;case 59:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_total_error_frames=a.readI64().toString():a.skip(e);break;case 60:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_alloc=a.readI64().toString():a.skip(e);break;case 61:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_invalid_params=a.readI64().toString():a.skip(e);break;case 62:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_cipher=a.readI64().toString():a.skip(e);break;case 63:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_parse=a.readI64().toString():a.skip(e);break;case 64:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_invalid_key=a.readI64().toString():a.skip(e);break;case 65:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_missing_key=a.readI64().toString():a.skip(e);break;case 66:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_out_of_ratchet_space=a.readI64().toString():a.skip(e);break;case 67:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_cipher_auth=a.readI64().toString():a.skip(e);break;case 68:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_frame_too_old=a.readI64().toString():a.skip(e);break;case 69:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_seen_frame=a.readI64().toString():a.skip(e);break;case 70:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_invalid_frame=a.readI64().toString():a.skip(e);break;case 71:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_setting_invalid_key=a.readI64().toString():a.skip(e);break;case 72:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_setting_existing_key=a.readI64().toString():a.skip(e);break;case 73:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_escape_data=a.readI64().toString():a.skip(e);break;case 74:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_deescape_data=a.readI64().toString():a.skip(e);break;case 75:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_parse_frame_or_key=a.readI64().toString():a.skip(e);break;case 76:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_unknown=a.readI64().toString():a.skip(e);break;case 77:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_unencrypted_frames=a.readI64().toString():a.skip(e);break;case 78:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_total_frames=a.readI64().toString():a.skip(e);break;case 79:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames=a.readI64().toString():a.skip(e);break;case 80:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_escape_bytes=a.readI64().toString():a.skip(e);break;case 81:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_total_error_frames=a.readI64().toString():a.skip(e);break;case 82:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_alloc=a.readI64().toString():a.skip(e);break;case 83:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_invalid_params=a.readI64().toString():a.skip(e);break;case 84:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_cipher=a.readI64().toString():a.skip(e);break;case 85:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_parse=a.readI64().toString():a.skip(e);break;case 86:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_invalid_key=a.readI64().toString():a.skip(e);break;case 87:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_cipher_auth=a.readI64().toString():a.skip(e);break;case 88:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_escape_data=a.readI64().toString():a.skip(e);break;case 89:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_unsupported_codec=a.readI64().toString():a.skip(e);break;case 90:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_unknown=a.readI64().toString():a.skip(e);break;case 91:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_total_frames_data_channel=a.readI64().toString():a.skip(e);break;case 92:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_total_error_frames_data_channel=a.readI64().toString():a.skip(e);break;case 93:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_alloc=a.readI64().toString():a.skip(e);break;case 94:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_invalid_params=a.readI64().toString():a.skip(e);break;case 95:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_cipher=a.readI64().toString():a.skip(e);break;case 96:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_parse=a.readI64().toString():a.skip(e);break;case 97:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_invalid_key=a.readI64().toString():a.skip(e);break;case 98:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_missing_key=a.readI64().toString():a.skip(e);break;case 99:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_out_of_ratchet_space=a.readI64().toString():a.skip(e);break;case 100:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_cipher_auth=a.readI64().toString():a.skip(e);break;case 101:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_frame_too_old=a.readI64().toString():a.skip(e);break;case 102:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_seen_frame=a.readI64().toString():a.skip(e);break;case 103:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_invalid_frame=a.readI64().toString():a.skip(e);break;case 104:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_setting_invalid_key=a.readI64().toString():a.skip(e);break;case 105:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_setting_existing_key=a.readI64().toString():a.skip(e);break;case 106:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_escape_data=a.readI64().toString():a.skip(e);break;case 107:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_deescape_data=a.readI64().toString():a.skip(e);break;case 108:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_parse_frame_or_key=a.readI64().toString():a.skip(e);break;case 109:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_error_frames_data_channel_unknown=a.readI64().toString():a.skip(e);break;case 110:e===(h||(h=c("ThriftTypes"))).I64?b.decryption_unencrypted_frames_data_channel=a.readI64().toString():a.skip(e);break;case 111:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_total_frames_data_channel=a.readI64().toString():a.skip(e);break;case 112:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel=a.readI64().toString():a.skip(e);break;case 113:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_total_error_frames_data_channel=a.readI64().toString():a.skip(e);break;case 114:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_alloc=a.readI64().toString():a.skip(e);break;case 115:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_invalid_params=a.readI64().toString():a.skip(e);break;case 116:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_cipher=a.readI64().toString():a.skip(e);break;case 117:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_parse=a.readI64().toString():a.skip(e);break;case 118:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_invalid_key=a.readI64().toString():a.skip(e);break;case 119:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_cipher_auth=a.readI64().toString():a.skip(e);break;case 120:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_escape_data=a.readI64().toString():a.skip(e);break;case 121:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_unsupported_codec=a.readI64().toString():a.skip(e);break;case 122:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_data_channel_unknown=a.readI64().toString():a.skip(e);break;case 123:e===(h||(h=c("ThriftTypes"))).I64?b.num_removed_data_decryptors=a.readI64().toString():a.skip(e);break;case 124:e===(h||(h=c("ThriftTypes"))).I64?b.num_frame_decryptor_with_unencrypted_data=a.readI64().toString():a.skip(e);break;case 125:e===(h||(h=c("ThriftTypes"))).I64?b.num_removed_decryptors=a.readI64().toString():a.skip(e);break;case 126:e===(h||(h=c("ThriftTypes"))).I64?b.data_channel_encryption_not_ready_in_mandated_calls_error=a.readI64().toString():a.skip(e);break;case 127:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_total_encrypt=a.readI64().toString():a.skip(e);break;case 128:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_error_encrypt=a.readI64().toString():a.skip(e);break;case 129:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_total_decrypt=a.readI64().toString():a.skip(e);break;case 130:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_error_decrypt=a.readI64().toString():a.skip(e);break;case 131:e===(h||(h=c("ThriftTypes"))).I64?b.negotiate_off_time=a.readI64().toString():a.skip(e);break;case 132:e===(h||(h=c("ThriftTypes"))).I64?b.negotiated_version=a.readI64().toString():a.skip(e);break;case 133:e===(h||(h=c("ThriftTypes"))).I64?b.decryptor_removed_time=a.readI64().toString():a.skip(e);break;case 134:e===(h||(h=c("ThriftTypes"))).I64?b.is_e2ee_mandated_group=a.readI64().toString():a.skip(e);break;case 135:if(e===(h||(h=c("ThriftTypes"))).LIST){b.events=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString();b.events.push(g)}}else a.skip(e);break;case 136:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_received=a.readI64().toString():a.skip(e);break;case 137:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_error_decrypt_non_e2ee_received=a.readI64().toString():a.skip(e);break;case 138:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_error_decrypt_missing_sender=a.readI64().toString():a.skip(e);break;case 139:e===(h||(h=c("ThriftTypes"))).I64?b.num_e2ee_message_error_decrypt_exceeding_retry=a.readI64().toString():a.skip(e);break;case 140:e===(h||(h=c("ThriftTypes"))).I64?b.max_media_channel_key_message_retry_count=a.readI64().toString():a.skip(e);break;case 141:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_total_count_of_extra_decryptions=a.readI64().toString():a.skip(e);break;case 142:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_total_count_of_extra_decryptions_failures=a.readI64().toString():a.skip(e);break;case 143:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_total_count_of_extra_decryptions_failures_due_to_missing_key=a.readI64().toString():a.skip(e);break;case 144:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_decryption_error_frames_empty_supported_codes=a.readI64().toString():a.skip(e);break;case 146:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_encryption_error_frames_empty=a.readI64().toString():a.skip(e);break;case 147:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_encryption_error_frames_empty_nalu_blocks=a.readI64().toString():a.skip(e);break;case 148:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_encryption_error_frames_invalid_h264=a.readI64().toString():a.skip(e);break;case 149:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_encryption_error_frames_invalid_h265=a.readI64().toString():a.skip(e);break;case 150:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_encryption_error_frames_invalid_h265_nalu_block=a.readI64().toString():a.skip(e);break;case 151:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_total_count_of_extra_encryptions=a.readI64().toString():a.skip(e);break;case 152:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_total_count_of_extra_encryptions_failures=a.readI64().toString():a.skip(e);break;case 153:e===(h||(h=c("ThriftTypes"))).I64?b.encryption_error_frames_no_active_key=a.readI64().toString():a.skip(e);break;case 154:e===(h||(h=c("ThriftTypes"))).I64?b.key_negotiation_protocol=a.readI64().toString():a.skip(e);break;case 155:e===(h||(h=c("ThriftTypes"))).I64?b.key_messages_received_via_signaling=a.readI64().toString():a.skip(e);break;case 156:e===(h||(h=c("ThriftTypes"))).I64?b.key_messages_received_via_media=a.readI64().toString():a.skip(e);break;case 157:e===(h||(h=c("ThriftTypes"))).I64?b.key_messages_received_via_signaling_joiner=a.readI64().toString():a.skip(e);break;case 158:e===(h||(h=c("ThriftTypes"))).I64?b.key_messages_received_via_media_joiner=a.readI64().toString():a.skip(e);break;case 159:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_participant_hash_verification_failed_error=a.readI64().toString():a.skip(e);break;case 160:e===(h||(h=c("ThriftTypes"))).I64?b.g_e2ee_invalid_key_distributor_id_error=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function d(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.p2p_e2ee=m(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.group_e2ee=n(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.p2p_e2ee===void 0&&(b.p2p_e2ee=i());b.group_e2ee===void 0&&(b.group_e2ee=j());return b}g.P2pE2eeMetrics$DefaultConstructor=i;g.GroupE2eeMetrics$DefaultConstructor=j;g.E2eeMetrics$DefaultConstructor=a;g.serializeP2pE2eeMetrics=k;g.serializeGroupE2eeMetrics=l;g.serializeE2eeMetrics=b;g.deserializeP2pE2eeMetrics=m;g.deserializeGroupE2eeMetrics=n;g.deserializeE2eeMetrics=d}),98);
__d("HorizonWebMqttChannel",["CurrentUser","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();function h(){var a;d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);return new(c("MqttChannel"))({appId:(a=c("MqttWebConfig")).appID,capabilities:a.capabilities,chatVisibility:!0,clientCapabilities:a.clientCapabilities,endpoint:a.endpoint,initialSubscribedTopics:a.subscribedTopics,pageId:null,phpOverride:a.hostNameOverride,pollingEndpoint:a.pollingEndpoint,userFbid:a.fbid})}var i=null;function a(){i==null&&(i=h());return i}function b(){i!=null&&(i.shutdown(),i=null)}g.getHorizonWebMqttChannelInstance=a;g.shutdownAndClear=b}),98);
__d("RequestStreamBodyUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){return g(atob(a))};b=function(a){return btoa(h(a))};c=function(a){a=btoa(a);var b=a.indexOf("=");return b===-1?a:a.substring(0,b)};var g=function(a){a=a;var b=a.length,c=new Uint8Array(b);for(var d=0;d<b;d++)c[d]=a.charCodeAt(d);return c},h=function(a){var b="",c=a.byteLength;for(var d=0;d<c;d++)b+=String.fromCharCode(a[d]);return b};f.base64ToUint8Array=a;f.uint8ArrayToBase64=b;f.stringToBase64WithoutPadding=c;f.stringToUint8Array=g;f.uint8ArrayToString=h}),66);
__d("ZenonIceStatsParser",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=[];a=a.split("\r\n");a.forEach(function(a){g(a)&&b.push({gen:h(a),type:i(a)})});return b}function g(a){return a.indexOf("candidate:")>-1}function h(a){var b=0;a=a.match(/generation (\d+)/);a&&(b=parseInt(a[1],10));return b}function i(a){a=a.match(/typ (host|relay|srflx|prflx)/);if(a)return a[1];else return"unknown"}f.extractIceInfo=a}),66);
__d("fbwebrtc_ClientStack",[],(function(a,b,c,d,e,f){a=Object.freeze({OLD_CLIENT_PLATFORM_STACK:0,RSYS_X:1,IG_OLD_STACK:2,MLITE_OLD_STACK:3,SCOTCH:4,ZENON:5});f["default"]=a}),66);
__d("multiway_ApprovalStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({DENIED:0,APPROVED:1});f["default"]=a}),66);
__d("multiway_Capability",[],(function(a,b,c,d,e,f){a=Object.freeze({SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4,SUPPORT_MWPP:5,REQUIRE_FULL_SDP_IN_SMU:6,SUPPORT_PRECONNECT:7,SUPPORT_MWPP_DEESCALATION:8,SUPPORT_PARTICIPANT_STATE_UNCALLABLE:9,SUPPORT_MULTIPLE_VIDEO_STREAMS:10,REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED:11,SUPPORT_MULTISTREAM_FEC:12,SUPPORT_DELTA_SMU:13,REQUIRE_DEFAULT_CHANNEL_SCREENSHARE:14,SUPPORT_SCREENSHARE_FLAG_IN_JOIN_RESPONSE_AND_SMU:15,SUPPORT_TEMPORAL_LAYER_JBE:16,REQUIRES_P2P_RELAY_INFO_VIA_SIGNALING:17,SUPPORT_NUMERIC_TOPICS:18,SUPPORT_PSEUDO_QUIC_CONNECTION:19});f["default"]=a}),66);
__d("multiway_ClientEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,MEDIA_CONNECTED:1});f["default"]=a}),66);
__d("multiway_ConferenceType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,GROUP:1,IGVIDEOCALL:9,ROOM:15,DEBUGTOOL:16,CRUCIBLE:20,MBS_WA:21,BOT:22,HORIZON:23});f["default"]=a}),66);
__d("multiway_DeviceStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10});f["default"]=a}),66);
__d("multiway_DismissReason",[],(function(a,b,c,d,e,f){a=Object.freeze({CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,CALL_ENDED_BY_PRODUCT:9,JOIN_APPROVAL_DENIED:10,JOIN_APPROVAL_TIMEDOUT:11,UNSUPPORTED_VERSION:12,LIVE_NOT_ACKED:13,TX_ACK_TIMEDOUT:14,ANSWERED_BY_OTHER_USER:15,PARTICIPANT_SELF_TERMINATION:16,PARTICIPANT_REJOIN:17,LONG_LASTING_AUDIO_ISSUE:18,PRIMARY_ENDPOINT_HANGUP:19,RECONNECT_FAILED:20,E2EE_HARDENING_ERROR:21,CALL_ENDED_BY_EXTENSION:22});f["default"]=a}),66);
__d("multiway_E2eeMode",[],(function(a,b,c,d,e,f){a=Object.freeze({E2EE_NOT_MANDATED:0,DEPRECATED_NO_REQUIREMENT:1,E2EE_MANDATED:2});f["default"]=a}),66);
__d("multiway_EndpointServiceType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,COMPOSITING_SERVICE:1,MEDIA_SERVER:2,CATHODE_AMBISONIC:3,CATHODE_CAPTIONS:4,CATHODE_MEETING_SUMMARIZER:5,CATHODE_REALTIME_SHARED_STATE:6,RP_GENAI_SERVICE:7});f["default"]=a}),66);
__d("multiway_HangupReason",[],(function(a,b,c,d,e,f){a=Object.freeze({IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5,SESSION_MIGRATED:6,E2EE_MANDATED_BUT_OFFER_DID_NOT_CONTAIN_E2EE:7,E2EE_MANDATED_BUT_ANSWER_DID_NOT_NEGOTIATE_E2EE:8,WEBRTC_ERROR:9,CONNECTION_DROPPED:10});f["default"]=a}),66);
__d("multiway_JoinMode",[],(function(a,b,c,d,e,f){a=Object.freeze({PRIMARY:0,SECONDARY:1});f["default"]=a}),66);
__d("multiway_MediaPath",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,SFU:1,P2P:2});f["default"]=a}),66);
__d("multiway_MediaPauseStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({NotPaused:0,Paused:1});f["default"]=a}),66);
__d("multiway_MessageTag",[],(function(a,b,c,d,e,f){a=Object.freeze({PRANSWER:1001,INITIAL_ANSWER_TO_P2P_CALLER:1002,DEESCALATE_OFFER_TO_P2P_CALLEE:1003,DEESCALATE_ANSWER_TO_P2P_CALLER:1004,REQUEST_DEESCALATE_TO_P2P_CALLER:1005,REQUEST_ESCALATE:1006,REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM:1007,REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS:1008,PARTICIPANT_ADDED:1009,PARTICIPANT_REMOVED:1010,FIRST_REMOTE_ALERTED_FOR_INITIATOR:2001,FIRST_REMOTE_ANSWERED_FOR_INITIATOR:2002,CONTAIN_PENDING_APPROVAL_PARTICIPANTS:2003,KEEP_ALIVE_PING:3001,IS_INITIATOR:4001,PREGEN_SDP:4002});f["default"]=a}),66);
__d("multiway_MessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,P2P_PROTOCOL:19,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,UNSUBSCRIBE:25,APPROVAL:26,TRANSFER:27,WAKEUP:28});f["default"]=a}),66);
__d("multiway_ParticipantCallState",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,CONNECTING:8,CONNECTED:9,PARTICIPANT_LIMIT_REACHED:10,IN_ANOTHER_CALL:11,RING_TYPE_UNSUPPORTED:12,PENDING_APPROVAL:13,APPROVED:14,FAILED_APPROVAL:15,HANGUP_IN_WAITING_ROOM:16,UNCALLABLE:17});f["default"]=a}),66);
__d("multiway_RingType",[],(function(a,b,c,d,e,f){a=Object.freeze({GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6,LIVE_AUDIO_ROOM:7,LIVE_WITH_ROOM:8});f["default"]=a}),66);
__d("multiway_RtcResponseStatusCode",[],(function(a,b,c,d,e,f){a=Object.freeze({OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONFLICT:409,CONDITIONAL_REQUEST_FAILED:412,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503});f["default"]=a}),66);
__d("multiway_RtcResponseSubCode",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:1e3,EXCEEDED_MAX_ALLOWED_PARTICIPANTS:1001,MEMBERSHIP_CHECK_FAIL:1002,CONFERENCE_THROTTLED:1003,ENDPOINT_THROTTLED:1004,MWS_MESSAGE_SENT_TO_INCORRECT_REGION:1005,UNSUPPORTED_REQUEST_TYPE:2e3,CLIENT_REQUEST_UNACCEPTABLE:2001,CLIENT_RESPONSE_UNACCEPTABLE:2002,RING_RESPONSE_BODY_NOT_SET:2004,SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:2005,INVALID_SDP:2006,INVALID_CONFERENCE_NAME:2007,SERVER_INFO_CONFERENCE_NAME_MISMATCH:2008,INVALID_USER_ID:2009,INCORRECT_VERSION_RANGE:2010,SENDER_ID_MISMATCH:2011,RECIPIENT_NOT_SPECIFIED:2012,FIELD_NOT_ALLOWED:2013,USERS_NOT_SPECIFIED:2015,REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:2016,INVALID_CALL_ID:2017,SESSION_DESCRIPTION_ID_MISMATCH:2018,EMPTY_CLIENT_MEDIA_UPDATES:2019,INVALID_SERVER_INFO_DATA:2020,INCORRECT_STATE_VERSION:2021,MISMATCHED_STATE_FOR_VERSION:2022,INVALID_STATE_VERSION:2023,NO_RESOLVER_FOUND:2024,MISSING_APPROVERLIST:2025,FULL_SDP_REQUIRED_IN_APPROVED_STATE:2026,INVALID_BROADCAST_ID:2027,INVALID_ENDPOINT_CONFIG:2028,INVALID_E2EE_STATE:2029,SFU_MODE_PREVENTED:2030,INVALID_CONFERENCE_STATE:2031,JOIN_REQUEST_DENIED:2032,EMPTY_USER_IDS:2033,MISSING_SDP_CONNECT_REQUEST:2034,MISSING_BODY_ENDPOINT:2101,MISSING_BODY_HEADER:2102,MISSING_BODY_BODY:2103,MISSING_BODY_PARAMS:2104,MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:2105,MISSING_BODY_DATA_MESSAGE_REQUEST:2106,MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:2107,MISSING_BODY_ADD_PARTICIPANTS_REQUEST:2108,MISSING_BODY_SUBSCRIPTION_REQUEST:2110,MISSING_BODY_JOIN_REQUEST:2111,MISSING_BODY_HANGUP_REQUEST:2112,MISSING_BODY_ICE_CANDIDATE_REQUEST:2113,MISSING_BODY_P2P_MESSAGE_REQUEST:2114,MISSING_BODY_UPDATE_REQUEST:2115,MISSING_BODY_CLIENT_EVENT_REQUEST:2116,MISSING_BODY_CONNECT_REQUEST:2117,MISSING_BODY_UNSUBSCRIBE_REQUEST:2118,MISSING_BODY_APPROVAL_REQUEST:2119,MISSING_ENDPOINT_USER_ID:2120,EMPTY_ENDPOINT_USER_ID:2121,MISSING_BODY_TRANSFER_REQUEST:2122,MISSING_BODY_GENERIC:2199,REQUESTOR_NOT_MEMBER_CONFERENCE:3002,NOT_BROADCAST_OWNER:3003,GUEST_NOT_INVITED:3004,GUEST_DISCONNECTED:3005,GUEST_INVITATION_EXPIRED:3006,SHOULD_USE_NEW_SIGNALING_PATH:3007,PARTICIPANT_IN_PENDING_APPROVAL_STATE:3008,BROADCAST_ALREADY_STOPPED:4002,FAILED_TO_GENERATE_SDP_ANSWER:4003,FAILED_GENERATE_SESSION_DESCRIPTION:4004,SDP_SESSION_ID_MISMATCH:4005,MEDIA_ENDPOINT_GONE:4007,MEDIA_ENDPOINT_ALREADY_EXISTS:4008,MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:4009,LEGACY_MESSENGER_SENDER_UNSET:4010,FAILED_TO_SET_TRANSPORT_INFO:4011,NON_PRIMARY_MULTIWAY_SERVER:4012,FAILED_TO_GET_REMOTE_DESCRIPTION:4013,LOCAL_DESCRIPTION_NOT_SET:4014,INVALID_SDP_TYPE:4015,CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:4016,SDP_UNSET_ON_P2P_ANSWER:4017,MISSING_ICE_CANDIDATE_PAYLOAD:4018,P2P_PROTOCOL_UNSET:4019,CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:4020,LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:4021,CONNECT_UNSUPPORTED_IN_SFU_MODE:4022,CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:4023,RESOLVE_STATE_API_ERROR:4024,EXTERNAL_RESOLUTION_ERROR:4025,INTERNAL_RESOLUTION_ERROR:4026,RESOLUTION_DISABLED:4027,BROADCAST_ID_MISSING:4028,SDP_UNSET_ON_P2P_OFFER:4029,LEGACY_OFFER_MISSING_REQUIRED_VALUE:4031,MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR:4032,CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS:4033,OTHER_USER_ANSWERED_THE_CALL:4034,MEDIA_SERVER_DESERIALIZATION_ERROR:4035,REMOTE_SDP_TRACKID_MISMATCH:4036,SIGNALING_MESSAGE_TO_CLIENT_DROPPED:4037,DATA_CHANNEL_ENDPOINT_GONE:4038,DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS:4039,CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION:4040,P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION:4041,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE:4042,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER:4043,REQUEST_TIMEOUT:4044,CONFERENCE_NOT_FOUND:5001,CONFERENCE_IS_TERMINATING:5002,CONFERENCE_IS_TERMINATED:5003,CONFERENCE_NAME_EMPTY:5004,NONCE_EMPTY:5005,NONCE_MISMATCH:5006,CONFERENCE_HAS_GONE:5007,PARTICIPANT_HAS_GONE:5008,MEDIA_SERVER_NOT_FOUND:5009,CLIENT_TERMINATED:5010,MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:6001,CONFERENCE_INCAPABLE_RENEGOTIATION:6002,REJECTING_CMU_WHEN_SMU_PENDING:6003,PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:6004,PARTICIPANT_ALREADY_IN_WAITING_ROOM:6005,PARTICIPANT_NOT_IN_PENDING_APPROVAL:6006,USER_NOT_APPROVER_FOR_TARGET_USER:6007,UNSUPPORTED_CAPABILITIES:6008,PRODUCT_SERVER_DEFINED_END_REASON:6009,WWW_KILLSWITCHED_REQUEST:6010,CONFLICTING_MEDIA_PATH:6011,CONFLICTING_MEDIA_STATUS:6012,CONFLICTING_SESSION_DESCRIPTION:6013,OK:9e3});f["default"]=a}),66);
__d("multiway_SubscriptionType",[],(function(a,b,c,d,e,f){a=Object.freeze({CNAME:0,TRACK:1,DOMINANT_SPEAKER:2});f["default"]=a}),66);
__d("multiway_VideoQuality",[],(function(a,b,c,d,e,f){a=Object.freeze({LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4});f["default"]=a}),66);
__d("ZenonMWMessageTypes",["$InternalEnum","fbwebrtc_ClientStack","multiway_ApprovalStatus","multiway_Capability","multiway_ClientEventType","multiway_ConferenceType","multiway_DeviceStatus","multiway_DismissReason","multiway_E2eeMode","multiway_EndpointServiceType","multiway_HangupReason","multiway_JoinMode","multiway_MediaPath","multiway_MediaPauseStatus","multiway_MessageTag","multiway_MessageType","multiway_ParticipantCallState","multiway_RingType","multiway_RtcResponseStatusCode","multiway_RtcResponseSubCode","multiway_SubscriptionType","multiway_VideoQuality"],(function(a,b,c,d,e,f,g){"use strict";a=b("$InternalEnum")({DEFAULT_AUDIO:0,DEFAULT_VIDEO:1,SCREEN_AUDIO:2,SCREEN_VIDEO:3});g.ZenonMWClientStack=c("fbwebrtc_ClientStack");g.ZenonMWApprovalStatus=c("multiway_ApprovalStatus");g.ZenonMWCapability=c("multiway_Capability");g.ZenonMWClientEventType=c("multiway_ClientEventType");g.ZenonMWConferenceType=c("multiway_ConferenceType");g.ZenonMWDeviceStatus=c("multiway_DeviceStatus");g.ZenonMWDismissReason=c("multiway_DismissReason");g.ZenonMWE2eeMode=c("multiway_E2eeMode");g.ZenonMWEndpointServiceType=c("multiway_EndpointServiceType");g.ZenonMWHangupReason=c("multiway_HangupReason");g.ZenonMWMediaPath=c("multiway_MediaPath");g.ZenonMWJoinMode=c("multiway_JoinMode");g.ZenonMWMediaPauseStatus=c("multiway_MediaPauseStatus");g.ZenonMWMessageTag=c("multiway_MessageTag");g.ZenonMWSignalingPayloadType=c("multiway_MessageType");g.ZenonMWParticipantCallState=c("multiway_ParticipantCallState");g.ZenonMWRingType=c("multiway_RingType");g.ZenonMWResponseStatusCode=c("multiway_RtcResponseStatusCode");g.ZenonMWResponseSubCode=c("multiway_RtcResponseSubCode");g.ZenonMWSubscriptionType=c("multiway_SubscriptionType");g.ZenonMWVideoQuality=c("multiway_VideoQuality");g.ZenonMWTrackLabel=a}),98);
__d("ZenonMWMessageMap",["ZenonMWMessageTypes"],(function(a,b,c,d,e,f,g){"use strict";c=Object.freeze((a={},a[(b=d("ZenonMWMessageTypes")).ZenonMWSignalingPayloadType.JOIN]="JOIN",a[b.ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE]="SERVER_MEDIA_UPDATE",a[b.ZenonMWSignalingPayloadType.ICE_CANDIDATE]="ICE_CANDIDATE",a[b.ZenonMWSignalingPayloadType.HANGUP]="HANGUP",a[b.ZenonMWSignalingPayloadType.RING]="RING",a[b.ZenonMWSignalingPayloadType.DISMISS]="DISMISS",a[b.ZenonMWSignalingPayloadType.CONFERENCE_STATE]="CONFERENCE_STATE",a[b.ZenonMWSignalingPayloadType.ADD_PARTICIPANTS]="ADD_PARTICIPANTS",a[b.ZenonMWSignalingPayloadType.SUBSCRIPTION]="SUBSCRIPTION",a[b.ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE]="CLIENT_MEDIA_UPDATE",a[b.ZenonMWSignalingPayloadType.DATA_MESSAGE]="DATA_MESSAGE",a[b.ZenonMWSignalingPayloadType.REMOVE_PARTICIPANTS]="REMOVE_PARTICIPANTS",a[b.ZenonMWSignalingPayloadType.PING]="PING",a[b.ZenonMWSignalingPayloadType.P2P_PROTOCOL]="P2P_PROTOCOL",a[b.ZenonMWSignalingPayloadType.NOTIFY]="NOTIFY",a[b.ZenonMWSignalingPayloadType.CONNECT]="CONNECT",a[b.ZenonMWSignalingPayloadType.CLIENT_EVENT]="CLIENT_EVENT",a[b.ZenonMWSignalingPayloadType.UNSUBSCRIBE]="UNSUBSCRIBE",a[b.ZenonMWSignalingPayloadType.UPDATE]="UPDATE",a[b.ZenonMWSignalingPayloadType.APPROVAL]="APPROVAL",a[b.ZenonMWSignalingPayloadType.WAKEUP]="WAKEUP",a));e=c;g["default"]=e}),98);
__d("OverlayConfigConstants",[],(function(a,b,c,d,e,f){"use strict";a={OverlayConfigNumParameters:4640,OverlayConfigNotPresentFlagValue:-1};b=a;f["default"]=b}),66);
__d("OverlayConfigLayerSource",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,DEFAULT:1,MOBILECONFIG:2,APP_CRUCIBLE:3,APP_JNI:4,UNITTEST_CONFIG:5,SERVER:6,PLACEHOLDER:7,LS_MOBILECONFIG:8,APP_LS:9,APP_JS:10,BROWSER:11,APP_OVRRTC:12,APP_IG:13,MLITE4A_LEGACY_QE:14,APP_MLITE4A:15,APP_PORTAL:16,IG_LAUNCHER:17,APP_ARCHON:18,APP_WS:19,APP_NOX:20,APP_WEARABLE_MSNGR:21,APP_WEARABLE_IG:22,APP_ORCA_RSYS:23,APP_WILDE:24,APP_MKIOS:25,APP_MK4A:26,DYNAMIC:27,SDK_DEFAULT:28,APP_FB4A:29,APP_RSYS_SDK_SAMPLE:30,APP_BIZAPP:31,APP_WORKCHAT:32,APP_ARCHON_LOCAL_OVERRIDES:33,APP_CATHODE:34,APP_WR4I:35,APP_WR4A:36,APP_METACAM:37,HORIZON_EMERGENCY:38,APP_SOCIALPLATFORM:39,APP_TWILIGHT:40,APP_AR_CALLING_LOCAL_OVERRIDES:41,APP_TWILIGHT_CASTING:42,TWILIGHT_EMERGENCY:43,METACAM_EMERGENCY:44,CALL_SCOPED:45});b=a;f["default"]=b}),66);
__d("OverlayConfigServerLayer",["OverlayConfigConstants","OverlayConfigLayerSource"],(function(a,b,c,d,e,f,g){"use strict";a=function(){a.createFromHeader=function(b){try{b=b==null?void 0:(b=b.extensions)==null?void 0:b.oc1_json;if(b==null)return null;b=JSON.parse(b);b=b==null?void 0:b.values;return b==null?null:new a(b)}catch(a){return null}};function a(a){this.$1=a}var b=a.prototype;b.getLayerSource=function(){return c("OverlayConfigLayerSource").SERVER};b.getValue=function(a){a=this.$1[String(a)];return a!=null?a:c("OverlayConfigConstants").OverlayConfigNotPresentFlagValue};b.logExposure=function(a){};return a}();g["default"]=a}),98);
__d("ZenonEndCallReason",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({BREAKOUT_SESSION_SWITCH_ROOM:"BreakoutSessionSwitchRoom",CALL_END_ACCEPT_AFTER_HANG_UP:"CallEndAcceptAfterHangUp",CALLER_NOT_VISIBLE:"CallerNotVisible",CAMERA_PERMISSION_DENIED:"CameraPermissionDenied",CARRIER_BLOCKED:"CarrierBlocked",CLIENT_ENCRYPTION_ERROR:"ClientEncryptionError",CLIENT_ERROR:"ClientError",CLIENT_INTERRUPTED:"ClientInterrupted",CONNECTION_DROPPED:"ConnectionDropped",END_TO_END_ENCRYPTION_INVARIANT_VIOLATED:"EndToEndEncryptionInvariantViolated",HANGUP_CALL:"HangupCall",IGNORE_CALL:"IgnoreCall",IN_ANOTHER_CALL:"InAnotherCall",INACTIVE_TIMEOUT:"InactiveTimeout",INCOMING_TIMEOUT:"IncomingTimeout",MAX_ALLOWED_PARTICIPANTS_REACHED:"MaxAllowedParticipantsReached",MICROPHONE_PERMISSION_DENIED:"MicrophonePermissionDenied",NO_ANSWER_TIMEOUT:"NoAnswerTimeout",NO_PERMISSION:"NoPermission",NO_UI_SHOWN:"NoUIShown",OTHER_CARRIER_BLOCKED:"OtherCarrierBlocked",OTHER_INSTANCE_HANDLED:"OtherInstanceHandled",OTHER_NOT_CAPABLE:"OtherNotCapable",PRODUCT_SERVER_DEFINED_END_REASON:"ProductServerDefinedEndReason",REMOVED_BY_PARTICIPANT:"RemovedByParticipant",RING_MUTED:"RingMuted",SESSION_MIGRATED:"SessionMigrated",SIGNALING_MESSAGE_FAILED:"SignalingMessageFailed",TX_ACK_TIMEOUT:"TxAckTimeout",UNEXPECTED_END_OF_CALL:"UnexpectedEndOfCall",UNKNOWN:"Unknown",VERSION_UNSUPPORTED:"VersionUnsupported",WEBRTC_ERROR:"WebRTCError"});c=a;f["default"]=c}),66);
__d("ZenonIncomingRingSDKTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Hangup","OtherDismiss"]);f.ZenonCancelReason=a}),66);
__d("ZenonMediaError",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["ConnectionClosed","IceDisconnected","IceFailure","SetLocalSdpFailed","SetRemoteSdpFailed","RollbackSdpFailed","UnknownError"]);f.ZenonMediaError=a}),66);
__d("ZenonDismissReason",["$InternalEnum","FBLogger","ZenonIncomingRingSDKTypes","ZenonMWMessageTypes","ZenonMediaError"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("$InternalEnum")({IgnoreCall:0,HangupCall:1,InAnotherCall:2,AcceptAfterHangUp:3,NoAnswerTimeout:4,IncomingTimeout:5,OtherInstanceHandled:6,SignalingMessageFailed:7,ConnectionDropped:8,ClientInterrupted:9,WebRTCError:10,ClientError:11,NoPermission:12,OtherNotCapable:13,NoUIShown:14,VersionUnsupported:15,CallerNotVisible:16,CarrierBlocked:17,OtherCarrierBlocked:18,ClientEncryptionError:19,MicrophonePermissionDenied:20,CameraPermissionDenied:21,SessionMigrated:22,RingMuted:23,JoinApprovalDenied:24,RejectedByCallee:25,CallEndedByProduct:26,CallEnded:27,AnsweredOnAnotherDevice:28,RejectedOnAnotherDevice:29,CallCollision:30,MaxAllowedParticipantsReached:31,UnexpectedEndOfCall:32,TxAckTimeout:33,EndToEndEncryptionInvariantViolated:34,ProductServerDefinedEndReason:35,RemovedByParticipant:39,AnsweredByOtherUser:40});function a(a){switch(a){case"BreakoutSessionSwitchRoom":return i.HangupCall;case"CallEndAcceptAfterHangUp":return i.AcceptAfterHangUp;case"CallerNotVisible":return i.CallerNotVisible;case"CarrierBlocked":return i.CarrierBlocked;case"ClientEncryptionError":return i.ClientEncryptionError;case"ClientError":return i.ClientError;case"ClientInterrupted":return i.ClientInterrupted;case"ConnectionDropped":return i.ConnectionDropped;case"HangupCall":return i.HangupCall;case"IgnoreCall":return i.IgnoreCall;case"InAnotherCall":return i.InAnotherCall;case"EndToEndEncryptionInvariantViolated":return i.EndToEndEncryptionInvariantViolated;case"InactiveTimeout":return i.CallEnded;case"IncomingTimeout":return i.IncomingTimeout;case"MaxAllowedParticipantsReached":return i.MaxAllowedParticipantsReached;case"NoAnswerTimeout":return i.NoAnswerTimeout;case"NoPermission":return i.NoPermission;case"NoUIShown":return i.NoUIShown;case"OtherCarrierBlocked":return i.OtherCarrierBlocked;case"OtherInstanceHandled":return i.OtherInstanceHandled;case"OtherNotCapable":return i.OtherNotCapable;case"SignalingMessageFailed":return i.SignalingMessageFailed;case"UnexpectedEndOfCall":return i.UnexpectedEndOfCall;case"Unknown":return i.CallEnded;case"VersionUnsupported":return i.VersionUnsupported;case"WebRTCError":return i.WebRTCError;case"MicrophonePermissionDenied":return i.MicrophonePermissionDenied;case"CameraPermissionDenied":return i.CameraPermissionDenied;case"SessionMigrated":return i.SessionMigrated;case"RingMuted":return i.RingMuted;case"TxAckTimeout":return i.TxAckTimeout;case"ProductServerDefinedEndReason":return i.ProductServerDefinedEndReason;case"RemovedByParticipant":return i.RemovedByParticipant}}function e(a){switch(a){case i.CallEnded:case i.CallEndedByProduct:case i.HangupCall:return"HangupCall";case i.IgnoreCall:case i.JoinApprovalDenied:case i.RejectedByCallee:return"IgnoreCall";case i.InAnotherCall:return"InAnotherCall";case i.AcceptAfterHangUp:return"CallEndAcceptAfterHangUp";case i.NoAnswerTimeout:return"NoAnswerTimeout";case i.IncomingTimeout:return"IncomingTimeout";case i.AnsweredOnAnotherDevice:case i.CallCollision:case i.RejectedOnAnotherDevice:case i.OtherInstanceHandled:case i.AnsweredByOtherUser:return"OtherInstanceHandled";case i.SignalingMessageFailed:return"SignalingMessageFailed";case i.ConnectionDropped:return"ConnectionDropped";case i.ClientInterrupted:return"ClientInterrupted";case i.WebRTCError:return"WebRTCError";case i.ClientError:return"ClientError";case i.NoPermission:return"NoPermission";case i.OtherNotCapable:return"OtherNotCapable";case i.NoUIShown:return"NoUIShown";case i.VersionUnsupported:return"VersionUnsupported";case i.CallerNotVisible:return"CallerNotVisible";case i.CarrierBlocked:return"CarrierBlocked";case i.OtherCarrierBlocked:return"OtherCarrierBlocked";case i.ClientEncryptionError:return"ClientEncryptionError";case i.UnexpectedEndOfCall:return"UnexpectedEndOfCall";case i.MaxAllowedParticipantsReached:return"MaxAllowedParticipantsReached";case i.MicrophonePermissionDenied:return"MicrophonePermissionDenied";case i.CameraPermissionDenied:return"CameraPermissionDenied";case i.SessionMigrated:return"SessionMigrated";case i.RingMuted:return"RingMuted";case i.TxAckTimeout:return"TxAckTimeout";case i.EndToEndEncryptionInvariantViolated:return"EndToEndEncryptionInvariantViolated";case i.ProductServerDefinedEndReason:return"ProductServerDefinedEndReason";case i.RemovedByParticipant:return"RemovedByParticipant"}c("FBLogger")("rtc_www").mustfix("Unknown dismiss reason: %s",a);return"Unknown"}function f(a){switch(a){case i.OtherInstanceHandled:case i.AnsweredOnAnotherDevice:case i.AnsweredByOtherUser:case i.RejectedOnAnotherDevice:return d("ZenonIncomingRingSDKTypes").ZenonCancelReason.OtherDismiss;default:return d("ZenonIncomingRingSDKTypes").ZenonCancelReason.Hangup}}function j(a){switch(a){case d("ZenonMediaError").ZenonMediaError.IceDisconnected:return i.ConnectionDropped;case d("ZenonMediaError").ZenonMediaError.ConnectionClosed:return i.HangupCall;case d("ZenonMediaError").ZenonMediaError.IceFailure:case d("ZenonMediaError").ZenonMediaError.SetLocalSdpFailed:case d("ZenonMediaError").ZenonMediaError.SetRemoteSdpFailed:case d("ZenonMediaError").ZenonMediaError.RollbackSdpFailed:return i.WebRTCError;case d("ZenonMediaError").ZenonMediaError.UnknownError:return i.UnexpectedEndOfCall}}function k(a){return l[a]}var l=Object.freeze((b={},b[(h=d("ZenonMWMessageTypes")).ZenonMWDismissReason.CALL_ENDED]=i.CallEnded,b[h.ZenonMWDismissReason.ANSWERED_ON_ANOTHER_DEVICE]=i.AnsweredOnAnotherDevice,b[h.ZenonMWDismissReason.ANSWERED_BY_OTHER_USER]=i.AnsweredByOtherUser,b[h.ZenonMWDismissReason.IN_ANOTHER_CALL]=i.InAnotherCall,b[h.ZenonMWDismissReason.CONNECTION_DROPPED]=i.ConnectionDropped,b[h.ZenonMWDismissReason.REJECTED_ON_ANOTHER_DEVICE]=i.RejectedOnAnotherDevice,b[h.ZenonMWDismissReason.REJECTED_BY_CALLEE]=i.RejectedByCallee,b[h.ZenonMWDismissReason.CALL_ENDED_BY_PRODUCT]=i.CallEndedByProduct,b[h.ZenonMWDismissReason.INTERNAL_ERROR]=i.SignalingMessageFailed,b[h.ZenonMWDismissReason.REMOVED_BY_PARTICIPANT]=i.RemovedByParticipant,b[h.ZenonMWDismissReason.TX_ACK_TIMEDOUT]=i.TxAckTimeout,b));g.ZenonDismissReason=i;g.endCallToDismissReason=a;g.dismissToEndCallReason=e;g.dismissReasonToCancelReason=f;g.mediaErrorToDismissReason=j;g.mwDismissToDmissReason=k}),98);
__d("ZenonCallsModelTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum")).Mirrored(["Disconnected","Precontacting","Contacting","Ringing","PendingApproval","Approved","FailedApproval","Connecting","Connected","Reconnecting","ProvisionalRinging"]);d=a.Mirrored(["Facebook","Instagram","Messenger","Guest","WhatsApp","Workplace"]);e=a.Mirrored(["New","Connecting","PendingApproval","Connected","Terminating","Terminated"]);b=a.Mirrored(["Unknown","CallsBlocked","PageAdminPressedDecline"]);a=a.Mirrored(["None","PendingPeerFeedback","Declined","RemoteDeclined","LocalDeclined","Cancelled","TimedOut","Accepted","InitiatedFromPeer"]);f.ZenonCallParticipantState=c;f.ZenonCallParticipantType=d;f.ZenonCallState=e;f.ZenonEndCallSubreason=b;f.ZenonVideoEscalationStatus=a}),66);
__d("ZenonParticipantState",["$InternalEnum","ZenonCallsModelTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({UNKNOWN:0,ADDING:1,CONTACTING:2,RINGING:3,ACCEPTING:4,PRECONNECTING:5,CONNECTING:6,CONNECTED:7,REMOVING:8,DISCONNECTED:9,NO_ANSWER:10,REJECTED:11,UNREACHABLE:12,CONNECTION_DROPPED:13,PARTICIPANT_LIMIT_REACHED:14,IN_ANOTHER_CALL:15,RING_TYPE_UNSUPPORTED:16,PENDING_APPROVAL:17,APPROVING:18,DENYING:19,APPROVED:20,FAILED_APPROVAL:21,HANGUP_IN_WAITING_ROOM:22,RECONNECTING:23});function a(a){if(a==null)return d("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected;switch(a){case h.CONTACTING:case h.PRECONNECTING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Contacting;case h.RINGING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Ringing;case h.CONNECTING:case h.RECONNECTING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Connecting;case h.CONNECTED:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected;case h.PENDING_APPROVAL:case h.APPROVING:case h.DENYING:case h.ACCEPTING:case h.ADDING:case h.REMOVING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.PendingApproval;case h.APPROVED:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Approved;case h.FAILED_APPROVAL:return d("ZenonCallsModelTypes").ZenonCallParticipantState.FailedApproval;case h.HANGUP_IN_WAITING_ROOM:case h.UNKNOWN:case h.DISCONNECTED:case h.NO_ANSWER:case h.REJECTED:case h.UNREACHABLE:case h.CONNECTION_DROPPED:case h.PARTICIPANT_LIMIT_REACHED:case h.IN_ANOTHER_CALL:case h.RING_TYPE_UNSUPPORTED:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected}return d("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected}g.ZenonParticipantState=h;g.toCallParticipantState=a}),98);
__d("ZenonScreenShare",["UserAgent","ZenonAppProvider","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.length===1&&((a=a[0])==null?void 0:a.contentType)==="screen"}function h(){return!c("UserAgent").isBrowser("Safari")}function i(){return d("ZenonAppProvider").isOculusCastingSite()&&c("justknobx")._("1977")?!1:!0}function b(){return!h()||!i()}g.isScreenSharingTrack=a;g.screenShareWithReplaceTrack=b}),98);
__d("ZenonSignalingTypes",[],(function(a,b,c,d,e,f){"use strict";a={OK:0,REJECTED_FROM_VERSION_DOES_NOT_MATCH:1,METHOD_NOT_ALLOWED:2};b={CLIENT_TERMINATED:0};f.ZenonSignalingStatusCode=a;f.ZenonSignalingStatusSubCode=b}),66);
__d("ZenonStateSyncPayloadSerializer",["RequestStreamBodyUtils","ZenonAppProvider"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("ZenonAppProvider").isInstagramApp()?d("RequestStreamBodyUtils").stringToUint8Array(a):d("RequestStreamBodyUtils").base64ToUint8Array(a)}g.stateSyncStringToUint8Array=a}),98);
__d("addDevTierOverridesToHeaderExtensions",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b={multiwayCoreTier:"",multiwayWwwTier:""};if(!c("gkx")("25224"))return b;b.multiwayWwwTier=h(a,"multiway_www_tier");b.multiwayCoreTier=h(a,"multiway_core_tier");return b}function h(a,b){b=b+"=";a=a.split(b);return a[1]?a.pop().split("&").shift():""}g["default"]=a}),98);
__d("ZenonMWTranslatorUtils",["ChannelClientID","CurrentUser","IGDWebUtils","OverlayConfigServerLayer","RequestStreamBodyUtils","RpWebMqttEnabledAppIds","ZenonDismissReason","ZenonMWMessageTypes","ZenonParticipantState","ZenonScreenShare","ZenonSignalingProtocol","ZenonSignalingTypes","ZenonStateSyncPayloadSerializer","addDevTierOverridesToHeaderExtensions","err","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k="signalingDominantSpeakerUpdate",l="signalingVideoUploadUpdate",m="E2eeState",n=new Set(c("RpWebMqttEnabledAppIds").APP_IDS);function a(a,b,e,f){e===void 0&&(e=!1),a&&Object.keys(a).forEach(function(g){if(g===m&&f&&c("justknobx")._("1893"))return;var h=a[g],i=h.data;h=h.version;if(i!=null){i={data:d("ZenonStateSyncPayloadSerializer").stateSyncStringToUint8Array(i),eventName:"stateSyncNotifyRequest",responseRequired:e,topic:g,version:h};b.push(i)}})}function b(a){var b;if(a){a=a[m];(a==null?void 0:a.data)!=null&&(b=d("ZenonStateSyncPayloadSerializer").stateSyncStringToUint8Array(a.data));return b}}function e(a,b,d){var e={appId:t(),deviceId:c("ChannelClientID").getID(),userId:b.userInfo.userID};b=z(b,a);return{endpoint:e,jsonPayload:{body:d,header:b}}}function f(a,b,d,e,f){var g={appId:t(),deviceId:c("ChannelClientID").getID(),userId:b.userInfo.userID};b=A(b,a,e,f);return{endpoint:g,jsonPayload:{body:d,header:b}}}function o(a){a=d("ZenonDismissReason").mwDismissToDmissReason(a);return(a=a)!=null?a:d("ZenonDismissReason").ZenonDismissReason.CallEnded}function p(a){a=N[a];return(a=a)!=null?a:d("ZenonMWMessageTypes").ZenonMWParticipantCallState.UNKNOWN}function q(a){var b=null;a!=null&&a.forEach(function(a){a=(a=a.body)==null?void 0:a.genericMessage;if(a!=null&&a.topic==="collision_context_payload"){a=a.data;if(a!=null){var c;a=JSON.parse(a);b={groupThreadID:(c=a.group_thread_id)!=null?c:null,peerID:(c=a.peer_id)!=null?c:null,serverInfoData:(c=a.server_info_data)!=null?c:null}}}});return b}function r(a){a=(a=a.message.body)!=null?a:{};var b=a.dominantSpeakerSignalingInfo,c=a.genericMessage;a=a.videoUploadSignalingInfo;if(c)try{return atob(c.data)}catch(a){return c.data}else if(b)return JSON.stringify(b);else if(a)return JSON.stringify(a);return null}function s(a){a=(a=a.message.body)!=null?a:{};var b=a.dominantSpeakerSignalingInfo,c=a.genericMessage;a=a.videoUploadSignalingInfo;if(c)return c.topic;else if(b)return k;else if(a)return l;return null}function t(){var a=c("CurrentUser").getAppID();if(a!=null&&d("IGDWebUtils").isInstagramWebSupportedApp(Number(a)))return a;a=(a=a)!=null?a:219994525426954..toString();return n.has(Number(a))?a:219994525426954..toString()}function u(a){a=a&&a.length>0?a.find(function(a){return((a=a.body)==null?void 0:(a=a.genericMessage)==null?void 0:a.topic)==="room_metadata"}):null;if(a){var b;b=(b=a.body)==null?void 0:(b=b.genericMessage)==null?void 0:b.data;if(b!=null){b=JSON.parse(b);a=(a=a.header)==null?void 0:a.sender;if(b.link_hash!=null&&b.room_name!=null&&a!=null)return{linkHash:b.link_hash,profileURL:b.profile_url,ringSubtitle:b.ring_subtitle,roomName:b.room_name,sender:a}}}return null}function v(a,b){b=c("OverlayConfigServerLayer").createFromHeader(b);if(b){b={eventName:"overlayConfigServerUpdateRequest",serverLayer:b};a.push(b)}}function w(a){return a.reduce(function(a,b){var c;c=(c=b.body)==null?void 0:(c=c.genericMessage)==null?void 0:c.topic;b=(b=b.body)==null?void 0:(b=b.genericMessage)==null?void 0:b.data;c!=null&&b!=null&&(a[c]=b);return a},{})}function x(a){var b=a.clientSessionId,d=a.conferenceName,e=a.receiver,f=a.receiverUserId,g=a.sequenceNumber,h=a.serverInfoData,i=a.transactionId;if(f==null)throw c("err")("Incoming MW messages should have receiverUserId populated.");b=b;var j={userID:"2"};e={actorID:(e=e==null?void 0:e.actorId)!=null?e:null,messageID:i,messageTags:(e=a.messageTags)!=null?e:[],protocol:c("ZenonSignalingProtocol").MW,remoteInfo:j,retryCount:a.retryCount,roomInfo:{name:d},sequenceNumber:g,signalingID:b,userInfo:{userID:(i=f)!=null?i:"1"}};h!=null&&(e.remoteSignalingID=h);return e}function y(a,b){return Object.keys(a).map(function(c){var d=a[c];return{body:{genericMessage:{data:d,topic:c}},header:{recipients:b,topic_DEPRECATED:c}}})}function z(a,b){var e=a.messageID,f=a.messageTags,g=a.remoteSignalingID,h=a.roomInfo,i=a.signalingID,j=c("addDevTierOverridesToHeaderExtensions")(window.location.href);h={clientStack:d("ZenonMWMessageTypes").ZenonMWClientStack.ZENON,conferenceName:h.name,messageTags:f,retryCount:a.retryCount,sequenceNumber:a.sequenceNumber,transactionId:e,type:b};(j.multiwayCoreTier!==""||j.multiwayWwwTier!=="")&&(h.extensions=j);i!=null&&(h.clientSessionId=i);g!=null&&(h.serverInfoData=g);a.actorID!=null&&(h.sender={id:a.actorID});return h}function A(a,b,c,e){a=z(a,b);a.responseStatusCode=(b=c)!=null?b:d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK;e!=null&&(a.responseSubCode=e);return a}function B(a){var b={tracks:{}},c=!d("ZenonScreenShare").screenShareWithReplaceTrack();a.tracks.forEach(function(a){var d={enabled:a.enabled,name:a.name,owner:a.participantID},e=c?K(a.type):null;e!=null&&(d.label=e);b.tracks[a.trackID]=d});return b}function C(a){if(a==null)return null;switch(a){case d("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_AUDIO:return"audio";case d("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_VIDEO:return"video";case d("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_AUDIO:return"screen_audio";case d("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_VIDEO:return"screen"}}function D(a){a=M[a];return(a=a)!=null?a:d("ZenonMWMessageTypes").ZenonMWDeviceStatus.OK}function E(a){switch(a){case d("ZenonDismissReason").ZenonDismissReason.IgnoreCall:return d("ZenonMWMessageTypes").ZenonMWHangupReason.IGNORE_CALL;case d("ZenonDismissReason").ZenonDismissReason.HangupCall:return d("ZenonMWMessageTypes").ZenonMWHangupReason.HANGUP_CALL;case d("ZenonDismissReason").ZenonDismissReason.NoAnswerTimeout:return d("ZenonMWMessageTypes").ZenonMWHangupReason.NO_ANSWER_TIMEOUT;case d("ZenonDismissReason").ZenonDismissReason.ClientError:return d("ZenonMWMessageTypes").ZenonMWHangupReason.CLIENT_ERROR;case d("ZenonDismissReason").ZenonDismissReason.InAnotherCall:return d("ZenonMWMessageTypes").ZenonMWHangupReason.IN_ANOTHER_CALL;case d("ZenonDismissReason").ZenonDismissReason.ClientInterrupted:return d("ZenonMWMessageTypes").ZenonMWHangupReason.CLIENT_INTERRUPTED;case d("ZenonDismissReason").ZenonDismissReason.SessionMigrated:return d("ZenonMWMessageTypes").ZenonMWHangupReason.SESSION_MIGRATED;default:return d("ZenonMWMessageTypes").ZenonMWHangupReason.HANGUP_CALL}}function F(a){var b={};a.tracks.forEach(function(a){b[a.trackID]=a.enabled});return b}function G(a){var b={},c=!d("ZenonScreenShare").screenShareWithReplaceTrack();a.tracks.forEach(function(a){var d={enabled:a.enabled},e=c?K(a.type):null;e!=null&&(d.label=e);b[a.trackID]=d});return{tracks:b}}function H(a){return O[a]}function I(a){return a==null?null:P[a]}function J(a){var b={};a.forEach(function(a,c){b[c]={data:a.data?d("RequestStreamBodyUtils").uint8ArrayToBase64(a.data):void 0,version:a.version}});return b}function K(a){switch(a){case"audio":return d("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_AUDIO;case"video":return d("ZenonMWMessageTypes").ZenonMWTrackLabel.DEFAULT_VIDEO;case"screen":return d("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_VIDEO;case"screen_audio":return d("ZenonMWMessageTypes").ZenonMWTrackLabel.SCREEN_AUDIO;default:return null}}function L(a,b,c){c===void 0&&(c=0);var d={fromVersion:b,tracks:[],version:c};a!=null&&Object.keys(a.tracks).forEach(function(b){var c=a.tracks[b];b={enabled:c.enabled,name:c.name,participantID:c.owner,trackID:b,type:C(c.label)};d.tracks.push(b)});return d}var M={IN_ANOTHER_CALL:(i=d("ZenonMWMessageTypes")).ZenonMWDeviceStatus.IN_ANOTHER_CALL,NOT_SUPPORTED:i.ZenonMWDeviceStatus.NOT_SUPPORTED,OK:i.ZenonMWDeviceStatus.OK},N=Object.freeze((h={},h[i.ZenonMWParticipantCallState.UNKNOWN]=(j=d("ZenonParticipantState")).ZenonParticipantState.UNKNOWN,h[i.ZenonMWParticipantCallState.DISCONNECTED]=j.ZenonParticipantState.DISCONNECTED,h[i.ZenonMWParticipantCallState.NO_ANSWER]=j.ZenonParticipantState.NO_ANSWER,h[i.ZenonMWParticipantCallState.REJECTED]=j.ZenonParticipantState.REJECTED,h[i.ZenonMWParticipantCallState.UNREACHABLE]=j.ZenonParticipantState.UNREACHABLE,h[i.ZenonMWParticipantCallState.CONNECTION_DROPPED]=j.ZenonParticipantState.CONNECTION_DROPPED,h[i.ZenonMWParticipantCallState.CONTACTING]=j.ZenonParticipantState.CONTACTING,h[i.ZenonMWParticipantCallState.RINGING]=j.ZenonParticipantState.RINGING,h[i.ZenonMWParticipantCallState.CONNECTING]=j.ZenonParticipantState.CONNECTING,h[i.ZenonMWParticipantCallState.CONNECTED]=j.ZenonParticipantState.CONNECTED,h[i.ZenonMWParticipantCallState.PARTICIPANT_LIMIT_REACHED]=j.ZenonParticipantState.PARTICIPANT_LIMIT_REACHED,h[i.ZenonMWParticipantCallState.IN_ANOTHER_CALL]=j.ZenonParticipantState.IN_ANOTHER_CALL,h[i.ZenonMWParticipantCallState.RING_TYPE_UNSUPPORTED]=j.ZenonParticipantState.RING_TYPE_UNSUPPORTED,h[i.ZenonMWParticipantCallState.PENDING_APPROVAL]=j.ZenonParticipantState.PENDING_APPROVAL,h[i.ZenonMWParticipantCallState.APPROVED]=j.ZenonParticipantState.APPROVED,h[i.ZenonMWParticipantCallState.FAILED_APPROVAL]=j.ZenonParticipantState.FAILED_APPROVAL,h[i.ZenonMWParticipantCallState.UNCALLABLE]=j.ZenonParticipantState.UNREACHABLE,h[i.ZenonMWParticipantCallState.HANGUP_IN_WAITING_ROOM]=j.ZenonParticipantState.HANGUP_IN_WAITING_ROOM,h)),O=Object.freeze((j={},j[(h=d("ZenonSignalingTypes")).ZenonSignalingStatusCode.OK]=i.ZenonMWResponseStatusCode.OK,j[h.ZenonSignalingStatusCode.REJECTED_FROM_VERSION_DOES_NOT_MATCH]=i.ZenonMWResponseStatusCode.CONDITIONAL_REQUEST_FAILED,j[h.ZenonSignalingStatusCode.METHOD_NOT_ALLOWED]=i.ZenonMWResponseStatusCode.METHOD_NOT_ALLOWED,j)),P=Object.freeze((j={},j[h.ZenonSignalingStatusSubCode.CLIENT_TERMINATED]=i.ZenonMWResponseSubCode.CLIENT_TERMINATED,j));g.E2EE_STATE_SYNC_TOPIC=m;g.addStateStoreSignalingEvents=a;g.fetchE2eeServerState=b;g.createMWRequest=e;g.createMWResponse=f;g.fromMWDismissReason=o;g.fromMWParticipantState=p;g.getCollisionContextFromAppMessages=q;g.getGenericDataMessageData=r;g.getGenericDataMessageTopic=s;g.getMWAppID=t;g.getRoomMetadataFromAppMessages=u;g.maybeAddOverlayConfigServerUpdateRequest=v;g.mwAppMessagesToSignalingAppMessages=w;g.mwMessageHeaderToSignalingMessageHeader=x;g.signalingMessageAppMessagesToMWAppMessages=y;g.toMWClientMediaStatus=B;g.toMWClientTrackContentType=C;g.toMWDeviceStatus=D;g.toMWHangupReason=E;g.toMWMediaStatus=F;g.toMWMediaStatusEx=G;g.toMWResponseStatusCode=H;g.toMWResponseStatusSubCode=I;g.toMWSyncStateStore=J;g.toMWTrackLabel=K;g.toZenonMediaStates=L}),98);
__d("ZenonMWMessageDebugLogger",["Log","LogHistory","ODS","RpWebStateMachineLoggingBlocklist","ZenonAuditedCheckpointLogId","ZenonIceStatsParser","ZenonInfraActionsLogger","ZenonMWMessageMap","ZenonMWMessageTypes","ZenonMWTranslatorUtils","formatDate","isEmployeeTestUserZenonLogging"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){this.$1=d("LogHistory").getInstance("webrtc"),this.$2=new Set(c("RpWebStateMachineLoggingBlocklist").MESSAGE_TYPES)}var b=a.prototype;b.$3=function(a,b,d){b===void 0&&(b=!0);var e=c("formatDate")(new Date(),"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",e+" "+a);b&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] "+a,messageID:d})};b.$4=function(a){a=a.jsonPayload.header;return a.responseStatusCode!=null};b.logMWMessage=function(a,b,d){this.$5(a,b,d);if(d.jsonPayload==null||!c("isEmployeeTestUserZenonLogging")())return;var e=d.jsonPayload.header,f=c("ZenonMWMessageMap")[e.type],g=this.$4(d)?"RESPONSE":"REQUEST";d=this.$6(d);a="[ms] "+a+" ["+b+"] "+f+" "+g+" [retryCount: "+e.retryCount+(d!=null?" details: "+d:"")+"]";this.$2.has(f)||this.$3(a,!0,e.transactionId)};b.$5=function(a,b,c){a=this.$7(a,b,c);a!==null&&(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_signaling",a)};b.$7=function(a,b,e){if(e.jsonPayload==null)return null;var f=e.jsonPayload,g=f.body;f=f.header;var h="";switch(f.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE:if(g.dataMessageRequest){h=(g=d("ZenonMWTranslatorUtils").getGenericDataMessageTopic(g.dataMessageRequest))!=null?g:"undefined"}break}g=this.$4(e)?"RESPONSE":"REQUEST";e=c("ZenonMWMessageMap")[f.type];if(h==="")return a+"-"+b+"-"+e+"-"+g;else return a+"-"+b+"-"+e+"-"+g+"-"+h};b.$6=function(a){if(a.jsonPayload==null)return null;var b=a.jsonPayload.header;switch(b.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:return this.$8(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:return this.$9(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:return this.$10(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SUBSCRIPTION:return this.$11(a);case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:return this.$12(a);default:return null}};b.$8=function(a){var b=a.jsonPayload,c=b.body;b=b.header;if(this.$4(a)){return JSON.stringify({hasAnswer:((a=c.joinResponse)==null?void 0:a.answer)!=null,hasRenegotiationOffer:((a=c.joinResponse)==null?void 0:a.renegotiationOffer)!=null,isPendingApproval:(a=c.joinResponse)==null?void 0:a.isPendingApproval,multipleVideoStreamsAllowed:(a=c.joinResponse)==null?void 0:a.multipleVideoStreamsAllowed,statusCode:b.responseStatusCode,subCode:b.responseSubCode})}return JSON.stringify({deviceCapabilities:(a=c.joinRequest)==null?void 0:a.deviceCapabilities,sdpType:((b=c.joinRequest)==null?void 0:b.offer)!=null?"offer":((a=c.joinRequest)==null?void 0:a.answer)!=null?"answer":"null",userCapabilities:(b=c.joinRequest)==null?void 0:b.userCapabilities})};b.$9=function(a){var b=a.jsonPayload,c=b.body;b=b.header;if(this.$4(a)){return JSON.stringify({currentVersion:(a=c.serverMediaUpdateResponse)==null?void 0:a.currentVersion,hasAnswer:((a=c.serverMediaUpdateResponse)==null?void 0:a.answer)!=null,statusCode:b.responseStatusCode,subCode:b.responseSubCode})}return JSON.stringify({fromVersion:(a=c.serverMediaUpdateRequest)==null?void 0:a.fromVersion,messageTags:b.messageTags,renegotiationRequested:(b=(a=c.serverMediaUpdateRequest)==null?void 0:a.renegotiationRequested)!=null?b:!1,sdpType:((a=c.serverMediaUpdateRequest)==null?void 0:a.offer)?"offer":((b=c.serverMediaUpdateRequest)==null?void 0:b.answer)?"answer":((a=c.serverMediaUpdateRequest)==null?void 0:a.update)?"delta":"empty",toVersion:(a=(b=c.serverMediaUpdateRequest)==null?void 0:b.toVersion)!=null?a:""})};b.$10=function(a){var b=a.jsonPayload,c=b.body;b=b.header;if(this.$4(a)){return JSON.stringify({currentVersion:(a=(a=c.clientMediaUpdateResponse)==null?void 0:a.currentVersion)!=null?a:"",statusCode:b.responseStatusCode,subCode:b.responseSubCode})}return JSON.stringify({fromVersion:(b=(a=c.clientMediaUpdateRequest)==null?void 0:a.fromVersion)!=null?b:"",toVersion:(b=(a=c.clientMediaUpdateRequest)==null?void 0:a.toVersion)!=null?b:""})};b.$11=function(a){var b=a.jsonPayload.body;return this.$4(a)?null:JSON.stringify({subscriptions:(b=(a=b.subscriptionRequest)==null?void 0:a.subscriptions)!=null?b:""})};b.$12=function(a){var b=a.jsonPayload.body;if(this.$4(a))return null;b=(a=b.iceCandidateRequest)==null?void 0:a.iceCandidateSdps.map(function(a){a=a.candidateSdpString;if(a!=null)return d("ZenonIceStatsParser").extractIceInfo(a)});return JSON.stringify({iceCandidates:b})};b.logSendMultiwayMessageFailure=function(a,b){(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","send_message_failure"),h.flush(),c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to send MW message of type "+b+". Error msg: "+a+":"})};return a}();b=new a();g["default"]=b}),98);
__d("ZenonArmadilloLoggingChecks",["justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("justknobx")._("1019")}function b(){return c("justknobx")._("1020")}function d(){return c("justknobx")._("1021")}function e(){return c("justknobx")._("1155")}g.isArmadilloCallSummaryLoggingEnabled=a;g.isArmadilloQPLLoggingEnabled=b;g.isArmadilloCheckpointLoggingEnabled=d;g.areArmadilloTslogsEnabled=e}),98);
__d("ZenonLoggingUtils",["ZenonAppProvider"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("ZenonAppProvider").isHorizonApp()?!1:!0}g.shouldAllowLogging=a}),98);
__d("ZenonMWMessageReliabilityLogTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["RECEIVED_REQUEST","RECEIVED_RESPONSE","PROCESSING_REQUEST","START_PROCESSING_RESPONSE","PROCESSING_RESPONSE","PROCESSED_REQUEST","PROCESSED_RESPONSE","SENDING_REQUEST","SENDING_RESPONSE","SENT_REQUEST","SENT_REQUEST_FROM_HANDLER","SENT_RESPONSE","SEND_REQUEST_FAILED","SEND_REQUEST_FAILED_FROM_HANDLER","SEND_RESPONSE_FAILED","SENT_SM_EVENT","PROCESSED_SM_EVENT","REQUEST_AFTER_NULL_CHECK","REQUEST_AFTER_TRANSLATION"]);f.ZenonMWMessageReliabilityEvent=a}),66);
__d("OculusMqttChannel",["CurrentUser","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();function h(a){d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);a=c("CurrentUser").getAppID()==null?2763362503905702:Number(c("CurrentUser").getAppID());return new(c("MqttChannel"))({appId:a,capabilities:c("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:c("MqttWebConfig").clientCapabilities,clientType:"websocket",deviceId:c("uuidv4")(),endpoint:c("MqttWebConfig").endpoint,initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,phpOverride:c("MqttWebConfig").hostNameOverride,pollingEndpoint:c("MqttWebConfig").pollingEndpoint,userFbid:c("CurrentUser").getPossiblyNonFacebookUserID()})}var i=null;function a(a){i==null&&(i=h(a));return i}function b(){return i}function e(){i!=null&&(i.shutdown(),i=null)}g.getOculusMqttChannelInstance=a;g.getOculusMqttChannelInstanceDoNotCreate=b;g.shutdownAndClear=e}),98);
__d("ZenonMqttChannel",["CurrentUser","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);a=c("CurrentUser").getAppID()!=null?Number(c("CurrentUser").getAppID()):c("MqttWebConfig").appID;b=new(c("MqttChannel"))({appId:a,capabilities:c("MqttWebConfig").capabilities,chatVisibility:!1,clientCapabilities:c("MqttWebConfig").clientCapabilities,endpoint:c("MqttWebConfig").endpoint,initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,phpOverride:c("MqttWebConfig").hostNameOverride,pollingEndpoint:c("MqttWebConfig").pollingEndpoint,userFbid:c("MqttWebConfig").fbid});e=b;g["default"]=e}),98);
__d("getZenonMqttChannel",["CurrentUser","FBMqttChannel","HorizonWebMqttChannel","IGDOverLSMqttChannel","OculusMqttChannel","RpWebMqttEnabledAppIds","ZenonAppProvider","ZenonMqttChannel"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(c("RpWebMqttEnabledAppIds").APP_IDS);function a(){if(d("ZenonAppProvider").isInstagramApp())return d("IGDOverLSMqttChannel").getInstance();else if(d("ZenonAppProvider").isOculusCastingSite())return d("OculusMqttChannel").getOculusMqttChannelInstance();else if(d("ZenonAppProvider").isHorizonApp())return d("HorizonWebMqttChannel").getHorizonWebMqttChannelInstance();else return h.has(Number(c("CurrentUser").getAppID()))?c("ZenonMqttChannel"):c("FBMqttChannel")}g["default"]=a}),98);
__d("ZenonMWMessageQPLLogger",["DateConsts","QPLMsgTypesSitevarConfig","QPLUserFlow","ZenonLoggingUtils","ZenonMWMessageMap","ZenonMWMessageReliabilityLogTypes","getZenonMqttChannel","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=30*d("DateConsts").MS_PER_SEC,i=c("getZenonMqttChannel")(),j=new Map();function a(a,b,e){if(!d("ZenonLoggingUtils").shouldAllowLogging())return;var f=a.jsonPayload.header,g=c("ZenonMWMessageMap")[f.type].toLowerCase();if(!c("QPLMsgTypesSitevarConfig").QPL_MSG_TYPES.includes(g))return;f=k(f.transactionId);switch(b){case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST:l(f,g,{connectionState:(b=e==null?void 0:e.connectionState)!=null?b:"",peerConnectionState:(b=e==null?void 0:e.peerConnectionState)!=null?b:"",signalingState:(b=e==null?void 0:e.signalingState)!=null?b:""},a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST:m(f);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE:n(f,a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE:o(f,a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_RESPONSE_FAILED:p(f,a,e==null?void 0:e.errorMessage);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST:q(f,g,{connectionState:(b=e==null?void 0:e.connectionState)!=null?b:"",peerConnectionState:(g=e==null?void 0:e.peerConnectionState)!=null?g:"",signalingState:(b=e==null?void 0:e.signalingState)!=null?b:""},a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_REQUEST:r(f);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_REQUEST_FAILED:s(f,e==null?void 0:e.errorMessage);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE:t(f,a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT:u(f,e==null?void 0:e.smEvent);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT:v(f,e==null?void 0:e.smEvent);return;default:return}}function b(a,b){if(!d("ZenonLoggingUtils").shouldAllowLogging())return;c("QPLUserFlow").addAnnotations(c("qpl")._(398988976,"737"),{string:babelHelpers["extends"]({},b)},{instanceKey:+a})}function k(a){a=isNaN(+a)?0:+a;var b=9223372036854776e3;return Math.round(a%b)}function l(a,b,d,e){c("QPLUserFlow").start(c("qpl")._(398988976,"737"),{annotations:{"int":{retryCount:e.jsonPayload.header.retryCount},int_array:{messageTags:e.jsonPayload.header.messageTags},string:babelHelpers["extends"]({},d,{messageType:b,mqttState:i.getConnectionState()})},instanceKey:a,timeoutInMs:h});if(e.jsonPayload.body.serverMediaUpdateRequest){d=e.jsonPayload.body.serverMediaUpdateRequest;b=d.answer;e=d.offer;d=d.update;c("QPLUserFlow").addAnnotations(c("qpl")._(398988976,"737"),{string:{sdpType:e?"offer":b?"answer":d?"delta":"empty"}},{instanceKey:a})}e={onMQTTStateChanged:function(b){c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"mqtt_"+b,{instanceKey:a})}};i.subscribeChannelEvents(e);j.set(a,e);return}function m(a){c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"processed_request",{instanceKey:a})}function n(a,b){b=b.jsonPayload.header;var d=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"sending_response",{instanceKey:a});c("QPLUserFlow").addAnnotations(c("qpl")._(398988976,"737"),{"int":{responseStatusCode:d,responseSubCode:b}},{instanceKey:a})}function o(a,b){b=b.jsonPayload.header;var d=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").endSuccess(c("qpl")._(398988976,"737"),{annotations:{"int":{responseStatusCode:d,responseSubCode:b}},instanceKey:a});d=j.get(a);d&&(i.unsubscribeChannelEvents(d),j["delete"](a))}function p(a,b,d){b=b.jsonPayload.header;var e=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").endFailure(c("qpl")._(398988976,"737"),"send_response_failed",{annotations:{"int":{responseStatusCode:e,responseSubCode:b},string:{errorMessage:d}},instanceKey:a});e=j.get(a);e&&(i.unsubscribeChannelEvents(e),j["delete"](a))}function q(a,b,d,e){c("QPLUserFlow").start(c("qpl")._(398988976,"737"),{annotations:{"int":{retryCount:e.jsonPayload.header.retryCount},int_array:{messageTags:e.jsonPayload.header.messageTags},string:babelHelpers["extends"]({},d,{messageType:b,mqttState:i.getConnectionState()})},instanceKey:a,timeoutInMs:h})}function r(a){c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"sending_request",{instanceKey:a})}function s(a,b){c("QPLUserFlow").endFailure(c("qpl")._(398988976,"737"),"send_request_failed",{annotations:{string:{errorMessage:b}},instanceKey:a})}function t(a,b){b=b.jsonPayload.header;var d=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").endSuccess(c("qpl")._(398988976,"737"),{annotations:{"int":{responseStatusCode:d,responseSubCode:b}},instanceKey:a})}function u(a,b){b!=null&&c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"sent_sm_event:"+b,{instanceKey:a})}function v(a,b){b!=null&&c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"processed_sm_event:"+b,{instanceKey:a})}g.log=a;g.updateState=b}),98);
__d("ZenonMWMessageReliabilityLogger",["ODS","ZenonArmadilloLoggingChecks","ZenonMWMessageMap","ZenonMWMessageQPLLogger","ZenonMWMessageReliabilityLogTypes","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map(),j=new Map(),k=new Map();function a(a){k.set(a,!0)}function b(a,b,c){a=j.get(a);if(!a)return;v(a,b,c)}function e(a){r(a)?v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE):v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST)}function f(a){r(a)?v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_RESPONSE):v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_REQUEST)}function l(a){r(a)||v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_NULL_CHECK)}function m(a){r(a)||v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_TRANSLATION)}function n(a){r(a)?v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_RESPONSE):v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST)}function o(a){r(a)?v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE):v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_REQUEST)}function p(a){r(a)?v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE):v(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST)}function q(a,b){var c=r(a)?d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_RESPONSE_FAILED:d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_REQUEST_FAILED;v(a,c,{errorMessage:b})}function r(a){a=a.jsonPayload.header;return a.responseStatusCode!=null}function s(a,b){var e=a.jsonPayload.header;e=c("ZenonMWMessageMap")[e.type].toLowerCase();a=r(a)?"response":"request";switch(b){case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST:case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","receive_"+a+"_"+e);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_REQUEST:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","processing_"+a+"_"+e);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","processed_"+a+"_"+e);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","sending_"+a+"_"+e);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_TRANSLATION:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","after_translation_"+a+"_"+e);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_NULL_CHECK:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","after_null_check_"+a+"_"+e);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE:case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","sent_"+a+"_"+e);(h||(h=d("ODS"))).flush();return;default:return}}var t={connectionState:"",peerConnectionState:"",signalingState:""};function u(a){var b=babelHelpers["extends"]({},t,a);if(t.connectionState!==b.connectionState||t.peerConnectionState!==b.peerConnectionState||t.signalingState!==b.signalingState){t=b;for(var b=i.keys(),c=Array.isArray(b),e=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(c){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;d("ZenonMWMessageQPLLogger").updateState(f,a)}}}function v(a,b,e){var f;if(c("justknobx")._("855"))return;var g=a.jsonPayload.header;f=(f=i.get(g.transactionId))!=null?f:new Set();i.set(g.transactionId,f);if(b!==d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT&&b!==d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT&&f.has(b))return;f.add(b);j.set(g.transactionId,a);s(a,b);f=(g=k.get((f=g.clientSessionId)!=null?f:""))!=null?g:!1;(!f||d("ZenonArmadilloLoggingChecks").isArmadilloQPLLoggingEnabled())&&d("ZenonMWMessageQPLLogger").log(a,b,babelHelpers["extends"]({},e,t))}g.setE2eeIsMandatedForCall=a;g.logEventForTxid=b;g.logReceivedMessage=e;g.logProcessingMessage=f;g.logMessageAfterNullCheck=l;g.logMessageAfterTranslation=m;g.logProcessedMessage=n;g.logSendingMessage=o;g.logSentMessage=p;g.logSendMessageFailed=q;g.updateState=u}),98);
__d("ZenonMWAddRemoveParticipantsTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";var h="new_room_context";function a(a,b){var c={usersToInvite:b.participants};if(b.groupThreadId!=null){b={calling_tags:2,group_thread_id:b.groupThreadId};if(b){b=[{body:{genericMessage:{data:JSON.stringify(b),topic:h}},header:{topic_DEPRECATED:h}}];c.appMessages=b}}return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ADD_PARTICIPANTS,a,{addParticipantsRequest:c})}function b(a,b){b={usersToRemove:b.participants};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.REMOVE_PARTICIPANTS,a,{removeParticipantsRequest:b})}g.NEW_ROOM_CONTEXT=h;g.toAddParticipantsRequest=a;g.toRemoveParticipantsRequest=b}),98);
__d("ZenonMWApprovalTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=b.approvalStatus;b=b.targetUsers;c={approvalStatus:c,targetUsers:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.APPROVAL,a,{approvalRequest:c})}g.toApprovalRequest=a}),98);
__d("ZenonMWClientEventTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b={clientEvents:[{type:b.clientEventType}]};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_EVENT,a,{clientEventRequest:b})}g.toClientEventRequest=a}),98);
__d("ZenonMWCommonUtils",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.split("\n");if(a.length<2)throw c("unrecoverableViolation")("Expected SDP string with two or more lines, but got "+a.length,"rtc_www");a=a[1].trim();a=a.split(" ");if(a.length<3)throw c("unrecoverableViolation")("Session line should have at least 3 tokens, but got "+a.length,"rtc_www");a=parseInt(a[2],10);if(isNaN(a))throw c("unrecoverableViolation")("SDP version could not be parsed as number.","rtc_www");return a}function b(a){return a.includes("BUNDLE 0")}g.getSdpVersion=a;g.isUnifiedPlan=b}),98);
__d("ZenonMWClientMediaUpdateTranslator",["ZenonMWCommonUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload;var c=a.body;a=a.header;c=c.clientMediaUpdateResponse;var e=a.responseStatusCode,f=a.responseSubCode,g=a.retryAfterMsec;if(c){var h=c.answer,i=c.mediaStatus,j=h!=null&&i!=null;d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(c.stateStore,b,!1,j);var k=d("ZenonMWTranslatorUtils").fetchE2eeServerState(c.stateStore);if(j){h=(j=h==null?void 0:h.sdpString)!=null?j:"";j=d("ZenonMWTranslatorUtils").toZenonMediaStates(i);i={ackMessageId:a.transactionId,eventName:"localSdpResponse",hasAnswerInJoinResponse:!1,source:"clientMediaUpdate"};var l=c.renegotiationOffer,m=null;l!=null&&l.sdpString!=null&&(m={sdp:l.sdpString,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(l.sdpString)});l={e2eeServerState:k,eventName:"remoteSdpRequest",mediaPath:c.mediaPath,mediaStates:j,negotiateType:!1,renegotiationOffer:m,sdp:{sdp:h,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(h)},sdpOriginLocalId:c.sdpOriginLocalId,source:"clientMediaUpdateResponse"};b.push(i);b.push(l)}k={ackMessageId:a.transactionId,acknowledgedVersion:c.currentVersion,eventName:"mediaUpdateResponse",responseStatusCode:e,responseSubCode:f,retryAfter:g};b.push(k)}return b}function b(a,b,c){b={fromVersion:b.version,mediaUpdates:[{mediaStatus:d("ZenonMWTranslatorUtils").toMWMediaStatus(b),mediaStatusEx:d("ZenonMWTranslatorUtils").toMWMediaStatusEx(b)}],toVersion:b.version};c!==void 0&&(b.offer={sdpString:c.sdp});return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE,a,{clientMediaUpdateRequest:b})}g.fromClientMediaUpdateResponse=a;g.toClientMediaUpdateRequest=b}),98);
__d("ZenonMWConferenceStateTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],c=a.jsonPayload.body.conferenceStateRequest;if(c){var e=c.appMessages,f=c.participantStates,g={eventName:"participantUpdateRequest",participantStates:new Map(),sctpUserIdNodeIdMap:new Map(),versionId:c.version},h={actorRepresentatives:new Map(),eventName:"clientInfoRequest",mediaPath:d("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN,userCapabilities:new Map()};Object.keys(f).forEach(function(a){var b=f[a],c=b.sctpNodeId,e=b.state;b=b.userCapabilities;g.participantStates.set(a,d("ZenonMWTranslatorUtils").fromMWParticipantState(e));c!=null&&g.sctpUserIdNodeIdMap.set(a,c);h.userCapabilities.set(a,(e=b)!=null?e:"")});b.push(g);b.push(h);c=d("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(e);if(c){c.serverInfoData=a.jsonPayload.header.serverInfoData;e={context:c,eventName:"roomContextUpdateRequest"};b.push(e)}}return b}function b(a,b){b={currentVersion:b.requestVersionId};return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CONFERENCE_STATE,a,{conferenceStateResponse:b})}g.fromConferenceStateRequest=a;g.toConferenceStateResponse=b}),98);
__d("ZenonMWDataMessageTranslator",["ZenonActorHooks","ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.body.dataMessageRequest;if(a){var c=a.message.header,e=d("ZenonMWTranslatorUtils").getGenericDataMessageData(a);a=d("ZenonMWTranslatorUtils").getGenericDataMessageTopic(a);if(e!=null&&a!=null){c={data:e,eventName:"genericDataMessageRequest",recipientIDs:(e=c.recipients)!=null?e:[],serviceRecipients:(e=c.serviceRecipients)!=null?e:[],topic:a};b.push(c)}}return b}function b(a,b){var c={data:b.data,topic:b.topic};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE,a,{dataMessageRequest:{message:{body:{genericMessage:c},header:{recipients:b.recipientIDs,sender:d("ZenonActorHooks").ZenonActor.getID(),serviceRecipients:b.serviceRecipients,topic_DEPRECATED:""}}}})}function c(a){return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE,a,{dataMessageResponse:{deliveryResult:{}}})}g.fromDataMessageRequest=a;g.toDataMessageRequest=b;g.toDataMessageResponse=c}),98);
__d("ZenonMWDismissTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.body.dismissRequest;if(a){var c=a.detailedReasonString;a=a.reason;a={eventName:"terminateRequest",fromJoinResponse:!1,reason:d("ZenonMWTranslatorUtils").fromMWDismissReason(a),shouldInformPeer:!0,subreason:c};b.push(a)}return b}function b(a){return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DISMISS,a,{})}g.fromDismissRequest=a;g.toDismissResponse=b}),98);
__d("ZenonMWHangupTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"hangupResponse"};b.push(a);return b}function b(a,b){b=b.reason;b={detailedReasonString:"",reason:d("ZenonMWTranslatorUtils").toMWHangupReason(b)};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.HANGUP,a,{hangupRequest:b})}g.fromHangupResponse=a;g.toHangupRequest=b}),98);
__d("ZenonMWIceCandidateTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.body.iceCandidateRequest;if(a){a={eventName:"iceCandidateRequest",iceCandidates:a.iceCandidateSdps.map(function(a){var b;return{candidateSdpString:(b=a.candidateSdpString)!=null?b:"",sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex}})};b.push(a)}return b}function b(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"iceCandidateResponse"};b.push(a);return b}function c(a){return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE,a,{})}function e(a,b){b=b.iceCandidates;b=b.map(function(a){return{candidateSdpString:a.candidateSdpString,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex}});b={iceCandidateSdps:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE,a,{iceCandidateRequest:b})}g.fromIceCandidateRequest=a;g.fromIceCandidateResponse=b;g.toIceCandidateResponse=c;g.toIceCandidateRequest=e}),98);
__d("MultiwaySharedTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({UNKNOWN:0,SFU:1,P2P:2});d=a({UNKNOWN:0,GROUP:1,IGVIDEOCALL:9,ROOM:15,DEBUGTOOL:16,CRUCIBLE:20,MBS_WA:21,BOT:22,HORIZON:23});f=a({OFFER:0,PRANSWER:1,ANSWER:2,PROFFER:3});b=a({LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4});var g=a({E2EE_NOT_MANDATED:0,DEPRECATED_NO_REQUIREMENT:1,E2EE_MANDATED:2}),h=a({NOT_SET:0,CONTROL:1,TEST:2}),i=a({NotPaused:0,Paused:1}),j=a({AUDIO:0,VIDEO:1,DATA:2}),k=a({UDP:1,TCP:2}),l=a({DEFAULT:0,DIRECT_XPOP:1,PSEUDO_QUIC:2,OVERRIDE:3}),m=a({UNKNOWN:0,COMPOSITING_SERVICE:1,MEDIA_SERVER:2,CATHODE_AMBISONIC:3,CATHODE_CAPTIONS:4,CATHODE_MEETING_SUMMARIZER:5,CATHODE_REALTIME_SHARED_STATE:6,RP_GENAI_SERVICE:7}),n=a({CNAME:0,TRACK:1,DOMINANT_SPEAKER:2}),o=a({UNKNOWN:0,DEFAULT:1,SCREEN_SHARE:2}),p=a({UNSPECIFIED:0,FNA:1,FNA_PREFERRED:2});a=a({IntValue:"intValue",StringValue:"stringValue"});e.exports={ConferenceType:d,E2eeInfraMandatedExpStatus:h,E2eeMode:g,EdgerayType:p,EndpointServiceType:m,MediaPath:c,MediaPauseStatus:i,MediaType:j,ProxygenCandidateProtocol:k,ProxygenVipType:l,QuickExperimentValue$Types:a,RenderedStreamType:o,SdpType:f,SubscriptionType:n,VideoQuality:b}}),null);
__d("ZenonJoiningContext",[],(function(a,b,c,d,e,f){"use strict";b="joining_context";function a(a){var b=a.callablePostID,c=a.callingTags,d=a.callTrigger,e=a.conferenceName,f=a.groupThreadID,g=a.igThreadID,h=a.immersiveModeDoorID,i=a.isMetaAiCall,j=a.linkUrl,k=a.liveBroadcastID,l=a.meetingID,m=a.peerID,n=a.rtcDoorID;a=a.serverInfoData;return{call_trigger:d,callable_post_id:b,calling_tags:c,conference_name:e,group_thread_id:f,ig_thread_id:g,immersive_mode_door_id:h,is_meta_ai_call:i,link_url:j,live_broadcast_id:k,meeting_id:l,peer_id:m,rtc_door_id:n,server_info_data:a}}f.JOINING_CONTEXT_TOPIC=b;f.convertCollisionToJoiningContext=a}),66);
__d("ZenonBrowsers",["UserAgent","UserAgentData"],(function(a,b,c,d,e,f,g){"use strict";function h(){return c("UserAgent").isBrowser("Chrome")}function i(){return!!navigator.webkitGetUserMedia}function a(){return c("UserAgent").isBrowser("Edge (Chromium Based)")||c("UserAgent").isBrowser("Edge PWA (Chromium Based)")}function j(){return c("UserAgent").isBrowser("Safari")}function k(){return c("UserAgent").isBrowser("Firefox")}function b(){return c("UserAgent").isBrowser("Opera")}function l(){return c("UserAgent").isBrowser("Mobile Safari")}function m(){return c("UserAgent").isBrowser("Oculus Browser")}function n(){return c("UserAgent").isBrowser("Samsung Browser")}function d(){return l()||c("UserAgent").isPlatform("Android")||n()}function o(){return c("UserAgent").isPlatform("Android")||c("UserAgent").isPlatform("iOS")}function p(){if(k()){var a;return(a=c("UserAgentData").browserVersion)!=null?a:0}if(i()){a=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return a!=null?parseInt(a[2],10):999}return 0}function q(){return c("UserAgent").isBrowser("FBLite")||c("UserAgent").isBrowser("Facebook for Android")}function e(a){if(!q())return!1;var b=p();return b>=a}function f(){return k()}function r(){return k()||j()||c("UserAgent").isBrowser("Chrome >= 97")}function s(){return!o()&&(c("UserAgent").isBrowser("Chrome >= 51")||c("UserAgent").isBrowser("Opera >= 36"))}function t(){return c("UserAgent").isBrowser("Firefox < 60")||c("UserAgent").isBrowser("Edge")}function u(){return!m()}function v(){return!m()}function w(){return!l()&&!j()&&!((i()||h())&&p()<80)&&!(k()&&p()<70)}function x(){return(i()||h())&&p()>=77||c("UserAgent").isBrowser("Firefox >= 70")||c("UserAgent").isBrowser("Safari >= 14.1")}function y(){return c("UserAgent").isBrowser("Chrome >= 89")||c("UserAgent").isBrowser("Opera >= 75")||c("UserAgent").isBrowser("Edge (Chromium Based) >= 89")||c("UserAgent").isBrowser("Edge PWA (Chromium Based) >= 89")}g.isChrome=h;g.isChromium=i;g.isChromiumBasedEdge=a;g.isDesktopSafari=j;g.isFirefox=k;g.isOpera=b;g.isMobileSafari=l;g.isOculusBrowser=m;g.isSamsung=n;g.isSupportedMobileBrowser=d;g.isMobileDevice=o;g.webrtcVersion=p;g.isFBWebview=q;g.isFBWebviewWithChromeMinVersion=e;g.noTransceiverForNegotiations=f;g.onlySupportsUnifiedPlan=r;g.isVideoFilterEffectSupported=s;g.videoEscalationByUnmuteWorkaround=t;g.supportsMWAVEscalation=u;g.supportsVideoCalls=v;g.supportsRollback=w;g.supportsIceRestart=x;g.isVideoLayersAllocationSupported=y}),98);
__d("ZenonIGMediaUtil",["ZenonAppProvider","gkx"],(function(a,b,c,d,e,f,g){"use strict";a={shouldUseSFUOnly:function(){return d("ZenonAppProvider").isInstagramApp()&&!c("gkx")("2274")}};b=a;g["default"]=b}),98);
__d("shouldUseSFUMediaPath",["ZenonAppProvider","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=c("gkx")("25249");if(b)return!0;return d("ZenonAppProvider").isMessengerWebApp()&&a&&((b=c("gkx")("3298"))!=null?b:!1)?!0:!1}g["default"]=a}),98);
__d("ZenonMWJoinUtils",["ZenonBrowsers","ZenonIGMediaUtil","gkx","shouldUseSFUMediaPath"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("ZenonBrowsers").isFirefox()&&a!=="answer"?!1:!c("ZenonIGMediaUtil").shouldUseSFUOnly()}function b(){return c("shouldUseSFUMediaPath")(!1)?!1:c("gkx")("25223")}g.canUseMwpp=a;g.canDeescalate=b}),98);
__d("ZenonMWJoinTranslator",["MultiwaySharedTypes","RoboticsPermission","ZenonAuditedCheckpointLogId","ZenonDismissReason","ZenonInfraActionsLogger","ZenonJoiningContext","ZenonMWCommonUtils","ZenonMWJoinUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils","ZenonScreenShare","gkx","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],e=a.jsonPayload.header,f=e.responseStatusCode,g=e.responseSubCode;if(f&&f!==d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK){g="JOIN response status code: "+f+" subcode "+((g=g)!=null?g:"[undefined]");c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",checkpoint:"[ZP] Got non-OK "+g,errorDomain:"ZenonMWMessageTranslator.fromJoinResponse"});f={detailedReasonFromMW:e.responseStatusMessage,eventName:"terminateRequest",fromJoinResponse:!0,reason:h(f,e.responseSubCode),shouldInformPeer:!1,subreason:g};b.push(f);return b}g=a.jsonPayload.body.joinResponse;if(!g)return b;f=(a=(f=g.answer)==null?void 0:f.sdpString)!=null?a:"";a=f!=="";d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(g.stateStore,b,!1,a);d("ZenonMWTranslatorUtils").maybeAddOverlayConfigServerUpdateRequest(b,e);var i=d("ZenonMWTranslatorUtils").fetchE2eeServerState(g.stateStore);e={ackMessageId:e.transactionId,eventName:"localSdpResponse",hasAnswerInJoinResponse:a,source:"joinResponse"};b.push(e);if(a){e={sdp:f,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(f)};a=d("ZenonMWTranslatorUtils").toZenonMediaStates(g.mediaStatusEx);f=g.renegotiationOffer;var j=null;f!=null&&f.sdpString!=null&&(j={sdp:f.sdpString,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(f.sdpString)});f={e2eeServerState:i,eventName:"remoteSdpRequest",mediaPath:g.mediaPath,mediaStates:a,negotiateType:!1,renegotiationOffer:j,sdp:e,sdpOriginLocalId:g.sdpOriginLocalId,source:"joinResponse"};b.push(f)}i={capabilities:{addParticipantEnabled:!0,cowatchEnabled:!0,cowatchGroupEnabled:!0,multipleVideoStreamsAllowed:g.multipleVideoStreamsAllowed},eventName:"capabilitiesRequest"};b.push(i);if(g.isPendingApproval){a={eventName:"pendingApprovalRequest"};b.push(a)}j=g.groupsOfUsers;var k=new Map();j.forEach(function(a){var b=a.aliasId;a=a.users;b!=null&&a.forEach(function(a){k.set(a,b)})});e={actorRepresentatives:k,eventName:"clientInfoRequest",mediaPath:g.mediaPath,userCapabilities:new Map()};b.push(e);return b}function b(a,b,e,f){var g,h=b.initialSyncStates,k=b.isSecondaryJoinRole,l=b.userCapabilities;g={clientMediaMode:j(e.mediaMode),deviceCapabilities:[(g=d("ZenonMWMessageTypes")).ZenonMWCapability.SUPPORT_NEW_PARTICIPANT_STATES,g.ZenonMWCapability.REQUIRE_FULL_SDP_IN_SMU,g.ZenonMWCapability.SUPPORT_SDP_RENEGOTIATION,g.ZenonMWCapability.REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED,g.ZenonMWCapability.SUPPORT_DELTA_SMU].concat(c("gkx")("25225")?[d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_PRECONNECT]:[]),mediaStatus:d("ZenonMWTranslatorUtils").toMWMediaStatus(e.mediaStates),mediaStatusEx:d("ZenonMWTranslatorUtils").toMWMediaStatusEx(e.mediaStates),offer:{},syncPayload:h?{stateStore:d("ZenonMWTranslatorUtils").toMWSyncStateStore(h)}:void 0,userCapabilities:l.get(a.userInfo.userID)};k!=null&&(g.endpointSettings={joinMode:k?d("ZenonMWMessageTypes").ZenonMWJoinMode.SECONDARY:d("ZenonMWMessageTypes").ZenonMWJoinMode.PRIMARY});h=b.isE2eeMandated===!0;g.e2eeEnforcement={infraMandatedExpStatus:(l=b.e2eeInfraMandatedExpStatus)!=null?l:d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.NOT_SET,mode:h?d("ZenonMWMessageTypes").ZenonMWE2eeMode.E2EE_MANDATED:d("ZenonMWMessageTypes").ZenonMWE2eeMode.E2EE_NOT_MANDATED};e.sdp.type==="offer"&&(g.offer={sdpString:e.sdp.sdp});d("ZenonMWJoinUtils").canUseMwpp(e.sdp.type)&&(g.deviceCapabilities.push(d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_MWPP),e.sdp.type==="answer"&&(g.answer={sdpString:e.sdp.sdp}),d("ZenonMWJoinUtils").canDeescalate()&&g.deviceCapabilities.push(d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_MWPP_DEESCALATION));(!d("ZenonScreenShare").screenShareWithReplaceTrack()||c("RoboticsPermission").is_authorized_robot)&&g.deviceCapabilities.push(d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_MULTIPLE_VIDEO_STREAMS);k=f==null?void 0:f.otherParticipants;k&&(g.usersToCall=k);b=[];e=(l=f==null?void 0:f.roomInfo.context)!=null?l:a.roomInfo.context;if(e!=null){l=d("ZenonJoiningContext").convertCollisionToJoiningContext(e);h&&(l.calling_tags=2);b=[].concat(b,[{body:{genericMessage:{data:JSON.stringify(l),topic:d("ZenonJoiningContext").JOINING_CONTEXT_TOPIC}},header:{topic_DEPRECATED:d("ZenonJoiningContext").JOINING_CONTEXT_TOPIC}}])}(f==null?void 0:f.appMessages)!=null&&(b=[].concat(b,d("ZenonMWTranslatorUtils").signalingMessageAppMessagesToMWAppMessages(f.appMessages,k)));g.appMessages=b;h=d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN,a,{joinRequest:g});e&&e.serverInfoData!=null&&(h.jsonPayload.header.serverInfoData=e.serverInfoData);i(e,h.jsonPayload.header)&&(h.jsonPayload.header.conferenceType=d("ZenonMWMessageTypes").ZenonMWConferenceType.ROOM);return h}function h(a,b){if(b===d("ZenonMWMessageTypes").ZenonMWResponseSubCode.EXCEEDED_MAX_ALLOWED_PARTICIPANTS)return d("ZenonDismissReason").ZenonDismissReason.MaxAllowedParticipantsReached;if(b===d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PRODUCT_SERVER_DEFINED_END_REASON)return d("ZenonDismissReason").ZenonDismissReason.ProductServerDefinedEndReason;switch(a){case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.METHOD_NOT_ALLOWED:case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.UNAUTHORIZED:return d("ZenonDismissReason").ZenonDismissReason.NoPermission;case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.SERVICE_UNAVAILABLE:return d("ZenonDismissReason").ZenonDismissReason.SignalingMessageFailed;case d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK:throw c("unrecoverableViolation")("Response status code is OK; should not return a dismiss reason","rtc_www");default:c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",error:"[ZP] Got unexpected JOIN response status: "+a+" subcode "+((a=b)!=null?a:"[undefined]"),errorDomain:"fromMWJoinResponseStatusToDismissReason"});return d("ZenonDismissReason").ZenonDismissReason.UnexpectedEndOfCall}}function i(a,b){return((a==null?void 0:a.peerID)!=null||(a==null?void 0:a.groupThreadID)!=null)&&b.conferenceName==null}function j(a){return a==="p2p"?d("ZenonMWMessageTypes").ZenonMWMediaPath.P2P:d("ZenonMWMessageTypes").ZenonMWMediaPath.SFU}g.fromJoinResponse=a;g.toJoinRequest=b}),98);
__d("ZenonMWPingTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"pingResponse"};b.push(a);return b}function b(a){var b=Object.freeze({});return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.PING,a,{pingRequest:b})}g.fromPingResponse=a;g.toPingRequest=b}),98);
__d("ZenonMWRingTranslator",["ZenonMWCommonUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){if(b)return{groupThreadID:b.groupThreadId,peerID:b.peerId,serverInfoData:c};b=d("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(a);b&&(b.serverInfoData=c);return(a=b)!=null?a:{groupThreadID:null,peerID:null,serverInfoData:c}}function a(a,b){var c=[];a=a.jsonPayload;var e=a.body;a=a.header;e=e.ringRequest;if(e){var f=e.appMessages,g=e.caller,i=e.e2eeEnforcement,j=e.otherParticipants,k=e.ringType,l=e.sdpOriginLocalId,m=e.threadIdInfo;g=g;k=k===d("ZenonMWMessageTypes").ZenonMWRingType.PEER_VIDEO_CALL||k===d("ZenonMWMessageTypes").ZenonMWRingType.GROUP_VIDEO_CALL||k===d("ZenonMWMessageTypes").ZenonMWRingType.LIVE_STREAM||k===d("ZenonMWMessageTypes").ZenonMWRingType.PEER_ESCALATED_AUDIO_CALL;var n=a.conferenceName;a=a.serverInfoData;m=h(f,m,a);var o=d("ZenonMWTranslatorUtils").getRoomMetadataFromAppMessages(f);g={actorID:b.actorID,e2eeInfraMandatedExpStatus:i==null?void 0:i.infraMandatedExpStatus,eventName:"inviteRequest",inviterID:g,isE2eeMandated:(i==null?void 0:i.mode)===d("ZenonMWMessageTypes").ZenonMWE2eeMode.E2EE_MANDATED,isRemoteOfferer:!1,otherParticipants:j,requestingVideo:k,roomInfo:babelHelpers["extends"]({context:m,name:n},o==null?{}:{room:o,sender:o.sender}),serverInfoData:a,userID:b.userInfo.userID};f!=null&&(g.appMessages=d("ZenonMWTranslatorUtils").mwAppMessagesToSignalingAppMessages(f));c.push(g);k=(j=(i=e.offer)==null?void 0:i.sdpString)!=null?j:"";n=(m=e.mediaStatusEx)!=null?m:null;if(k!==""&&n!=null){o={sdp:k,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(k)};a=d("ZenonMWTranslatorUtils").toZenonMediaStates(n);b={eventName:"remoteSdpRequest",mediaPath:e.mediaPath,mediaStates:a,negotiateType:!1,sdp:o,sdpOriginLocalId:l,source:"ringRequest"};c.push(b)}}return c}function b(a,b){b=b.status;b==="IN_ANOTHER_CALL"&&(a.signalingID=null);b=d("ZenonMWTranslatorUtils").toMWDeviceStatus(b);b={deviceCapabilities:[d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_AUDIO_DEPRECATED,d("ZenonMWMessageTypes").ZenonMWCapability.SUPPORT_VIDEO_DEPRECATED],deviceStatus:b};return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.RING,a,{ringResponse:b})}g.fromRingRequest=a;g.toRingResponse=b}),98);
__d("ZenonMWServerMediaUpdateTranslator",["FBLogger","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWCommonUtils","ZenonMWMessageReliabilityLogger","ZenonMWMessageTypes","ZenonMWTranslatorUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],e=a.jsonPayload,f=e.body;e=e.header;f=f.serverMediaUpdateRequest;var g=e.messageTags,i=e.transactionId;if(!f)return b;var j=f.answer,k=f.fromVersion,l=f.mediaPath,m=f.mediaStatus,n=f.multipleVideoStreamsAllowed,o=f.offer,p=f.prAnswer,q=f.renegotiationRequested,r=f.sdpOriginLocalId,s=f.stateStore,t=f.toVersion;f=f.update;o=(o=o==null?void 0:o.sdpString)!=null?o:"";j=(j=j==null?void 0:j.sdpString)!=null?j:"";p=(p=p==null?void 0:p.sdpString)!=null?p:"";var u=function(){d("ZenonMWMessageReliabilityLogger").logProcessedMessage(a)},v=o!=="",w=j!=="",x=c("gkx")("25225")&&p!=="",y=f!==null;y=v||w||x||y;d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(s,b,!1,y);y=d("ZenonMWTranslatorUtils").fetchE2eeServerState(s);if(q){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 1: renegotationRequested"});q={ackMessageId:i,eventName:"initiateRenegotiationRequest",fromVersion:k,hasRemoteOffer:o!=="",mediaPath:l,messageTags:(s=g)!=null?s:[],onProcessed:u,version:t};b.push(q);if(v){s=h(i,k,l,m,{sdp:o,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(o)},r,u,g,y);b.push(s)}}else if(w){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 2: answer SDP"});q=h(i,k,l,m,{sdp:j,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(j)},r,u,g,y);if(q.sdp.sdp!=null&&d("ZenonMWCommonUtils").isUnifiedPlan(q.sdp.sdp)){s={sdp:j,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(j)};q.renegotiationOffer=s}b.push(q)}else if(v){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 3: offer SDP"});w=h(i,k,l,m,{sdp:o,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(o)},r,u,g,y);b.push(w)}else if(f){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 4: delta SDP"});j=h(i,k,l,m,{type:"offer",update:f,version:t},r,u,g,y);b.push(j)}else if(x){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 5: prAnswer SDP"});s=h(i,k,l,m,{sdp:p,type:"pranswer",version:d("ZenonMWCommonUtils").getSdpVersion(p)},r,u,g,y);b.push(s)}else if(m){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 6: media update"});v={ackMessageId:i,eventName:"mediaUpdateRequest",mediaStates:d("ZenonMWTranslatorUtils").toZenonMediaStates(m,k,t),messageTags:(q=g)!=null?q:[],onProcessed:u};b.push(v)}else{o="Warning: unsupported SMU type. TXID: "+i;c("FBLogger")("rpweb").warn(o);c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:o,errorDomain:"ZenonMWServerMediaUpdateTranslator"})}d("ZenonMWTranslatorUtils").maybeAddOverlayConfigServerUpdateRequest(b,e);f={capabilities:{multipleVideoStreamsAllowed:n},eventName:"capabilitiesRequest",messageTags:(w=g)!=null?w:[]};b.push(f);return b}function h(a,b,c,e,f,g,h,i,j){return{ackMessageId:a,e2eeServerState:j,eventName:"remoteSdpRequest",fromVersion:b,mediaPath:c,mediaStates:d("ZenonMWTranslatorUtils").toZenonMediaStates(e),messageTags:(a=i)!=null?a:[],negotiateType:!1,onProcessed:h,sdp:f,sdpOriginLocalId:g,source:"serverMediaUpdateRequest"}}function b(a,b,c,e){return i(a,b.acknowledgedVersion,d("ZenonMWTranslatorUtils").toMWResponseStatusCode(b.statusCode),d("ZenonMWTranslatorUtils").toMWResponseStatusSubCode(b.subCode),c,e)}function e(a,b){return i(a,b.acknowledgedVersion,d("ZenonMWTranslatorUtils").toMWResponseStatusCode(b.statusCode),d("ZenonMWTranslatorUtils").toMWResponseStatusSubCode(b.subCode))}function f(a,b){return i(a,b.acknowledgedVersion,(a=b.responseStatusCode)!=null?a:d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.CONDITIONAL_REQUEST_FAILED,b.responseSubCode)}function i(a,b,c,e,f,g){b={currentVersion:b};f&&(b.mediaStatus=d("ZenonMWTranslatorUtils").toMWClientMediaStatus(f));g&&(b.answer={sdpString:g.sdp});return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE,a,{serverMediaUpdateResponse:b},c,e)}g.fromServerMediaUpdateRequest=a;g.toServerMediaUpdateResponse=b;g.toServerMediaUpdateRenegotiationResponse=e;g.toServerMediaUpdateNoSdpResponse=f}),98);
__d("ZenonMWStateSyncTranslator",["RequestStreamBodyUtils","ZenonMWMessageTypes","ZenonMWTranslatorUtils","ZenonStateSyncPayloadSerializer"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.jsonPayload;var b=a.body.updateResponse;a=a.header.transactionId;if(!b)return[];var c=b.topic;b=b.version;a={ackMessageId:a,eventName:"stateSyncUpdateResponse",topic:c,version:b};return[a]}function b(a){a=a.jsonPayload.body.notifyRequest;if(!a)return[];var b=[];if(a.syncPayload!=null)d("ZenonMWTranslatorUtils").addStateStoreSignalingEvents(a.syncPayload.stateStore,b,!0,!1);else{var c=a.data,e=a.topic;a=a.version;c={data:d("ZenonStateSyncPayloadSerializer").stateSyncStringToUint8Array(c),eventName:"stateSyncNotifyRequest",responseRequired:!0,topic:e,version:a};b.push(c)}return b}function c(a){a=a.jsonPayload;var b=a.body.unsubscribeResponse;a=a.header.transactionId;if(!b)return[];var c=b.topic;b=b.version;a={ackMessageId:a,eventName:"stateSyncUnsubscribeResponse",topic:c,version:b};return[a]}function e(a,b){var c=b.data,e=b.topic;b=b.version;c={data:c?d("RequestStreamBodyUtils").uint8ArrayToBase64(c):void 0,topic:e,version:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UPDATE,a,{updateRequest:c})}function f(a,b){var c=b.topic;b=b.version;c={topic:c,version:b};return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.NOTIFY,a,{notifyResponse:c})}function h(a,b){var c=b.topic;b=b.version;c={topic:c,version:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UNSUBSCRIBE,a,{unsubscribeRequest:c})}g.fromUpdateResponse=a;g.fromNotifyRequest=b;g.fromUnsubscribeResponse=c;g.toUpdateRequest=e;g.toNotifyResponse=f;g.toUnsubscribeRequest=h}),98);
__d("ZenonMWSubscriptionTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=b.subscriptions;b={subscriptions:b};return d("ZenonMWTranslatorUtils").createMWRequest(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SUBSCRIPTION,a,{subscriptionRequest:b})}g.toSubscriptionRequest=a}),98);
__d("ZenonMWWakeupTranslator",["ZenonMWMessageTypes","ZenonMWTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"wakeupRequest"};b.push(a);return b}function b(a){var b=Object.freeze({});return d("ZenonMWTranslatorUtils").createMWResponse(d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.WAKEUP,a,{wakeupResponse:b})}g.fromWakeupRequest=a;g.toWakeupResponse=b}),98);
__d("ZenonSignalingMessage",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getHeader=function(){return this.$1};b.getEvents=function(){return this.$2};b.setSignalingID=function(a){this.$1.signalingID=a};b.setRetryCount=function(a){this.$1.retryCount=a};return a}();f["default"]=a}),66);
__d("ZenonMWMessageTranslator",["FBLogger","ZenonActorHooks","ZenonMWAddRemoveParticipantsTranslator","ZenonMWApprovalTranslator","ZenonMWClientEventTranslator","ZenonMWClientMediaUpdateTranslator","ZenonMWConferenceStateTranslator","ZenonMWDataMessageTranslator","ZenonMWDismissTranslator","ZenonMWHangupTranslator","ZenonMWIceCandidateTranslator","ZenonMWJoinTranslator","ZenonMWMessageTypes","ZenonMWPingTranslator","ZenonMWRingTranslator","ZenonMWServerMediaUpdateTranslator","ZenonMWStateSyncTranslator","ZenonMWSubscriptionTranslator","ZenonMWTranslatorUtils","ZenonMWWakeupTranslator","ZenonSignalingMessage","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.getHeader();a=a.getEvents();if(a.length===0)throw c("unrecoverableViolation")("Unexpected Translation: called toMWMessage with empty signaling events","rtc_www");else{var e=a[0];switch(e.eventName){case"addParticipantsRequest":return d("ZenonMWAddRemoveParticipantsTranslator").toAddParticipantsRequest(b,e);case"clientEventRequest":return d("ZenonMWClientEventTranslator").toClientEventRequest(b,e);case"clientInfoRequest":if(a.length>=2&&a[1].eventName==="localSdpRequest"&&(a[1].sdp.type==="offer"||a[1].sdp.type==="answer"))return d("ZenonMWJoinTranslator").toJoinRequest(b,e,a[1]);break;case"genericDataMessageRequest":return d("ZenonMWDataMessageTranslator").toDataMessageRequest(b,e);case"inviteRequest":if(a.length>=3&&a[1].eventName==="clientInfoRequest"&&a[2].eventName==="localSdpRequest"&&a[2].sdp.type==="offer")return d("ZenonMWJoinTranslator").toJoinRequest(b,a[1],a[2],e);break;case"genericDataMessageResponse":return d("ZenonMWDataMessageTranslator").toDataMessageResponse(b);case"inviteResponse":return d("ZenonMWRingTranslator").toRingResponse(b,e);case"dismissResponse":return d("ZenonMWDismissTranslator").toDismissResponse(b);case"initiateRenegotiationResponse":if(a.length>=3&&a[1].eventName==="remoteSdpResponse"&&a[2].eventName==="localSdpRequest"&&a[2].sdp.type==="answer")return d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,a[1],a[2].mediaStates,a[2].sdp);else return d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateRenegotiationResponse(b,e);case"iceCandidateRequest":return d("ZenonMWIceCandidateTranslator").toIceCandidateRequest(b,e);case"iceCandidateResponse":return d("ZenonMWIceCandidateTranslator").toIceCandidateResponse(b);case"localSdpRequest":return d("ZenonMWClientMediaUpdateTranslator").toClientMediaUpdateRequest(b,e.mediaStates,e.sdp);case"mediaUpdateRequest":return d("ZenonMWClientMediaUpdateTranslator").toClientMediaUpdateRequest(b,e.mediaStates);case"mediaUpdateResponse":return d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateNoSdpResponse(b,e);case"participantUpdateResponse":return d("ZenonMWConferenceStateTranslator").toConferenceStateResponse(b,e);case"pingRequest":return d("ZenonMWPingTranslator").toPingRequest(b);case"remoteSdpResponse":return e.type==="offer"&&(a.length>=2&&a[1].eventName==="localSdpRequest"&&a[1].sdp.type==="answer")?a[1].mediaMode!=="p2p"?d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,e,a[1].mediaStates):d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,e,a[1].mediaStates,a[1].sdp):d("ZenonMWServerMediaUpdateTranslator").toServerMediaUpdateResponse(b,e);case"removeParticipantsRequest":return d("ZenonMWAddRemoveParticipantsTranslator").toRemoveParticipantsRequest(b,e);case"stateSyncNotifyResponse":return d("ZenonMWStateSyncTranslator").toNotifyResponse(b,e);case"stateSyncUnsubscribeRequest":return d("ZenonMWStateSyncTranslator").toUnsubscribeRequest(b,e);case"stateSyncUpdateRequest":return d("ZenonMWStateSyncTranslator").toUpdateRequest(b,e);case"subscriptionRequest":return d("ZenonMWSubscriptionTranslator").toSubscriptionRequest(b,e);case"terminateRequest":return d("ZenonMWHangupTranslator").toHangupRequest(b,e);case"usersApprovalRequest":return d("ZenonMWApprovalTranslator").toApprovalRequest(b,e);case"wakeupResponse":return d("ZenonMWWakeupTranslator").toWakeupResponse(b)}}return null}function b(a){var b=a.jsonPayload.header,e=h(b);if(e!=null){c("FBLogger")("rtc_www").info("Ignoring JSON MW message; receiver does not match self ID: "+e,"rtc_www");return null}e=b.type;var f=b.responseStatusCode==null;b=d("ZenonMWTranslatorUtils").mwMessageHeaderToSignalingMessageHeader(b);var g=[];switch(e){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.RING:f&&(g=d("ZenonMWRingTranslator").fromRingRequest(a,b));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DISMISS:f&&(g=d("ZenonMWDismissTranslator").fromDismissRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:f||(g=d("ZenonMWJoinTranslator").fromJoinResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:f?g=d("ZenonMWIceCandidateTranslator").fromIceCandidateRequest(a):g=d("ZenonMWIceCandidateTranslator").fromIceCandidateResponse(a);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CONFERENCE_STATE:f&&(g=d("ZenonMWConferenceStateTranslator").fromConferenceStateRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:f||(g=d("ZenonMWClientMediaUpdateTranslator").fromClientMediaUpdateResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:f&&(g=d("ZenonMWServerMediaUpdateTranslator").fromServerMediaUpdateRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.PING:f||(g=d("ZenonMWPingTranslator").fromPingResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.HANGUP:f||(g=d("ZenonMWHangupTranslator").fromHangupResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE:f&&(g=d("ZenonMWDataMessageTranslator").fromDataMessageRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UPDATE:f||(g=d("ZenonMWStateSyncTranslator").fromUpdateResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.UNSUBSCRIBE:f||(g=d("ZenonMWStateSyncTranslator").fromUnsubscribeResponse(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.NOTIFY:f&&(g=d("ZenonMWStateSyncTranslator").fromNotifyRequest(a));break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.WAKEUP:f&&(g=d("ZenonMWWakeupTranslator").fromWakeupRequest(a))}return new(c("ZenonSignalingMessage"))(b,g)}function h(a){var b,c=a.receiverUserId;if(d("ZenonActorHooks").ZenonActor.isInstagramUser()||d("ZenonActorHooks").ZenonActor.isOculusUser()||c==null)return null;if(c===d("ZenonActorHooks").ZenonActor.getID()||((b=a.receiver)==null?void 0:b.baseId)===d("ZenonActorHooks").ZenonActor.getAccountID())return null;if(c!==d("ZenonActorHooks").ZenonActor.getID()&&((b=a.receiver)==null?void 0:b.baseId)==null)return"receiverUserId mismatch and missing header.receiver.baseId";return c!==d("ZenonActorHooks").ZenonActor.getID()&&((b=a.receiver)==null?void 0:b.baseId)!==d("ZenonActorHooks").ZenonActor.getAccountID()?"receiverUserId mismatch and mismatched header.receiver.baseId":"unknown error"}g.toMWMessage=a;g.toSignalingMessage=b}),98);
__d("TCompactProtocol",["StringToUtf8","ThriftTypes","Utf8ToString"],(function(a,b,c,d,e,f,g){var h,i=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),j=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:i.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:i.CT_BOOLEAN_FALSE}),k=[i.CT_STOP,0,i.CT_BOOLEAN_TRUE,i.CT_BYTE,i.CT_DOUBLE,0,i.CT_I16,0,i.CT_I32,0,i.CT_I64,i.CT_BINARY,i.CT_STRUCT,i.CT_MAP,i.CT_SET,i.CT_LIST,0,0,0,i.CT_FLOAT],l=Math.pow(2,7)-1,m=-1*Math.pow(2,7),n=Math.pow(2,15)-1,o=-1*Math.pow(2,15),p=Math.pow(2,31)-1,q=-1*Math.pow(2,31),r=Math.pow(2,32)-1,s=BigInt("9223372036854775807"),t=BigInt("-9223372036854775808"),u=BigInt("18446744073709551615"),v=BigInt(63),w=BigInt(1),x=BigInt(7),y=BigInt("0x7f"),z=BigInt("0x80"),A=Math.pow(2,4);a=function(){function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var b=a.prototype;b.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};b.readStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};b.writeStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeFieldBegin=function(a){if(a.ftype===(h||(h=c("ThriftTypes"))).BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,j.NONE)};b.writeListBegin=function(a){return this.$8(a)};b.writeListEnd=function(){return 0};b.writeSetBegin=function(a){return this.$8(a)};b.writeSetEnd=function(){return 0};b.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};b.writeMapEnd=function(){return 0};b.$7=function(a,b){var c=0;b=b===j.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=A-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};b.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=A-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};b.readFieldBegin=function(){var a=this.$1.readByte(),b=a&15;if(b===(h||(h=c("ThriftTypes"))).STOP)return{ftype:(h||(h=c("ThriftTypes"))).STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(b);(b===i.CT_BOOLEAN_TRUE||b===i.CT_BOOLEAN_FALSE)&&(this.$5=b===i.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};b.readListBegin=function(){return this.$11()};b.readListEnd=function(){return 0};b.readSetBegin=function(){return this.$11()};b.readSetEnd=function(){return 0};b.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};b.readMapEnd=function(){return 0};b.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};b.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};b.readFieldEnd=function(){return 0};b.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};b.writeByte=function(a){if(a<m||a>l)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};b.readFloat=function(){return this.$1.readFloatBE()};b.writeFloat=function(a){return this.$1.writeFloatBE(a)};b.readDouble=function(){return this.$1.readDoubleBE()};b.writeDouble=function(a){return this.$1.writeDoubleBE(a)};b.writeString=function(a){return this.writeBinary(d("StringToUtf8").StringToUtf8(a))};b.skip=function(a){switch(a){case(h||(h=c("ThriftTypes"))).STOP:return;case(h||(h=c("ThriftTypes"))).BOOL:this.readBool();break;case(h||(h=c("ThriftTypes"))).BYTE:this.readByte();break;case(h||(h=c("ThriftTypes"))).DOUBLE:this.readDouble();break;case(h||(h=c("ThriftTypes"))).I16:this.readI16();break;case(h||(h=c("ThriftTypes"))).I32:this.readI32();break;case(h||(h=c("ThriftTypes"))).I64:this.readI64();break;case(h||(h=c("ThriftTypes"))).STRING:this.readString();break;case(h||(h=c("ThriftTypes"))).STRUCT:this.readStructBegin();var b;while(!0){b=this.readFieldBegin();if(b.ftype===(h||(h=c("ThriftTypes"))).STOP)break;this.skip(b.ftype)}this.readStructEnd();break;case(h||(h=c("ThriftTypes"))).MAP:b=this.readMapBegin();if(b.size>0&&b.ktype!=null&&b.vtype!=null){var d=b.ktype,e=b.vtype;for(var f=0;f<b.size;f++)this.skip(d),this.skip(e)}break;case(h||(h=c("ThriftTypes"))).SET:case(h||(h=c("ThriftTypes"))).LIST:f=this.$11();for(d=0;d<f.size;d++)this.skip(f.etype);break;case(h||(h=c("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};b.toByteArray=function(){return this.$1.toByteArray()};b.writeFieldEnd=function(){return 0};b.writeFieldStop=function(){return this.$1.writeByte((h||(h=c("ThriftTypes"))).STOP)};b.writeI16=function(a){if(a<o||a>n)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<o||a>n)throw new Error("read invalid i16: "+a);return a};b.writeI32=function(a){if(a<q||a>p)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI32=function(){return this.zigzagToI32(this.readVarint32())};b.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};b.readI64=function(){return this.zigzagToI64(this.readVarint64())};b.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===i.CT_BOOLEAN_TRUE;return a};b.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?j.CT_BOOLEAN_TRUE:j.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?i.CT_BOOLEAN_TRUE:i.CT_BOOLEAN_FALSE);return b};b.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};b.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};b.i32ToZigzag=function(a){if(a<q||a>p)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};b.zigzagToI32=function(a){if(a<0||a>r)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};b.i64ToZigzag=function(a){if(a>s||a<t)throw new Error("i64 out of range: "+a.toString());return a>>v^a<<w};b.zigzagToI64=function(a){if(a<0||a>u)throw new Error("invalid uint64: "+a.toString());return(a&w)===w?~(a>>w):a>>w};b.writeVarint32=function(a){if(a<0||a>r)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};b.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};b.writeVarint64=function(a){if(a<0||a>u)throw new Error("invalid uint64: "+a.toString());a=a;var b=0;while(!0)if(a>>x==0){this.$1.writeByte(Number(a));b++;break}else this.$1.writeByte(Number(a&y|z)),b++,a>>=x;return b};b.readVarint64=function(){var a=BigInt(0),b=BigInt(0),c;while(!0){c=BigInt(this.$1.readByte());a|=(c&y)<<b;b+=x;if((c&z)==0){if(b==70&&c!==w)throw new Error("result exceeded 64 bit limit");break}if(b>63)throw new Error("result exceeded 64 bit limit")}return a};b.readString=function(){return d("Utf8ToString").Utf8ToString(this.readBinary())};b.getLastFieldId=function(){return this.$3};b.getLastField=function(){return this.$2};b.getBooleanFieldInfo=function(){return this.$4};b.getBooleanValue=function(){return this.$5};b.$9=function(a){return k[a]};b.$10=function(a){switch(a){case i.CT_STOP:return(h||(h=c("ThriftTypes"))).STOP;case i.CT_BOOLEAN_FALSE:case i.CT_BOOLEAN_TRUE:return(h||(h=c("ThriftTypes"))).BOOL;case i.CT_BYTE:return(h||(h=c("ThriftTypes"))).BYTE;case i.CT_I16:return(h||(h=c("ThriftTypes"))).I16;case i.CT_I32:return(h||(h=c("ThriftTypes"))).I32;case i.CT_I64:return(h||(h=c("ThriftTypes"))).I64;case i.CT_DOUBLE:return(h||(h=c("ThriftTypes"))).DOUBLE;case i.CT_FLOAT:return(h||(h=c("ThriftTypes"))).FLOAT;case i.CT_BINARY:return(h||(h=c("ThriftTypes"))).STRING;case i.CT_LIST:return(h||(h=c("ThriftTypes"))).LIST;case i.CT_SET:return(h||(h=c("ThriftTypes"))).SET;case i.CT_MAP:return(h||(h=c("ThriftTypes"))).MAP;case i.CT_STRUCT:return(h||(h=c("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}};return a}();g["default"]=a}),98);
__d("decodeIgSignalingPayload",["TCompactProtocol","TReadBuffer","ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h,i=2;function a(a){a=new(c("TReadBuffer"))(a);a=new(c("TCompactProtocol"))(a);var b=null;a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case i:e===(h||(h=c("ThriftTypes"))).STRING?b=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}g["default"]=a}),98);
__d("shouldUseThriftSignaling",["ZenonActorHooks","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("ZenonActorHooks").ZenonActor.isOculusCastingUser()?c("justknobx")._("2788"):c("gkx")("25251")||c("gkx")("25252")}g["default"]=a}),98);
__d("IgSignalingListener",["FBLogger","IGDOverLSMqttChannel","JSResourceForInteraction","Promise","RequestStreamBodyUtils","ZenonMWMessageDebugLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","decodeIgSignalingPayload","nullthrows","promiseDone","recoverableViolation","shouldUseThriftSignaling"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("IGDOverLSMqttChannel").waitAndGetInstance();a=function(){function a(){}var e=a.prototype;e.setLoggingEventHandler=function(a){this.$1=a};e.subscribe=function(a,e,f){var g=this;c("promiseDone")(i.then(function(i){i.subscribeBinary("/pubsub",function(i){try{i=c("nullthrows")(c("decodeIgSignalingPayload")(i));var j=JSON.parse(i);i={endpoint:j.payload.endpoint,jsonPayload:{body:j.payload.body,header:j.payload.header}};if(c("shouldUseThriftSignaling")()){var k,l=(k=c("JSResourceForInteraction"))("ZenonMWThriftMessageSerializer").__setRef("IgSignalingListener").load(),m=k("ZenonMWThriftMessageReliabilityLogger").__setRef("IgSignalingListener").load(),n=k("ZenonMWThriftMessageDebugLogger").__setRef("IgSignalingListener").load();k=k("ZenonMWThriftMessageTranslator").__setRef("IgSignalingListener").load();(h||(h=b("Promise"))).all([l,m,n,k]).then(function(b){var c=b[0],e=b[1],h=b[2];b=b[3];var i=d("RequestStreamBodyUtils").base64ToUint8Array(j.binaryPayload);c=c.deserializeMWThriftMessage(i,!0);e.logReceivedMessage(c);h.logMWThriftMessage("RECEIVED","MQTT Thrift",c);g.$1&&g.$1({mwThriftMessage:c,name:"mwThriftMessageRecv"});i=b.toSignalingMessage(c);if(i==null)return;a(i);f&&g.$2(c,i,f);e.logProcessingMessage(c)})["catch"](function(a){c("FBLogger")("rpweb").catching(a).mustfix("Error receiving MQTT message from /pubsub topic")})}else{d("ZenonMWMessageReliabilityLogger").logReceivedMessage(i);c("ZenonMWMessageDebugLogger").logMWMessage("RECEIVED","MQTT",i);g.$1&&g.$1({mwMessage:i,name:"mwMessageRecv"});l=d("ZenonMWMessageTranslator").toSignalingMessage(i);if(l==null)return;a(l);e&&l&&g.$3(i,l,e);d("ZenonMWMessageReliabilityLogger").logProcessingMessage(i)}}catch(a){c("FBLogger")("rpweb").catching(a).mustfix("Error Cannot load modules")}})}))};e.unsubscribe=function(){c("promiseDone")(i.then(function(a){a.unsubscribeAll("/webrtc"),a.unsubscribeAll("/pubsub")}))};e.$3=function(a,b,d){try{d(a,b)}catch(a){c("recoverableViolation")("Signaling messages should be json parsable. error:"+a,"rtweb")}};e.$2=function(a,b,d){try{d(a,b)}catch(a){c("recoverableViolation")("Signaling messages should be json parsable. error:"+a,"rtweb")}};return a}();g["default"]=a}),98);
__d("InstagramWebDiscoveryModuleFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2843");b=d("FalcoLoggerInternal").create("instagram_web_discovery_module",a);e=b;g["default"]=e}),98);
__d("LazyLoadInstance",["asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h={LOADING:1,NOT_READY:0,READY:2};a=function(){function a(a,b){this.$1={instantiate:b,moduleReference:a,stage:h.NOT_READY}}var d=a.prototype;d.get=function(a){switch(this.$1.stage){case h.NOT_READY:c("promiseDone")(this.$2(this.$1),a);break;case h.LOADING:c("promiseDone")(this.$1.instancePromise,a);break;case h.READY:a(this.$1.instance);break}};d.getNow=function(){return this.$1.stage===h.READY?this.$1.instance:null};d.preload=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){this.$1.stage===h.NOT_READY&&(yield this.$2(this.$1))});function c(){return a.apply(this,arguments)}return c}();d.$2=function(a){var b=this,c=a.instantiate;a=a.moduleReference;a=a.load().then(function(a){a=c(a);b.$1={instance:a,stage:h.READY};return a});this.$1={instancePromise:a,stage:h.LOADING};return a};return a}();g["default"]=a}),98);
__d("LsRtcEndCallSurveyFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1743882");b=d("FalcoLoggerInternal").create("ls_rtc_end_call_survey",a);e=b;g["default"]=e}),98);
__d("LsRtcStarRatingFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1743884");b=d("FalcoLoggerInternal").create("ls_rtc_star_rating",a);e=b;g["default"]=e}),98);
__d("OverlayConfigDefaults",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze([1,0,0,20,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,640,360,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,0,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,0,1,-1,-1,-1,-1,-1,-1,1,1,0,2e3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1e3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,16e3,2e4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6e4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2e3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);b=a;f["default"]=b}),66);
__d("OverlayConfigDefaultsLayer",["OverlayConfigDefaults","OverlayConfigLayerSource"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}var b=a.prototype;b.getLayerSource=function(){return c("OverlayConfigLayerSource").DEFAULT};b.getValue=function(a){return c("OverlayConfigDefaults")[a]};b.logExposure=function(a){};return a}();g["default"]=a}),98);
__d("OverlayConfigLayerManager",["OverlayConfigConstants","OverlayConfigDefaultsLayer","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[new(c("OverlayConfigDefaultsLayer"))()]}var b=a.prototype;b.getValue=function(a){for(var b=this.$1.length-1;b>=0;b--){var d=this.$1[b].getValue(a);if(d>c("OverlayConfigConstants").OverlayConfigNotPresentFlagValue)return d}throw c("unrecoverableViolation")("OverlayConfigLayerManager: No value found for id "+String(a),"rtc_www")};b.addLayer=function(a){this.$1.push(a);return this.$1.length-1};b.replaceLayer=function(a,b){if(a===0)throw c("unrecoverableViolation")("OverlayConfigLayerManager: Tried to replace default layer!","rtc_www");else if(this.$1[a]==null)throw c("unrecoverableViolation")("OverlayConfigLayerManager: Layer does not exist at index "+String(a),"rtc_www");this.$1[a]=b};b.clone=function(){var b=new a();b.$1=this.$1.slice();return b};return a}();g["default"]=a}),98);
__d("OverlayConfigManager",["Configs","OverlayConfigLayerManager"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("Configs")).ExampleConfig,h=a.SimulcastOverSignalingConfig,i=a.PreferredCaptureConfig,j=a.ZenonSdpTransformConfig,k=a.ZenonPeerConnectionConfig,l=a.ZenonStartCallImmediatelyConfig,m=a.ZenonGeneralizedIdentityConfig,n=a.ZenonMultiCallSupportConfig,o=a.ZenonPlatformSupportConfig,p=a.ZenonSimulcastConfig,q=a.DynamicRuleConfig,r=a.SignalingPingConfig;c=function(){function a(){this.layerManager=new(b("OverlayConfigLayerManager"))()}var c=a.prototype;c.getExampleConfig=function(){return new g(this.layerManager)};c.getSimulcastOverSignalingConfig=function(){return new h(this.layerManager)};c.getPreferredCaptureConfig=function(){return new i(this.layerManager)};c.getZenonSdpTransformConfig=function(){return new j(this.layerManager)};c.getZenonPeerConnectionConfig=function(){return new k(this.layerManager)};c.getZenonStartCallImmediatelyConfig=function(){return new l(this.layerManager)};c.getZenonGeneralizedIdentityConfig=function(){return new m(this.layerManager)};c.getZenonMultiCallSupportConfig=function(){return new n(this.layerManager)};c.getZenonPlatformSupportConfig=function(){return new o(this.layerManager)};c.getZenonSimulcastConfig=function(){return new p(this.layerManager)};c.getDynamicRuleConfig=function(){return new q(this.layerManager)};c.getSignalingPingConfig=function(){return new r(this.layerManager)};return a}();e.exports=c}),null);
__d("OverlayConfigManagerWithServerLayer",["OverlayConfigManager"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this)||this;c.$OverlayConfigManagerWithServerLayer$p_1=-1;b!=null&&(c.layerManager=b.layerManager.clone());return c}var c=b.prototype;c.setServerLayer=function(a){if(this.$OverlayConfigManagerWithServerLayer$p_1>-1){this.layerManager.replaceLayer(this.$OverlayConfigManagerWithServerLayer$p_1,a);return}this.$OverlayConfigManagerWithServerLayer$p_1=this.layerManager.addLayer(a)};return b}(c("OverlayConfigManager"));g["default"]=a}),98);
__d("PolarisAppStoreLauncher.react",["InstagramODS","PolarisUA","polarisGetInstallAppHref","react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");var i="launch_app_store",j="instagram_carbon",k="utm_campaign",l="utm_medium";b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var e=b.prototype;e.componentDidMount=function(){var a=new URLSearchParams(location.search);if(a.get(i)){var b=new URL(location.href),e=a.get(j)==="true";b.searchParams["delete"](i);b.searchParams["delete"](j);history.replaceState({},document.title,b.toString());if(!d("PolarisUA").isDesktop())if(e){c("InstagramODS").incr("web.logging.preload_ods.iglite_open_app_store");c("InstagramODS").incr("web.logging.preload_ods.polaris_iglite_open_app_store");b=a.get(k);e=a.get(l);location.href=d("polarisGetInstallAppHref").getInstallIGLiteCarbonAppHref(b!=null&&b!==""?b:"instagramlitecarbon",e!=null?e:"")}else location.href=d("polarisGetInstallAppHref").getInstallAppHref()}};e.render=function(){return null};return b}(a.PureComponent);g["default"]=b}),98);
__d("PolarisLiveCreationModalLazy.react",["CometPlaceholder.react","IGCoreModal.react","IGDSBox.react","IGDSSpinner.react","JSResourceForInteraction","PolarisSizing","lazyLoadComponent","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h,k=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisLiveCreationModal.react").__setRef("PolarisLiveCreationModalLazy.react"));function a(a){var b=i(3),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=j.jsx(c("IGCoreModal.react"),{backdropColor:"dark",children:j.jsx(c("IGDSBox.react"),{alignItems:"center",height:112,justifyContent:"center",maxWidth:d("PolarisSizing").FEED_WIDTH_WIDE,position:"relative",width:"100%",children:j.jsx(c("IGDSSpinner.react"),{size:"medium"})})}),b[0]=e):e=b[0];b[1]!==a?(e=j.jsx(c("CometPlaceholder.react"),{fallback:e,children:j.jsx(k,babelHelpers["extends"]({},a))}),b[1]=a,b[2]=e):e=b[2];return e}g["default"]=a}),98);
__d("PolarisGlobalUIComponents.react",["CometErrorBoundary.react","CometPlaceholder.react","PolarisAppStoreLauncher.react","PolarisCallGatingHelpers","PolarisConfig","PolarisIsLiveProducerEnabled","PolarisLiveCreationModalLazy.react","PolarisOneTapLogin","PolarisQPConstants","PolarisReactRedux.react","PolarisSwitchAccountsModalLazy.react","PolarisToastWrapper.react","PolarisUA","cr:1609","cr:3106","cr:4692","cr:4779","cr:4839","cr:8738","cr:9681","polarisNavigationSelectors","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("react"))).c,k=i,l={mobileToast:{marginBottom:"xx7atzb",$$css:!0}};function a(a){var e=j(23),f=a.hasMobileNavs,g=a.pageIdentifier;a=a.viewer;var i=d("PolarisReactRedux.react").useSelector(d("polarisNavigationSelectors").getHideNavQueryParam),n=d("PolarisReactRedux.react").useSelector(m),o=n.isAccountSwitcherOpen;n=n.isLiveCreationModalOpen;var p;e[0]!==n?(p=!d("PolarisUA").isMobile()&&n&&d("PolarisIsLiveProducerEnabled").isLiveProducerEnabled()?k.jsx(c("PolarisLiveCreationModalLazy.react"),{}):null,e[0]=n,e[1]=p):p=e[1];n=p;p=f&&!!a&&l.mobileToast;e[2]!==p?(f=(h||(h=c("stylex")))(p),e[2]=p,e[3]=f):f=e[3];e[4]!==f?(p=k.jsx(c("PolarisToastWrapper.react"),{className:f}),e[4]=f,e[5]=p):p=e[5];var q;e[6]===Symbol["for"]("react.memo_cache_sentinel")?(f=b("cr:9681")!=null&&k.jsx(b("cr:9681"),{slot:d("PolarisQPConstants").SLOTS.app_start}),q=d("PolarisUA").isMobile()&&d("PolarisOneTapLogin").isCAASpiDialogEligible()&&b("cr:8738")&&k.jsx(b("cr:8738"),{}),e[6]=f,e[7]=q):(f=e[6],q=e[7]);var r;e[8]!==o?(r=o&&d("PolarisConfig").isLoggedIn()&&k.jsx("div",{children:k.jsx(c("PolarisSwitchAccountsModalLazy.react"),{})}),e[8]=o,e[9]=r):r=e[9];e[10]===Symbol["for"]("react.memo_cache_sentinel")?(o=k.jsx(c("CometErrorBoundary.react"),{children:b("cr:4779")!=null&&d("PolarisCallGatingHelpers").isIncomingCallEnabled()?b("cr:4692")!=null?k.jsx(b("cr:4692"),{children:k.jsx(b("cr:4779"),{})}):k.jsx(b("cr:4779"),{}):null}),e[10]=o):o=e[10];var s;e[11]===Symbol["for"]("react.memo_cache_sentinel")?(s=b("cr:3106")&&k.jsx(b("cr:3106"),{}),e[11]=s):s=e[11];var t;e[12]!==i||e[13]!==g||e[14]!==a?(t=d("PolarisConfig").probablyHasApp()&&!i&&b("cr:1609")&&k.jsx("div",{children:k.jsx(b("cr:1609"),{pageID:g,viewer:a})}),e[12]=i,e[13]=g,e[14]=a,e[15]=t):t=e[15];e[16]===Symbol["for"]("react.memo_cache_sentinel")?(i=k.jsx(c("PolarisAppStoreLauncher.react"),{}),g=b("cr:4839")!=null?k.jsx(c("CometPlaceholder.react"),{fallback:null,children:k.jsx(b("cr:4839"),{})}):null,e[16]=i,e[17]=g):(i=e[16],g=e[17]);e[18]!==p||e[19]!==r||e[20]!==n||e[21]!==t?(a=k.jsxs(k.Fragment,{children:[p,f,q,r,o,n,s,t,i,g]}),e[18]=p,e[19]=r,e[20]=n,e[21]=t,e[22]=a):a=e[22];return a}function m(a){return a.navigation}g["default"]=a}),98);
__d("PolarisLoggedOutExploreModuleLogger",["CometRouteURL","InstagramWebDiscoveryModuleFalcoEvent","PolarisLogger","PolarisLoggerUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.component,e=a.containermodule,f=a.eventName,g=a.key;c("InstagramWebDiscoveryModuleFalcoEvent").log(function(){var a;return babelHelpers["extends"]({},d("PolarisLogger").getExtra(babelHelpers["extends"]({component:b,containermodule:e,event_name:f},g!=null&&{category:g})),{objid:d("PolarisLoggerUtils").trimAndSanitizeUrl((a=d("CometRouteURL").getWindowURL())!=null?a:"")})})}g.logExploreModuleEvent=a}),98);
__d("RTWebDropInUtils",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";var h="drop_in_metadata";a=function(a){var b;return b={},b[h]=JSON.stringify({is_drop_in:a?"1":"0"}),b};b=function(a){a=i(a);a=a.isDropIn;return a};var i=function(a){a=a==null?void 0:a[h];if(a!=null)try{a=JSON.parse(a);return{isDropIn:a.is_drop_in==="1"}}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to parse drop_in_metadata app message");return{isDropIn:!1}}return{isDropIn:!1}};g.getDropInAppMessages=a;g.isDropInFromAppMessages=b}),98);
__d("ZenonCallWindowOpener_Popup",["UserAgent","ZenonUserActionLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=1280,i={LargeForGroup:{height:772,width:1100},LargeForP2P:{height:720,width:1280},Small:{height:540,width:960}},j=["menubar=no","location=no","scrollbars=no","status=no","personalbar=no"];a=function(){function a(){}var b=a.prototype;b.openWindow=function(a){a=this.$1(a.joinContext);var b=this.$2(a),e=b.left;b=b.top;d("ZenonUserActionLogger").logCheckpoint({checkpoint:"Opening_Popup: left="+e+",top="+b+",width="+a.width+",height="+a.height});var f=c("UserAgent").isBrowser("Safari")?window.location.hostname:"";return window.open(f,"",[].concat(j,["height="+a.height,"width="+a.width,"left="+e,"top="+b]).join(","))};b.$1=function(a){if(screen&&screen.width>h)if(a.type==="link"||a.thread.type===2)return{height:i.LargeForGroup.height,width:i.LargeForGroup.width};else return{height:i.LargeForP2P.height,width:i.LargeForP2P.width};else return{height:i.Small.height,width:i.Small.width}};b.$2=function(a){var b=a.height;a=a.width;return{left:Math.floor(window.innerWidth/2-a/2+((a=window.screenLeft)!=null?a:window.screenX)),top:Math.floor(window.innerHeight/2-b/2+((a=window.screenTop)!=null?a:window.screenY))}};return a}();g["default"]=a}),98);
__d("RTWebCallWindowOpener",["RTWebDropInUtils","ZenonCallWindowOpener_Popup"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new(c("ZenonCallWindowOpener_Popup"))()}var b=a.prototype;b.openWindow=function(a){if(a.context.intent==="accept invite"&&a.context.controllerParams.appMessages!=null){var b=d("RTWebDropInUtils").isDropInFromAppMessages(a.context.controllerParams.appMessages);if(b)return babelHelpers["extends"]({},window,{close:function(){return null}})}return this.$1.openWindow(a)};return a}();g["default"]=a}),98);
__d("RtcDoorCallingTags",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({OPEN:0,VANISHING:1,SECRET:2,THREADS_APP_HANGOUTS:4,REELS_TOGETHER:8,CANVAS:32,WORKROOMS:64,LEAD_GEN:128,COPRESENCE:256});c=a;f["default"]=c}),66);
__d("TokenBucketRateLimit",["DateConsts"],(function(a,b,c,d,e,f,g){"use strict";var h=1e3;a=function(){function a(a,b){this.$1=a*h,this.$2=a*h,this.$3=Date.now(),this.$4=b*h}var b=a.prototype;b.take=function(a){a===void 0&&(a=1);a=a*h;this.$5();if(this.$2<a)return!1;this.$2-=a;return!0};b.$5=function(){if(this.$2>=this.$1)return;var a=Date.now(),b=(a-this.$3)/d("DateConsts").MS_PER_SEC;b=Math.round(b*this.$4);if(b===0)return;this.$2=Math.min(this.$1,this.$2+b);this.$3=a};return a}();g["default"]=a}),98);
__d("WebAssemblyMemorySingleton",[],(function(a,b,c,d,e,f){"use strict";var g=64*1024;c=5701632;d=45*g;var h=c+d,i=null,j=0,k=0;function a(){i==null&&(i=new WebAssembly.Memory({initial:h/g,maximum:2147483648/g}),j=h);return i}function b(){if(i!=null){var a=i.buffer.byteLength;a!==j&&(k++,j=a)}return{memory_reallocation_count:k,memory_size_kb:j/1024}}e={INITIAL_MEMORY_ALLOCATED_IN_BYTES:h,get:a,getMetrics:b};f.WebAssemblyMemorySingleton=e}),66);
__d("ZenonCallFalcoEventUtils",["performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return String(Math.trunc(a))};a=function(){return i((h||(h=c("performanceNow")))())};b=function(a){return i((a=a)!=null?a:0)};d=function(a){return a==null?null:i((a=a)!=null?a:0)};e=function(a){return(a=a)!=null?a:""};g.truncateNumber=i;g.performanceNowParsed=a;g.nonNullIntNumber=b;g.intNumberOrNull=d;g.nonNullString=e}),98);
__d("ZenonCallInfoManager",["ZenonDeviceId"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.callTrigger,c=a.conferenceName,e=a.isCaller,f=a.isVideo,g=a.localCallID,h=a.peerID,i=a.protocol,j=a.serverInfoData;a=a.signalingID;var k=d("ZenonDeviceId").getZenonLocalStorageDeviceIdWithFallback();c={callTrigger:(b=b)!=null?b:"",conferenceName:(b=c)!=null?b:"",deviceID:k,isCaller:e,isVideo:f,localCallID:g,peerID:h,protocol:i,signalingID:a};this.$1=babelHelpers["extends"]({},c,{serverInfoData:j})}var b=a.prototype;b.setDeviceID=function(a){this.$1.deviceID=a};b.setSharedCallId=function(a){this.$1.serverInfoData=a};b.getCallInfo=function(){return this.$1};return a}();g["default"]=a}),98);
__d("ZenonCallInviteModelTypes",[],(function(a,b,c,d,e,f){"use strict";a={missed:"missed",ringing:"ringing",unsupported_browser:"unsupported_browser"};f.CallInviteModelType=a}),66);
__d("ZenonCallInviteModel",["BaseEventEmitter","FBLogger","ZenonCallInviteModelTypes","ZenonIncomingRingSDKTypes"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var e;e=a.call(this)||this;e.$ZenonCallInviteModel$p_2=function(a){c("FBLogger")("rtc_www").info("Received cancel for: ",a.ringID);if(e.__currentRequest&&e.__currentRequest.model&&e.__currentRequest.model.ringID===a.ringID)switch(a.reason){case d("ZenonIncomingRingSDKTypes").ZenonCancelReason.Hangup:a=((a=e.__currentRequest)==null?void 0:(a=a.model)==null?void 0:a.type)!==d("ZenonCallInviteModelTypes").CallInviteModelType.unsupported_browser;e.__currentRequest.model=babelHelpers["extends"]({},e.__currentRequest.model,{type:"missed"});a&&e.emit("callInvite",e.__currentRequest.model);break;case d("ZenonIncomingRingSDKTypes").ZenonCancelReason.OtherDismiss:e.dismiss();break}};e.$ZenonCallInviteModel$p_1=function(a){var b;c("FBLogger")("rtc_www").info("Receiving ring: ",a.ringID);if(((b=e.__currentRequest)==null?void 0:(b=b.model)==null?void 0:b.type)==="ringing")return;e.__currentRequest={model:{actorID:a.actorID,context:a.context,controllerParams:a.controllerParams,inviterID:a.inviterID,isE2eeMandated:a.isE2eeMandated,participants:a.otherParticipants,receiverUserId:a.receiverUserId,requestingVideo:a.requestingVideo,ringID:a.ringID,ringRequest:a.ringRequest,type:a.isClientPermissableRing?"ringing":"unsupported_browser"},ringPayload:a};e.emit("callInvite",e.__currentRequest.model);a.isClientPermissableRing||a.onDecline("VersionUnsupported")};e.__eventSource=b;e.__currentRequest=null;return e}var e=b.prototype;e.getCurrentInvite=function(){var a;return(a=(a=this.__currentRequest)==null?void 0:a.model)!=null?a:null};e.startListening=function(a){a=a.callsBlocked;this.__currentRequest&&this.dismiss();this.stopListening();a||(this.__eventSource.addListener("incomingRing",this.$ZenonCallInviteModel$p_1),this.__eventSource.addListener("ringCancel",this.$ZenonCallInviteModel$p_2))};e.stopListening=function(){this.__eventSource.removeAllListeners("incomingRing"),this.__eventSource.removeAllListeners("ringCancel"),this.__currentRequest=null};e.dismiss=function(){var a;c("FBLogger")("rtc_www").info("Dismissing ring: ",(a=this.__currentRequest)==null?void 0:(a=a.model)==null?void 0:a.ringID);this.__currentRequest=null;this.emit("callInvite",null)};e.accept=function(a,b){var d=this.__currentRequest;if(d){var e;c("FBLogger")("rtc_www").info("Accepting ring: ",(e=d.model)==null?void 0:e.ringID);((e=d.model)==null?void 0:e.type)==="ringing"&&d.ringPayload.onAccept(a,b);this.dismiss()}};e.decline=function(a,b){a===void 0&&(a="IgnoreCall");var d=this.__currentRequest;if(d){var e;c("FBLogger")("rtc_www").info("Declining ring: ",(e=d.model)==null?void 0:e.ringID);d.ringPayload.onDecline(a,b);this.dismiss();return}};return b}(c("BaseEventEmitter"));g["default"]=a}),98);
__d("ZenonLogPromiseRejection",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a["catch"](function(a){return c("FBLogger")("rtc_www").catching(a).debug(a.message)})}g["default"]=a}),98);
__d("ZenonCallLogger",["Promise","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonLogPromiseRejection","isEmployeeTestUserZenonLogging","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Set(["mwMessageSent","mwThriftMessageSent","mwMessageRecv","mwThriftMessageRecv","setMediaStats","updateE2EEStats","updateIceInfo","setRemoteSdpOffer"]),j=new Set(["atLeastOneParticipantAlerted","atLeastOneParticipantAnswered"]);a=function(){function a(a){var b=this,c=a.config,d=a.initLoggerInfo,e=a.isE2eeMandated;a=a.processorConfigs;this.$5=[];this.$6=new Set();this.$1=d;this.$2=c;this.$3=e;this.$4={clientSessionID:d.signalingID,localCallID:d.localCallID,peerID:d.peerID,sharedCallID:d.serverInfoData};a.forEach(function(a){b.addLogProcessor(a)})}var d=a.prototype;d.addLogProcessor=function(a){var b=this;if(this.$3&&!a.approvedForMandatedE2ee())return;this.$5.push(new a.LogProcessor({config:this.$2,data:this.$1,isE2eeMandated:this.$3,updateLogIdentifiers:function(a){return b.updateLogIdentifiers(a)}}))};d.updateLogIdentifiers=function(a){Object.assign(this.$4,a),this.log({logIdentifiers:a,name:"updateLogIdentifiers"})};d.log=function(a){if(j.has(a.name)&&this.$6.has(a.name))return;this.$6.add(a.name);this.$7(a);c("promiseDone")(this.logToProcessors(a))};d.logToProcessors=function(a){return c("ZenonLogPromiseRejection")((h||(h=b("Promise"))).all(this.$5.map(function(b){return b.processEvent(a)})).then(function(){}))};d.$7=function(a){if(!c("isEmployeeTestUserZenonLogging")())return;if(i.has(a.name))return;c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] ZenonCallLogger event: "+a.name})};d.getLogIdentifiers=function(){return this.$4};return a}();g["default"]=a}),98);
__d("ZenonCallWindowController",["FBLogger","Promise","ZenonCallWindowErrors"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b){var c=b.callWindowInitializerResource,d=b.callWindowOpener;b=b.uriBuilderResource;this.$2=null;this.$3=!1;this.$5=null;this.$1=a;this.$7=b;this.$4=c;this.$6=d}var e=a.prototype;e.initCall=function(a){var e=this;if(this.$3)throw new(d("ZenonCallWindowErrors").OpeningAnotherCallError)();try{if(this.$2&&!this.$2.closed&&a.joinContext.type==="thread"&&this.$2.inCallWith===a.joinContext.thread.id){this.$2.focus();return[this.$2,(h||(h=b("Promise"))).resolve({alohaEscalatedMW:!1})]}}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to access inCallWith on call window")}var f=this.$6.openWindow(a);try{this.$2&&(this.$2.closed||this.$2.close(),this.$2=null)}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to access close on call window")}this.$2=f;this.$3=!0;return[f,(h||(h=b("Promise"))).all([this.$7.load(),this.$4.load()]).then(function(b){var c=b[0];b=b[1];e.$5===null&&(e.$5=new b(e.$1,new c(e.$1)));return e.$5.initCall(e.$2,a)})["finally"](function(){e.$3=!1})]};return a}();g["default"]=a}),98);
__d("ZenonClientPerfQPLConstants",[],(function(a,b,c,d,e,f){"use strict";a="zenon_popup_opened";b="zenon_call_join_request";c="zenon_sfu_e2ee_negotiation_complete";d="csm_outgoing_start";e="csm_incoming_connection_started";var g="csm_invite_sent",h="csm_invite_ack_recv",i="csm_answer_recv",j="csm_answer_sdp_recv",k="csm_pranswer_sdp_recv",l="csm_offer_sdp_recv",m="csm_answer_sent",n="csm_negotiation_complete",o="csm_network_ready",p="csm_connection_ready",q="csm_dismiss_sent",r="csm_dismiss_recv",s="signaling_mw_join_req_sent",t="signaling_mw_join_response_recv";f.POINT_ZENON_POPUP_OPENED=a;f.POINT_ZENON_CALL_JOIN_REQUEST=b;f.POINT_ZENON_SFU_E2EE_NEGOTIATION_COMPLETE=c;f.POINT_CONNECTION_OUTGOING_START=d;f.POINT_CONNECTION_INCOMING_CONNECTION_STARTED=e;f.POINT_CONNECTION_INVITE_SENT=g;f.POINT_CONNECTION_INVITE_ACK_RECV=h;f.POINT_CONNECTION_ANSWER_RECV=i;f.POINT_CONNECTION_ANSWER_SDP_RECV=j;f.POINT_CONNECTION_PRANSWER_SDP_RECV=k;f.POINT_CONNECTION_OFFER_SDP_RECV=l;f.POINT_CONNECTION_ANSWER_SENT=m;f.POINT_CONNECTION_NEGOTIATION_COMPLETE=n;f.POINT_CONNECTION_NETWORK_READY=o;f.POINT_CONNECTION_READY=p;f.POINT_CONNECTION_DISMISS_SENT=q;f.POINT_CONNECTION_DISMISS_RECV=r;f.POINT_SIGNALING_MW_JOIN_REQ_SENT=s;f.POINT_SIGNALING_MW_JOIN_RESPONSE_RECV=t}),66);
__d("ZenonCollisionContext",["RtcDoorCallingTags"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=null;a.groupThreadID!=null?c={e2eeThreadID:a.groupThreadID,id:a.groupThreadID,type:b?16:2}:a.peerID!=null&&(c={id:a.peerID,secureOneToOneThreadPeerId:b?a.peerID:void 0,type:b?15:1});return c}function b(a){var b=a.call_trigger,d=a.callable_post_id,e=a.calling_tags,f=a.conference_name,g=a.group_thread_id,h=a.ig_thread_id,i=a.immersive_mode_door_id,j=a.is_meta_ai_call,k=a.link_url,l=a.live_broadcast_id,m=a.meeting_id,n=a.peer_id,o=a.rtc_door_id;a=a.server_info_data;return{callablePostID:d,callingTags:c("RtcDoorCallingTags").cast(e),callTrigger:b,conferenceName:f,groupThreadID:g,igThreadID:h,immersiveModeDoorID:i,isMetaAiCall:j,linkUrl:k,liveBroadcastID:l,meetingID:m,peerID:n,rtcDoorID:o,serverInfoData:a}}function d(a){a===void 0&&(a={});return!Object.values(a).some(function(a){return a!=null})}g.getThreadIDAndTypeFromCollisionContext=a;g.fromRTCJoiningContext=b;g.isCollisionContextEmpty=d}),98);
__d("ZenonDeviceInfoHelper",["asyncToGeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g=-1,h=!1,i={getBatteryStats:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield i.internalGetWindow().navigator.getBattery);if(typeof a!=="function")return{level:g,placeholder:!0,wasCharged:!1};a=(yield a.call(navigator));a.charging?h=!0:a.onchargingchange=function(a){a.target.charging&&(h=!0),a.target.onchargingchange=null};return{level:a.level*100,placeholder:!1,wasCharged:h}});function c(){return a.apply(this,arguments)}return c}(),internalGetWindow:function(){return window}};a=i;f["default"]=a}),66);
__d("ZenonE2eeMandatedStateManager",["$InternalEnum","E2eeStateTypes","MultiwaySharedTypes","ZenonActorHooks","qex"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum").Mirrored(["NONE","ONLY_INFRA_MANDATED_EXP_CONTROL","ONLY_INFRA_MANDATED_EXP_TEST","INFRA_AND_PRODUCT_MANDATED"]),i=null,j=function(){function a(){this.$1=h.NONE}var b=a.prototype;b.processE2eeMandatedStateFromProductAndRing=function(a,b){this.$1=this.$2(a,b)};b.areBothInfraAndProductE2eeMandated=function(){return this.$1===h.INFRA_AND_PRODUCT_MANDATED};b.isInfraE2eeMandated=function(){return this.areBothInfraAndProductE2eeMandated()||this.$3()};b.$3=function(){return this.$1===h.ONLY_INFRA_MANDATED_EXP_TEST};b.processE2eeMandatedStateFromE2eeServerUpdate=function(a){if(this.areBothInfraAndProductE2eeMandated())return;if(a===d("E2eeStateTypes").InfraMandatedExpStatus.TEST&&this.$1===h.ONLY_INFRA_MANDATED_EXP_TEST)return;if(a===d("E2eeStateTypes").InfraMandatedExpStatus.CONTROL&&this.$1===h.ONLY_INFRA_MANDATED_EXP_CONTROL)return;this.$1=h.NONE};b.isEligibleForE2eeInfraMandatedExperiment=function(){var a;return(a=(a=c("qex")._("138"))!=null?a:c("qex")._("192"))!=null?a:!1};b.isP2pMediaPathPreferredForInfraMandatedExperiment=function(){var a;return this.$3()&&((a=(a=c("qex")._("531"))!=null?a:c("qex")._("532"))!=null?a:!1)};b.getE2eeInfraMandatedExpStatus=function(){switch(this.$1){case h.INFRA_AND_PRODUCT_MANDATED:case h.NONE:return d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.NOT_SET;case h.ONLY_INFRA_MANDATED_EXP_CONTROL:return d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.CONTROL;case h.ONLY_INFRA_MANDATED_EXP_TEST:return d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.TEST}};b.$2=function(a,b){if(a)return h.INFRA_AND_PRODUCT_MANDATED;if(d("ZenonActorHooks").ZenonActor.getAppID()===436761779744620..toString())return h.NONE;if(!this.isEligibleForE2eeInfraMandatedExperiment())return h.NONE;a=this.$4();if(b==null)return a;b=this.$5(b);if(b===h.NONE)return h.NONE;return b===h.ONLY_INFRA_MANDATED_EXP_CONTROL?a===h.ONLY_INFRA_MANDATED_EXP_TEST?h.NONE:h.ONLY_INFRA_MANDATED_EXP_CONTROL:a===h.ONLY_INFRA_MANDATED_EXP_CONTROL?h.NONE:h.ONLY_INFRA_MANDATED_EXP_TEST};b.$4=function(){var a=this.$6();if(a===d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.TEST)return h.ONLY_INFRA_MANDATED_EXP_TEST;return a===d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.CONTROL?h.ONLY_INFRA_MANDATED_EXP_CONTROL:h.NONE};b.$6=function(){var a;return(a=c("qex")._("196"))!=null?a:c("qex")._("227")};b.$5=function(a){if(a===d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.TEST)return h.ONLY_INFRA_MANDATED_EXP_TEST;return a===d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.CONTROL?h.ONLY_INFRA_MANDATED_EXP_CONTROL:h.NONE};return a}();function a(){i==null&&(i=new j());return i}e=a();g["default"]=e}),98);
__d("ZenonGenericLocalStorageStore",["CacheStorage","WebStorage","ZenonODSLogger","ZenonUserActionLogger","areEqual","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=2e3,k=3;a=function(){function a(a,b,d){this.$1=a,this.$2=new(c("CacheStorage"))(b,d)}var b=a.prototype;b.getLocalStorageObjects=function(){return this.$2.get(this.$1)||{}};b.removeLocalStorageObjects=function(a){this.mutateLocalStorageObjects(function(b){a.forEach(function(a){var c=a.peerID;a=a.signalingID;b[c]&&b[c][a]&&(delete b[c][a],Object.entries(b[c]).length===0&&delete b[c])});return b})};b.mutateLocalStorageObjects=function(a,b,d,e){var f=this;b===void 0&&(b=k);d===void 0&&(d=!1);e===void 0&&(e=null);var g=this.getLocalStorageObjects(),i=this.getLocalStorageObjects();g=a(g);var l=this.getLocalStorageObjects();(h||(h=c("areEqual")))(i,l)?(this.$2.set(this.$1,g),this.logStorageError(this.$2.getLastSetException(),e)):b>0&&(d?c("setTimeout")(function(){f.mutateLocalStorageObjects(a,b-1,!0)},j):this.mutateLocalStorageObjects(a,b-1,!0))};b.logStorageError=function(a,b){a!=null&&(d("ZenonUserActionLogger").logError({call_id:b==null?void 0:b.signalingID,error_domain:"ZenonGenericLocalStorageStore_storeLocalStorageObjects",error_type:a.name,peer_id:b==null?void 0:b.peerID}),(i||(i=c("WebStorage"))).isLocalStorageQuotaExceeded()&&c("ZenonODSLogger").logCounter("local_storage_quota_exceeded"))};return a}();g["default"]=a}),98);
__d("ZenonLoggingEventTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Send","Receive"]);c=b("$InternalEnum")({Primary:"primary",Secondary:"secondary"});d="rtc_www";f.ZenonUpdateIceInfoDirection=a;f.ZenonJoinMode=c;f.tslogSource=d}),66);
__d("ZenonMWMessageLogger",["ZenonLoggingEventTypes","ZenonMWMessageTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(),i=new Set();function a(a,b){a=a.jsonPayload;var c=a.body;a=a.header;if(h.has(a.transactionId))return;switch(a.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:c.joinRequest&&j(c.joinRequest,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:c.iceCandidateRequest&&l(c.iceCandidateRequest,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:c.clientMediaUpdateRequest&&m(c.clientMediaUpdateRequest,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:c.serverMediaUpdateResponse&&p(c.serverMediaUpdateResponse,b);break}h.add(a.transactionId)}function b(a,b){a=a.jsonPayload;var c=a.body;a=a.header;if(i.has(a.transactionId))return;switch(a.type){case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN:c.joinResponse&&k(c.joinResponse,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.ICE_CANDIDATE:c.iceCandidateRequest&&l(c.iceCandidateRequest,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.CLIENT_MEDIA_UPDATE:c.clientMediaUpdateResponse&&n(c.clientMediaUpdateResponse,b);break;case d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.SERVER_MEDIA_UPDATE:c.serverMediaUpdateRequest&&o(c.serverMediaUpdateRequest,b);break}i.add(a.transactionId)}function j(a,b){var c=a.answer;a=a.offer;b({name:"inviteSent"});q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send);c&&q(c,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function k(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function l(a,b,c){a=a.iceCandidateSdps;a.forEach(function(a){a.candidateSdpString!=null&&b({direction:c,name:"updateIceInfo",sdpString:a.candidateSdpString})})}function m(a,b){a=a.offer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function n(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function o(a,b){var c=a.answer;a=a.offer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive);c&&q(c,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function p(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function q(a,b,c){a.sdpString!=null&&b({direction:c,name:"updateIceInfo",sdpString:a.sdpString})}g.logSentMessage=a;g.logReceivedMessage=b}),98);
__d("ZenonMWSendMessageMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8002805496396921"}),null);
__d("ZenonMWSendMessageMutation.graphql",["ZenonMWSendMessageMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"RtcWebSendMultiwaySignalingMessageResponsePayload",kind:"LinkedField",name:"rtc_web_send_multiway_signaling_message",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"header",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"body",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"ZenonMWSendMessageMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"ZenonMWSendMessageMutation",selections:c},params:{id:b("ZenonMWSendMessageMutation_facebookRelayOperation"),metadata:{},name:"ZenonMWSendMessageMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("ZenonMWSendMessageMutation",["CometRelayErrorHandling","Promise","ZenonMWSendMessageMutation.graphql","asyncToGeneratorRuntime","cr:1012418","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,e){return new(i||(i=b("Promise")))(function(f,g){b("cr:1012418").commitMutation(e,{mutation:h!==void 0?h:h=b("ZenonMWSendMessageMutation.graphql"),onCompleted:function(a){return f(a)},onError:function(a){c("gkx")("20935")&&d("CometRelayErrorHandling").markErrorAsHandled(a);return g(a)},variables:{input:{message:a}}})})}function k(a){a=a.rtc_web_send_multiway_signaling_message;var b=null,c=null;a!=null&&(a.header!=null&&(b=JSON.parse(a.header)),a.body!=null&&(c=JSON.parse(a.body)));return{body:c,header:b}}function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield j(a,b));return k(a)});return l.apply(this,arguments)}g.sendMessage=a}),98);
__d("ZenonValidateMWMessage",["FBLogger","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.jsonPayload.header.type;if(a.jsonPayload.header.serverInfoData==null&&b!=null&&b!==d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.JOIN){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP][DROP] No remoteSignalingID in message: "+b});c("FBLogger")("rtc_www").warn("[ZP][DROP] No remoteSignalingID in message: "+b);return!1}return!0}g["default"]=a}),98);
__d("ZenonGraphQLMWMessageSender",["ChannelClientID","Promise","RpZenonBinaryThriftSignalingSitevarConfig","ZenonActorHooks","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonMWMessageDebugLogger","ZenonMWMessageLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","ZenonMWMessageTypes","ZenonMWSendMessageMutation","ZenonMWTranslatorUtils","ZenonValidateMWMessage","asyncToGeneratorRuntime","err","shouldUseThriftSignaling","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.$3=a;a=c("RpZenonBinaryThriftSignalingSitevarConfig").supported_message_types_mqtt.map(function(a){return d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType[a]});this.$4=new Set(a)}var e=a.prototype;e.handleResponse=function(a){var b=this.$1;if(b==null)throw c("unrecoverableViolation")("Should never have null message receiver","rtc_www");var e=a.header||null;a=a.body||null;if(e!=null&&a!=null){var f;f={endpoint:{appId:d("ZenonMWTranslatorUtils").getMWAppID(),deviceId:c("ChannelClientID").getID(),userId:(f=e.receiverUserId)!=null?f:d("ZenonActorHooks").ZenonActor.getID()},jsonPayload:{body:a,header:e}};c("ZenonMWMessageDebugLogger").logMWMessage("RECEIVED","GraphQL",f);d("ZenonMWMessageReliabilityLogger").logReceivedMessage(f);this.$2&&this.$2({mwMessage:f,name:"mwMessageRecv"});a=d("ZenonMWMessageTranslator").toSignalingMessage(f);a!=null&&(b(a),d("ZenonMWMessageReliabilityLogger").logProcessingMessage(f))}};e.$5=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("ZenonMWMessageReliabilityLogger").logSendingMessage(a);c("ZenonMWMessageDebugLogger").logMWMessage("SENDING","GraphQL",a);this.$2&&d("ZenonMWMessageLogger").logSentMessage(a,this.$2);try{var b=(yield d("ZenonMWSendMessageMutation").sendMessage(JSON.stringify(a),this.$3));d("ZenonMWMessageReliabilityLogger").logSentMessage(a);this.$2&&this.$2({mwMessage:a,name:"mwMessageSent"});this.handleResponse(b)}catch(e){b=e!=null?e.toString():"Message Send Error";d("ZenonMWMessageReliabilityLogger").logSendMessageFailed(a,"[GraphQL] "+b);c("ZenonMWMessageDebugLogger").logSendMultiwayMessageFailure(b,a.jsonPayload.header.type);e!=null&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"Failed to send MW message of type "+a.jsonPayload.header.type+". Stack Trace: "+e.stack+"."})}});function e(b){return a.apply(this,arguments)}return e}();e.sendMessage=function(a){a=d("ZenonMWMessageTranslator").toMWMessage(a);if(!a||!c("ZenonValidateMWMessage")(a))return(h||(h=b("Promise"))).reject(c("err")("Invalid MW message"));var e=a.jsonPayload.header.type;if(c("shouldUseThriftSignaling")()&&this.$4.has(a.jsonPayload.header.type))return(h||(h=b("Promise"))).resolve();return a.endpoint.userId!==d("ZenonActorHooks").ZenonActor.getAccountID()||e!==d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType.DATA_MESSAGE?this.$5(a):(h||(h=b("Promise"))).reject(c("err")("GraphQL only sends DATA_MESSAGE for Page users"))};e.setMessageReceiver=function(a){this.$1=a};e.setLoggingEventHandler=function(a){this.$2=a};return a}();g["default"]=a}),98);
__d("ZenonLSCallStartEventManager",["ZenonCallFalcoEventUtils","ZenonCallInfoManager","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonLSCallStartEventManager$p_1={},c.$ZenonLSCallStartEventManager$p_2=!1,c.$ZenonLSCallStartEventManager$p_3=!1,b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateEventTimestamp=function(a){this.$ZenonLSCallStartEventManager$p_1[a]==null&&(this.$ZenonLSCallStartEventManager$p_1[a]=d("ZenonCallFalcoEventUtils").performanceNowParsed())};c.receivedFromInvite=function(){this.$ZenonLSCallStartEventManager$p_2=!0};c.receivedFromServer=function(){this.$ZenonLSCallStartEventManager$p_3=!0};c.getStartEventData=function(){var a=this.getCallInfo();a=a.signalingID;var b=babelHelpers["extends"]({},this.getTimestamps(),this.$ZenonLSCallStartEventManager$p_4());a!==""&&(b.local_signaling_id=a);return b};c.$ZenonLSCallStartEventManager$p_4=function(){var a=this.getCallInfo(),b=a.deviceID,c=a.localCallID,e=a.peerID,f=a.serverInfoData;a=a.signalingID;return babelHelpers["extends"]({connection_logging_id:a,local_call_id:c,peer_id:d("ZenonPeerID").convertPeerIDForLogging(e),protocol:"multiway"},f!=null&&{shared_call_id:f},{steady_time_ms:d("ZenonCallFalcoEventUtils").performanceNowParsed(),system_time_ms:String(Date.now()),web_device_id:b})};c.getTimestamps=function(){return this.$ZenonLSCallStartEventManager$p_1};c.save=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.storeCallStartEventManager(c,b,this)};c["delete"]=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.removeLocalStorageObjects([{peerID:c,signalingID:b}])};c.toJsonString=function(){var a=this.getCallInfo(),b=a.signalingID;a={callInfo:a,connectionLoggingId:b,receivedFromInvite:this.$ZenonLSCallStartEventManager$p_2,receivedFromServer:this.$ZenonLSCallStartEventManager$p_3,timestamps:this.getTimestamps()};return JSON.stringify(a)};b.fromJsonString=function(a){var c;try{c=JSON.parse(a)}catch(a){return null}a=c.callInfo;a.deviceID;a=babelHelpers.objectWithoutPropertiesLoose(a,["deviceID"]);a=new b(a);a.$ZenonLSCallStartEventManager$p_2=c.receivedFromInvite;a.$ZenonLSCallStartEventManager$p_3=c.receivedFromServer;a.$ZenonLSCallStartEventManager$p_1=c.timestamps;return a};return b}(c("ZenonCallInfoManager"));g["default"]=a}),98);
__d("ZenonLSCallStartEventStore",["ZenonGenericLocalStorageStore","ZenonLSCallStartEventManager"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_LS_CALL_START_",j="ls_call_start",k=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,j,h,i)||this}var d=b.prototype;d.retrieveCallStartEventManager=function(a,b){var d=this.getLocalStorageObjects();d=d[a]?d[a][b]:null;if(d)return c("ZenonLSCallStartEventManager").fromJsonString(d.__d);else return null};d.storeCallStartEventManager=function(a,b,c){this.mutateLocalStorageObjects(function(d){d[a]||(d[a]={});d[a][b]={__d:c.toJsonString(),__t:Date.now(),__z:!0};return d},k,!1,{peerID:a,signalingID:b})};return b}(c("ZenonGenericLocalStorageStore"));b=new a();g.ZenonLSCallStartEventStoreInstance=b}),98);
__d("ZenonLSCallSummary",["ZenonCallFalcoEventUtils","ZenonCallInfoManager","ZenonDeviceInfoHelper","ZenonDismissReason","ZenonLoggingEventTypes","ZenonPeerID","asyncToGeneratorRuntime","performanceNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){babelHelpers.inheritsLoose(e,a);function e(b){var e;e=a.call(this,b)||this;e.$ZenonLSCallSummary$p_1={call_answered_time:"-1",call_connected_time:"-1",call_created_time:"-1",call_ended_time:"-1",last_updated_time:"-1"};e.$ZenonLSCallSummary$p_2=!1;e.$ZenonLSCallSummary$p_3=null;e.$ZenonLSCallSummary$p_6=null;e.$ZenonLSCallSummary$p_8=null;e.$ZenonLSCallSummary$p_9=null;e.$ZenonLSCallSummary$p_10=null;e.$ZenonLSCallSummary$p_11=null;e.$ZenonLSCallSummary$p_15=null;e.$ZenonLSCallSummary$p_19=!1;e.$ZenonLSCallSummary$p_12=b.callTrigger;e.$ZenonLSCallSummary$p_7=b.isVideo;e.$ZenonLSCallSummary$p_4=0;e.$ZenonLSCallSummary$p_14=(b=b.joinMode)!=null?b:d("ZenonLoggingEventTypes").ZenonJoinMode.Primary;e.$ZenonLSCallSummary$p_5=(h||(h=c("performanceNow")))();e.setTimestamp("call_created_time");e.updateLastUpdatedTime();c("promiseDone")(e.updateBatteryStart());return e}var f=e.prototype;f.setTimestamp=function(a){if(this.$ZenonLSCallSummary$p_1[a]!=="-1")return;this.$ZenonLSCallSummary$p_1[a]=String(this.$ZenonLSCallSummary$p_20())};f.getTimestamps=function(){return this.$ZenonLSCallSummary$p_1};f.getExtraInfo=function(){var a={};this.$ZenonLSCallSummary$p_9!=null&&!isNaN(this.$ZenonLSCallSummary$p_9)&&(a.battery_end_level=String(this.$ZenonLSCallSummary$p_9));this.$ZenonLSCallSummary$p_8!=null&&!isNaN(this.$ZenonLSCallSummary$p_8)&&(a.battery_start_level=String(this.$ZenonLSCallSummary$p_8));this.$ZenonLSCallSummary$p_10!=null&&(a.was_device_charged=this.$ZenonLSCallSummary$p_10);this.$ZenonLSCallSummary$p_11!=null&&(a.max_concurrent_connected_participant=this.$ZenonLSCallSummary$p_11);return a};f.getVideoStats=function(){var a={};if(this.$ZenonLSCallSummary$p_6!=null){var b;isNaN(this.$ZenonLSCallSummary$p_6.ld)||(a.local_video_duration=String(this.$ZenonLSCallSummary$p_6.ld));if(!isNaN((b=this.$ZenonLSCallSummary$p_6)==null?void 0:b.rd)){a.remote_video_duration=String((b=(b=this.$ZenonLSCallSummary$p_6)==null?void 0:b.rd)!=null?b:0)}}return a};f.getEndCallStats=function(){var a={};this.$ZenonLSCallSummary$p_16!=null&&(a.end_call_reason=d("ZenonDismissReason").dismissToEndCallReason(this.$ZenonLSCallSummary$p_16));this.$ZenonLSCallSummary$p_17!=null&&(a.end_call_subreason=this.$ZenonLSCallSummary$p_17);this.$ZenonLSCallSummary$p_19!=null&&(a.remote_ended=this.$ZenonLSCallSummary$p_19);this.$ZenonLSCallSummary$p_3!=null&&(a.is_connected_end=this.$ZenonLSCallSummary$p_3);return a};f.getLoggingArgs=function(){var a=this.getCallInfo(),b=a.deviceID,c=a.peerID,e=a.serverInfoData;a=a.signalingID;return{call_id:a,conf_name:(a=this.$ZenonLSCallSummary$p_13)!=null?a:"",peer_id:d("ZenonPeerID").convertPeerIDForLogging(c),serv_info:(a=e)!=null?a:"",web_device_id:b}};f.getSummaryLoggingInfo=function(){var a=this.getCallInfo(),b=a.deviceID,c=a.isCaller,e=a.localCallID,f=a.peerID,g=a.serverInfoData;a=a.signalingID;return babelHelpers["extends"]({},this.getTimestamps(),this.getExtraInfo(),this.getVideoStats(),this.getEndCallStats(),g!=null&&{shared_call_id:g},{call_trigger:(g=this.$ZenonLSCallSummary$p_12)!=null?g:"",client_session_id:a==null?null:String(a),invite_requested_video:this.$ZenonLSCallSummary$p_7,is_caller:c,join_mode:String(this.$ZenonLSCallSummary$p_14),local_call_id:e,peer_id:d("ZenonPeerID").convertPeerIDForLogging(f),rtc_actor_id:this.$ZenonLSCallSummary$p_15,steady_time:d("ZenonCallFalcoEventUtils").performanceNowParsed(),system_time:String(Date.now()),web_device_id:b})};f.onCallEscalated=function(){this.updateLastUpdatedTime()};f.onCallAccepted=function(a){this.$ZenonLSCallSummary$p_12=a,this.setTimestamp("call_answered_time"),this.updateLastUpdatedTime()};f.onCallConnected=function(){this.setTimestamp("call_connected_time"),this.updateLastUpdatedTime()};f.setMediaStats=function(a){this.$ZenonLSCallSummary$p_6=a.video,this.updateLastUpdatedTime()};f.setMaxConnectedParticipants=function(a){this.$ZenonLSCallSummary$p_11=d("ZenonCallFalcoEventUtils").nonNullIntNumber(a),this.updateLastUpdatedTime()};f.setRtcActorID=function(a){this.$ZenonLSCallSummary$p_15=a};f.unsetEndCallFields=function(){this.$ZenonLSCallSummary$p_18===!0&&(this.$ZenonLSCallSummary$p_16=null,this.$ZenonLSCallSummary$p_17=null,this.$ZenonLSCallSummary$p_19=null,this.$ZenonLSCallSummary$p_3=null,this.$ZenonLSCallSummary$p_1.call_ended_time="-1",this.$ZenonLSCallSummary$p_5=0,this.$ZenonLSCallSummary$p_18=null)};f.onCallEnded=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){this.$ZenonLSCallSummary$p_16=a,this.$ZenonLSCallSummary$p_17=d,this.$ZenonLSCallSummary$p_18=c,this.$ZenonLSCallSummary$p_19=b,this.$ZenonLSCallSummary$p_3==null&&(this.$ZenonLSCallSummary$p_3=this.$ZenonLSCallSummary$p_2),yield this.updateBatteryEnd(),this.setTimestamp("call_ended_time"),this.updateLastUpdatedTime()});function c(b,c,d,e){return a.apply(this,arguments)}return c}();f.onPCStateChange=function(a){this.$ZenonLSCallSummary$p_2=a,this.updateLastUpdatedTime()};f.updateBatteryStart=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("ZenonDeviceInfoHelper").getBatteryStats()),b=a.level;a=a.placeholder;a!==!0&&(this.$ZenonLSCallSummary$p_8=parseInt(b,10))});function d(){return a.apply(this,arguments)}return d}();f.updateBatteryEnd=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield c("ZenonDeviceInfoHelper").getBatteryStats()),b=a.level,d=a.placeholder;a=a.wasCharged;d!==!0&&(this.$ZenonLSCallSummary$p_9=parseInt(b,10),this.setDeviceCharged(a))});function d(){return a.apply(this,arguments)}return d}();f.setDeviceCharged=function(a){this.$ZenonLSCallSummary$p_10!==!0&&(this.$ZenonLSCallSummary$p_10=a)};f.setConferenceName=function(a){this.$ZenonLSCallSummary$p_13=a,this.updateLastUpdatedTime()};f.getDeviceCharged=function(){return this.$ZenonLSCallSummary$p_10};e.fromJsonString=function(a){var b;try{b=JSON.parse(a)}catch(a){return null}a=b.callInfo;var c=a.deviceID;a=babelHelpers.objectWithoutPropertiesLoose(a,["deviceID"]);a=new e(a);a.setDeviceID(c);a.$ZenonLSCallSummary$p_1=b.timestamps;a.$ZenonLSCallSummary$p_2=b.pcIsConnected;a.$ZenonLSCallSummary$p_3=b.endIsConnected;a.$ZenonLSCallSummary$p_16=b.endCallReason;a.$ZenonLSCallSummary$p_17=b.endCallSubreason;a.$ZenonLSCallSummary$p_19=b.isRemoteEnded;a.$ZenonLSCallSummary$p_7=b.isVideo;a.$ZenonLSCallSummary$p_15=(c=b.rtcActorID)!=null?c:null;a.$ZenonLSCallSummary$p_6={ld:parseInt(b.videoStats.local_video_duration,10),rd:parseInt(b.videoStats.remote_video_duration,10)};a.$ZenonLSCallSummary$p_8=parseInt(b.extraInfo.battery_start_level,10);a.$ZenonLSCallSummary$p_9=parseInt(b.extraInfo.battery_end_level,10);b.extraInfo.was_device_charged!=null&&(a.$ZenonLSCallSummary$p_10=b.extraInfo.was_device_charged);b.extraInfo.max_concurrent_connected_participant!=null&&(a.$ZenonLSCallSummary$p_11=b.extraInfo.max_concurrent_connected_participant);b.unsetOnRetrieve!=null&&(a.$ZenonLSCallSummary$p_18=b.unsetOnRetrieve);b.accumulatedCallTime!=null&&(a.$ZenonLSCallSummary$p_4=b.accumulatedCallTime);b.conferenceName!=null&&(a.$ZenonLSCallSummary$p_13=b.conferenceName);return a};f.toJsonString=function(){var a={accumulatedCallTime:this.$ZenonLSCallSummary$p_20(),callInfo:this.getCallInfo(),conferenceName:this.$ZenonLSCallSummary$p_13,endCallReason:this.$ZenonLSCallSummary$p_16,endCallSubreason:this.$ZenonLSCallSummary$p_17,endIsConnected:this.$ZenonLSCallSummary$p_3,extraInfo:this.getExtraInfo(),isRemoteEnded:this.$ZenonLSCallSummary$p_19,isVideo:this.$ZenonLSCallSummary$p_7,joinMode:this.$ZenonLSCallSummary$p_14,pcIsConnected:this.$ZenonLSCallSummary$p_2,rtcActorID:this.$ZenonLSCallSummary$p_15,timestamps:this.getTimestamps(),unsetOnRetrieve:this.$ZenonLSCallSummary$p_18,videoStats:this.getVideoStats()};return JSON.stringify(a)};f.$ZenonLSCallSummary$p_20=function(){var a=(h||(h=c("performanceNow")))()-this.$ZenonLSCallSummary$p_5;return Math.floor(this.$ZenonLSCallSummary$p_4+a)};f.updateLastUpdatedTime=function(){this.$ZenonLSCallSummary$p_1.last_updated_time=String(this.$ZenonLSCallSummary$p_20())};f.save=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.storeCallSummary(c,b,this)};f.remove=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.removeLocalStorageObjects([{peerID:c,signalingID:b}])};return e}(c("ZenonCallInfoManager"));g["default"]=a}),98);
__d("ZenonLSCallSummaryStore",["ZenonGenericLocalStorageStore","ZenonLSCallSummary"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_LS_CALL_SUMMARY_",j="ls_summary",k=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,j,h,i)||this}var d=b.prototype;d.retrieveCallSummary=function(a,b){var d=this.getLocalStorageObjects();d=d[a]?d[a][b]:null;if(d)return c("ZenonLSCallSummary").fromJsonString(d.__d);else return null};d.storeCallSummary=function(a,b,c){this.mutateLocalStorageObjects(function(d){d[a]||(d[a]={});d[a][b]={__d:c.toJsonString(),__t:Date.now(),__z:!0};return d},k,!1,{peerID:a,signalingID:b})};return b}(c("ZenonGenericLocalStorageStore"));b=new a();g.ZenonLSCallSummaryStoreInstance=b}),98);
__d("ZenonLSE2EEStatsManager",["E2eeMetricsSerializers","WebAssemblyMemorySingleton","ZenonCallFalcoEventUtils","ZenonCallInfoManager","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(b=c=a.call.apply(a,[this].concat(f))||this,c.$ZenonLSE2EEStatsManager$p_1={group_e2ee_metrics:d("E2eeMetricsSerializers").GroupE2eeMetrics$DefaultConstructor(),p2p_e2ee_metrics:d("E2eeMetricsSerializers").P2pE2eeMetrics$DefaultConstructor(),track_specific_e2ee_stats:new Map(),wasm_metrics:d("WebAssemblyMemorySingleton").WebAssemblyMemorySingleton.getMetrics()},b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.updateE2eeStats=function(a){this.$ZenonLSE2EEStatsManager$p_1=a};c.getGroupE2eeMetricsInFalcoShape=function(){var a=this.getCallInfo(),b=a.deviceID,c=a.localCallID;a=a.serverInfoData;return babelHelpers["extends"]({g_e2ee_web_wasm_final_memory_usage_kb:String(this.$ZenonLSE2EEStatsManager$p_1.wasm_metrics.memory_size_kb),g_e2ee_web_wasm_memory_reallocation_count:String(this.$ZenonLSE2EEStatsManager$p_1.wasm_metrics.memory_reallocation_count),local_call_id:c},a!=null&&{shared_call_id:a},{steady_time_ms:d("ZenonCallFalcoEventUtils").performanceNowParsed(),system_time_ms:String(Date.now()),web_device_id:b},this.$ZenonLSE2EEStatsManager$p_1.group_e2ee_metrics)};c.getP2pE2eeMetricsInFalcoShape=function(){var a=this.getCallInfo(),b=a.deviceID,c=a.localCallID,e=a.peerID;a=a.serverInfoData;return babelHelpers["extends"]({local_call_id:c},a!=null&&{shared_call_id:a},{peer_id:d("ZenonPeerID").convertPeerIDForLogging(e),steady_time_ms:d("ZenonCallFalcoEventUtils").performanceNowParsed(),system_time_ms:String(Date.now()),web_device_id:b},this.$ZenonLSE2EEStatsManager$p_1.p2p_e2ee_metrics)};c.save=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.storeE2eeStats(c,b,this)};c["delete"]=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.removeLocalStorageObjects([{peerID:c,signalingID:b}])};c.toJsonString=function(){var a={callInfo:this.getCallInfo(),groupE2eeMetrics:this.$ZenonLSE2EEStatsManager$p_1.group_e2ee_metrics,p2pE2eeMetrics:this.$ZenonLSE2EEStatsManager$p_1.p2p_e2ee_metrics,trackSpecificE2eeStatsWithTrackId:Array.from(this.$ZenonLSE2EEStatsManager$p_1.track_specific_e2ee_stats),wasmMetrics:this.$ZenonLSE2EEStatsManager$p_1.wasm_metrics};return JSON.stringify(a)};b.fromJsonString=function(a){var c;try{c=JSON.parse(a)}catch(a){return null}a=c.callInfo;a.deviceID;a=babelHelpers.objectWithoutPropertiesLoose(a,["deviceID"]);a=new b(a);a.$ZenonLSE2EEStatsManager$p_1={group_e2ee_metrics:c.groupE2eeMetrics,p2p_e2ee_metrics:c.p2pE2eeMetrics,track_specific_e2ee_stats:new Map(c.trackSpecificE2eeStatsWithTrackId),wasm_metrics:c.wasmMetrics};return a};return b}(c("ZenonCallInfoManager"));g["default"]=a}),98);
__d("ZenonLSE2EEStore",["ZenonGenericLocalStorageStore","ZenonLSE2EEStatsManager"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_LS_E2EE_STATS_",j="ls_e2ee_stats",k=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,j,h,i)||this}var d=b.prototype;d.retrieveE2eeStats=function(a,b){var d=this.getLocalStorageObjects();d=d[a]?d[a][b]:null;if(d)return c("ZenonLSE2EEStatsManager").fromJsonString(d.__d);else return null};d.storeE2eeStats=function(a,b,c){this.mutateLocalStorageObjects(function(d){d[a]||(d[a]={});d[a][b]={__d:c.toJsonString(),__t:Date.now(),__z:!0};return d},k,!1,{peerID:a,signalingID:b})};return b}(c("ZenonGenericLocalStorageStore"));b=new a();g.ZenonLSE2EEStoreInstance=b}),98);
__d("ZenonLSPeerConnectionSummary",["ZenonCallFalcoEventUtils","ZenonCallInfoManager","ZenonIceStatsParser","ZenonLoggingEventTypes","ZenonMWMessageTypes","ZenonPeerID","performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;b.$ZenonLSPeerConnectionSummary$p_1={CoreAudioMetrics:{isstall:"0",voice_detect_pct:[]},CoreVideoMetrics:{screen:{capture_stall:{is_stall:"0"},encode_stall:{is_stall:"0"},sent_stall:{is_stall:"0"}},video:{capture_stall:{is_stall:"0"},encode_stall:{is_stall:"0"},sent_stall:{is_stall:"0"}}},DebugAudioMetrics:{NetworkReceive:{}},audio:{echo_confidence:{}},dataChannelMetrics:{},ecv:{},extraInfo:{},receiver:{},receiver_pct:{audio:{}},receiver_stalls:{screen_recv_stalls:{recv_decode_stall:{is_stall:"0"},recv_no_bytes_stall:{is_stall:"0"},recv_render_stall:{is_stall:"0"}},video_recv_stalls:{recv_decode_stall:{is_stall:"0"},recv_no_bytes_stall:{is_stall:"0"},recv_render_stall:{is_stall:"0"}}},sender:{},sender_pct:{screen:{},video:{}},video:{}};b.$ZenonLSPeerConnectionSummary$p_2={};b.$ZenonLSPeerConnectionSummary$p_3={};b.$ZenonLSPeerConnectionSummary$p_5=-1;b.$ZenonLSPeerConnectionSummary$p_8=null;b.$ZenonLSPeerConnectionSummary$p_9=new Map();b.$ZenonLSPeerConnectionSummary$p_10="unknown";b.$ZenonLSPeerConnectionSummary$p_6=(h||(h=c("performanceNow")))();b.$ZenonLSPeerConnectionSummary$p_4=0;b.$ZenonLSPeerConnectionSummary$p_7=null;return b}var e=b.prototype;e.$ZenonLSPeerConnectionSummary$p_11=function(){var a,b=this,c="",e=0,f=0,g=0,h=0;Object.keys((a=this.$ZenonLSPeerConnectionSummary$p_1.dataChannelMetrics)!=null?a:{}).forEach(function(a){a=b.$ZenonLSPeerConnectionSummary$p_1.dataChannelMetrics[a];if(a==null)return;c+=a.label+":"+a.bytes_sent+":"+a.bytes_received+":"+a.messages_sent+":"+a.messages_received+",";e+=Number(a.bytes_sent);f+=Number(a.bytes_received);g+=Number(a.messages_sent);h+=Number(a.messages_received)});return{data_channel_total_bytes_recv:d("ZenonCallFalcoEventUtils").nonNullIntNumber(f),data_channel_total_bytes_sent:d("ZenonCallFalcoEventUtils").nonNullIntNumber(e),data_channel_total_msg_recv:d("ZenonCallFalcoEventUtils").nonNullIntNumber(h),data_channel_total_msg_sent:d("ZenonCallFalcoEventUtils").nonNullIntNumber(g),data_channel_type:"SCTP",sctp_per_channel_stats_raw:c}};e.$ZenonLSPeerConnectionSummary$p_12=function(){var a=this.$ZenonLSPeerConnectionSummary$p_1.sender,b=a.codec;b=b===void 0?{}:b;var c={gen0_ice_sent_host:d("ZenonCallFalcoEventUtils").nonNullIntNumber(this.$ZenonLSPeerConnectionSummary$p_2.host),gen0_ice_sent_relay:d("ZenonCallFalcoEventUtils").nonNullIntNumber(this.$ZenonLSPeerConnectionSummary$p_2.relay),gen0_ice_sent_srflx:d("ZenonCallFalcoEventUtils").nonNullIntNumber(this.$ZenonLSPeerConnectionSummary$p_2.srflx)};b=b.www;b!=null&&(c.audio_send_codec=String(b));this.$ZenonLSPeerConnectionSummary$p_13(c,"audio_send_bytes_sent",a.bytes);this.$ZenonLSPeerConnectionSummary$p_13(c,"audio_send_level_count",a.taulc);this.$ZenonLSPeerConnectionSummary$p_13(c,"audio_send_level_sum",a.tx_sum_lvl);this.$ZenonLSPeerConnectionSummary$p_13(c,"audio_send_packets_sent",a.psent);this.$ZenonLSPeerConnectionSummary$p_13(c,"avg_video_uplink_bandwidth_estimate",a.ube_avg);this.$ZenonLSPeerConnectionSummary$p_13(c,"transport_conn_rtt_avg",a.avgrtt);return c};e.$ZenonLSPeerConnectionSummary$p_13=function(a,b,c){c!=null&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(c))};e.$ZenonLSPeerConnectionSummary$p_14=function(){var a,b,c;a=(a=this.$ZenonLSPeerConnectionSummary$p_1.video.sender)==null?void 0:a.ss;b=(b=a==null?void 0:a.frames)!=null?b:0;c=(c=a==null?void 0:a.eqps)!=null?c:0;c=b>0&&c>0?c/b:null;b={};this.$ZenonLSPeerConnectionSummary$p_15(b,"avg_video_actual_encode_bitrate_ss",a==null?void 0:a.avbr);this.$ZenonLSPeerConnectionSummary$p_15(b,"avg_video_uplink_bandwidth_estimate_ss",a==null?void 0:a.avbw);this.$ZenonLSPeerConnectionSummary$p_15(b,"video_send_duration_ss",a==null?void 0:a.dur);this.$ZenonLSPeerConnectionSummary$p_15(b,"video_send_frames_send_to_encoder_ss",a==null?void 0:a.eiframes);this.$ZenonLSPeerConnectionSummary$p_15(b,"video_send_total_input_pixel_ss",a==null?void 0:a.video_sum_capture_pixel);this.$ZenonLSPeerConnectionSummary$p_15(b,"video_send_total_output_pixel_ss",a==null?void 0:a.video_sum_encoded_pixel);this.$ZenonLSPeerConnectionSummary$p_15(b,"video_send_frames_encoded_ss",a==null?void 0:a.frames);this.$ZenonLSPeerConnectionSummary$p_15(b,"video_send_qp_sum_ss",c);return b};e.$ZenonLSPeerConnectionSummary$p_15=function(a,b,c){c!=null&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(c))};e.$ZenonLSPeerConnectionSummary$p_16=function(){var a=this.$ZenonLSPeerConnectionSummary$p_1.video.bwe,b={};this.$ZenonLSPeerConnectionSummary$p_17(b,"avg_video_actual_encode_bitrate",a==null?void 0:a.avg_enc_bitrate);this.$ZenonLSPeerConnectionSummary$p_17(b,"avg_video_actual_encode_bitrate_ss",a==null?void 0:a.avg_enc_bitrate_ss);this.$ZenonLSPeerConnectionSummary$p_17(b,"avg_video_retransmit_bitrate",a==null?void 0:a.avg_retrans_bitrate);this.$ZenonLSPeerConnectionSummary$p_17(b,"avg_video_transmit_bitrate",a==null?void 0:a.avg_trans_bitrate);this.$ZenonLSPeerConnectionSummary$p_17(b,"avg_video_uplink_bandwidth_estimate",a==null?void 0:a.avg_send_bw);return b};e.$ZenonLSPeerConnectionSummary$p_17=function(a,b,c){c!=null&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(c))};e.$ZenonLSPeerConnectionSummary$p_18=function(){var a;a=(a=this.$ZenonLSPeerConnectionSummary$p_1.sender_pct.video)==null?void 0:a.vqs;var b={};(a==null?void 0:a.avg)!=null&&(b.video_send_quality_score=d("ZenonCallFalcoEventUtils").truncateNumber(a==null?void 0:a.avg));return b};e.$ZenonLSPeerConnectionSummary$p_19=function(){var a=this.$ZenonLSPeerConnectionSummary$p_1.video.sender,b={video_send_codec:a==null?void 0:a.ename};this.$ZenonLSPeerConnectionSummary$p_20(b,"video_recv_firs_sent",a==null?void 0:a.fir);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_recv_nacks_sent",a==null?void 0:a.nack);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_recv_plis_sent",a==null?void 0:a.pli);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frame_height",a==null?void 0:a.ah);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frame_height_input",a==null?void 0:a.ch);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frame_width",a==null?void 0:a.aw);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frame_width_input",a==null?void 0:a.cw);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frames_captured",a==null?void 0:a.fcap);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frames_encoded",a==null?void 0:a.frames);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frames_sent",a==null?void 0:a.fcsn);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_frames_send_to_encoder",a==null?void 0:a.eiframes);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_capture_duration_ms",this.$ZenonLSPeerConnectionSummary$p_1.video.ld);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_duration_blur",a==null?void 0:a.video_blur_dur);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_key_frames_encoded",a==null?void 0:a.kframes);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_packets_sent",a==null?void 0:a.psent);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_qp_sum",a==null?void 0:a.eqps);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_total_input_pixel",a==null?void 0:a.video_sum_capture_pixel);this.$ZenonLSPeerConnectionSummary$p_20(b,"video_send_total_output_pixel",a==null?void 0:a.video_sum_encoded_pixel);return b};e.$ZenonLSPeerConnectionSummary$p_20=function(a,b,c){c!=null&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(c))};e.$ZenonLSPeerConnectionSummary$p_21=function(){var a,b=this.$ZenonLSPeerConnectionSummary$p_1.video.receiver,c={video_recv_codec:b==null?void 0:b.dname};this.$ZenonLSPeerConnectionSummary$p_22(c,"audio_recv_jitter_buffer_frames_assembled",b==null?void 0:b.jtasb);this.$ZenonLSPeerConnectionSummary$p_22(c,"audio_recv_jitter_buffer_frames_out",b==null?void 0:b.jtfrm);this.$ZenonLSPeerConnectionSummary$p_22(c,"audio_recv_jitter_buffer_keyframes_out",b==null?void 0:b.jtkey);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_agg_bytes_decoded",b==null?void 0:b.dec_bytes);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_agg_packets_lost",b==null?void 0:b.plost);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_agg_packets_recv",b==null?void 0:b.precv);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_av_sync_abs",b==null?void 0:b.avabs);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_frame_height",b==null?void 0:b.rh);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_frame_width",b==null?void 0:b.rw);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_frames_decoded",b==null?void 0:b.frd);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_freeze_count",b==null?void 0:b.frcnt);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_freeze_duration",b==null?void 0:b.frdur);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_freeze_duration_above_500_ms",b==null?void 0:b.frdur500);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_freeze_duration_above_500_ms_v2",b==null?void 0:b.frdur500);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_pause_count",b==null?void 0:b.pact);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_pause_duration_ms",b==null?void 0:b.padur);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_qp_sum",b==null?void 0:b.qps);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_total_pixels_decoded",b==null?void 0:b.agg_video_sum_decoded_pixel);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_union_decode_time_ms",b==null?void 0:b.dec_time);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_send_firs_recv",b==null?void 0:b.fir);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_send_nacks_recv",b==null?void 0:b.nack);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_send_plis_recv",b==null?void 0:b.pli);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_weighted_vqs",b==null?void 0:(a=b.vqs)==null?void 0:a.avg);a=b==null?void 0:b.dec_time_all_streams;b=b==null?void 0:b.dec_frame;this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_agg_decode_time_ms",a);this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_agg_frames_decoded",b);a!=null&&a>0&&b!=null&&b>0&&this.$ZenonLSPeerConnectionSummary$p_22(c,"video_recv_framerate_decoded",b*1e3/a);return c};e.$ZenonLSPeerConnectionSummary$p_23=function(){var a;a=(a=this.$ZenonLSPeerConnectionSummary$p_1.video.receiver)==null?void 0:a.ss_recv;var b={};this.$ZenonLSPeerConnectionSummary$p_24(b,"video_recv_duration_ss",a==null?void 0:a.ss_recv_dur);return b};e.$ZenonLSPeerConnectionSummary$p_24=function(a,b,c){c!=null&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(c))};e.$ZenonLSPeerConnectionSummary$p_25=function(){var a,b,c;a=(a=this.$ZenonLSPeerConnectionSummary$p_1.receiver_stalls)==null?void 0:(a=a.video_recv_stalls)==null?void 0:a.recv_no_bytes_stall;b=(b=this.$ZenonLSPeerConnectionSummary$p_1.receiver_stalls)==null?void 0:(b=b.video_recv_stalls)==null?void 0:b.recv_decode_stall;c=(c=this.$ZenonLSPeerConnectionSummary$p_1.receiver_stalls)==null?void 0:(c=c.video_recv_stalls)==null?void 0:c.recv_render_stall;var d={};if(a){var e=a.is_stall,f=a.sdur;a=a.nstall;e!=null&&(d.video_recv_byte_received_is_stalled=String(e));f!=null&&(d.video_recv_byte_received_total_stall_duration_ms=String(f));a!=null&&(d.video_recv_byte_received_total_stalls=String(a))}if(b){e=b.is_stall;f=b.sdur;a=b.nstall;e!=null&&(d.video_recv_decoder_is_stalled=String(e));f!=null&&(d.video_recv_decoder_total_stall_duration_ms=String(f));a!=null&&(d.video_recv_decoder_total_stalls=String(a))}if(c){b=c.is_stall;e=c.sdur;f=c.nstall;b!=null&&(d.video_render_is_stalled=String(b));e!=null&&(d.video_render_total_stall_duration_ms=String(e));f!=null&&(d.video_render_total_stalls=String(f))}return d};e.$ZenonLSPeerConnectionSummary$p_26=function(){var a;a=(a=this.$ZenonLSPeerConnectionSummary$p_1.receiver_stalls)==null?void 0:(a=a.screen_recv_stalls)==null?void 0:a.recv_decode_stall;var b={};if(a){var c=a.is_stall,d=a.sdur;a=a.nstall;c!=null&&(b.screen_share_recv_decoder_is_stalled=String(c));d!=null&&(b.screen_share_recv_decoder_total_stall_duration_ms=String(d));a!=null&&(b.screen_share_recv_decoder_total_stalls=String(a))}return b};e.$ZenonLSPeerConnectionSummary$p_22=function(a,b,c){c!=null&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(c))};e.$ZenonLSPeerConnectionSummary$p_27=function(){var a,b,c=this.$ZenonLSPeerConnectionSummary$p_1.DebugAudioMetrics.NetworkReceive.jb_nm;a=c==null?void 0:(a=c.neteq)==null?void 0:a.meanWait;b=c==null?void 0:(b=c.speech_expand_rate)==null?void 0:b.avg;c=c==null?void 0:(c=c.speech_expand_rate)==null?void 0:c.M;var d={};a!=null&&(d.audio_recv_neteq_mean_wait_ms=String(a));b!=null&&(d.audio_recv_neteq_speech_expand_rate_avg=String(b));c!=null&&(d.audio_recv_neteq_speech_expand_rate_max=String(c));return d};e.$ZenonLSPeerConnectionSummary$p_28=function(){var a=this.$ZenonLSPeerConnectionSummary$p_1.CoreAudioMetrics,b=a.audio_device,c=a.isstall,d=a.sdur;a=a.astall;var e={};b!=null&&(e.audio_device=String(b));c!=null&&(e.audio_device_is_stalled=String(c));d!=null&&(e.audio_device_stall_duration=String(d));a!=null&&(e.audio_device_total_stall=String(a));return e};e.$ZenonLSPeerConnectionSummary$p_29=function(){var a,b={};if(((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_neteq_wait_time_ms)!=null){b.ecv_neteq_wait_time_ms=d("ZenonCallFalcoEventUtils").truncateNumber(Number((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_neteq_wait_time_ms))}if(((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_rtt_ms)!=null){b.ecv_rtt_ms=d("ZenonCallFalcoEventUtils").truncateNumber(Number((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_rtt_ms))}if(((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_plccng_v2)!=null){b.ecv_plccng_v2=d("ZenonCallFalcoEventUtils").truncateNumber(Number((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_plccng_v2))}if(((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_video_freeze_duration_above_500_ms_v2)!=null){b.ecv_video_freeze_duration_above_500_ms_v2=d("ZenonCallFalcoEventUtils").truncateNumber(Number((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_video_freeze_duration_above_500_ms_v2))}if(((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_av_sync_above_1000_ms)!=null){b.ecv_av_sync_above_1000_ms=d("ZenonCallFalcoEventUtils").truncateNumber(Number((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_av_sync_above_1000_ms))}if(((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_decoded_bitrate_duration_sum)!=null){b.ecv_decoded_bitrate_duration_sum=d("ZenonCallFalcoEventUtils").truncateNumber(Number((a=this.$ZenonLSPeerConnectionSummary$p_1.ecv)==null?void 0:a.ecv_decoded_bitrate_duration_sum))}return b};e.$ZenonLSPeerConnectionSummary$p_30=function(){var a=this.$ZenonLSPeerConnectionSummary$p_1.CoreVideoMetrics.video.capture_stall,b=a.is_stall,c=a.last_sdur,d=a.sdur;a=a.nstall;var e=this.$ZenonLSPeerConnectionSummary$p_1.CoreVideoMetrics.video.encode_stall,f=e.is_stall,g=e.last_sdur,h=e.sdur;e=e.nstall;var i=this.$ZenonLSPeerConnectionSummary$p_1.CoreVideoMetrics.video.sent_stall,j=i.is_stall,k=i.last_sdur,l=i.sdur;i=i.nstall;var m={};b!=null&&(m.video_device_capture_is_stalled=String(b));c!=null&&(m.video_device_capture_last_stall_duration_ms=String(c));d!=null&&(m.video_device_capture_total_stall_duration_ms=String(d));a!=null&&(m.video_device_capture_total_stalls=String(a));f!=null&&(m.video_encode_is_stalled=String(f));g!=null&&(m.video_encode_last_stall_duration_ms=String(g));h!=null&&(m.video_encode_total_stall_duration_ms=String(h));e!=null&&(m.video_encode_total_stalls=String(e));j!=null&&(m.video_send_is_stalled=String(j));k!=null&&(m.video_send_last_stall_duration_ms=String(k));l!=null&&(m.video_send_total_stall_duration_ms=String(l));i!=null&&(m.video_send_total_stalls=String(i));return m};e.$ZenonLSPeerConnectionSummary$p_31=function(){var a=this.$ZenonLSPeerConnectionSummary$p_1,b=a.receiver;a=a.receiver_pct;var c=null;b.codec!=null&&(c=String(Object.values(b.codec).pop()));var e={gen0_ice_received_host:d("ZenonCallFalcoEventUtils").nonNullIntNumber(this.$ZenonLSPeerConnectionSummary$p_3.host),gen0_ice_received_relay:d("ZenonCallFalcoEventUtils").nonNullIntNumber(this.$ZenonLSPeerConnectionSummary$p_3.relay),gen0_ice_received_srflx:d("ZenonCallFalcoEventUtils").nonNullIntNumber(this.$ZenonLSPeerConnectionSummary$p_3.srflx)};c!=null&&(e.audio_recv_codec=String(c));this.$ZenonLSPeerConnectionSummary$p_32(e,"audio_ctp_latency_avg_us",(c=a.audio.jbd)==null?void 0:c.avg,(c=a.audio.rtt)==null?void 0:c.avg);this.$ZenonLSPeerConnectionSummary$p_32(e,"audio_ctp_latency_p5_us",(c=a.audio.jbd)==null?void 0:c.p5,(c=a.audio.rtt)==null?void 0:c.p5);this.$ZenonLSPeerConnectionSummary$p_32(e,"audio_ctp_latency_p50_us",(c=a.audio.jbd)==null?void 0:c.p50,(c=a.audio.rtt)==null?void 0:c.p50);this.$ZenonLSPeerConnectionSummary$p_32(e,"audio_ctp_latency_p95_us",(c=a.audio.jbd)==null?void 0:c.p95,(c=a.audio.rtt)==null?void 0:c.p95);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_bytes_recv",b.bytes);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_concealed_samples",b.sp_c);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_fec_packets_discarded",b.fecpd);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_fec_packets_received",b.fecpr);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_jitter",b.jitter);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_jitter_buffer_flushes",b.dec_pack_flush);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_level_count",b.taulc);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_jitter_buffer_emitted_count",b.jbec);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_jitter_buffer_delay",b.jbd);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_level_sum",b.rx_sum_lvl);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_total_samples_duration",b.sp_dur);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_total_samples_received",b.sp_r);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_neteq_accelerate",b.dec_ar);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_neteq_normal",b.dec_normal);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_neteq_operations",b.neteq_calls);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_neteq_plc",b.dec_plc);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_neteq_plccng",b.dec_plc_cng);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_neteq_preemptive_expand",b.dec_per);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_packets_lost",b.plost);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_packets_recv",b.precv);this.$ZenonLSPeerConnectionSummary$p_33(e,"audio_recv_silent_concealed_samples",b.sp_sc);return e};e.$ZenonLSPeerConnectionSummary$p_34=function(){var a,b={};a=(a=this.$ZenonLSPeerConnectionSummary$p_1.video.sender)==null?void 0:a.ss;if((a==null?void 0:a.dur)!=null&&(a==null?void 0:a.dur)>0){a=this.$ZenonLSPeerConnectionSummary$p_1.CoreVideoMetrics.screen.capture_stall;var c=a.is_stall,d=a.sdur;a=a.nstall;var e=this.$ZenonLSPeerConnectionSummary$p_1.CoreVideoMetrics.screen.encode_stall,f=e.is_stall,g=e.sdur;e=e.nstall;var h=this.$ZenonLSPeerConnectionSummary$p_1.CoreVideoMetrics.screen.sent_stall,i=h.is_stall,j=h.sdur;h=h.nstall;c!=null&&(b.screen_share_capture_is_stalled=String(c));d!=null&&(b.screen_share_capture_total_stall_duration_ms=String(d));a!=null&&(b.screen_share_capture_total_stalls=String(a));f!=null&&(b.screen_share_encode_is_stalled=String(f));g!=null&&(b.screen_share_encode_total_stall_duration_ms=String(g));e!=null&&(b.screen_share_encode_total_stalls=String(e));i!=null&&(b.screen_share_send_is_stalled=String(i));j!=null&&(b.screen_share_send_total_stall_duration_ms=String(j));h!=null&&(b.screen_share_send_total_stalls=String(h))}return b};e.$ZenonLSPeerConnectionSummary$p_33=function(a,b,c){c!=null&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(c))};e.$ZenonLSPeerConnectionSummary$p_35=function(){var a,b=this.$ZenonLSPeerConnectionSummary$p_1.extraInfo,c=b.localIceCandidate;b=b.remoteIceCandidate;return{relay_protocol:c==null?void 0:c.relayProtocol,transport_conn_type:"l:"+((a=c==null?void 0:c.candidateType)!=null?a:"")+"-"+((a=c==null?void 0:c.protocol)!=null?a:"")+";r:"+((c=b==null?void 0:b.candidateType)!=null?c:"")+"-"+((a=b==null?void 0:b.protocol)!=null?a:"")}};e.$ZenonLSPeerConnectionSummary$p_36=function(){var a=this.$ZenonLSPeerConnectionSummary$p_9,b={},c=0,e=!1,f=0,g=0;a.forEach(function(a,b){e!==a&&(a?c>0&&(g++,f+=b-c,c=0):c=b,e=a)});if(c>0){a=this.$ZenonLSPeerConnectionSummary$p_5;a>-1&&a>c&&(g++,f+=a-c)}b.transport_num_gaps=d("ZenonCallFalcoEventUtils").nonNullIntNumber(g);b.transport_total_gap_duration_ms=d("ZenonCallFalcoEventUtils").nonNullIntNumber(f);this.$ZenonLSPeerConnectionSummary$p_8!=null&&(b.transport_connected=this.$ZenonLSPeerConnectionSummary$p_8?"1":"0");return b};e.$ZenonLSPeerConnectionSummary$p_37=function(){var a,b={};b.audio_send_echo_confidence=(a=this.$ZenonLSPeerConnectionSummary$p_1.audio)==null?void 0:(a=a.echo_confidence)==null?void 0:a.audio_send_echo_confidence;return b};e.onCallEnded=function(){this.$ZenonLSPeerConnectionSummary$p_5=this.$ZenonLSPeerConnectionSummary$p_38(),this.$ZenonLSPeerConnectionSummary$p_8==null&&(this.$ZenonLSPeerConnectionSummary$p_8=this.$ZenonLSPeerConnectionSummary$p_7)};e.$ZenonLSPeerConnectionSummary$p_32=function(a,b,c,e){var f=0;c!=null&&(f+=c);e!=null&&(f+=e/2);f>0&&(a[b]=d("ZenonCallFalcoEventUtils").truncateNumber(f))};e.getPeerConnectionSummary=function(){var a=this.getCallInfo(),b=a.deviceID,c=a.localCallID,e=a.peerID,f=a.serverInfoData;a=a.signalingID;return babelHelpers["extends"]({},this.$ZenonLSPeerConnectionSummary$p_11(),this.$ZenonLSPeerConnectionSummary$p_28(),this.$ZenonLSPeerConnectionSummary$p_12(),this.$ZenonLSPeerConnectionSummary$p_31(),this.$ZenonLSPeerConnectionSummary$p_14(),this.$ZenonLSPeerConnectionSummary$p_16(),this.$ZenonLSPeerConnectionSummary$p_18(),this.$ZenonLSPeerConnectionSummary$p_19(),this.$ZenonLSPeerConnectionSummary$p_21(),this.$ZenonLSPeerConnectionSummary$p_23(),this.$ZenonLSPeerConnectionSummary$p_27(),this.$ZenonLSPeerConnectionSummary$p_36(),this.$ZenonLSPeerConnectionSummary$p_29(),this.$ZenonLSPeerConnectionSummary$p_30(),this.$ZenonLSPeerConnectionSummary$p_34(),this.$ZenonLSPeerConnectionSummary$p_25(),this.$ZenonLSPeerConnectionSummary$p_26(),this.$ZenonLSPeerConnectionSummary$p_35(),this.$ZenonLSPeerConnectionSummary$p_37(),f!=null&&{shared_call_id:f},{connection_logging_id:a,local_call_id:c,media_path:this.$ZenonLSPeerConnectionSummary$p_10,peer_id:d("ZenonPeerID").convertPeerIDForLogging(e),protocol:"multiway",steady_time_ms:d("ZenonCallFalcoEventUtils").performanceNowParsed(),system_time_ms:String(Date.now()),web_device_id:b})};e.$ZenonLSPeerConnectionSummary$p_38=function(){var a=(h||(h=c("performanceNow")))()-this.$ZenonLSPeerConnectionSummary$p_6;return Math.floor(this.$ZenonLSPeerConnectionSummary$p_4+a)};e.updateIceInfo=function(a,b){var c=b===d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send?this.$ZenonLSPeerConnectionSummary$p_2:this.$ZenonLSPeerConnectionSummary$p_3;b=d("ZenonIceStatsParser").extractIceInfo(a);b.forEach(function(a){var b=a.gen;a=a.type;b===0&&(c[a]==null?c[a]=1:c[a]++)})};e.onPCStateChange=function(a){this.$ZenonLSPeerConnectionSummary$p_7!==a&&(this.$ZenonLSPeerConnectionSummary$p_7=a,this.$ZenonLSPeerConnectionSummary$p_9.set(this.$ZenonLSPeerConnectionSummary$p_38(),a))};e.$ZenonLSPeerConnectionSummary$p_39=function(a){switch(a){case d("ZenonMWMessageTypes").ZenonMWMediaPath.SFU:return"sfu";case d("ZenonMWMessageTypes").ZenonMWMediaPath.P2P:return"p2p";case d("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN:default:return"unknown"}};e.setMediaPath=function(a){this.$ZenonLSPeerConnectionSummary$p_10=this.$ZenonLSPeerConnectionSummary$p_39(a)};e.setMediaStats=function(a){this.$ZenonLSPeerConnectionSummary$p_1=a};e.save=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.storePeerConnectionSummary(c,b,this)};e["delete"]=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.removeLocalStorageObjects([{peerID:c,signalingID:b}])};e.toJsonString=function(){var a=this.getCallInfo();a=a.signalingID;a={accumulatedCallTime:this.$ZenonLSPeerConnectionSummary$p_38(),callInfo:this.getCallInfo(),connectionLoggingId:a,endIsConnected:this.$ZenonLSPeerConnectionSummary$p_8,gen0IceReceivedCount:this.$ZenonLSPeerConnectionSummary$p_3,gen0IceSentCount:this.$ZenonLSPeerConnectionSummary$p_2,mediaPath:this.$ZenonLSPeerConnectionSummary$p_10,mediaStats:this.$ZenonLSPeerConnectionSummary$p_1,pcIsConnected:this.$ZenonLSPeerConnectionSummary$p_7};return JSON.stringify(a)};b.fromJsonString=function(a){var c,d;try{d=JSON.parse(a)}catch(a){return null}a=d.callInfo;a.deviceID;a=babelHelpers.objectWithoutPropertiesLoose(a,["deviceID"]);a=new b(a);a.$ZenonLSPeerConnectionSummary$p_10=d.mediaPath;a.$ZenonLSPeerConnectionSummary$p_1=d.mediaStats;a.$ZenonLSPeerConnectionSummary$p_3=d.gen0IceReceivedCount;a.$ZenonLSPeerConnectionSummary$p_2=d.gen0IceSentCount;a.$ZenonLSPeerConnectionSummary$p_7=(c=d.pcIsConnected)!=null?c:null;a.$ZenonLSPeerConnectionSummary$p_8=d.endIsConnected;d.accumulatedCallTime!=null&&(a.$ZenonLSPeerConnectionSummary$p_4=d.accumulatedCallTime);return a};return b}(c("ZenonCallInfoManager"));g["default"]=a}),98);
__d("ZenonLSPeerConnectionSummaryStore",["ZenonGenericLocalStorageStore","ZenonLSPeerConnectionSummary"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_LS_PCS_",j="ls_pcs",k=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,j,h,i)||this}var d=b.prototype;d.retrievePeerConnectionSummary=function(a,b){var d=this.getLocalStorageObjects();d=d[a]?d[a][b]:null;if(d)return c("ZenonLSPeerConnectionSummary").fromJsonString(d.__d);else return null};d.storePeerConnectionSummary=function(a,b,c){this.mutateLocalStorageObjects(function(d){d[a]||(d[a]={});d[a][b]={__d:c.toJsonString(),__t:Date.now(),__z:!0};return d},k,!1,{peerID:a,signalingID:b})};return b}(c("ZenonGenericLocalStorageStore"));b=new a();g.ZenonLSPeerConnectionSummaryStoreInstance=b}),98);
__d("ZenonLSStarRatingsManager",["LsRtcEndCallSurveyFalcoEvent","LsRtcStarRatingFalcoEvent","ZenonCallInfoManager","ZenonPeerID"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var e=b.prototype;e.setRating=function(a){var b=this.getCallInfo(),e=b.deviceID,f=b.localCallID,g=b.peerID;b=b.serverInfoData;var h={local_call_id:f,peer_id:d("ZenonPeerID").convertPeerIDForLogging(g),shared_call_id:b,web_device_id:e};c("LsRtcStarRatingFalcoEvent").logImmediately(function(){return babelHelpers["extends"]({star_rating:a.toString()},h)})};e.setSurvey=function(a,b,e){b===void 0&&(b=null);e===void 0&&(e=null);var f=this.getCallInfo(),g=f.deviceID,h=f.localCallID,i=f.peerID;f=f.serverInfoData;h={local_call_id:h,peer_id:d("ZenonPeerID").convertPeerIDForLogging(i),shared_call_id:f,web_device_id:g};i=Array.isArray(b)?b:b!=null?[b]:[];var j=babelHelpers["extends"]({rtc_end_call_survey_issue:(g=(f=e)==null?void 0:f.toLocaleLowerCase())!=null?g:"",rtc_end_call_survey_selected_options:i},h,a==null?{}:{rtc_end_call_survey_freeform:a});c("LsRtcEndCallSurveyFalcoEvent").log(function(){return j})};e.save=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.storeStarRatings(c,b,this)};e["delete"]=function(a){var b=this.getCallInfo(),c=b.peerID;b=b.signalingID;a.removeLocalStorageObjects([{peerID:c,signalingID:b}])};e.toJsonString=function(){var a={callInfo:this.getCallInfo()};return JSON.stringify(a)};b.fromJsonString=function(a){var c;try{c=JSON.parse(a)}catch(a){return null}a=c.callInfo;a.deviceID;a=babelHelpers.objectWithoutPropertiesLoose(a,["deviceID"]);return new b(a)};return b}(c("ZenonCallInfoManager"));g["default"]=a}),98);
__d("ZenonLSStarRatingsStore",["ZenonGenericLocalStorageStore","ZenonLSStarRatingsManager"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_LS_STAR_RATINGS_",j="ls_star_ratings",k=3;a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,j,h,i)||this}var d=b.prototype;d.retrieveStarRatings=function(a,b){var d=this.getLocalStorageObjects();d=d[a]?d[a][b]:null;if(d)return c("ZenonLSStarRatingsManager").fromJsonString(d.__d);else return null};d.storeStarRatings=function(a,b,c){this.mutateLocalStorageObjects(function(d){d[a]||(d[a]={});d[a][b]={__d:c.toJsonString(),__t:Date.now(),__z:!0};return d},k,!1,{peerID:a,signalingID:b})};return b}(c("ZenonGenericLocalStorageStore"));b=new a();g.ZenonLSStarRatingsStoreInstance=b}),98);
__d("promiseAny",["invariant","AggregateError","Promise"],(function(a,b,c,d,e,f,g,h){var i;function j(a){return new(i||(i=b("Promise")))(function(c,d){return(i||(i=b("Promise"))).resolve(a).then(d,c)})}function a(a){a.length!==0||h(0,14837);return(i||(i=b("Promise"))).all(a.map(j)).then(function(a){throw new(c("AggregateError"))(a)},function(a){return a})}g["default"]=a}),98);
__d("ZenonMessageSenderChain",["promiseAny"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.addMessageSender=function(a){this.$1.push(a)};b.sendMessage=function(a){var b=this.$1.map(function(b){return b.sendMessage(a)});return c("promiseAny")(b)};b.setMessageReceiver=function(a){this.$1.forEach(function(b){return b.setMessageReceiver(a)})};b.setLoggingEventHandler=function(a){this.$1.forEach(function(b){return b.setLoggingEventHandler(a)})};return a}();g["default"]=a}),98);
__d("ZenonSignalingConstants",[],(function(a,b,c,d,e,f){"use strict";a="/rtc_multi";b="/t_rtc_multi";c="config_engine";d="D3F4U1T_F8_TR4CK";f.RTC_MULTI_MQTT_TOPIC=a;f.T_RTC_MULTI_MQTT_TOPIC=b;f.CONFIG_ENGINE_STATE_SYNC_TOPIC=c;f.DEFAULT_TRACK=d}),66);
__d("waitForZenonMqttConnected",["Promise","ZenonUserActionLogger","err","getZenonMqttChannel"],(function(a,b,c,d,e,f,g){"use strict";var h,i=15e3;function a(){return new(h||(h=b("Promise")))(function(a,b){var d=c("getZenonMqttChannel")();if(d.getConnectionState()==="Connected")a();else{c("ZenonUserActionLogger").logCheckpoint({checkpoint:"MQTT not connected, deferring sending MWS message"});c("ZenonUserActionLogger").startTimer("MQTT not connected");var e={onMQTTStateChanged:function(b){b==="Connected"&&(c("ZenonUserActionLogger").stopTimer({checkpointName:"MQTT connected after deferring sending MWS message",timerName:"MQTT not connected"}),d.unsubscribeChannelEvents(e),window.clearTimeout(f),a())}},f=window.setTimeout(function(){d.unsubscribeChannelEvents(e),c("ZenonUserActionLogger").stopTimer({checkpointName:"MQTT never connected. Current status: "+d.getConnectionState(),timerName:"MQTT not connected"}),b(c("err")("timeout"))},i);d.subscribeChannelEvents(e)}})}g["default"]=a}),98);
__d("ZenonMqttMWMessageSender",["Promise","RpZenonBinaryThriftSignalingSitevarConfig","ZenonActorHooks","ZenonMWMessageDebugLogger","ZenonMWMessageLogger","ZenonMWMessageReliabilityLogger","ZenonMWMessageTranslator","ZenonMWMessageTypes","ZenonSignalingConstants","ZenonUserActionLogger","ZenonValidateMWMessage","asyncToGeneratorRuntime","err","getZenonMqttChannel","shouldUseThriftSignaling","waitForZenonMqttConnected"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){var a=c("RpZenonBinaryThriftSignalingSitevarConfig").supported_message_types_mqtt.map(function(a){return d("ZenonMWMessageTypes").ZenonMWSignalingPayloadType[a]});this.$3=new Set(a)}var e=a.prototype;e.$4=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,e=!0;yield c("waitForZenonMqttConnected")()["catch"](function(a){c("ZenonUserActionLogger").logCheckpoint({checkpoint:"Not sending MWS message through MQTT because MQTT could not connect. Error: "+a}),e=!1});if(!e)return;d("ZenonMWMessageReliabilityLogger").logSendingMessage(a);c("ZenonMWMessageDebugLogger").logMWMessage("SENDING","MQTT",a);this.$2&&d("ZenonMWMessageLogger").logSentMessage(a,this.$2);var f=c("getZenonMqttChannel")();try{yield f.publish(d("ZenonSignalingConstants").RTC_MULTI_MQTT_TOPIC,JSON.stringify(a)).then(function(){d("ZenonMWMessageReliabilityLogger").logSentMessage(a),b.$2&&b.$2({mwMessage:a,name:"mwMessageSent"})},function(c){b.$5(a,c.toString())})}catch(b){this.$5(a,b.toString())}});function e(b){return a.apply(this,arguments)}return e}();e.$5=function(a,b){b=b!=null?b:"MQTT Message Send Error";d("ZenonMWMessageReliabilityLogger").logSendMessageFailed(a,"[MQTT] "+b);c("ZenonMWMessageDebugLogger").logSendMultiwayMessageFailure(b,a.jsonPayload.header.type)};e.sendMessage=function(a){a=d("ZenonMWMessageTranslator").toMWMessage(a);if(!a||!c("ZenonValidateMWMessage")(a))return(h||(h=b("Promise"))).reject(c("err")("Invalid MW message"));if(c("shouldUseThriftSignaling")()&&this.$3.has(a.jsonPayload.header.type))return(h||(h=b("Promise"))).resolve();return a.endpoint.userId!==d("ZenonActorHooks").ZenonActor.getAccountID()&&!d("ZenonActorHooks").ZenonActor.isInstagramUser()&&!d("ZenonActorHooks").ZenonActor.isOculusUser()?(h||(h=b("Promise"))).reject(c("err")("MQTT doesn't work with Page users yet")):this.$4(a)};e.setMessageReceiver=function(a){this.$1=a};e.setLoggingEventHandler=function(a){this.$2=a};return a}();g["default"]=a}),98);
__d("ZenonParentClientPerfQPLLogProcessor",["Promise","QuickPerformanceLogger","ZenonArmadilloLoggingChecks","ZenonClientPerfQPLConstants","ZenonDismissReason","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;a=function(){function a(a){var b=a.data;a=a.isE2eeMandated;this.$1=b.localCallID;this.$2=b.serverInfoData;this.$3=b.signalingID;this.$4=a}var e=a.prototype;e.processEvent=function(a){var e=c("qpl")._(41156610,"2039");switch(a.name){case"inviteReceived":this.$2=a.serverInfoData;(i||(i=c("QuickPerformanceLogger"))).markerStart(e,+this.$3);(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(e,{bool:{isE2eeMandated:this.$4},string:{local_call_id:this.$1,server_info_data:this.$2}},{instanceKey:+this.$3});break;case"callEnded":(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(e,{string:{endCallReason:d("ZenonDismissReason").ZenonDismissReason.getName(a.endCallReason),endCallSubreason:a.endCallSubreason}},{instanceKey:+this.$3});(i||(i=c("QuickPerformanceLogger"))).markerEnd(e,4,+this.$3);break;case"popupOpened":(i||(i=c("QuickPerformanceLogger"))).markerPoint(e,d("ZenonClientPerfQPLConstants").POINT_ZENON_POPUP_OPENED,{instanceKey:+this.$3});break}return(h||(h=b("Promise"))).resolve()};return a}();e={LogProcessor:a,approvedForMandatedE2ee:function(){return d("ZenonArmadilloLoggingChecks").isArmadilloQPLLoggingEnabled()}};g.ZenonParentClientPerfQPLLogProcessor=a;g.ZenonParentClientPerfQPLLogProcessorConfig=e}),98);
__d("ZenonParentLSCallSummaryLogProcessor",["ODS","ZenonArmadilloLoggingChecks","ZenonDismissReason","ZenonInfraActionsLogger","ZenonLSCallStartEventManager","ZenonLSCallStartEventStore","ZenonLSCallSummary","ZenonLSCallSummaryStore","ZenonLSE2EEStatsManager","ZenonLSE2EEStore","ZenonLSPeerConnectionSummary","ZenonLSPeerConnectionSummaryStore","ZenonLSStarRatingsManager","ZenonLSStarRatingsStore","ZenonPeerID","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){a=a.data;a.peerID=d("ZenonPeerID").ZenonMWPeerID;this.$6=a.protocol;this.$1=new(c("ZenonLSCallSummary"))(a);this.$2=new(c("ZenonLSPeerConnectionSummary"))(a);this.$3=new(c("ZenonLSCallStartEventManager"))(a);this.$4=new(c("ZenonLSE2EEStatsManager"))(a);this.$5=new(c("ZenonLSStarRatingsManager"))(a);c("ZenonInfraActionsLogger").logCheckpointEmployeesTestUsersOnly({checkpoint:"NSL - created call summaries in parent window"})}var e=a.prototype;e.processEvent=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){switch(a.name){case"callAccepted":this.$1.onCallAccepted(a.trigger);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);this.$2.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);this.$3.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);this.$4.save(d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance);this.$5.save(d("ZenonLSStarRatingsStore").ZenonLSStarRatingsStoreInstance);break;case"callEnded":yield this.$7(a);break;case"inviteReceived":this.$8(a);break;case"popupOpened":yield this.$9(a);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);this.$2.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);this.$3.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);this.$4.save(d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance);this.$5.save(d("ZenonLSStarRatingsStore").ZenonLSStarRatingsStoreInstance);break}});function c(b){return a.apply(this,arguments)}return c}();e.$8=function(a){a=a.serverInfoData;if(a==null)return;this.$1.setSharedCallId(a);this.$2.setSharedCallId(a);this.$3.setSharedCallId(a);this.$4.setSharedCallId(a)};e.$9=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$1.onCallEnded(d("ZenonDismissReason").ZenonDismissReason.ClientError,!1,!0,a.isPopupBlocked?"PopupBlocked":"PopupPending"),this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance)});function c(b){return a.apply(this,arguments)}return c}();e.$7=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(a.isRemoteEnded)return;var b=a.endCallReason,c=a.endCallSubreason;a=a.isRemoteEnded;if(b===d("ZenonDismissReason").ZenonDismissReason.OtherInstanceHandled&&a)return;b===d("ZenonDismissReason").ZenonDismissReason.ClientError&&(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_client_crashes","zenon_client_error_end_call_reason");yield this.$1.onCallEnded(b,a,!1,c);this.$1.save(d("ZenonLSCallSummaryStore").ZenonLSCallSummaryStoreInstance);this.$2.save(d("ZenonLSPeerConnectionSummaryStore").ZenonLSPeerConnectionSummaryStoreInstance);this.$3.save(d("ZenonLSCallStartEventStore").ZenonLSCallStartEventStoreInstance);this.$4.save(d("ZenonLSE2EEStore").ZenonLSE2EEStoreInstance);this.$5.save(d("ZenonLSStarRatingsStore").ZenonLSStarRatingsStoreInstance)});function c(b){return a.apply(this,arguments)}return c}();return a}();e={LogProcessor:a,approvedForMandatedE2ee:function(){return d("ZenonArmadilloLoggingChecks").isArmadilloCallSummaryLoggingEnabled()}};g.ZenonParentLSCallSummaryLogProcessor=a;g.ZenonParentLSCallSummaryLogProcessorConfig=e}),98);
__d("ZenonParentQPLLogProcessor",["Promise","QPLUserFlow","ZenonArmadilloLoggingChecks","ZenonDismissReason","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){var b=a.data;a=a.isE2eeMandated;this.$1=b.localCallID;this.$2=b.serverInfoData;this.$3=b.signalingID;this.$4=a}var e=a.prototype;e.processEvent=function(a){switch(a.name){case"inviteReceived":c("QPLUserFlow").start(c("qpl")._(64225282,"3408"),{annotations:{bool:{isE2eeMandated:this.$4}},instanceKey:+this.$3});c("QPLUserFlow").start(c("qpl")._(398997251,"1544"),{annotations:{bool:{isE2eeMandated:this.$4},string:{localCallID:this.$1,serverInfoData:this.$2}},instanceKey:+this.$3});c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"invite_received",{instanceKey:+this.$3});break;case"callEnded":c("QPLUserFlow").endCancel(c("qpl")._(398997251,"1544"),{annotations:{string:{endCallReason:d("ZenonDismissReason").ZenonDismissReason.getName(a.endCallReason),endCallSubreason:a.endCallSubreason}},instanceKey:+this.$3});if(a.isRemoteEnded)return(h||(h=b("Promise"))).resolve();c("QPLUserFlow").endCancel(c("qpl")._(64225282,"3408"),{instanceKey:+this.$3});break;case"callAccepted":c("QPLUserFlow").addPoint(c("qpl")._(64225282,"3408"),"call_accepted",{instanceKey:+this.$3});c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"call_accepted",{instanceKey:+this.$3});break;case"dismissRecv":c("QPLUserFlow").addPoint(c("qpl")._(64225282,"3408"),"dismiss_recv",{instanceKey:+this.$3});c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"dismiss_recv",{instanceKey:+this.$3});break;case"inviteResponded":c("QPLUserFlow").addPoint(c("qpl")._(64225282,"3408"),"invite_responded",{instanceKey:+this.$3});c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"invite_responded",{instanceKey:+this.$3});break;case"popupOpened":c("QPLUserFlow").endSuccess(c("qpl")._(64225282,"3408"),{instanceKey:+this.$3});c("QPLUserFlow").addPoint(c("qpl")._(398997251,"1544"),"popup_opened",{instanceKey:+this.$3});break}return(h||(h=b("Promise"))).resolve()};return a}();e={LogProcessor:a,approvedForMandatedE2ee:function(){return d("ZenonArmadilloLoggingChecks").isArmadilloQPLLoggingEnabled()}};g.ZenonParentQPLLogProcessor=a;g.ZenonParentQPLLogProcessorConfig=e}),98);
__d("ZenonParentSignalingClient",["Promise","ZenonDebugLogger","ZenonSignalingTypes","promiseDone","qpl","recoverableViolation","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b,d,e){var f=this;this.remoteSignalingID=null;this.$4="init";this.$6=null;this.$7=null;this.$8=function(){};this.$9=function(a,b,d){c("ZenonDebugLogger").getInstance().logStateMachine("ParentSignalingClient",f.$4,"received "+a.eventName,f.$1.getSignalingID());switch(a.eventName){case"inviteRequest":f.$11(a,b,d);break;case"remoteSdpRequest":f.$12(a,b);break;case"terminateRequest":f.$13(a,b,d);break}};this.$1=a;this.$3=d;this.$5=e;this.$2=b;b.setReceiver(this.$9);c("ZenonDebugLogger").getInstance().startQPL(c("qpl")._(64234815,"1094"),+a.getSignalingID())}var e=a.prototype;e.setSignalingEventHandlers=function(a){if(this.$6!=null){c("recoverableViolation")("setSignalingEventHandlers should only be called once, to avoid accidentally losing handlers.","rtc_www");return}this.$6=a};e.setLoggingEventHandler=function(a){this.$8=a};e.setSecureDataMessageManager=function(a){throw c("unrecoverableViolation")("setSecureDataMessageManager called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.getSignalingModel=function(){return this.$1};e.processReceiveEvent=function(a,b,d){throw c("unrecoverableViolation")("processReceiveEvent called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendDismiss=function(a){this.$4="terminated";a={eventName:"terminateRequest",fromJoinResponse:!1,reason:a,shouldInformPeer:!0};return this.$10(a)};e.receiveMessage=function(a){this.$2.receiveMessage(a)};e.isTerminated=function(){return this.$4==="terminated"};e.sendAnswerIntent=function(){if(this.$4==="inviteAcknowledged"){this.$4="answered";var a={eventName:"answerIntentRequest"};return this.$10(a)}else throw c("unrecoverableViolation")("sendAnswerIntent called in unexpected state "+this.$4,"rtc_www")};e.respondToInvite=function(a){if(this.$4==="inviteReceived"){if(this.$7==null)throw c("unrecoverableViolation")("respondToInvite called without inviteMessageId being populated first","rtc_www");this.$4="inviteAcknowledged";a={ackMessageId:this.$7,eventName:"inviteResponse",status:a};return this.$10(a)}else throw c("unrecoverableViolation")("respondToInvite called in unexpected state "+this.$4,"rtc_www")};e.initiateClientRenegotiation=function(a){throw c("unrecoverableViolation")("initiateClientRenegotiation called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendClientEvent=function(a){throw c("unrecoverableViolation")("sendClientEvent called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendInvite=function(a,b,d){throw c("unrecoverableViolation")("sendInvite called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendSdp=function(a,b){throw c("unrecoverableViolation")("sendSdp called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendIceCandidate=function(a){throw c("unrecoverableViolation")("sendIceCandidate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendMediaUpdate=function(a){throw c("unrecoverableViolation")("sendMediaUpdate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendAddParticipantsMessage=function(a){throw c("unrecoverableViolation")("sendAddParticipantsMessage called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendRemoveParticipantsRequest=function(a){throw c("unrecoverableViolation")("sendRemoveParticipantsRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendUsersApprovalRequest=function(a,b){throw c("unrecoverableViolation")("sendUsersApprovalRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendStateSyncUnsubscribe=function(a){throw c("unrecoverableViolation")("sendStateSyncUnsubscribe called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendStateSyncUpdate=function(a,b){throw c("unrecoverableViolation")("sendStateSyncUpdate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendSubscriptionRequest=function(a){throw c("unrecoverableViolation")("sendSubscriptionRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendClientInfo=function(a){throw c("unrecoverableViolation")("sendClientInfo called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.sendGenericDataMessage=function(a,b,d){throw c("unrecoverableViolation")("sendGenericDataMessage called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.silentlyTerminate=function(){throw c("unrecoverableViolation")("terminate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};e.$10=function(a){var d=this;c("ZenonDebugLogger").getInstance().logStateMachine("ParentSignalingClient",this.$4,"sending "+a.eventName,this.$1.getSignalingID());return new(h||(h=b("Promise")))(function(b,c){return d.$3.sendEvent(a,b,c)})};e.$11=function(a,b,c){this.$4==="init"&&(this.$4="inviteReceived",this.$7=b,this.$5(a,c,this))};e.$13=function(a,b,d){if(this.$4!=="terminated"){this.$4="terminated";d={ackMessageId:b,eventName:"dismissResponse"};this.$3.sendEvent(d);if(this.$6&&this.$6.onDismissReceived){c("promiseDone")(this.$6.onDismissReceived(this.$1.getSignalingID(),a.reason,(b=a.subreason)!=null?b:null,a.detailedReasonFromMW))}}};e.$12=function(a,b){b={ackMessageId:b,acknowledgedVersion:a.sdp.version,eventName:"remoteSdpResponse",negotiateType:a.negotiateType,statusCode:d("ZenonSignalingTypes").ZenonSignalingStatusCode.OK,type:a.sdp.type};this.$3.sendEvent(b)};return a}();g["default"]=a}),98);
__d("ZenonSDKRateLimiter",["TokenBucketRateLimit","ZenonPlatformRateLimitSitevarConfig"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.take=function(a,b){b===void 0&&(b=1);a=this.$2(a);return a.take(b)};b.$2=function(a){var b,d=this.$1.get(a);if(d)return d;b=(b=c("ZenonPlatformRateLimitSitevarConfig").buckets.get(a))!=null?b:c("ZenonPlatformRateLimitSitevarConfig")["default"];d=new(c("TokenBucketRateLimit"))(b.bucket_size,b.refill_rate);this.$1.set(a,d);return d};return a}();g["default"]=a}),98);
__d("ZenonSignalingTransportTypes",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({CHILD_WINDOW_READY:"rtc_child_window_ready",PARENT_INITIATED_CALL:"rtc_child_window_start_call",PARENT_LOG_IDENTIFIERS:"rtc_parent_log_identifiers",PARENT_QPL_MARKER:"rtc_parent_qpl_marker",PARENT_TO_CHILD_MESSAGE:"rtc_child_window_message"});f.ChildTransportMessageType=a}),66);
__d("isFacebookishURI",["isFacebookURI","isMessengerDotComURI"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("isFacebookURI")(a)||c("isMessengerDotComURI")(a)}g["default"]=a}),98);
__d("ZenonSignalingParentTransport",["MultiwaySharedTypes","QuickPerformanceLogger","RTWebIncomingRingConfiguration","Random","URI","ZenonBrowsers","ZenonE2eeMandatedStateManager","ZenonIGMediaUtil","ZenonMWMessageTypes","ZenonSignalingTransportTypes","isFacebookishURI","recoverableViolation","shouldUseSFUMediaPath"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=45*1e3;a=function(){function a(a){var b=this;this.verificationNonce=null;this.portToChild=null;this.$1=null;this.$2=null;this.localCallID=null;this.$3=new Map();this.$4=new Map();this.$5=new Map();this.$6=new Map();this.$7=window;a!=null&&(this.$7=a);d("RTWebIncomingRingConfiguration").isSupportedClient()&&this.$7.addEventListener&&this.$7.addEventListener("message",function(a){b.handleWindowMessageFromChild(a)},!1)}var b=a.prototype;b.handleWindowMessageFromChild=function(a){var b=this;if(this.windowMessageValid(a)&&a.data.type===d("ZenonSignalingTransportTypes").ChildTransportMessageType.CHILD_WINDOW_READY&&this.hasPort(a)){var c;c=(c=a.data.roomID)!=null?c:null;var e=a.data.serverInfoData;this.portToChild=a.ports[0];a=a.data.childNonce;this.$2=a;this.$7.clearTimeout(this.$1);this.$1=this.$7.setTimeout(function(){b.portToChild=null},j);this.verificationNonce=this.generateNonce();this.startCallInChildWindow(c,e);this.sendQPLToChildWindow();this.sendLogIdentifiersToChildWindow(this.localCallID)}};b.generateNonce=function(){return String(d("Random").random())};b.hasPort=function(a){return Boolean(a.ports!=null&&Array.isArray(a.ports)&&a.ports[0]!=null)};b.getRingRequestBySID=function(a){var b;b=k((b=this.$4.get(a))!=null?b:null);a=l((a=this.$6.get(a))!=null?a:null);return{mwRingRequest:b,mwThriftRingRequest:a}};b.startCallInChildWindow=function(a,b){var c=null,e=null;if(b!==void 0){if(b!=null){b=this.getRingRequestBySID(b);c=b.mwRingRequest;e=b.mwThriftRingRequest}}else if(a!=null){c=k((b=this.$3.get(a))!=null?b:null);e=l((b=this.$5.get(a))!=null?b:null)}a={mwRingRequest:c,mwThriftRingRequest:e,nonce:this.$2,type:d("ZenonSignalingTransportTypes").ChildTransportMessageType.PARENT_INITIATED_CALL};this.sendMessageToChild(a)};b.sendQPLToChildWindow=function(){var a=new Map();(h||(h=c("QuickPerformanceLogger"))).activeMarkers.forEach(function(b,c){(c===398997251||c===41156610)&&a.set(c,b)});if(a.size>0){var b={markers:a,nonce:this.$2,type:d("ZenonSignalingTransportTypes").ChildTransportMessageType.PARENT_QPL_MARKER,version:2};this.sendMessageToChild(b);a.forEach(function(a){for(var a=a,b=Array.isArray(a),d=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(b){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;var f=e[0];e=e[1];(h||(h=c("QuickPerformanceLogger"))).markerDrop(e.event,f)}})}};b.sendLogIdentifiersToChildWindow=function(a){a={localCallID:a,nonce:this.$2,type:d("ZenonSignalingTransportTypes").ChildTransportMessageType.PARENT_LOG_IDENTIFIERS};this.sendMessageToChild(a)};b.windowMessageValid=function(a){return Boolean(a.origin===this.$7.location.origin||c("isFacebookishURI")(new(i||(i=c("URI")))(a.origin))&&c("isFacebookishURI")(new(i||(i=c("URI")))(this.$7.location.origin)))&&this.postMessageValid(a)};b.postMessageValid=function(a){return this.verificationNonce!==null&&(a==null?void 0:(a=a.data)==null?void 0:a.nonce)===this.verificationNonce};b.sendMessageToChild=function(a){this.portToChild!=null?this.portToChild.postMessage(a):c("recoverableViolation")("The child window port should be available","rtc_www")};b.enqueueRawMWMessage=function(a,b){var c=a.jsonPayload,d=c.body;c=c.header;d=d.ringRequest;if(d){d=c.conferenceName;c=c.serverInfoData;d!=null&&this.$3.set(d,{parsedMessage:b,rawMessage:a});c!=null&&this.$4.set(c,{parsedMessage:b,rawMessage:a})}};b.enqueueRawMWThriftMessage=function(a,b){var c=a.messageBody,d=a.messageHeader;c=c.ringRequest;if(c){c=d.conferenceName;d=d.serverInfoData;c!=null&&this.$5.set(c,{parsedMessage:b,rawMessage:a});d!=null&&this.$6.set(d,{parsedMessage:b,rawMessage:a})}};b.testGetChildNonce=function(){return this.$2};return a}();function k(a){var b;if(a===null)return null;var e=a.parsedMessage;a=a.rawMessage;if(e==null)return null;e=n(e);if((e==null?void 0:e.eventName)!=="inviteRequest")return null;e=(e=(e=a.jsonPayload.body.ringRequest)==null?void 0:e.isLegacyCall)!=null?e:!1;b=((b=a.jsonPayload.body.ringRequest)==null?void 0:(b=b.e2eeEnforcement)==null?void 0:b.mode)===d("ZenonMWMessageTypes").ZenonMWE2eeMode.E2EE_MANDATED;c("ZenonE2eeMandatedStateManager").processE2eeMandatedStateFromProductAndRing(b,(b=a.jsonPayload.body.ringRequest)==null?void 0:(b=b.e2eeEnforcement)==null?void 0:b.infraMandatedExpStatus);return o(e)?a:p(a)}function l(a){var b;if(a==null)return null;var e=a.parsedMessage;a=a.rawMessage;if(e==null)return null;e=n(e);if((e==null?void 0:e.eventName)!=="inviteRequest")return null;e=(e=(e=a.messageBody.ringRequest)==null?void 0:e.isLegacyCall)!=null?e:!1;b=((b=a.messageBody.ringRequest)==null?void 0:(b=b.e2eeEnforcement)==null?void 0:b.mode)===d("MultiwaySharedTypes").E2eeMode.E2EE_MANDATED;c("ZenonE2eeMandatedStateManager").processE2eeMandatedStateFromProductAndRing(b,(b=a.messageBody.ringRequest)==null?void 0:(b=b.e2eeEnforcement)==null?void 0:b.infraMandatedExpStatus);return o(e)?a:q(a)}function m(a){return d("ZenonBrowsers").isFirefox()||c("shouldUseSFUMediaPath")(a)||c("ZenonIGMediaUtil").shouldUseSFUOnly()}function n(a){a=a.getEvents().find(function(a){return a.eventName==="inviteRequest"});return a}function o(a){return a||!m(!1)}function p(a){var b;(b=a.jsonPayload.body.ringRequest)==null?void 0:delete b.offer;return a}function q(a){var b;(b=a.messageBody.ringRequest)==null?void 0:delete b.offer;return a}g["default"]=a}),98);
__d("ZenonParentCallsManager",["BaseEventEmitter","FBLogger","JSResource","JSResourceForInteraction","LazyLoadInstance","OverlayConfigManagerWithServerLayer","Promise","RTWebIncomingRingConfiguration","ZenonActorHooks","ZenonAppProvider","ZenonBrowsers","ZenonCallLogger","ZenonCallsModelTypes","ZenonCollisionContext","ZenonDeviceId","ZenonDismissReason","ZenonGraphQLMWMessageSender","ZenonMessageSenderChain","ZenonMqttMWMessageSender","ZenonParentClientPerfQPLLogProcessor","ZenonParentLSCallSummaryLogProcessor","ZenonParentQPLLogProcessor","ZenonParentSignalingClient","ZenonSDKRateLimiter","ZenonSignalingParentTransport","gkx","promiseDone","recoverableViolation","shouldUseThriftSignaling","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("JSResourceForInteraction")("setE2eeIsMandatedForZenonLoggers").__setRef("ZenonParentCallsManager"),j=c("JSResourceForInteraction")("ZenonGraphQLMWThriftMessageSender").__setRef("ZenonParentCallsManager");a=function(a){babelHelpers.inheritsLoose(e,a);function e(e){var f;f=a.call(this)||this;f.$ZenonParentCallsManager$p_4=new Map();f.$ZenonParentCallsManager$p_5=new Set();f.$ZenonParentCallsManager$p_6=null;f.$ZenonParentCallsManager$p_8=[];f.onInviteReceived=function(a,b,e){var g,h=e.getSignalingModel().getSignalingID();e.setSignalingEventHandlers({onDismissReceived:f.onDismissReceived});var i=a.appMessages,j=a.inviterID,k=a.isE2eeMandated,l=a.otherParticipants,m=a.requestingVideo,n=a.roomInfo,o=a.serverInfoData;k===!0&&f.$ZenonParentCallsManager$p_10(h);var p=m&&d("ZenonBrowsers").supportsVideoCalls(),q="multiway_incoming",r=c("uuidv4")(),s=f.$ZenonParentCallsManager$p_11({callTrigger:q,isCaller:!1,isVideo:p,localCallID:r,peerID:j,protocol:b,signalingID:h},(m=k)!=null?m:!1);s==null?void 0:s.log({name:"inviteReceived",serverInfoData:o});m=d("RTWebIncomingRingConfiguration").isSupportedClient();var t=m?"OK":"NOT_SUPPORTED";c("promiseDone")(e.respondToInvite(t));s==null?void 0:s.log({name:"inviteResponded"});t={thread:{id:"0",type:2},type:"thread"};if(n.context!=null&&(((g=n.context)==null?void 0:g.groupThreadID)!=null||((g=n.context)==null?void 0:g.peerID)!=null)){g=(g=a.appMessages)==null?void 0:g.collision_context_payload;var u=null;if(g!=null)try{u=JSON.parse(g).calling_tags}catch(a){}g=k===!0&&u===2;if(n.context!=null){t={thread:(u=d("ZenonCollisionContext").getThreadIDAndTypeFromCollisionContext(n.context,g))!=null?u:{id:"0",type:2},type:"thread"}}}else((g=n.room)==null?void 0:g.linkHash)!=null&&((u=n.room)==null?void 0:u.roomName)!=null&&(t={room:n.room,type:"room"});u=(g=a.actorID)!=null?g:d("ZenonActorHooks").ZenonActor.getID();g={mwRingRequest:null,mwThriftRingRequest:null};o!=null&&(g=f.$ZenonParentCallsManager$p_2.getRingRequestBySID(o));n={actorID:a.actorID,context:t,controllerParams:{appMessages:i,callContext:n.name,configuration:b,serverInfoData:(t=(o=n.context)==null?void 0:o.serverInfoData)!=null?t:null,signalingID:h},inviterID:j,isClientPermissableRing:m,isE2eeMandated:(i=k)!=null?i:!1,onAccept:function(a,d){d=d.isPopupBlocked;s==null?void 0:s.log({name:"callAccepted",trigger:q});c("promiseDone")(e.sendAnswerIntent());f.$ZenonParentCallsManager$p_12(a,{callTrigger:q,isE2eeMandated:(a=k)!=null?a:!1,isPopupBlocked:d,isVideo:p,peerID:j,protocol:b,signalingID:h},r)},onDecline:function(a,b){b===void 0&&(b=null),f.onDecline(h,s,a,b)},otherParticipants:l.includes(u)?l:[u].concat(l),receiverUserId:a.userID,requestingVideo:p,ringID:h,ringRequest:g};f.emit("incomingRing",n)};f.onDismissReceived=function(a,c){var e=d("ZenonDismissReason").dismissReasonToCancelReason(c);e={reason:e,ringID:a};f.emit("ringCancel",e);e=f.$ZenonParentCallsManager$p_4.get(a);e!=null&&(e.log({name:"dismissRecv"}),e.log({endCallReason:c,isRemoteEnded:!0,name:"callEnded"}));return(h||(h=b("Promise"))).resolve()};f.$ZenonParentCallsManager$p_7=new(c("OverlayConfigManagerWithServerLayer"))();f.$ZenonParentCallsManager$p_3=e;f.$ZenonParentCallsManager$p_2=new(c("ZenonSignalingParentTransport"))(window);var g=new(c("ZenonMessageSenderChain"))([new(c("ZenonMqttMWMessageSender"))()].concat(!d("ZenonAppProvider").isOculusCastingSite()&&e.relayEnvironment?[new(c("ZenonGraphQLMWMessageSender"))(e.relayEnvironment)]:[]));if(c("shouldUseThriftSignaling")()){var i=new(c("LazyLoadInstance"))(c("JSResource")("ZenonMqttMWThriftMessageSender").__setRef("ZenonParentCallsManager"),function(a){return new a()});i.get(function(a){return g.addMessageSender(a)});c("promiseDone")(j.load(),function(a){if(e.relayEnvironment){a=new a(e.relayEnvironment);g.addMessageSender(a)}})}f.$ZenonParentCallsManager$p_1=new(c("LazyLoadInstance"))(c("JSResource")("ZenonSignalingClientManager").__setRef("ZenonParentCallsManager"),function(a){return new a(c("ZenonParentSignalingClient"),f.onInviteReceived,g)});f.$ZenonParentCallsManager$p_6=new(c("ZenonSDKRateLimiter"))();return f}var f=e.prototype;f.startOutgoingCallIntent=function(a,b){if(!this.$ZenonParentCallsManager$p_9("startOutgoingCallIntent"))return;var d=b.callTrigger,e=b.isE2eeMandated,f=b.isVideo,g=b.peerID,h=b.protocol,i=b.signalingID;e&&this.$ZenonParentCallsManager$p_10(i);var j=c("uuidv4")();this.$ZenonParentCallsManager$p_11({callTrigger:d,isCaller:!0,isVideo:f,localCallID:j,peerID:g,protocol:h,signalingID:i},e);this.$ZenonParentCallsManager$p_12(a,b,j)};f.$ZenonParentCallsManager$p_11=function(a,b){var d,e=a.callTrigger,f=a.isCaller,g=a.isVideo,h=a.localCallID,i=a.peerID,j=a.protocol;a=a.signalingID;d=(d=this.$ZenonParentCallsManager$p_4.get(a))!=null?d:null;if(e==="meetup_join")return d;if(d!=null){c("recoverableViolation")("Call logger key collision in parentCallsManager for signalingID: "+a,"rtc_www");return d}var k=new(c("ZenonCallLogger"))({config:this.$ZenonParentCallsManager$p_7,initLoggerInfo:{callTrigger:e,isCaller:f,isVideo:g,localCallID:h,peerID:i,protocol:j,signalingID:a},isE2eeMandated:b,processorConfigs:this.getLogProcessors()});this.$ZenonParentCallsManager$p_4.set(a,k);this.$ZenonParentCallsManager$p_8.forEach(function(a){a.setLoggingEventHandler(function(a){return k.log(a)})});return k};f.getLogProcessors=function(){var a=[d("ZenonParentLSCallSummaryLogProcessor").ZenonParentLSCallSummaryLogProcessorConfig,d("ZenonParentQPLLogProcessor").ZenonParentQPLLogProcessorConfig];c("gkx")("25214")&&a.push(d("ZenonParentClientPerfQPLLogProcessor").ZenonParentClientPerfQPLLogProcessorConfig);return a};f.$ZenonParentCallsManager$p_12=function(a,b,c){var e=b.isPopupBlocked;b=b.signalingID;this.$ZenonParentCallsManager$p_2.localCallID=c;this.$ZenonParentCallsManager$p_2.verificationNonce=a;this.$ZenonParentCallsManager$p_5.add(b);c=this.$ZenonParentCallsManager$p_4.get(b);c!=null&&c.log({isPopupBlocked:e,name:"popupOpened"});d("ZenonDeviceId").setZenonLocalStorageDeviceId(d("ZenonDeviceId").getZenonLocalStorageDeviceIdWithFallback())};f.initListeners=function(a){var b=this;this.$ZenonParentCallsManager$p_8=a;for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e.subscribe(function(a){return b.onMessageReceived(a)},function(a,c){return b.$ZenonParentCallsManager$p_2.enqueueRawMWMessage(a,c)},function(a,c){return b.$ZenonParentCallsManager$p_2.enqueueRawMWThriftMessage(a,c)})}};f.onMessageReceived=function(a){var b=a.getHeader().signalingID;if(b!=null&&this.$ZenonParentCallsManager$p_5.has(b))return;this.$ZenonParentCallsManager$p_1.get(function(b){b.receiveMessage(a)})};f.onDecline=function(a,b,e,f){f===void 0&&(f=null),this.$ZenonParentCallsManager$p_1.get(function(g){g=g.getSignalingClient(a);if(g){var h=d("ZenonDismissReason").endCallToDismissReason(e);e!=="VersionUnsupported"&&f!==d("ZenonCallsModelTypes").ZenonEndCallSubreason.CallsBlocked&&c("promiseDone")(g.sendDismiss(h));b==null?void 0:b.log({endCallReason:h,endCallSubreason:f==null?null:f,isRemoteEnded:!1,name:"callEnded"})}else c("recoverableViolation")("signaling client should be defined","rtc_www")})};f.removeListeners=function(a){for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.unsubscribe()}};f.$ZenonParentCallsManager$p_9=function(a){if(this.$ZenonParentCallsManager$p_6&&!this.$ZenonParentCallsManager$p_6.take(a)){c("FBLogger")("rtc_www").warn("[ZP] Dropping %s invocation. This SDK method is being called too rapidly.",a);return!1}return!0};f.$ZenonParentCallsManager$p_10=function(a){c("promiseDone")(i.load(),function(b){return b(a)})};return e}(c("BaseEventEmitter"));g["default"]=a}),98);
__d("delegateZenonCallInviteModel",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a.getCurrentInvite=b.getCurrentInvite.bind(b),a.startListening=b.startListening.bind(b),a.stopListening=b.stopListening.bind(b),a.dismiss=b.dismiss.bind(b),a.accept=b.accept.bind(b),a.decline=b.decline.bind(b),b.addListener("callInvite",function(b){a.emit("callInvite",b)})}f["default"]=a}),66);/*FB_PKG_DELIM*/
__d("ACSCipherSuiteModule",[],(function(a,b,c,d,e,f){"use strict";b={hash:"SHA-512",name:"HMAC"};c={curveName:"RISTRETTO",macAlgorithm:b,value:1};var g=new Map([[c.value,c]]);function a(a){return g.has(a)?g.get(a):null}f.VOPRF_RISTRETTO_HMACSHA512=c;f.getACSCipherSuiteByValue=a}),66);
__d("ACSTokenHmacUtil",["XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h(a,b).then(function(a){return j(a,c)})}function h(a,b){return d("XPlatReactCrypto").subtleImportKey("raw",b,a,!1,["sign"]).then(function(b){return{algo:a,key:b}})}function i(a){return typeof a.hash==="string"?a.hash:a.hash.name}function j(a,b){var c=a.algo;a=a.key;c={hash:i(c),name:"HMAC"};return d("XPlatReactCrypto").subtleSign(c,a,b).then(function(a){return new Uint8Array(a)})}g.hmac=a}),98);
__d("LSACSExperimentCapability",[],(function(a,b,c,d,e,f){a=Object.freeze({RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:0,BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:1,INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:2});f["default"]=a}),66);
__d("LSBeginHandlingFireForgetTasksForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return c[0]=b.createArray(),b.forEach(b.filter(b.db.table(5).fetch(),function(b){return b.queueName===a[0]}),function(a){a=a.item;return c[3]=new b.Map(),c[3].set("label",a.context),c[3].set("payload",a.taskValue),c[3].set("queue_name",a.queueName),c[3].set("task_id",a.taskId),c[3].set("failure_count",b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))?void 0:b.i64.cast([0,0])),c[4]=(c[0].push(c[3]),c[0])})},function(e){return c[1]=new b.Map(),c[1].set("tasks",c[0]),c[1].set("epoch_id",void 0),c[2]=new b.Map(),c[2].set("queue_name",a[0]),c[2].set("next_sync_ms",void 0),c[2].set("work_item_type",b.i64.cast([0,5])),c[2].set("network_payload",c[1]),c[2].set("http_url_override",void 0),c[2].set("skip_realtime_gateway",!1),d[0]=c[2]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreBeginHandlingFireForgetTasksForQueueStoredProcedure";e.exports=a}),null);
__d("LSBeginHandlingFireForgetTasksForQueueStoredProcedure",["LSBeginHandlingFireForgetTasksForQueue","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSBeginHandlingFireForgetTasksForQueue")(b.queueName,a)}g["default"]=a}),98);
__d("LSForceTaskExecutionImmediately",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?0:(e=d.item,c[1]=b.i64.of_float(Date.now()),b.i64.lt(c[1],e.minTimeToSyncTimestampMs)?b.forEach(b.db.table(2).fetch([[[a[0]]]]),function(a){var c=a.update;a=a.item;return c({minTimeToSyncTimestampMs:b.i64.cast([0,0]),failureCount:b.i64.add(a.failureCount,b.i64.cast([0,1]))})}):b.resolve())})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreForceTaskExecutionImmediatelyStoredProcedure";e.exports=a}),null);
__d("LSRemoveUsedTokens",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.forEach(b.filter(b.db.table(309).fetch(),function(a){return b.i64.le(a.redeemLimit,b.i64.cast([0,0]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSAnonymousCredentialsRemoveUsedTokensStoredProcedure";e.exports=a}),null);
__d("LSGetCurrentTokenPoolState",["LSArrayGetObjectAt","LSRemoveBlindedTokens","LSRemoveUsedTokens"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),d[1]=c.createArray(),c.count(c.filter(c.db.table(307).fetch(),function(b){return b.projectName===a[0]})).then(function(a){return d[2]=a})},function(b){return c.forEach(c.filter(c.db.table(307).fetch(),function(b){return b.projectName===a[0]}),function(a){a=a.item;return d[7]=a.configId,c.i64.gt(d[0],a.expirationTimestampMs)?c.forEach(c.db.table(307).fetch([[[d[7]]]]),function(a){return a["delete"]()}):c.resolve(d[8]=(d[1].push(d[7]),d[1]))})},function(a){return c.storedProcedure(b("LSRemoveUsedTokens"))},function(a){return d[3]=c.i64.cast([0,0]),d[4]=c.i64.of_int32(d[1].length),c.i64.gt(d[4],c.i64.cast([0,0]))?c.loopAsync(d[4],function(a){return d[7]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[1],d[7]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return c.count(c.filter(c.db.table(309).fetch(),function(a){return a.configId===d[8]})).then(function(a){return d[10]=a})},function(a){return d[3]=c.i64.add(d[10],d[3]),c.storedProcedure(b("LSRemoveBlindedTokens"),d[8])}])}):c.resolve()},function(a){return c.i64.gt(d[2],c.i64.cast([0,0]))?(d[7]=c.i64.of_int32(d[1].length),d[5]=c.i64.ge(d[7],c.i64.cast([0,1]))):d[5]=void 0,d[5]!==void 0?(d[5]?(c.i64.gt(d[3],c.i64.cast([0,0]))?d[8]=c.i64.cast([0,3]):d[8]=c.i64.cast([0,2]),d[7]=d[8]):d[7]=c.i64.cast([0,1]),d[6]=d[7]):d[6]=c.i64.cast([0,0]),a=[d[6],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsGetCurrentTokenPoolStateStoredProcedure";e.exports=a}),null);
__d("LSIssueNextSync",["LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.count(c.filter(c.db.table(310).fetch(),function(b){return b.projectName===a[1]})).then(function(a){return d[0]=a})},function(e){return c.i64.gt(d[0],c.i64.cast([0,0]))&&a[3]===!0?c.resolve(0):c.sequence([function(b){return c.forEach(c.filter(c.db.table(310).fetch(),function(b){return b.projectName===a[1]}),function(a){return a["delete"]()})},function(e){return c.i64.gt(a[2],c.i64.cast([0,0]))?(d[3]=c.i64.of_float(Date.now()),d[1]=c.i64.add(d[3],a[2])):d[1]=c.i64.cast([0,0]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["acs_sync","_",a[1]].join(""),c.i64.cast([0,362]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[1],c.i64.cast([0,0])).then(function(a){return a=a,d[2]=a[0],a})},function(b){return c.db.table(310).add({taskId:d[2],projectName:a[1],maxClientTokenPoolSize:a[0]})}])}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsIssueNextSyncStoredProcedure";e.exports=a}),null);
__d("LSVoprfBlind.nop",["LSVoprfLoggingUtils","XPlatReactVoprf","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(25304788,"29");a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=d("LSVoprfLoggingUtils").getAcsQplEventLogger(h);a.start();b=(yield d("XPlatReactVoprf").loadXPlatReactVoprf());var e=b.instanceCreationTimestampNs;b=b.voprfInstance;var f=b.voprfInfo,g=b.voprfWasm;a.addVoprfLoadedPoint(e);try{e=g.blind(f,new Uint8Array(c));a.endSuccess({wasmMemorySize:(f=g.wasmMemory)==null?void 0:f.buffer.byteLength});return[e.blindedElement.buffer,e.blindingFactor.buffer]}catch(b){a.endFailure({error:b,wasmMemorySize:(c=g.wasmMemory)==null?void 0:c.buffer.byteLength});throw b}finally{d("XPlatReactVoprf").freeVoprfInstance(b)}});function c(b,c,d){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("LSVoprfCreateNonce.nop",["Promise","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h,i=32;a=function(a,c){a=i;c=new Uint8Array(a);d("XPlatReactCrypto").getRandomValues(c);return(h||(h=b("Promise"))).resolve([c.buffer])};g["default"]=a}),98);
__d("LSTaskSerializerAcsIssueNextSync",["LSBase64Encode.nop","LSGetCurrentTokenPoolState","LSIssueNextSync","LSVoprfBlind.nop","LSVoprfCreateNonce.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.db.table(310).fetch([[[a[0]]]]).next().then(function(a,e){var f=a.done;a=a.value;return f?(function(a){c.logger(a).mustfix(a)}("Request context for the passed task_id was not found"),f=[void 0,void 0,void 0],d[0]=f[0],d[1]=f[1],d[2]=f[2],f):(e=a.item,c.sequence([function(a){return d[9]=e.projectName,d[10]=e.maxClientTokenPoolSize,c.storedProcedure(b("LSGetCurrentTokenPoolState"),d[9]).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(a){return c.i64.eq(d[4],c.i64.cast([0,0]))||c.i64.eq(d[4],c.i64.cast([0,1]))?c.resolve((d[11]=new c.Map(),d[11].set("project_name",d[9]),d[12]=c.toJSON(d[11]),a=[d[12],c.i64.cast([0,351]),void 0],d[6]=a[0],d[7]=a[1],d[8]=a[2],a)):c.sequence([function(a){return d[11]=c.i64.of_float(Date.now()),c.islc(c.sortBy(c.filter(c.db.table(307).fetch(),function(a){return a.projectName===d[9]&&c.i64.gt(a.expirationTimestampMs,d[11])}),[["expirationTimestampMs","DESC"]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?(function(a){c.logger(a).mustfix(a)}("A config for the passed project name was not found"),d[16]=new c.Map(),d[16].set("project_name",d[9]),d[16].set("max_client_token_pool_size",d[10]),d[17]=c.toJSON(d[16]),a=[d[17],c.i64.cast([0,362]),void 0],d[12]=a[0],d[13]=a[1],d[14]=a[2],a):(f=e.item,c.sequence([function(a){return d[24]=f.configId,d[16]=f.maxEvals,d[26]=f.tokenPollFrequencyMs,d[25]=f.maxClientTokenPoolSize,d[17]=c.i64.sub(d[10],d[5]),d[23]=c.i64.lt(d[16],d[17])?d[16]:d[17],d[18]=c.createArray(),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(a){return d[27]=a,c.sequence([function(a){return c.nativeOperation(b("LSVoprfCreateNonce.nop")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return c.blobs.neq(d[28],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSVoprfBlind.nop"),d[28]).then(function(a){return a=a,d[29]=a[0],d[30]=a[1],a})},function(a){return c.blobs.neq(d[29],void 0)?c.blobs.neq(d[30],void 0)?c.sequence([function(a){return d[31]=c.i64.cast([-1,4294967295]),c.db.table(308).peekNextAutoIncrementId().then(function(a){return d[31]=a})},function(a){return c.db.table(308).add({tokenId:void 0,blindedNonce:d[29],blindingFactor:d[30],nonce:d[28],configId:d[24]})},function(a){return c.db.table(308).fetch([[[d[31]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[32]=c.i64.cast([-1,4294967295]):(e=b.item,d[32]=e.tokenId)})},function(a){return c.i64.eq(d[32],c.i64.cast([-1,4294967295]))?c.sequence([function(a){return c.islc(c.db.table(308).fetchDesc([[[{gt:c.i64.cast([0,0])}]]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,e){var a=b.done;b=b.value;return a?d[37]=c.i64.cast([-1,4294967295]):(e=b.item,d[37]=e.tokenId)})},function(a){return d[34]=d[37]}]):c.resolve(d[34]=d[32])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[29]).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[36]=new c.Map(),d[36].set("id",d[34]),d[36].set("data",d[35]==null?"":d[35]),d[37]=(d[18].push(d[36]),d[18])}]):c.resolve():c.resolve()}]):c.resolve()}])}):c.resolve()},function(a){return d[19]=c.i64.of_int32(d[18].length),c.i64.gt(d[19],c.i64.cast([0,0]))?c.resolve((d[27]=new c.Map(),d[27].set("project_name",d[9]),d[27].set("config_id",d[24]),d[27].set("blinded_nonces",d[18]),d[28]=c.toJSON(d[27]),a=[d[28],c.i64.cast([0,354]),void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],a)):c.sequence([function(a){return c.i64.neq(d[26],void 0)?c.sequence([function(a){return c.i64.neq(d[25],void 0)?c.sequence([function(a){return function(a){c.logger(a).info(a)}(["Already have the max number of tokens. Scheduling next ACS token sync locally for project: ",d[9]].join("")),c.storedProcedure(b("LSIssueNextSync"),d[25],d[9],d[26],!1)},function(a){return a=[void 0,void 0,void 0],d[30]=a[0],d[31]=a[1],d[32]=a[2],a}]):c.resolve((function(a){c.logger(a).info(a)}(["token_poll_frequency is nonnull but max_client_token_pool_size is null. Already have the max number of tokens. Scheduling the next ACS token sync for project: ",d[9]].join("")),d[33]=new c.Map(),d[33].set("project_name",d[9]),d[33].set("max_client_token_pool_size",d[10]),d[34]=c.toJSON(d[33]),a=[d[34],c.i64.cast([0,362]),void 0],d[30]=a[0],d[31]=a[1],d[32]=a[2],a))},function(a){return a=[d[30],d[31],d[32]],d[27]=a[0],d[28]=a[1],d[29]=a[2],a}]):c.resolve((function(a){c.logger(a).info(a)}(["Already have the max number of tokens. Scheduling the next ACS token sync for project: ",d[9]].join("")),d[30]=new c.Map(),d[30].set("project_name",d[9]),d[30].set("max_client_token_pool_size",d[10]),d[31]=c.toJSON(d[30]),a=[d[31],c.i64.cast([0,362]),void 0],d[27]=a[0],d[28]=a[1],d[29]=a[2],a))},function(a){return a=[d[27],d[28],d[29]],d[20]=a[0],d[21]=a[1],d[22]=a[2],a}])},function(a){return a=[d[20],d[21],d[22]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return a=[d[12],d[13],d[14]],d[6]=a[0],d[7]=a[1],d[8]=a[2],a}])},function(a){return a=[d[6],d[7],d[8]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}]))})},function(a){return a=[d[0],d[1],d[2]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsTaskSerializerAcsIssueNextSyncStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerDeleteChatHistory",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("taskSerializerDeleteChatHistory: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?(c[9]=b.createArray(),c[10]=(c[9].push("taskSerializerDeleteChatHistory: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),d=[void 0,void 0,void 0],c[4]=d[0],c[5]=d[1],c[6]=d[2],d):(a.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,903]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerDeleteChatHistoryStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerE2eeMessageIntegrityCheckV2",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,705]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerE2eeMessageIntegrityCheckV2StoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerE2eeMetadataThreadIntegrityCheck",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,700]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSE2EEMessagingMetadataMailboxTaskSerializerE2eeMetadataThreadIntegrityCheckStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupAction",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,319]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsLoopingUpload",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure] LSEncryptedBackupsLoopingUploadPayloadsTable table not found"),d[2]=c.createArray(),void 0!==void 0?d[9]=(d[2].push(void 0),d[2]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure","LSEncryptedBackupsLoopingUploadPayloadsTable table not found",d[2],c.i64.cast([0,3]))},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[6]="Finishing execution. Execution time: ",d[7]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[8]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] ",d[5],d[6],d[5],d[7],d[5],d[8]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[9]=",",d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsLoopingUpload",[d[6],d[9],d[7],d[9],d[8]].join(""),d[10],c.i64.cast([0,4]))):c.resolve()},function(a){return a=['{"request_id":"unknown","upload_type":"FBN","payload":{"error_code":2,"operation":"","error_message":"","__typename":"MPSUploadFailurePayload"}}',c.i64.cast([0,50043]),void 0],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure";e.exports=a}),null);
__d("LSQueryLocalPersistenceStoreForBackup.nop",["Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){c=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store).filter(function(a){var b=a.offlineThreadingId;a=a.threadId;return a===e&&f===b})));if(c.length===0)return(h||(h=b("Promise"))).resolve([void 0,void 0,!1]);a=c[0];return(h||(h=b("Promise"))).resolve([a.messagePayload,a.messageTimestampMs,!1])});function c(b,c,d,e){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("LSQueryLocalPersistenceStoreSupplementalForBackup.nop",["Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g){c=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store_supplemental).filter(function(a){var b=a.supplementalKey,c=a.threadId;a=a.toplevelOfflineThreadingId;return c===e&&a===f&&b===g})));return c==null?(h||(h=b("Promise"))).resolve([void 0,void 0]):(h||(h=b("Promise"))).resolve([c.messagePayload,c.messageTimestampMs])});function c(b,c,d,e,f){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("isInstamadilloOpenEB",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("890")===!0}g["default"]=a}),98);
__d("LSQueryLocalPersistenceStoreTagsForBackup.nop",["LSVec","Promise","ReQL","asyncToGeneratorRuntime","isInstamadilloEB","isInstamadilloOpenEB"],(function(a,b,c,d,e,f,g){"use strict";var h,i=":";a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){if(!c("isInstamadilloEB")()&&!c("isInstamadilloOpenEB")())return(h||(h=b("Promise"))).resolve([c("LSVec").ofArray([])]);e=(yield d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store_tag_index.index("offlineThreadingId")).getKeyRange(g,f)));if(e==null)return(h||(h=b("Promise"))).resolve([c("LSVec").ofArray([])]);a=e.tag;return(h||(h=b("Promise"))).resolve([c("LSVec").ofArray(a.split(i))])});function e(b,c,d,e){return a.apply(this,arguments)}return e}();g["default"]=a}),98);
__d("LSLoadUnencryptedProtobufWithInputs",["LSBase64Encode.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadUnencryptedProtobufWithInputs] Beginning execution."),d[1]=c.i64.of_float(Date.now()),!1===!0?c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error REQUIRED_COLUMN_NOT_PRESENT_ON_CLIENT"),d[10]=new c.Map(),d[10].set("error_code",c.i64.cast([-1,4294967293])),d[10].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[10].set("error_message",""),e=[void 0,d[10]],d[2]=e[0],d[3]=e[1],e)):c.sequence([function(e){return c.i64.eq(a[0],c.i64.cast([0,1]))?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],d[14]=a[2],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[15]=a[0],a})},function(e){return c.blobs.neq(d[12],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[12]).then(function(a){return a=a,d[18]=a[0],a})},function(b){return d[18]!==void 0?(d[15]!==void 0?(d[23]=new c.Map(),d[23].set("message_tags",d[15]),d[24]=new c.Map(),d[28]="message_tags",d[25]=d[23].get(d[28]),d[23],d[25]?d[26]=!1:d[26]=!0,d[26]?0:d[24].set(d[28],d[25]),d[27]=c.toJSON(d[24]),d[21]=d[27]):d[21]=void 0,d[22]=new c.Map(),d[22].set("backup_action",a[0]),d[22].set("protobuf_encrypted",d[18]),d[22].set("supplemental_data_encrypted",void 0),d[22].set("timestamp_ms",a[4]),d[22].set("message_tags",d[21]),b=[d[22],void 0],d[19]=b[0],d[20]=b[1],b):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,68])),d[21].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[21].set("error_message",""),b=[void 0,d[21]],d[19]=b[0],d[20]=b[1],b),b=[d[19],d[20]],d[16]=b[0],d[17]=b[1],b}]):c.resolve((d[14]?(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,70])),d[20].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[18]=e[0],d[19]=e[1],e):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,63])),d[20].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[18]=e[0],d[19]=e[1],e),e=[d[18],d[19]],d[16]=e[0],d[17]=e[1],e))},function(a){return a=[d[16],d[17]],d[10]=a[0],d[11]=a[1],a}]):c.sequence([function(e){return c.i64.eq(a[0],c.i64.cast([0,2]))?c.sequence([function(e){return a[3]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),a[1],a[2],a[3]).then(function(a){return a=a,d[16]=a[0],d[17]=a[1],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[18]=a[0],a})},function(e){return c.blobs.neq(d[16],void 0)?c.sequence([function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[3]).then(function(a){return a=a,d[21]=a[0],a})},function(e){return c.blobs.neq(d[21],void 0)?c.sequence([function(a){return d[24]=new c.Map(),d[24].set("sk_ciphertext",d[21]),d[24].set("sk_hash",d[21]),c.nativeOperation(b("LSBase64Encode.nop"),d[16]).then(function(a){return a=a,d[25]=a[0],a})},function(b){return d[25]!==void 0?(d[18]!==void 0?(d[30]=new c.Map(),d[30].set("message_tags",d[18]),d[31]=new c.Map(),d[35]="message_tags",d[32]=d[30].get(d[35]),d[30],d[32]?d[33]=!1:d[33]=!0,d[33]?0:d[31].set(d[35],d[32]),d[34]=c.toJSON(d[31]),d[28]=d[34]):d[28]=void 0,d[29]=new c.Map(),d[29].set("backup_action",a[0]),d[29].set("protobuf_encrypted",d[25]),d[29].set("supplemental_data_encrypted",d[24]),d[29].set("timestamp_ms",a[4]),d[29].set("message_tags",d[28]),b=[d[29],void 0],d[26]=b[0],d[27]=b[1],b):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),d[28]=new c.Map(),d[28].set("error_code",c.i64.cast([0,68])),d[28].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[28].set("error_message",""),b=[void 0,d[28]],d[26]=b[0],d[27]=b[1],b),b=[d[26],d[27]],d[22]=b[0],d[23]=b[1],b}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_FORMATTING_FAILED"),d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,69])),d[24].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[24].set("error_message",""),e=[void 0,d[24]],d[22]=e[0],d[23]=e[1],e))},function(a){return a=[d[22],d[23]],d[19]=a[0],d[20]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,64])),d[21].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[21].set("error_message",""),e=[void 0,d[21]],d[19]=e[0],d[20]=e[1],e))},function(a){return a=[d[19],d[20]],d[14]=a[0],d[15]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,65])),d[16].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[16].set("error_message",""),e=[void 0,d[16]],d[14]=e[0],d[15]=e[1],e))},function(a){return a=[d[14],d[15]],d[12]=a[0],d[13]=a[1],a}]):c.resolve((c.i64.eq(a[0],c.i64.cast([0,3]))?(d[16]=new c.Map(),d[16].set("backup_action",a[0]),d[16].set("protobuf_encrypted",void 0),d[16].set("supplemental_data_encrypted",void 0),d[16].set("timestamp_ms",a[4]),d[16].set("message_tags",void 0),e=[d[16],void 0],d[14]=e[0],d[15]=e[1],e):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error INVALID_BACKUP_OPERATION"),d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([-1,4294967289])),d[16].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[16].set("error_message",""),e=[void 0,d[16]],d[14]=e[0],d[15]=e[1],e),e=[d[14],d[15]],d[12]=e[0],d[13]=e[1],e))},function(a){return a=[d[12],d[13]],d[10]=a[0],d[11]=a[1],a}])},function(a){return a=[d[10],d[11]],d[2]=a[0],d[3]=a[1],a}])},function(a){return d[4]=c.i64.of_float(Date.now()),d[5]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[4],d[0])),d[9]=" ms",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadUnencryptedProtobufWithInputs] ",d[6],d[7],d[6],d[8],d[6],d[9]].join("")),c.i64.eq(c.i64.mod_(d[5],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufWithInputs",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure";e.exports=a}),null);
__d("LSLoadUnencryptedProtobufBackupSerializedPayloadData",["LSLoadUnencryptedProtobufWithInputs","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[19]=c.i64.mul(d[1],c.i64.cast([0,1e6])),c.db.table(2).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?(d[23]=c.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f):(e=b.item,d[23]=c.i64.of_float(Date.now()),f=[a[0],e.queueName,e.enqueueTimestampMs,e.priority,e.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f)})},function(e){return d[10]=new c.Map(),d[10].set("task_id",d[2]),d[10].set("queue_name",d[3]),d[10].set("enqueue_timestamp_ms",d[4]),d[10].set("priority",d[5]),d[10].set("first_executed_timestamp_ms",d[6]),d[10].set("execution_time_ns",d[7]),d[10].set("echo_encoding_execution_time_ns",d[8]),d[11]=new c.Map(),d[11].set("task_metadata",d[10]),d[11].set("action_type",void 0),d[11].set("content_type",void 0),d[11].set("identifiers",void 0),d[11].set("identifiers_v2",void 0),d[11].set("task_creation_source",void 0),d[11].set("message_payload_source",c.i64.cast([0,2])),c.filter(c.db.table(305).fetch(),function(b){return c.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[23]=new c.Map(),d[23].set("error_code",c.i64.cast([0,5])),d[23].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure"),d[23].set("error_message",""),g=[void 0,d[23],d[11]],d[12]=g[0],d[13]=g[1],d[14]=g[2],g):(f=e.item,c.sequence([function(b){return d[41]=f.actThreadId,d[42]=f.toplevelOfflineThreadingId,d[24]=f.messageTimestampMs,d[23]=new c.Map(),d[23].set("backup_id","openEbUploadGenericBackupId"),d[23].set("act_thread_id",d[41]),d[23].set("server_thread_id",d[41]),d[23].set("timestamp",c.i64.to_string(d[24])),d[23].set("otid",d[42]),d[25]=new c.Map(),d[25].set("backup_id","openEbUploadGenericBackupId"),d[25].set("act_thread_id",d[41]),d[25].set("timestamp",c.i64.to_string(d[24])),d[25].set("otid",d[42]),c.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var b=e.done;e=e.value;return b?(d[43]=c.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[43],c.i64.cast([0,1e6])),d[19]),void 0],d[26]=b[0],d[27]=b[1],d[28]=b[2],d[29]=b[3],d[30]=b[4],d[31]=b[5],d[32]=b[6],b):(f=e.item,d[43]=c.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,f.priority,f.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[43],c.i64.cast([0,1e6])),d[19]),void 0],d[26]=b[0],d[27]=b[1],d[28]=b[2],d[29]=b[3],d[30]=b[4],d[31]=b[5],d[32]=b[6],b)})},function(a){return d[34]=new c.Map(),d[34].set("task_id",d[26]),d[34].set("queue_name",d[27]),d[34].set("enqueue_timestamp_ms",d[28]),d[34].set("priority",d[29]),d[34].set("first_executed_timestamp_ms",d[30]),d[34].set("execution_time_ns",d[31]),d[34].set("echo_encoding_execution_time_ns",d[32]),d[35]=new c.Map(),d[35].set("task_metadata",d[34]),d[35].set("action_type",void 0),d[35].set("content_type",void 0),d[35].set("identifiers",void 0),d[35].set("identifiers_v2",d[25]),d[35].set("task_creation_source",void 0),d[35].set("message_payload_source",c.i64.cast([0,2])),c.storedProcedure(b("LSLoadUnencryptedProtobufWithInputs"),f.backupAction,d[41],d[42],f.supplementalKey,d[24],d[23]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(a){return d[36]!==void 0?(d[43]=new c.Map(),d[43].set("unencrypted_protobuf_backup_payload",d[36]),d[43].set("message_identifiers",d[23]),d[43].set("attachment_backup_payload",f.attachmentPayload),d[43].set("sender_id",f.senderId),d[43].set("extra_data_for_eb_upload",void 0),a=[d[43],void 0,d[35]],d[38]=a[0],d[39]=a[1],d[40]=a[2],a):(a=[void 0,d[37],d[35]],d[38]=a[0],d[39]=a[1],d[40]=a[2],a),a=[d[38],d[39],d[40]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return d[16]=c.i64.of_float(Date.now()),d[17]=c.i64.random(),d[20]="Finishing execution. Execution time: ",d[21]=c.i64.to_string(c.i64.sub(d[16],d[0])),d[22]=" ms",d[18]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] ",d[18],d[20],d[18],d[21],d[18],d[22]].join("")),c.i64.eq(c.i64.mod_(d[17],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[23]=",",d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufBackupSerializedPayloadData",[d[20],d[23],d[21],d[23],d[22]].join(""),d[24],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[12],d[13],d[14]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsOpenUpload",["LSArrayGetObjectAt","LSBase64Encode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSLoadUnencryptedProtobufBackupSerializedPayloadData","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSLoadUnencryptedProtobufBackupSerializedPayloadData"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],a})},function(a){return d[2]!==void 0?c.sequence([function(a){return d[15]=d[2].get("message_identifiers"),d[2],d[16]=d[2].get("unencrypted_protobuf_backup_payload"),d[2],d[17]=d[15].get("server_thread_id"),d[15],d[18]=d[15].get("timestamp"),d[15],d[19]=d[15].get("otid"),d[15],d[20]=d[15].get("act_thread_id"),d[15],d[21]=new c.Map(),d[21].set("server_thread_key",d[17]),d[21].set("timestamp",d[18]),d[21].set("otid",d[19]),d[21].set("wa_thread_id",c.i64.from_string(d[20])),d[22]=new c.Map(),d[22].set("message_identifiers",d[21]),d[23]=d[2].get("extra_data_for_eb_upload"),d[2],d[23]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[23]).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[33]=new c.Map(),d[38]="ttd",d[34]=d[32].get(d[38]),d[32],d[34]?d[35]=!1:d[35]=!0,d[35]?c.resolve():c.sequence([function(a){return d[34]?d[40]=!1:d[40]=!0,d[40]?c.resolve(d[41]=void 0):c.sequence([function(a){return d[42]=new c.Map(),d[45]="message_tags",d[43]=d[34].get(d[45]),d[34],d[43]?d[44]=!1:d[44]=!0,d[44]?c.resolve():c.sequence([function(a){return d[46]=c.createArray(),d[47]=c.i64.of_int32(d[43].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[48]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[43],d[48]).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=(d[46].push(d[49]),d[46])}])}):c.resolve()},function(a){return d[42].set(d[45],d[46])}])},function(a){return d[41]=d[42]}])},function(a){return d[33].set(d[38],d[41])}])},function(a){return d[39]="mt",d[36]=d[32].get(d[39]),d[32],d[36]?d[37]=!1:d[37]=!0,d[37]?c.resolve():c.sequence([function(a){return d[36]?d[40]=!1:d[40]=!0,d[40]?c.resolve(d[41]=void 0):c.sequence([function(a){return d[42]=new c.Map(),d[45]="message_tags",d[43]=d[36].get(d[45]),d[36],d[43]?d[44]=!1:d[44]=!0,d[44]?c.resolve():c.sequence([function(a){return d[46]=c.createArray(),d[47]=c.i64.of_int32(d[43].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[48]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[43],d[48]).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=(d[46].push(d[49]),d[46])}])}):c.resolve()},function(a){return d[42].set(d[45],d[46])}])},function(a){return d[41]=d[42]}])},function(a){return d[33].set(d[39],d[41])}])},function(a){return d[24]=d[33]}]):c.resolve(d[24]=void 0)},function(a){return d[24]!==void 0?(d[32]=d[24].get("mt"),d[24],d[32]!==void 0?(d[34]=new c.Map(),d[38]="message_tags",d[35]=d[32].get(d[38]),d[32],d[35]?d[36]=!1:d[36]=!0,d[36]?0:d[34].set(d[38],d[35]),d[37]=c.toJSON(d[34]),d[33]=d[37]):d[33]=void 0,d[25]=d[33]):d[25]=void 0,d[26]=d[16].get("supplemental_data_encrypted"),d[16],d[26]!==void 0?c.sequence([function(a){return d[32]=d[16].get("protobuf_encrypted"),d[16],d[33]=d[16].get("backup_action"),d[16],d[34]=d[16].get("timestamp_ms"),d[16],d[35]=d[26].get("sk_ciphertext"),d[26],c.nativeOperation(b("LSBase64Encode.nop"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[37]=d[26].get("sk_hash"),d[26],c.nativeOperation(b("LSBase64Encode.nop"),d[37]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[39]=new c.Map(),d[39].set("supplementary_data_key",void 0),d[39].set("encrypted_protobuf",d[32]),d[39].set("key_value_backup_action",d[33]),d[39].set("protobuf_ts_ms",d[34]),d[39].set("supplemental_key_ciphertext",d[36]),d[39].set("supplemental_key_hash",d[38]),d[39].set("message_tags",d[25]),d[27]=d[39]}]):c.resolve((d[32]=d[16].get("protobuf_encrypted"),d[16],d[33]=d[16].get("backup_action"),d[16],d[34]=d[16].get("timestamp_ms"),d[16],d[35]=new c.Map(),d[35].set("supplementary_data_key",void 0),d[35].set("encrypted_protobuf",d[32]),d[35].set("key_value_backup_action",d[33]),d[35].set("protobuf_ts_ms",d[34]),d[35].set("message_tags",d[25]),d[27]=d[35]))},function(a){return d[22].set("key_value_backup_unencrypted_payload",d[27]),d[28]=d[2].get("sender_id"),d[2],d[22].set("sender_id",d[28]),d[29]=d[2].get("attachment_backup_payload"),d[2],d[29]!==void 0?d[22].set("attachment_backup_payload",d[29]):0,d[24]!==void 0?(d[32]=d[24].get("ttd"),d[24],d[32]!==void 0?(d[34]=new c.Map(),d[38]="message_tags",d[35]=d[32].get(d[38]),d[32],d[35]?d[36]=!1:d[36]=!0,d[36]?0:d[34].set(d[38],d[35]),d[37]=c.toJSON(d[34]),d[33]=d[37]):d[33]=void 0,d[30]=d[33]):d[30]=void 0,d[30]!==void 0?d[22].set("tags_to_delete",d[30]):0,d[31]=c.toJSON(d[22]),a=[d[31],void 0,d[4]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a}]):c.resolve((d[3]?d[15]=!1:d[15]=!0,d[15]?(a=[void 0,void 0,d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a):(a=[void 0,d[3],d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a),a=[d[16],d[17],d[18]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a))},function(a){return d[15]=new c.Map(),d[16]=d[15].set("success",d[5]),d[17]=d[15].set("failure",d[6]),d[18]=d[15].set("context",d[7]),d[19]=c.toJSON(d[15]),d[8]=d[19],d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsOpenUpload",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[8],c.i64.cast([0,50048])],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsOpenUploadStoredProcedure";e.exports=a}),null);
__d("LSCreateDataTrace",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return c[0]=b.i64.of_float(Date.now()),b.db.table(153).add({traceId:a[0],initTimestampMs:c[0],traceType:a[4],shouldFlush:!1,contextOne:a[1],contextTwo:a[2],contextThree:a[3]})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSDataTraceCreateDataTraceStoredProcedure";e.exports=a}),null);
__d("LSCreateDataTraceID.nop",["LSRequestId","LSResult","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,d){return(h||(h=b("Promise"))).resolve(c("LSResult")(c("LSRequestId").generate()))};g["default"]=a}),98);
__d("LSFlushDataTrace.nop",["MetaConfig","Promise","ReQL","updateAndFlushLSDataTrace"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e,f){return!c("MetaConfig")._("62")?(h||(h=b("Promise"))).resolve():d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.data_trace_meta).getKeyRange(f)).then(function(d){if(d!=null)return c("updateAndFlushLSDataTrace")(a,f);else return(h||(h=b("Promise"))).resolve()})};g["default"]=a}),98);
__d("LSDeleteBackupOnClient",["LSAppendDataTraceAddon","LSFlushDataTrace.nop","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] Beginning execution."),c.i64.neq(void 0,void 0)?(d[9]=["deleteBackupOnClient reason: "," ",c.i64.to_string(void 0)].join(""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] ","",d[9]].join("")),d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",[d[9]].join(""),d[10],c.i64.cast([0,4]))):c.resolve()},function(a){return d[1]="Beginning deleteBackupOnClient stored procedure",function(a){c.logger(a).info(a)}(["[EncryptedBackups][deleteBackupOnClient] ","",d[1]].join("")),d[2]=c.createArray(),void 0!==void 0?d[9]=(d[2].push(void 0),d[2]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"deleteBackupOnClient",[d[1]].join(""),d[2],c.i64.cast([0,4]))},function(b){return c.i64.neq(a[0],void 0)?c.forEach(c.db.table(168).fetch([[[a[0]]]]),function(a){return a["delete"]()}):c.forEach(c.db.table(168).fetch(),function(a){return a["delete"]()})},function(b){return c.i64.neq(a[0],void 0)?c.forEach(c.db.table(169).fetch([[[a[0]]],"fk_secure_encrypted_backups_client_state"]),function(a){return a["delete"]()}):c.forEach(c.db.table(169).fetch(),function(a){return a["delete"]()})},function(a){return c.forEach(c.db.table(190).fetch(),function(a){return a["delete"]()})},function(a){return c.forEach(c.db.table(174).fetch(),function(a){return a["delete"]()})},function(b){return a[1]==="fetch_virtual_device"?c.db.table(178).put({pk:c.i64.cast([0,1]),recoveryCodeStatus:c.i64.cast([0,4])}):c.resolve()},function(e){return a[2]?c.sequence([function(a){return d[9]="Clearing backups tables",function(a){c.logger(a).info(a)}(["[EncryptedBackups][deleteBackupOnClient] ","",d[9]].join("")),d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"deleteBackupOnClient",[d[9]].join(""),d[10],c.i64.cast([0,4]))},function(a){return c.forEach(c.db.table(172).fetch([[[c.i64.cast([0,1])]]]),function(a){var b=a.update;a.item;return b({backupId:void 0})})},function(b){return c.i64.neq(a[0],void 0)?c.forEach(c.filter(c.db.table(184).fetch(),function(b){return c.i64.eq(b.backupId,a[0])}),function(a){return a["delete"]()}):c.forEach(c.db.table(184).fetch(),function(a){return a["delete"]()})},function(b){return c.i64.neq(a[0],void 0)?c.forEach(c.db.table(196).fetch([[[a[0]]]]),function(a){return a["delete"]()}):c.forEach(c.db.table(196).fetch(),function(a){return a["delete"]()})}]):c.resolve()},function(e){return a[5]?c.resolve(0):a[4]!==void 0?c.sequence([function(e){return d[10]=["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] ","",a[4]].join(""),function(a){c.logger(a).mustfix(a)}(d[10]),d[9]=c.createArray(),void 0!==void 0?d[11]=(d[9].push(void 0),d[9]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",a[4],d[9],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return void 0!==void 0?c.sequence([function(a){return void 0!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),void 0,c.i64.cast([0,85]),c.i64.cast([0,2]),d[10],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[13]=a[0],a})},function(a){return d[13]?d[14]=!0:d[14]=!1,d[14]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[15]=c.createArray(),void 0!==void 0?d[16]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[15],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return void 0!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[11]=a[0],a})},function(a){return d[11]?d[12]=!0:d[12]=!1,d[12]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[13],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return void 0!==void 0?c.sequence([function(a){return void 0!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),void 0,c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[11]=a[0],a})},function(a){return d[11]?d[12]=!0:d[12]=!1,d[12]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[13],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return void 0!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!0:d[10]=!1,d[10]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[11],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[6]="Finishing execution. Execution time: ",d[7]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[8]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure] ",d[5],d[6],d[5],d[7],d[5],d[8]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[9]=",",d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",[d[6],d[9],d[7],d[9],d[8]].join(""),d[10],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeleteBackupOnClientStoredProcedure";e.exports=a}),null);
__d("LSGetOpenEpochKeys",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSCreateDataTrace","LSCreateDataTraceID.nop","LSDeleteBackupOnClient","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] Beginning execution."),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))&&c.i64.eq(a.backupTenancy,c.i64.cast([0,2]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?d[1]=!1:(a.item,d[1]=!0)})},function(a){return d[1]?d[3]=c.i64.or_(c.i64.cast([0,90]),c.i64.cast([0,128])):d[3]=c.i64.cast([0,90]),c.sequence([function(a){return c.nativeOperation(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return c.sequence([function(a){return d[24]="EncryptedBackups MCD Trace ID",d[25]=c.i64.to_string(d[3]),d[23]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",d[23],d[24],d[23],d[25]].join("")),c.resolve()},function(a){return c.storedProcedure(b("LSCreateDataTrace"),d[20],void 0,void 0,"get_open_epoch_keys",d[3])}])},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[22]=!0:d[22]=!1,d[22]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[23],c.i64.cast([0,3]))):c.resolve()},function(a){return d[4]=d[20]}])},function(b){return d[15]="Querying latest epoch keys with authority level: ",a[0]?d[5]="OPTIMISTIC":d[5]="AUTHORITATIVE",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] ",d[6],d[15],d[6],d[5]].join("")),c.resolve()},function(e){return a[0]?d[7]="OPTIMISTIC":d[7]="AUTHORITATIVE",c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2842]),c.i64.cast([0,2]),void 0,d[7]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2844]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}])},function(b){return d[8]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(b){return a[0]||c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[20]=(d[8].push(c.blobs.to_string(a.epochAnonIdBlob)),d[8])})},function(a){return d[9]=c.i64.of_int32(d[8].length),c.i64.gt(d[9],c.i64.cast([0,0]))?c.sequence([function(a){return d[20]=c.i64.of_int32(d[8].length),c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2845]),c.i64.cast([0,2]),void 0,c.i64.to_string(d[20])):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[25]=a[0],a})},function(a){return d[25]?d[26]=!0:d[26]=!1,d[26]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[27]=c.createArray(),void 0!==void 0?d[28]=(d[27].push(void 0),d[27]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[27],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[8],c.i64.cast([0,0])).then(function(a){return a=a,d[21]=a[0],d[22]=a[1],a})},function(a){return d[23]=d[21],d[24]=c.i64.of_int32(d[8].length),c.i64.gt(d[24],c.i64.cast([0,0]))?c.loopAsync(d[24],function(a){return d[25]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[8],d[25]).then(function(a){return a=a,d[26]=a[0],d[27]=a[1],a})},function(a){return c.i64.eq([0,d[23].length],[0,d[26].length])?(d[23]===d[26]?d[29]=d[23]:(d[23]>d[26]?d[30]=d[23]:d[30]=d[26],d[29]=d[30]),d[28]=d[29]):(c.i64.gt([0,d[23].length],[0,d[26].length])?d[29]=d[23]:d[29]=d[26],d[28]=d[29]),d[23]=d[28]}])}):c.resolve()},function(a){return d[10]=d[23]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] Epoch anon ID list is empty."),d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure","Epoch anon ID list is empty.",d[20],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2846]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[22]=!0:d[22]=!1,d[22]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[23],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[10]=void 0}])},function(a){return d[10]!==void 0?c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2863]),c.i64.cast([0,2]),void 0,d[10]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}]):c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2864]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!0:d[21]=!1,d[21]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[22],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[16]=c.blobs.of_string(d[10]),c.blobs.neq(d[16],void 0)?c.sequence([function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2847]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[23]=!0:d[23]=!1,d[23]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[24],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.filter(c.db.table(169).fetch(),function(a){return c.blobs.eq(a.epochAnonIdBlob,d[16])}).next().then(function(a,e){var f=a.done;a=a.value;return f?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] Found a most recent epoch anon ID, but unable to locate it again in the table. This can really only happen if the tablesomehow changed in the middle of our transaction."),d[22]=c.createArray(),void 0!==void 0?d[23]=(d[22].push(void 0),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure","Found a most recent epoch anon ID, but unable to locate it again in the table. This can really only happen if the tablesomehow changed in the middle of our transaction.",d[22],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2848]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[24]=!0:d[24]=!1,d[24]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[25]=c.createArray(),void 0!==void 0?d[26]=(d[25].push(void 0),d[25]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[25],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[20]=void 0}]):(e=a.item,c.sequence([function(a){return d[26]=e.epochAnonIdBlob,d[24]="Using latest epoch: ",d[25]=c.blobs.to_string(d[26]),d[22]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] ",d[22],d[24],d[22],d[25]].join("")),c.resolve()},function(a){return d[23]=new c.Map(),d[23].set("epoch_id",e.epochId),d[23].set("epoch_root_key",e.epochRootKeyBlob),d[23].set("epoch_anon_id",d[26]),d[20]=d[23]}]))})},function(a){return d[11]=d[20]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] No epochs whatsoever on client! This should absolutely never happen. Deleting backup from client."),d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure","No epochs whatsoever on client! This should absolutely never happen. Deleting backup from client.",d[20],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[4],c.i64.cast([0,2843]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[22]=!0:d[22]=!1,d[22]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[23],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.storedProcedure(b("LSDeleteBackupOnClient"),void 0,"get_open_epoch_keys",!0,d[4],"Attempted to fetch epoch keys when there are no epochs on the client.",!1)},function(a){return d[11]=void 0}])},function(a){return d[12]=c.i64.of_float(Date.now()),d[13]=c.i64.random(),d[17]="Finishing execution. Execution time: ",d[18]=c.i64.to_string(c.i64.sub(d[12],d[0])),d[19]=" ms",d[14]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure] ",d[14],d[17],d[14],d[18],d[14],d[19]].join("")),c.i64.eq(c.i64.mod_(d[13],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[20]=",",d[21]=c.createArray(),void 0!==void 0?d[22]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsGetOpenEpochKeysStoredProcedure",[d[17],d[20],d[18],d[20],d[19]].join(""),d[21],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[11]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsGetOpenEpochKeysStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsRestoreWithSerializer",["LSAppendDataTraceAddon","LSBase64Encode.nop","LSGetOpenEpochKeys","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] Beginning execution."),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] Fetching locally available epochs on client from epochs table"),d[1]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[16]=(d[1].push(a.epochId),d[1])})},function(a){return d[11]="Queried locally available epochs. Count: ",d[2]=c.i64.of_int32(d[1].length),d[12]=c.i64.to_string(d[2]),d[3]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[3],d[11],d[3],d[12]].join("")),c.resolve()},function(e){return c.db.table(168).fetch().next().then(function(e,f){var g=e.done;e=e.value;return g?(g=[void 0,void 0,void 0],d[4]=g[0],d[5]=g[1],d[6]=g[2],g):(f=e.item,c.sequence([function(e){return d[19]=f.deviceId,c.i64.neq(d[19],void 0)?c.sequence([function(e){return c.db.table(190).fetch([[[a[0]]]]).next().then(function(e,h){var a=e.done;e=e.value;return a?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] No restore payload context found."),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure","No restore payload context found.",d[24],c.i64.cast([0,3]))},function(a){return a=[void 0,void 0,void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],a}]):(h=e.item,c.sequence([function(a){return d[32]=h.traceId,c.sequence([function(a){return d[32]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[32],c.i64.cast([0,3603]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[33]?d[34]=!0:d[34]=!1,d[34]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[35]=c.createArray(),void 0!==void 0?d[36]=(d[35].push(void 0),d[35]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[35],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[24]=new c.Map(),d[24].set("server_thread_key",h.serverThreadKey),d[24].set("otid",h.messageId),d[24].set("timestamp",h.unencryptedSortKey),d[24].set("wa_thread_id",h.waThreadId),c.nativeOperation(b("LSBase64Encode.nop"),f.ocmfClientStateBlob).then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),f.mailboxRootKeyBlob).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[27]=new c.Map(),d[27].set("ocmf_client_state_blob",d[25]==null?"":d[25]),d[27].set("mailbox_root_key",d[26]==null?"":d[26]),c.storedProcedure(b("LSGetOpenEpochKeys"),!1).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]!==void 0?(d[33]=d[28].get("epoch_id"),d[28],d[29]=d[33]):d[29]=void 0,d[30]=new c.Map(),d[30].set("content_type",h.contentType),d[30].set("device_id",d[19]),d[30].set("epoch_id",d[29]),d[30].set("list_id",h.listId),d[30].set("num_items",h.numItems),d[30].set("start_sort_key",h.startSortKey),d[30].set("mailbox_partial_id",h.mailboxPartialId),d[30].set("trace_id",d[32]),d[30].set("message_partial_id",h.messagePartialId),d[30].set("newer_num_items",h.newerNumItems),d[30].set("locally_available_epochs",d[1]),d[30].set("raw_identifiers",d[24]),d[30].set("raw_tokens",d[27]),d[31]=c.toJSON(d[30]),a=[d[31],c.i64.cast([0,50015]),void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],a}]))})},function(a){return a=[d[20],d[21],d[22]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] Unexpected error: Device ID is null."),d[20]=c.createArray(),void 0!==void 0?d[21]=(d[20].push(void 0),d[20]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure","Unexpected error: Device ID is null.",d[20],c.i64.cast([0,3]))},function(a){return a=[void 0,void 0,void 0],d[16]=a[0],d[17]=a[1],d[18]=a[2],a}])},function(a){return a=[d[16],d[17],d[18]],d[4]=a[0],d[5]=a[1],d[6]=a[2],a}]))})},function(a){return d[8]=c.i64.of_float(Date.now()),d[9]=c.i64.random(),d[13]="Finishing execution. Execution time: ",d[14]=c.i64.to_string(c.i64.sub(d[8],d[0])),d[15]=" ms",d[10]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure] ",d[10],d[13],d[10],d[14],d[10],d[15]].join("")),c.i64.eq(c.i64.mod_(d[9],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[16]=",",d[17]=c.createArray(),void 0!==void 0?d[18]=(d[17].push(void 0),d[17]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure",[d[13],d[16],d[14],d[16],d[15]].join(""),d[17],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[4],d[5],d[6]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure";e.exports=a}),null);
__d("LSDeriveValueSecretRefV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][deriveValueSecretRefV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[2].get("message_payload_encryption_keys"),a[2],d[3]=d[2].get("encryption_version"),d[2],d[4]=d[2].get("epoch_anon_id"),d[2],d[5]=d[2].get("epoch_root_key"),d[2],d[6]=d[2].get("payload_key"),d[2],d[7]=c.createArray(),d[41]=(d[7].push(c.i64.cast([0,6])),d[7]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[8]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[8],void 0,d[4],d[7]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!1:d[10]=!0,d[10]?c.resolve(d[11]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[9],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[11]=d[43]==null?"":d[43]}])},function(a){return d[12]=c.createArray(),d[41]=(d[12].push(c.i64.cast([0,6])),d[12]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[13]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[13],void 0,d[5],d[12]).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!1:d[15]=!0,d[15]?c.resolve(d[16]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[14],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[16]=d[43]==null?"":d[43]}])},function(a){return d[17]=c.createArray(),d[41]=(d[17].push(c.i64.cast([0,6])),d[17]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[18],void 0,d[6],d[17]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[19]?d[20]=!1:d[20]=!0,d[20]?c.resolve(d[21]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[21]=d[43]==null?"":d[43]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[22]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[22]==null?"":d[22],a[0]].join("")).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[24]=c.createArray(),d[41]=(d[24].push(c.i64.cast([0,6])),d[24]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[25],void 0,d[23],d[24]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!1:d[27]=!0,d[27]?c.resolve(d[28]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[26],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[28]=d[43]==null?"":d[43]}])},function(a){return d[29]=":",c.blobs.neq(d[5],void 0)?c.sequence([function(a){return d[41]=c.createArray(),d[47]=(d[41].push(c.i64.cast([0,18])),d[41]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[5],d[41]).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]!==void 0?c.sequence([function(a){return d[47]=c.i64.of_int32(d[42].length),c.i64.ge(d[47],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[42],c.i64.cast([0,0])).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[48]=d[49]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[49]=c.createArray(),void 0!==void 0?d[50]=(d[49].push(void 0),d[49]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[49],c.i64.cast([0,3]))},function(a){return d[48]=void 0}])},function(a){return d[43]=d[48]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[47]=c.createArray(),void 0!==void 0?d[48]=(d[47].push(void 0),d[47]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[47],c.i64.cast([0,3]))},function(a){return d[43]=void 0}])},function(a){return c.blobs.neq(d[43],void 0)?d[44]=!0:d[44]=!1,d[44]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[43]).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]!==void 0?d[46]=d[45]:d[46]="encodingfailed",d[30]=d[46]}]):c.resolve(d[30]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[4]).then(function(a){return a=a,d[31]=a[0],a})},function(e){return d[32]=new c.Map(),d[32].set("encryption_version",d[3]),d[32].set("epoch_anon_id",d[31]==null?"":d[31]),d[32].set("message_encryption_values",[d[11],d[29],d[16],d[29],d[21],d[29],d[28]].join("")),d[32].set("root_key_fingerprint",d[30]),d[32].set("backup_id",a[1]),d[33]=c.toJSON(d[32]),d[34]=new c.Map(),d[34].set("value_secret_ref",d[33]),d[35]=c.i64.of_float(Date.now()),d[36]=c.i64.random(),d[38]="Finishing execution. Execution time: ",d[39]=c.i64.to_string(c.i64.sub(d[35],d[0])),d[40]=" ms",d[37]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][deriveValueSecretRefV2] ",d[37],d[38],d[37],d[39],d[37],d[40]].join("")),c.i64.eq(c.i64.mod_(d[36],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[41]=",",d[42]=c.createArray(),void 0!==void 0?d[43]=(d[42].push(void 0),d[42]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"deriveValueSecretRefV2",[d[38],d[41],d[39],d[41],d[40]].join(""),d[42],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[34],void 0],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeriveValueSecretRefV2StoredProcedure";e.exports=a}),null);
__d("LSEncryptIdentifiersV2",["LSBase64Encode.nop","LSBinaryToHex.nop","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][encryptIdentifiersV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[6].get("ocmf_shared_key"),a[6],c.nativeOperation(b("LSGetBlobFromString.nop"),a[2]).then(function(a){return a=a,d[3]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWFpbGJveF9pZF9zY29wZQ=="),d[3]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[2],d[4]).then(function(a){return a=a,d[5]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[6]=a[0],a})},function(e){return c.i64.eq(a[0],c.i64.cast([0,2]))&&c.i64.eq(a[1],c.i64.cast([0,2]))?d[7]=a[5]:d[7]=a[3],d[8]=a[6].get("ocmf_shared_key"),a[6],c.nativeOperation(b("LSGetBlobFromString.nop"),d[7]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("dGhyZWFkX2lkX3Njb3Bl"),d[9]).then(function(a){return a=a,d[10]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[8],d[10]).then(function(a){return a=a,d[11]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[11]).then(function(a){return a=a,d[12]=a[0],a})},function(e){return d[13]=a[6].get("ope_key"),a[6],c.nativeOperation(b("LSGetBlobFromInt64BE.nop"),a[4]).then(function(a){return a=a,d[14]=a[0],a})},function(a){return c.nativeOperation(b("LSTruncateSortKey.nop"),d[14]).then(function(a){return a=a,d[15]=a[0],a})},function(a){return c.nativeOperation(b("LSOpeEncrypt.nop"),d[13],d[15],c.i64.cast([0,16])).then(function(a){return a=a,d[16]=a[0],a})},function(a){return c.nativeOperation(b("LSBinaryToHex.nop"),d[16]).then(function(a){return a=a,d[17]=a[0],a})},function(e){return d[18]=a[6].get("ocmf_shared_key"),a[6],c.nativeOperation(b("LSGetBlobFromString.nop"),a[5]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWVzc2FnZV9pZF9zY29wZQ=="),d[19]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[18],d[20]).then(function(a){return a=a,d[21]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[21]).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[23]=new c.Map(),d[23].set("backup_id_ocmf_partial",d[6]==null?"":d[6]),d[23].set("act_thread_id_ocmf_partial",d[12]==null?"":d[12]),d[23].set("timestamp_encrypted",d[17]==null?"":d[17]),d[23].set("otid_ocmf_partial",d[22]==null?"":d[22]),d[24]=c.i64.of_float(Date.now()),d[25]=c.i64.random(),d[27]="Finishing execution. Execution time: ",d[28]=c.i64.to_string(c.i64.sub(d[24],d[0])),d[29]=" ms",d[26]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][encryptIdentifiersV2] ",d[26],d[27],d[26],d[28],d[26],d[29]].join("")),c.i64.eq(c.i64.mod_(d[25],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[30]=",",d[31]=c.createArray(),void 0!==void 0?d[32]=(d[31].push(void 0),d[31]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"encryptIdentifiersV2",[d[27],d[30],d[28],d[30],d[29]].join(""),d[31],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[23],void 0],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsEncryptIdentifiersV2StoredProcedure";e.exports=a}),null);
__d("LSSymmetricEncryptionCreateEncryptedData.nop",["CryptoLogger","EncryptedBackupsSymmetricEncryptionUtils","HChaCha20","Promise","RetUtil","SymmetricEncryptionPaddingUtils","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,c,e,f,g){var i=d("CryptoLogger").CryptoLogger("symmetric_encryption_create_encrypted_data"),j=d("SymmetricEncryptionPaddingUtils").padData(g),k=d("XPlatReactCrypto").getRandomValues(new Uint8Array(d("EncryptedBackupsSymmetricEncryptionUtils").totalNonceLengthInBytes));a=new(d("HChaCha20").HChaCha20)();c=a.hChaCha20Bytes(k.slice(0,d("EncryptedBackupsSymmetricEncryptionUtils").hChaCha20SubKeyNonceLengthInBytes).buffer,e);return d("XPlatReactCrypto").subtleImportKey("raw",c,"AES-GCM",!1,["encrypt"]).then(function(a){return d("XPlatReactCrypto").subtleEncrypt({additionalData:f,iv:new Uint8Array(k.slice(d("EncryptedBackupsSymmetricEncryptionUtils").hChaCha20SubKeyNonceLengthInBytes).buffer),name:"AES-GCM",tagLength:d("EncryptedBackupsSymmetricEncryptionUtils").aesGcmTagLength},a,j)}).then(function(a){var c=k.byteLength+a.byteLength;c=new Uint8Array(c);c.set(k);c.set(new Uint8Array(a),d("EncryptedBackupsSymmetricEncryptionUtils").totalNonceLengthInBytes);return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(c.buffer))})["catch"](function(a){d("CryptoLogger").captureError(i,a).mustfix("symmetric data encryption failed");return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult())})};g["default"]=a}),98);
__d("LSSymmetricEncryptionCreateEncryptedString.nop",["Base64Utils","CryptoLogger","LSCryptoUtils","LSSymmetricEncryptionCreateEncryptedData.nop","Promise","RetUtil"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e,f,g,i){var j=d("CryptoLogger").CryptoLogger("symmetric_encryption_create_encrypted_string");return c("LSSymmetricEncryptionCreateEncryptedData.nop")(a,e,f,g,d("LSCryptoUtils").strToBuf(i)).then(function(a){return a[0]}).then(function(a){return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(a?d("Base64Utils").fromArrayBuffer(a):void 0))})["catch"](function(a){d("CryptoLogger").captureError(j,a).mustfix("symmetric string encryption failed");return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult())})};g["default"]=a}),98);
__d("LSEncryptMessagePayloadV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateEncryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][encryptMessagePayloadV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[2].get("message_payload_encryption_keys"),a[2],d[3]=d[2].get("payload_key"),d[2],c.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),d[3],c.blobs.of_string(["message_thread","_",a[1]].join("")),a[3]).then(function(a){return a=a,d[4]=a[0],a})},function(e){return d[4]!==void 0?c.sequence([function(a){return d[13]=d[2].get("encryption_version"),d[2],d[14]=d[2].get("epoch_anon_id"),d[2],d[15]=d[2].get("epoch_root_key"),d[2],d[16]=d[2].get("payload_key"),d[2],d[17]=c.createArray(),d[45]=(d[17].push(c.i64.cast([0,6])),d[17]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[18],void 0,d[14],d[17]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[19]?d[20]=!1:d[20]=!0,d[20]?c.resolve(d[21]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[21]=d[47]==null?"":d[47]}])},function(a){return d[22]=c.createArray(),d[45]=(d[22].push(c.i64.cast([0,6])),d[22]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[23]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[23],void 0,d[15],d[22]).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!1:d[25]=!0,d[25]?c.resolve(d[26]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[24],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[26]=d[47]==null?"":d[47]}])},function(a){return d[27]=c.createArray(),d[45]=(d[27].push(c.i64.cast([0,6])),d[27]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[28]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[28],void 0,d[16],d[27]).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[29]?d[30]=!1:d[30]=!0,d[30]?c.resolve(d[31]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[31]=d[47]==null?"":d[47]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[15]).then(function(a){return a=a,d[32]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[32]==null?"":d[32],a[1]].join("")).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[34]=c.createArray(),d[45]=(d[34].push(c.i64.cast([0,6])),d[34]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[35]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[35],void 0,d[33],d[34]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[37]=!1:d[37]=!0,d[37]?c.resolve(d[38]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[36],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[38]=d[47]==null?"":d[47]}])},function(a){return d[39]=":",c.blobs.neq(d[15],void 0)?c.sequence([function(a){return d[45]=c.createArray(),d[51]=(d[45].push(c.i64.cast([0,18])),d[45]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[15],d[45]).then(function(a){return a=a,d[46]=a[0],a})},function(a){return d[46]!==void 0?c.sequence([function(a){return d[51]=c.i64.of_int32(d[46].length),c.i64.ge(d[51],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[46],c.i64.cast([0,0])).then(function(a){return a=a,d[53]=a[0],d[54]=a[1],a})},function(a){return d[52]=d[53]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[53]=c.createArray(),void 0!==void 0?d[54]=(d[53].push(void 0),d[53]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[53],c.i64.cast([0,3]))},function(a){return d[52]=void 0}])},function(a){return d[47]=d[52]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[51]=c.createArray(),void 0!==void 0?d[52]=(d[51].push(void 0),d[51]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[51],c.i64.cast([0,3]))},function(a){return d[47]=void 0}])},function(a){return c.blobs.neq(d[47],void 0)?d[48]=!0:d[48]=!1,d[48]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[47]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[49]!==void 0?d[50]=d[49]:d[50]="encodingfailed",d[40]=d[50]}]):c.resolve(d[40]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[14]).then(function(a){return a=a,d[41]=a[0],a})},function(b){return d[42]=new c.Map(),d[42].set("encryption_version",d[13]),d[42].set("epoch_anon_id",d[41]==null?"":d[41]),d[42].set("message_encryption_values",[d[21],d[39],d[26],d[39],d[31],d[39],d[38]].join("")),d[42].set("root_key_fingerprint",d[40]),d[42].set("backup_id",a[0]),d[43]=c.toJSON(d[42]),d[44]=new c.Map(),d[44].set("encrypted_message_payload",d[4]),d[44].set("value_secret_ref",d[43]),b=[d[44],void 0],d[5]=b[0],d[6]=b[1],b}]):c.resolve((d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,40])),d[13].set("stored_procedure","LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure"),d[13].set("error_message",""),e=[void 0,d[13]],d[5]=e[0],d[6]=e[1],e))},function(a){return d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][encryptMessagePayloadV2] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"encryptMessagePayloadV2",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure";e.exports=a}),null);
__d("LSGetLatestEpochKeys",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][getLatestEpochKeys] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]="",d[3]=void 0,d[4]=void 0,a[0]?c.resolve(0):(d[14]=void 0,c.i64.neq(d[14],void 0)?c.db.table(169).fetch([[[d[14]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?0:(b=a.item,d[2]=c.blobs.to_string(b.epochAnonIdBlob),d[3]=b.epochId,d[4]=b.epochRootKeyBlob)}):c.resolve())},function(b){return c.i64.neq(d[3],void 0)?c.resolve(0):c.forEach(c.filter(c.db.table(169).fetch(),function(b){return a[0]||c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[15]=c.blobs.to_string(a.epochAnonIdBlob),c.i64.eq([0,d[15].length],[0,d[2].length])?d[14]=d[15]>d[2]:d[14]=c.i64.gt([0,d[15].length],[0,d[2].length]),d[14]?(d[2]=d[15],d[3]=a.epochId,d[4]=a.epochRootKeyBlob,d[16]=c.i64.of_float(Date.now()),0):0})},function(a){return d[10]=c.blobs.of_string(d[2]),c.i64.neq(d[3],void 0)?(c.blobs.neq(d[10],void 0)?(c.blobs.neq(d[4],void 0)?(d[18]=new c.Map(),d[18].set("epoch_id",d[3]),d[18].set("epoch_root_key",d[4]),d[18].set("epoch_anon_id",d[10]),d[19]=new c.Map(),d[19].set("epoch_keys",d[18]),a=[d[19],void 0],d[16]=a[0],d[17]=a[1],a):(d[18]=new c.Map(),d[18].set("error_code",c.i64.cast([0,402])),d[18].set("error_message","failed to query latest epoch"),d[18].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[18]],d[16]=a[0],d[17]=a[1],a),a=[d[16],d[17]],d[14]=a[0],d[15]=a[1],a):(d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,403])),d[16].set("error_message","failed to query latest epoch"),d[16].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[16]],d[14]=a[0],d[15]=a[1],a),a=[d[14],d[15]],d[5]=a[0],d[6]=a[1],a):(d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([0,400])),d[14].set("error_message","failed to query latest epoch"),d[14].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[14]],d[5]=a[0],d[6]=a[1],a),d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[11]="Finishing execution. Execution time: ",d[12]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[13]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][getLatestEpochKeys] ",d[9],d[11],d[9],d[12],d[9],d[13]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[14]=",",d[15]=c.createArray(),void 0!==void 0?d[16]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"getLatestEpochKeys",[d[11],d[14],d[12],d[14],d[13]].join(""),d[15],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsGetLatestEpochKeysStoredProcedure";e.exports=a}),null);
__d("LSLoadAndEncryptProtobufWithInputsV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop","LSSymmetricEncryptionCreateEncryptedData.nop","gkx","qex"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] Beginning execution."),e[1]=d.i64.of_float(Date.now()),e[8]=function(a){return a==void 0?void 0:a}(c("qex")._("1526")),e[8]!==void 0?e[2]=e[8]:e[2]=!1,(c("gkx")("23657")||c("gkx")("26375"))&&(e[2]||c("gkx")("26377")||c("gkx")("687"))?d.sequence([function(c){return d.i64.eq(a[0],d.i64.cast([0,1]))?d.sequence([function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[14]=a[0],e[15]=a[1],e[16]=a[2],a})},function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[17]=a[0],a})},function(c){return d.blobs.neq(e[14],void 0)?d.sequence([function(c){return e[20]=a[5].get("message_payload_encryption_keys"),a[5],e[21]=e[20].get("payload_key"),e[20],d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[21],d.blobs.of_string(["message_thread","_",a[1]].join("")),e[14]).then(function(a){return a=a,e[22]=a[0],a})},function(a){return d.blobs.neq(e[22],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[22]).then(function(a){return a=a,e[26]=a[0],a})},function(a){return e[23]=e[26]}]):d.resolve(e[23]=void 0)},function(b){return e[23]!==void 0?(e[17]!==void 0?(e[28]=new d.Map(),e[28].set("message_tags",e[17]),e[29]=new d.Map(),e[33]="message_tags",e[30]=e[28].get(e[33]),e[28],e[30]?e[31]=!1:e[31]=!0,e[31]?0:e[29].set(e[33],e[30]),e[32]=d.toJSON(e[29]),e[26]=e[32]):e[26]=void 0,e[27]=new d.Map(),e[27].set("backup_action",a[0]),e[27].set("protobuf_encrypted",e[23]),e[27].set("supplemental_data_encrypted",void 0),e[27].set("timestamp_ms",a[4]),e[27].set("message_tags",e[26]),e[27].set("serialized_attachment_backup_payload",void 0),b=[e[27],void 0],e[24]=b[0],e[25]=b[1],b):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,62])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),b=[void 0,e[26]],e[24]=b[0],e[25]=b[1],b),b=[e[24],e[25]],e[18]=b[0],e[19]=b[1],b}]):d.resolve((e[16]?(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),e[22]=new d.Map(),e[22].set("error_code",d.i64.cast([0,70])),e[22].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[22].set("error_message",""),c=[void 0,e[22]],e[20]=c[0],e[21]=c[1],c):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),e[22]=new d.Map(),e[22].set("error_code",d.i64.cast([0,63])),e[22].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[22].set("error_message",""),c=[void 0,e[22]],e[20]=c[0],e[21]=c[1],c),c=[e[20],e[21]],e[18]=c[0],e[19]=c[1],c))},function(a){return a=[e[18],e[19]],e[12]=a[0],e[13]=a[1],a}]):d.sequence([function(c){return d.i64.eq(a[0],d.i64.cast([0,2]))?d.sequence([function(c){return a[3]!==void 0?d.sequence([function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),a[1],a[2],a[3]).then(function(a){return a=a,e[18]=a[0],e[19]=a[1],a})},function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[20]=a[0],a})},function(c){return d.blobs.neq(e[18],void 0)?d.sequence([function(c){return e[23]=a[5].get("mailbox_root_key_v2"),a[5],d.blobs.neq(e[23],void 0)?d.sequence([function(c){return e[26]=a[5].get("message_payload_encryption_keys"),a[5],e[27]=e[26].get("epoch_root_key"),e[26],e[28]=d.createArray(),e[41]=(e[28].push(d.i64.cast([0,32])),e[28]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfcHJmX2tleQ=="),void 0,e[23],e[28]).then(function(a){return a=a,e[29]=a[0],a})},function(a){return e[29]!==void 0?d.sequence([function(a){return e[41]=d.i64.of_int32(e[29].length),d.i64.ge(e[41],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[29],d.i64.cast([0,0])).then(function(a){return a=a,e[43]=a[0],e[44]=a[1],a})},function(a){return e[42]=e[43]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[43]=d.createArray(),void 0!==void 0?e[44]=(e[43].push(void 0),e[43]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[43],d.i64.cast([0,3]))},function(a){return e[42]=void 0}])},function(a){return e[30]=e[42]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[41]=d.createArray(),void 0!==void 0?e[42]=(e[41].push(void 0),e[41]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[41],d.i64.cast([0,3]))},function(a){return e[30]=void 0}])},function(a){return d.blobs.neq(e[30],void 0)?e[31]=!0:e[31]=!1,e[31]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[32]=d.createArray(),e[41]=(e[32].push(d.i64.cast([0,32])),e[32]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,e[27],e[32]).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]!==void 0?d.sequence([function(a){return e[41]=d.i64.of_int32(e[33].length),d.i64.ge(e[41],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[33],d.i64.cast([0,0])).then(function(a){return a=a,e[43]=a[0],e[44]=a[1],a})},function(a){return e[42]=e[43]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[43]=d.createArray(),void 0!==void 0?e[44]=(e[43].push(void 0),e[43]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[43],d.i64.cast([0,3]))},function(a){return e[42]=void 0}])},function(a){return e[34]=e[42]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[41]=d.createArray(),void 0!==void 0?e[42]=(e[41].push(void 0),e[41]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[41],d.i64.cast([0,3]))},function(a){return e[34]=void 0}])},function(c){return d.blobs.neq(e[34],void 0)?e[35]=!0:e[35]=!1,e[35]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d.nativeOperation(b("LSGetBlobFromString.nop"),a[3]).then(function(a){return a=a,e[36]=a[0],a})},function(a){return d.nativeOperation(b("LSHmac_v2.nop"),e[30],e[36]).then(function(a){return a=a,e[37]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[34],d.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),e[36]).then(function(a){return a=a,e[38]=a[0],a})},function(c){return d.blobs.neq(e[38],void 0)?d.sequence([function(c){return e[41]=new d.Map(),e[41].set("sk_ciphertext",e[38]),e[41].set("sk_hash",e[37]),e[42]=a[5].get("message_payload_encryption_keys"),a[5],e[43]=e[42].get("payload_key"),e[42],d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[43],d.blobs.of_string(["message_thread","_",a[1]].join("")),e[18]).then(function(a){return a=a,e[44]=a[0],a})},function(a){return d.blobs.neq(e[44],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[44]).then(function(a){return a=a,e[48]=a[0],a})},function(a){return e[45]=e[48]}]):d.resolve(e[45]=void 0)},function(b){return e[45]!==void 0?(e[20]!==void 0?(e[50]=new d.Map(),e[50].set("message_tags",e[20]),e[51]=new d.Map(),e[55]="message_tags",e[52]=e[50].get(e[55]),e[50],e[52]?e[53]=!1:e[53]=!0,e[53]?0:e[51].set(e[55],e[52]),e[54]=d.toJSON(e[51]),e[48]=e[54]):e[48]=void 0,e[49]=new d.Map(),e[49].set("backup_action",a[0]),e[49].set("protobuf_encrypted",e[45]),e[49].set("supplemental_data_encrypted",e[41]),e[49].set("timestamp_ms",a[4]),e[49].set("message_tags",e[48]),e[49].set("serialized_attachment_backup_payload",void 0),b=[e[49],void 0],e[46]=b[0],e[47]=b[1],b):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),e[48]=new d.Map(),e[48].set("error_code",d.i64.cast([0,62])),e[48].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[48].set("error_message",""),b=[void 0,e[48]],e[46]=b[0],e[47]=b[1],b),b=[e[46],e[47]],e[39]=b[0],e[40]=b[1],b}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_ENCRYPTION_FAILED"),e[41]=new d.Map(),e[41].set("error_code",d.i64.cast([0,66])),e[41].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[41].set("error_message",""),c=[void 0,e[41]],e[39]=c[0],e[40]=c[1],c))},function(a){return a=[e[39],e[40]],e[24]=a[0],e[25]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error NULL_MAILBOX_ROOT_KEY_V2"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,27])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),c=[void 0,e[26]],e[24]=c[0],e[25]=c[1],c))},function(a){return a=[e[24],e[25]],e[21]=a[0],e[22]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),e[23]=new d.Map(),e[23].set("error_code",d.i64.cast([0,64])),e[23].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[23].set("error_message",""),c=[void 0,e[23]],e[21]=c[0],e[22]=c[1],c))},function(a){return a=[e[21],e[22]],e[16]=a[0],e[17]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),e[18]=new d.Map(),e[18].set("error_code",d.i64.cast([0,65])),e[18].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[18].set("error_message",""),c=[void 0,e[18]],e[16]=c[0],e[17]=c[1],c))},function(a){return a=[e[16],e[17]],e[14]=a[0],e[15]=a[1],a}]):d.sequence([function(c){return d.i64.eq(a[0],d.i64.cast([0,4]))?d.sequence([function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[18]=a[0],e[19]=a[1],e[20]=a[2],a})},function(c){return d.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,e[21]=a[0],a})},function(c){return d.blobs.neq(e[18],void 0)?d.sequence([function(c){return e[24]=a[5].get("message_payload_encryption_keys"),a[5],e[25]=e[24].get("payload_key"),e[24],d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),e[25],d.blobs.of_string(["message_thread","_",a[1]].join("")),e[18]).then(function(a){return a=a,e[26]=a[0],a})},function(a){return d.blobs.neq(e[26],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[26]).then(function(a){return a=a,e[30]=a[0],a})},function(a){return e[27]=e[30]}]):d.resolve(e[27]=void 0)},function(b){return e[27]!==void 0?(e[21]!==void 0?(e[32]=new d.Map(),e[32].set("message_tags",e[21]),e[33]=new d.Map(),e[37]="message_tags",e[34]=e[32].get(e[37]),e[32],e[34]?e[35]=!1:e[35]=!0,e[35]?0:e[33].set(e[37],e[34]),e[36]=d.toJSON(e[33]),e[30]=e[36]):e[30]=void 0,e[31]=new d.Map(),e[31].set("backup_action",a[0]),e[31].set("protobuf_encrypted",e[27]),e[31].set("supplemental_data_encrypted",void 0),e[31].set("timestamp_ms",a[4]),e[31].set("message_tags",e[30]),e[31].set("serialized_attachment_backup_payload",void 0),b=[e[31],void 0],e[28]=b[0],e[29]=b[1],b):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),e[30]=new d.Map(),e[30].set("error_code",d.i64.cast([0,62])),e[30].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[30].set("error_message",""),b=[void 0,e[30]],e[28]=b[0],e[29]=b[1],b),b=[e[28],e[29]],e[22]=b[0],e[23]=b[1],b}]):d.resolve((e[20]?(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,70])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),c=[void 0,e[26]],e[24]=c[0],e[25]=c[1],c):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),e[26]=new d.Map(),e[26].set("error_code",d.i64.cast([0,63])),e[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[26].set("error_message",""),c=[void 0,e[26]],e[24]=c[0],e[25]=c[1],c),c=[e[24],e[25]],e[22]=c[0],e[23]=c[1],c))},function(a){return a=[e[22],e[23]],e[16]=a[0],e[17]=a[1],a}]):d.resolve((d.i64.eq(a[0],d.i64.cast([0,3]))?(e[20]=new d.Map(),e[20].set("backup_action",a[0]),e[20].set("protobuf_encrypted",void 0),e[20].set("supplemental_data_encrypted",void 0),e[20].set("timestamp_ms",a[4]),e[20].set("message_tags",void 0),e[20].set("serialized_attachment_backup_payload",void 0),c=[e[20],void 0],e[18]=c[0],e[19]=c[1],c):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error UNKNOWN"),e[20]=new d.Map(),e[20].set("error_code",d.i64.cast([0,603])),e[20].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[20].set("error_message",""),c=[void 0,e[20]],e[18]=c[0],e[19]=c[1],c),c=[e[18],e[19]],e[16]=c[0],e[17]=c[1],c))},function(a){return a=[e[16],e[17]],e[14]=a[0],e[15]=a[1],a}])},function(a){return a=[e[14],e[15]],e[12]=a[0],e[13]=a[1],a}])},function(a){return a=[e[12],e[13]],e[3]=a[0],e[4]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error NOT_SUPPORTED_ON_WEB"),e[12]=new d.Map(),e[12].set("error_code",d.i64.cast([0,7])),e[12].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),e[12].set("error_message",""),f=[void 0,e[12]],e[3]=f[0],e[4]=f[1],f))},function(a){return e[5]=d.i64.of_float(Date.now()),e[6]=d.i64.random(),e[9]="Finishing execution. Execution time: ",e[10]=d.i64.to_string(d.i64.sub(e[5],e[0])),e[11]=" ms",e[7]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] ",e[7],e[9],e[7],e[10],e[7],e[11]].join("")),d.i64.eq(d.i64.mod_(e[6],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[12]=",",e[13]=d.createArray(),void 0!==void 0?e[14]=(e[13].push(void 0),e[13]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufWithInputsV2",[e[9],e[12],e[10],e[12],e[11]].join(""),e[13],d.i64.cast([0,4]))):d.resolve()},function(a){return a=[e[3],e[4]],f[0]=a[0],f[1]=a[1],a}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure";d=a;g["default"]=d}),98);
__d("LSLoadAndEncryptProtobufV2",["LSLoadAndEncryptProtobufWithInputsV2","LSLogMebClientEvent.nop","gkx","qex"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][loadAndEncryptProtobufV2] Beginning execution."),e[1]=d.i64.of_float(Date.now()),e[8]=function(a){return a==void 0?void 0:a}(c("qex")._("1526")),e[8]!==void 0?e[2]=e[8]:e[2]=!1,(c("gkx")("23657")||c("gkx")("26375"))&&(e[2]||c("gkx")("26377")||c("gkx")("687"))?d.sequence([function(c){return d.filter(d.db.table(305).fetch(),function(b){return d.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(c,f){var g=c.done;c=c.value;return g?(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure] Returning error PROTOBUF_CONTEXT_ROW_NOT_FOUND"),e[15]=new d.Map(),e[15].set("error_code",d.i64.cast([0,67])),e[15].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure"),e[15].set("error_message",""),g=[void 0,e[15]],e[12]=g[0],e[13]=g[1],g):(f=c.item,d.sequence([function(c){return d.storedProcedure(b("LSLoadAndEncryptProtobufWithInputsV2"),f.backupAction,a[2],f.toplevelOfflineThreadingId,f.supplementalKey,f.messageTimestampMs,a[1]).then(function(a){return a=a,e[15]=a[0],e[16]=a[1],a})},function(a){return a=[e[15],e[16]],e[12]=a[0],e[13]=a[1],a}]))})},function(a){return a=[e[12],e[13]],e[3]=a[0],e[4]=a[1],a}]):d.resolve((function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure] Returning error NOT_SUPPORTED_ON_WEB"),e[12]=new d.Map(),e[12].set("error_code",d.i64.cast([0,7])),e[12].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure"),e[12].set("error_message",""),f=[void 0,e[12]],e[3]=f[0],e[4]=f[1],f))},function(a){return e[5]=d.i64.of_float(Date.now()),e[6]=d.i64.random(),e[9]="Finishing execution. Execution time: ",e[10]=d.i64.to_string(d.i64.sub(e[5],e[0])),e[11]=" ms",e[7]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][loadAndEncryptProtobufV2] ",e[7],e[9],e[7],e[10],e[7],e[11]].join("")),d.i64.eq(d.i64.mod_(e[6],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[12]=",",e[13]=d.createArray(),void 0!==void 0?e[14]=(e[13].push(void 0),e[13]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufV2",[e[9],e[12],e[10],e[12],e[11]].join(""),e[13],d.i64.cast([0,4]))):d.resolve()},function(a){return a=[e[3],e[4]],f[0]=a[0],f[1]=a[1],a}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure";d=a;g["default"]=d}),98);
__d("LSLogWebQpl.nop",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LogWebQplNOP").__setRef("LSLogWebQpl.nop");a=function(a,b,c,d,e,f,g){return h.load().then(function(a){return a.call(c,d,e,f,g)})};g["default"]=a}),98);
__d("LSSerializeBackupPayloadV2",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSDeriveValueSecretRefV2","LSEncryptIdentifiersV2","LSEncryptMessagePayloadV2","LSGetBlobFromString.nop","LSGetLatestEpochKeys","LSIsEncryptionVersionSecure","LSIsMobileClient","LSLoadAndEncryptProtobufV2","LSLogMebClientEvent.nop","LSLogWebQpl.nop","gkx","justknobx","qex"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(f){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][serializeBackupPayloadV2] Beginning execution."),e[1]=d.i64.of_float(Date.now()),e[9]=d.i64.mul(e[1],d.i64.cast([0,1e6])),(c("gkx")("23657")||c("gkx")("26375"))&&c("justknobx")._("1071")?d.sequence([function(f){return d.islc(d.filter(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))||!1}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(f,g){var h=f.done;f=f.value;return h?d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[30]=d.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[30],d.i64.cast([0,1e6])),e[9]),void 0],e[18]=b[0],e[19]=b[1],e[20]=b[2],e[21]=b[3],e[22]=b[4],e[23]=b[5],e[24]=b[6],b):(f=c.item,e[30]=d.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[30],d.i64.cast([0,1e6])),e[9]),void 0],e[18]=b[0],e[19]=b[1],e[20]=b[2],e[21]=b[3],e[22]=b[4],e[23]=b[5],e[24]=b[6],b)})},function(a){return e[26]=new d.Map(),e[26].set("task_id",e[18]),e[26].set("queue_name",e[19]),e[26].set("enqueue_timestamp_ms",e[20]),e[26].set("priority",e[21]),e[26].set("first_executed_timestamp_ms",e[22]),e[26].set("execution_time_ns",e[23]),e[26].set("echo_encoding_execution_time_ns",e[24]),e[27]=new d.Map(),e[27].set("task_metadata",e[26]),e[27].set("action_type",void 0),e[27].set("content_type",void 0),e[27].set("identifiers",void 0),e[27].set("identifiers_v2",void 0),e[27].set("task_creation_source",void 0),e[27].set("message_payload_source",d.i64.cast([0,2])),e[28]=new d.Map(),e[28].set("error_code",d.i64.cast([0,1])),e[28].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[28].set("error_message",""),e[29]=d.createArray(),a=[void 0,e[28],e[27],e[29]],e[13]=a[0],e[14]=a[1],e[15]=a[2],e[16]=a[3],a}]):(g=f.item,d.sequence([function(a){return e[28]=g.mailboxRootKeyBlob,e[29]=g.deviceId,e[27]=g.backupTenancy,e[26]=g.encryptionVersion,e[18]=void 0,d.i64.neq(e[18],void 0)?d.resolve(e[19]=e[18]):d.sequence([function(a){return e[30]=d.createArray(),d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,0])).then(function(a){return a=a,e[31]=a[0],a})},function(a){return e[31]?e[40]=(e[30].push(d.i64.cast([0,0])),e[30]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,2])).then(function(a){return a=a,e[32]=a[0],a})},function(a){return e[32]?e[40]=(e[30].push(d.i64.cast([0,2])),e[30]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,3])).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]?e[40]=(e[30].push(d.i64.cast([0,3])),e[30]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,4])).then(function(a){return a=a,e[34]=a[0],a})},function(a){return e[34]?e[40]=(e[30].push(d.i64.cast([0,4])),e[30]):0,e[35]=d.createArray(),e[36]=d.i64.of_int32(e[30].length),d.i64.gt(e[36],d.i64.cast([0,0]))?d.loopAsync(e[36],function(a){return e[40]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[30],e[40]).then(function(a){return a=a,e[41]=a[0],e[42]=a[1],a})},function(a){return e[43]=(e[35].push(e[41]),e[35])}])}):d.resolve()},function(a){return d.sequence([function(a){return e[40]=d.createArray(),e[41]=d.i64.of_int32(e[35].length),d.i64.gt(e[41],d.i64.cast([0,0]))?d.loopAsync(e[41],function(a){return e[43]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[35],e[43]).then(function(a){return a=a,e[44]=a[0],e[45]=a[1],a})},function(a){return e[46]=(e[40].push(d.i64.to_string(e[44])),e[40])}])}):d.resolve()},function(a){return e[42]=e[40].join(","),e[37]=e[42]}])},function(a){return e[35].some(function(a){return d.i64.eq(e[26],a)})?e[38]=e[26]:e[38]=void 0,d.i64.neq(e[38],void 0)?e[39]=e[38]:e[39]=void 0,e[19]=e[39]}])},function(f){return d.i64.neq(e[19],void 0)?e[20]=e[19]:e[20]=d.i64.cast([0,0]),d.i64.neq(e[27],void 0)?e[21]=e[27]:e[21]=d.i64.cast([0,1]),d.i64.neq(e[29],void 0)?d.sequence([function(f){return d.db.table(177).fetch([[[a[0]]],"fk_pending_tasks"]).next().then(function(i,j){var f=i.done;i=i.value;return f?d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[47]=d.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[47],d.i64.cast([0,1e6])),e[9]),void 0],e[35]=b[0],e[36]=b[1],e[37]=b[2],e[38]=b[3],e[39]=b[4],e[40]=b[5],e[41]=b[6],b):(f=c.item,e[47]=d.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[47],d.i64.cast([0,1e6])),e[9]),void 0],e[35]=b[0],e[36]=b[1],e[37]=b[2],e[38]=b[3],e[39]=b[4],e[40]=b[5],e[41]=b[6],b)})},function(a){return e[43]=new d.Map(),e[43].set("task_id",e[35]),e[43].set("queue_name",e[36]),e[43].set("enqueue_timestamp_ms",e[37]),e[43].set("priority",e[38]),e[43].set("first_executed_timestamp_ms",e[39]),e[43].set("execution_time_ns",e[40]),e[43].set("echo_encoding_execution_time_ns",e[41]),e[44]=new d.Map(),e[44].set("task_metadata",e[43]),e[44].set("action_type",void 0),e[44].set("content_type",void 0),e[44].set("identifiers",void 0),e[44].set("identifiers_v2",void 0),e[44].set("task_creation_source",void 0),e[44].set("message_payload_source",d.i64.cast([0,2])),e[45]=new d.Map(),e[45].set("error_code",d.i64.cast([0,5])),e[45].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[45].set("error_message","Pending backup context row not found"),e[46]=d.createArray(),a=[void 0,e[45],e[44],e[46]],e[30]=a[0],e[31]=a[1],e[32]=a[2],e[33]=a[3],a}]):(j=i.item,d.sequence([function(f){return e[40]=j.actionType,e[41]=j.contentType,e[45]=j.echoContent,e[43]=j.lsTraceId,e[44]=j.echoEncodingLatencyNs,e[42]=j.attachmentPayload,e[46]=j.tamThreadSubtype,e[47]=j.isInstamadillo,e[35]=new d.Map(),e[35].set("backup_id",d.i64.to_string(g.backupId)),e[35].set("act_thread_id",j.listKey),e[35].set("timestamp",j.sortKey),e[35].set("otid",j.uniqueKey),e[48]=j.error==null?d.i64.cast([0,0]):j.error,d.i64.eq(e[48],d.i64.cast([0,0]))?d.sequence([function(a){return e[49]=e[35].get("act_thread_id"),e[35],e[50]=e[35].get("otid"),e[35],d.storedProcedure(b("LSGetLatestEpochKeys"),!1).then(function(a){return a=a,e[51]=a[0],e[52]=a[1],a})},function(a){return e[51]!==void 0?d.sequence([function(a){return d.i64.eq(e[41],d.i64.cast([0,1]))?d.sequence([function(a){return e[62]=d.createArray(),e[67]=(e[62].push(d.i64.cast([0,32])),e[62]),d.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",e[49]].join("")).then(function(a){return a=a,e[63]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[63],void 0,e[28],e[62]).then(function(a){return a=a,e[64]=a[0],a})},function(a){return e[64]?e[65]=!1:e[65]=!0,e[65]?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),e[67]=d.createArray(),void 0!==void 0?e[68]=(e[67].push(void 0),e[67]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",e[67],d.i64.cast([0,3]))},function(a){return e[66]=void 0}]):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[64],d.i64.cast([0,0])).then(function(a){return a=a,e[67]=a[0],e[68]=a[1],a})},function(a){return e[66]=e[67]}])},function(a){return e[59]=e[66]}]):d.sequence([function(a){return d.i64.eq(e[40],d.i64.cast([0,2]))?d.sequence([function(a){return e[63]=d.createArray(),e[68]=(e[63].push(d.i64.cast([0,32])),e[63]),d.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",e[50]].join("")).then(function(a){return a=a,e[64]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[64],void 0,e[28],e[63]).then(function(a){return a=a,e[65]=a[0],a})},function(a){return e[65]?e[66]=!1:e[66]=!0,e[66]?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),e[68]=d.createArray(),void 0!==void 0?e[69]=(e[68].push(void 0),e[68]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",e[68],d.i64.cast([0,3]))},function(a){return e[67]=void 0}]):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[65],d.i64.cast([0,0])).then(function(a){return a=a,e[68]=a[0],e[69]=a[1],a})},function(a){return e[67]=e[68]}])},function(a){return e[62]=e[67]}]):d.resolve(e[62]=void 0)},function(a){return e[59]=e[62]}])},function(a){return d.blobs.neq(e[59],void 0)?d.sequence([function(a){return e[62]=e[51].get("epoch_keys"),e[51],e[63]=e[62].get("epoch_anon_id"),e[62],e[64]=e[62].get("epoch_root_key"),e[62],e[65]=d.createArray(),e[76]=(e[65].push(d.i64.cast([0,32])),e[65]),d.i64.ge(e[20],d.i64.cast([0,3]))?d.resolve(e[66]=void 0):d.sequence([function(a){return d.nativeOperation(b("LSGetBlobFromString.nop"),e[49]).then(function(a){return a=a,e[76]=a[0],a})},function(a){return e[66]=e[76]}])},function(a){return d.i64.ge(e[20],d.i64.cast([0,4]))?(e[76]="_",e[67]=["message_key_in_epoch",e[76],d.blobs.to_string(e[63]),e[76],"cipher_version",e[76],d.i64.to_string(e[20]),e[76],"thread",e[76],e[49]==null?"":e[49]].join("")):(d.i64.ge(e[20],d.i64.cast([0,3]))?(e[77]="_",e[76]=["message_key_in_epoch",e[77],d.blobs.to_string(e[63]),e[77],"cipher_version",e[77],d.i64.to_string(e[20]),e[77],"thread",e[77],e[49]==null?"":e[49]].join("")):(d.i64.ge(e[20],d.i64.cast([0,2]))?(e[78]="_",e[77]=["message_key_in_epoch",e[78],d.blobs.to_string(e[63]),e[78],"cipher_version",e[78],d.i64.to_string(e[20])].join("")):e[77]=["message_key_in_epoch","_",d.blobs.to_string(e[63])].join(""),e[76]=e[77]),e[67]=e[76]),d.nativeOperation(b("LSGetBlobFromString.nop"),e[67]).then(function(a){return a=a,e[68]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[68],e[66],e[64],e[65]).then(function(a){return a=a,e[69]=a[0],a})},function(a){return e[69]?e[70]=!1:e[70]=!0,e[70]?d.resolve(e[71]=void 0):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[69],d.i64.cast([0,0])).then(function(a){return a=a,e[76]=a[0],e[77]=a[1],a})},function(a){return e[71]=e[76]}])},function(a){return d.filter(d.db.table(169).fetch(),function(a){return d.blobs.eq(a.epochAnonIdBlob,d.blob("MA=="))}).next().then(function(c,f){var a=c.done;c=c.value;return a?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTableUtils] Failed to get mailbox_root_key_v2: epoch 0 is not available."),e[76]=d.createArray(),void 0!==void 0?e[77]=(e[76].push(void 0),e[76]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTableUtils","Failed to get mailbox_root_key_v2: epoch 0 is not available.",e[76],d.i64.cast([0,3]))},function(a){return e[72]=void 0}]):(f=c.item,d.sequence([function(a){return e[76]=d.createArray(),e[84]=(e[76].push(d.i64.cast([0,32])),e[76]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5zYWx0X21haWxib3hfcm9vdF9rZXlfdjI="),void 0,e[28],e[76]).then(function(a){return a=a,e[77]=a[0],a})},function(a){return e[77]!==void 0?d.sequence([function(a){return e[84]=d.i64.of_int32(e[77].length),d.i64.ge(e[84],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[77],d.i64.cast([0,0])).then(function(a){return a=a,e[86]=a[0],e[87]=a[1],a})},function(a){return e[85]=e[86]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[86]=d.createArray(),void 0!==void 0?e[87]=(e[86].push(void 0),e[86]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[86],d.i64.cast([0,3]))},function(a){return e[85]=void 0}])},function(a){return e[78]=e[85]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[84]=d.createArray(),void 0!==void 0?e[85]=(e[84].push(void 0),e[84]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[84],d.i64.cast([0,3]))},function(a){return e[78]=void 0}])},function(a){return d.blobs.neq(e[78],void 0)?e[79]=!0:e[79]=!1,e[79]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[80]=d.createArray(),e[84]=(e[80].push(d.i64.cast([0,32])),e[80]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5tYWlsYm94X3Jvb3Rfa2V5X3Yy"),e[78],f.epochRootKeyBlob,e[80]).then(function(a){return a=a,e[81]=a[0],a})},function(a){return e[81]!==void 0?d.sequence([function(a){return e[84]=d.i64.of_int32(e[81].length),d.i64.ge(e[84],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[81],d.i64.cast([0,0])).then(function(a){return a=a,e[86]=a[0],e[87]=a[1],a})},function(a){return e[85]=e[86]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[86]=d.createArray(),void 0!==void 0?e[87]=(e[86].push(void 0),e[86]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[86],d.i64.cast([0,3]))},function(a){return e[85]=void 0}])},function(a){return e[82]=e[85]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[84]=d.createArray(),void 0!==void 0?e[85]=(e[84].push(void 0),e[84]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[84],d.i64.cast([0,3]))},function(a){return e[82]=void 0}])},function(a){return d.blobs.neq(e[82],void 0)?e[83]=!0:e[83]=!1,e[83]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[72]=e[82]}]))})},function(a){return d.blobs.neq(e[71],void 0)?d.sequence([function(a){return d.blobs.neq(e[72],void 0)?d.sequence([function(a){return e[82]=d.createArray(),e[86]=(e[82].push(d.i64.cast([0,32])),e[82]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5mYWxsYmFja19rZXk="),void 0,e[72],e[82]).then(function(a){return a=a,e[83]=a[0],a})},function(a){return e[83]!==void 0?d.sequence([function(a){return e[86]=d.i64.of_int32(e[83].length),d.i64.ge(e[86],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[83],d.i64.cast([0,0])).then(function(a){return a=a,e[88]=a[0],e[89]=a[1],a})},function(a){return e[87]=e[88]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[88]=d.createArray(),void 0!==void 0?e[89]=(e[88].push(void 0),e[88]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[88],d.i64.cast([0,3]))},function(a){return e[87]=void 0}])},function(a){return e[84]=e[87]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[86]=d.createArray(),void 0!==void 0?e[87]=(e[86].push(void 0),e[86]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[86],d.i64.cast([0,3]))},function(a){return e[84]=void 0}])},function(a){return d.blobs.neq(e[84],void 0)?e[85]=!0:e[85]=!1,e[85]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[76]=e[84]}]):d.resolve(e[76]=void 0)},function(a){return e[77]=e[62].get("epoch_root_key"),e[62],e[78]=e[62].get("epoch_anon_id"),e[62],e[79]=e[62].get("epoch_id"),e[62],e[80]=new d.Map(),e[80].set("payload_key",e[71]),e[80].set("payload_fallback_key",e[76]),e[80].set("encryption_version",e[20]),e[80].set("epoch_root_key",e[77]),e[80].set("epoch_anon_id",e[78]),e[80].set("epoch_id",e[79]),e[81]=new d.Map(),e[81].set("ope_key",e[59]),e[81].set("message_payload_encryption_keys",e[80]),e[81].set("ocmf_shared_key",g.ocmfClientStateBlob),e[81].set("mailbox_base_salt",e[28]),e[81].set("mailbox_root_key_v2",e[72]),a=[e[81],void 0],e[74]=a[0],e[75]=a[1],a}]):d.resolve((e[76]=new d.Map(),e[76].set("error_code",d.i64.cast([0,26])),e[76].set("stored_procedure","MEBKeyDeriver"),e[76].set("error_message",""),a=[void 0,e[76]],e[74]=a[0],e[75]=a[1],a))},function(a){return a=[e[74],e[75]],e[60]=a[0],e[61]=a[1],a}]):d.resolve((e[62]=new d.Map(),e[62].set("error_code",d.i64.cast([0,25])),e[62].set("stored_procedure","MEBKeyDeriver"),e[62].set("error_message",""),a=[void 0,e[62]],e[60]=a[0],e[61]=a[1],a))},function(a){return a=[e[60],e[61]],e[53]=a[0],e[54]=a[1],a}]):d.resolve((a=[void 0,e[52]],e[53]=a[0],e[54]=a[1],a))},function(f){return e[53]!==void 0?d.sequence([function(a){return e[59]=e[35].get("backup_id"),e[35],e[60]=e[35].get("act_thread_id"),e[35],e[61]=e[35].get("timestamp"),e[35],e[62]=e[35].get("otid"),e[35],d.storedProcedure(b("LSEncryptIdentifiersV2"),e[40],e[41],e[59],e[60],d.i64.from_string(e[61]),e[62],e[53]).then(function(a){return a=a,e[63]=a[0],e[64]=a[1],a})},function(f){return e[63]!==void 0?d.sequence([function(c){return e[69]=e[35].get("act_thread_id"),e[35],d.storedProcedure(b("LSLoadAndEncryptProtobufV2"),a[0],e[53],e[69]).then(function(a){return a=a,e[70]=a[0],e[71]=a[1],a})},function(f){return e[77]=function(a){return a==void 0?void 0:a}(c("qex")._("2109")),e[77]!==void 0?e[72]=e[77]:e[72]=!1,(c("gkx")("6356")||e[72])&&e[70]!==void 0?d.sequence([function(a){return e[78]=e[35].get("act_thread_id"),e[35],e[79]=e[35].get("backup_id"),e[35],d.storedProcedure(b("LSDeriveValueSecretRefV2"),e[78],e[79],e[53]).then(function(a){return a=a,e[80]=a[0],e[81]=a[1],a})},function(c){return e[70]!==void 0?d.sequence([function(c){return e[80]!==void 0?d.sequence([function(a){return e[90]=e[80].get("value_secret_ref"),e[80],e[91]=e[63].get("act_thread_id_ocmf_partial"),e[63],e[92]=e[63].get("otid_ocmf_partial"),e[63],e[93]=e[63].get("timestamp_encrypted"),e[63],e[94]=new d.Map(),e[94].set("list_key",e[91]),e[94].set("unique_key",e[92]),e[94].set("sort_key",e[93]),void 0!==void 0?(e[126]=(void 0).get("encrypted_message_payload"),void 0,e[127]=(void 0).get("value_secret_ref"),void 0,e[128]=new d.Map(),e[128].set("value",e[126]),e[128].set("value_secret_ref",e[127]),e[95]=e[128]):e[95]=void 0,e[96]=new d.Map(),e[96].set("list_item_id",e[94]),e[96].set("list_item",e[95]),e[96].set("action_type",e[40]),e[97]=e[35].get("timestamp"),e[35],e[98]=e[35].get("otid"),e[35],e[99]=e[35].get("act_thread_id"),e[35],e[100]=new d.Map(),e[100].set("timestamp",e[97]),e[100].set("otid",e[98]),e[100].set("wa_thread_id",d.i64.from_string(e[99])),e[101]=e[53].get("mailbox_base_salt"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[101]).then(function(a){return a=a,e[102]=a[0],a})},function(a){return e[103]=e[53].get("ocmf_shared_key"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[103]).then(function(a){return a=a,e[104]=a[0],a})},function(a){return e[105]=new d.Map(),e[105].set("mailbox_root_key",e[102]==null?"":e[102]),e[105].set("ocmf_client_state_blob",e[104]==null?"":e[104]),e[106]=e[63].get("backup_id_ocmf_partial"),e[63],e[107]=e[53].get("message_payload_encryption_keys"),e[53],e[108]=e[107].get("epoch_id"),e[107],e[109]=e[53].get("message_payload_encryption_keys"),e[53],e[110]=e[109].get("encryption_version"),e[109],e[125]=e[43]==null?"":e[43],e[111]=new d.Map(),e[111].set("mailbox_partial_id",e[106]),e[111].set("action",e[96]),e[111].set("device_id",e[29]),e[111].set("echo_version",d.i64.cast([0,0])),e[111].set("epoch_id",e[108]),e[111].set("trace_id",void 0),e[111].set("encryption_version",e[110]),e[111].set("is_thread",d.i64.eq(e[41],d.i64.cast([0,2]))),e[111].set("raw_identifiers",e[100]),e[111].set("raw_tokens",e[105]),e[111].set("request_id",e[125]),e[111].set("tam_thread_subtype",e[46]==null?d.i64.cast([0,0]):e[46]),e[111].set("is_instamadillo",e[47]==null?!1:e[47]),e[111].set("empty_echo_payload_reason",d.i64.cast([0,1])),e[111].set("value_secret_ref",e[90]),e[70]!==void 0?d.sequence([function(a){return e[126]=e[70].get("supplemental_data_encrypted"),e[70],e[126]!==void 0?d.sequence([function(a){return e[128]=e[70].get("protobuf_encrypted"),e[70],e[129]=e[70].get("backup_action"),e[70],e[130]=e[70].get("timestamp_ms"),e[70],e[131]=e[126].get("sk_ciphertext"),e[126],d.nativeOperation(b("LSBase64Encode.nop"),e[131]).then(function(a){return a=a,e[132]=a[0],a})},function(a){return e[133]=e[126].get("sk_hash"),e[126],d.nativeOperation(b("LSBase64Encode.nop"),e[133]).then(function(a){return a=a,e[134]=a[0],a})},function(a){return e[135]=e[70].get("message_tags"),e[70],e[136]=new d.Map(),e[136].set("supplementary_data_key",void 0),e[136].set("encrypted_protobuf",e[128]),e[136].set("key_value_backup_action",e[129]),e[136].set("protobuf_ts_ms",e[130]),e[136].set("supplemental_key_ciphertext",e[132]),e[136].set("supplemental_key_hash",e[134]),e[136].set("message_tags",e[135]),e[127]=e[136]}]):d.resolve((e[128]=e[70].get("protobuf_encrypted"),e[70],e[129]=e[70].get("backup_action"),e[70],e[130]=e[70].get("timestamp_ms"),e[70],e[131]=e[70].get("message_tags"),e[70],e[132]=new d.Map(),e[132].set("supplementary_data_key",void 0),e[132].set("encrypted_protobuf",e[128]),e[132].set("key_value_backup_action",e[129]),e[132].set("protobuf_ts_ms",e[130]),e[132].set("message_tags",e[131]),e[127]=e[132]))},function(a){return e[111].set("key_value_backup_payload",e[127])}]):d.resolve()},function(a){return e[42]!==void 0?e[111].set("attachment_backup_payload",e[42]):function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),e[125]!==void 0?d.nativeOperation(b("LSLogWebQpl.nop"),e[125],d.i64.cast([0,521481602]),"upload_start",d.i64.cast([0,0]),void 0,void 0):d.resolve()},function(a){return d.sequence([function(a){return e[43]!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),e[43],d.i64.cast([0,1463]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[126]=a[0],a})},function(a){return e[126]?e[127]=!0:e[127]=!1,e[127]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[128]=d.createArray(),void 0!==void 0?e[129]=(e[128].push(void 0),e[128]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[128],d.i64.cast([0,3]))):d.resolve()}])},function(b){return e[112]=d.toJSON(e[111]),d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[126]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[127]=void 0:e[127]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[126],d.i64.cast([0,1e6])),e[9]),e[127]],e[113]=b[0],e[114]=b[1],e[115]=b[2],e[116]=b[3],e[117]=b[4],e[118]=b[5],e[119]=b[6],b):(f=c.item,e[126]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[127]=void 0:e[127]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[126],d.i64.cast([0,1e6])),e[9]),e[127]],e[113]=b[0],e[114]=b[1],e[115]=b[2],e[116]=b[3],e[117]=b[4],e[118]=b[5],e[119]=b[6],b)})},function(a){return e[121]=new d.Map(),e[121].set("task_id",e[113]),e[121].set("queue_name",e[114]),e[121].set("enqueue_timestamp_ms",e[115]),e[121].set("priority",e[116]),e[121].set("first_executed_timestamp_ms",e[117]),e[121].set("execution_time_ns",e[118]),e[121].set("echo_encoding_execution_time_ns",e[119]),e[122]=new d.Map(),e[122].set("task_metadata",e[121]),e[122].set("action_type",e[40]),e[122].set("content_type",e[41]),e[122].set("identifiers",void 0),e[122].set("identifiers_v2",e[35]),e[122].set("task_creation_source",void 0),e[122].set("message_payload_source",d.i64.cast([0,2])),e[123]=new d.Map(),e[123].set("payload",e[112]),e[124]=d.createArray(),e[126]=(e[124].push(void 0),e[124]),a=[e[123],void 0,e[122],e[124]],e[86]=a[0],e[87]=a[1],e[88]=a[2],e[89]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[101]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[102]=void 0:e[102]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[101],d.i64.cast([0,1e6])),e[9]),e[102]],e[90]=b[0],e[91]=b[1],e[92]=b[2],e[93]=b[3],e[94]=b[4],e[95]=b[5],e[96]=b[6],b):(f=c.item,e[101]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[102]=void 0:e[102]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[101],d.i64.cast([0,1e6])),e[9]),e[102]],e[90]=b[0],e[91]=b[1],e[92]=b[2],e[93]=b[3],e[94]=b[4],e[95]=b[5],e[96]=b[6],b)})},function(a){return e[98]=new d.Map(),e[98].set("task_id",e[90]),e[98].set("queue_name",e[91]),e[98].set("enqueue_timestamp_ms",e[92]),e[98].set("priority",e[93]),e[98].set("first_executed_timestamp_ms",e[94]),e[98].set("execution_time_ns",e[95]),e[98].set("echo_encoding_execution_time_ns",e[96]),e[99]=new d.Map(),e[99].set("task_metadata",e[98]),e[99].set("action_type",e[40]),e[99].set("content_type",e[41]),e[99].set("identifiers",void 0),e[99].set("identifiers_v2",e[35]),e[99].set("task_creation_source",void 0),e[99].set("message_payload_source",d.i64.cast([0,2])),e[100]=d.createArray(),e[101]=(e[100].push(void 0),e[100]),a=[void 0,e[81],e[99],e[100]],e[86]=a[0],e[87]=a[1],e[88]=a[2],e[89]=a[3],a}])},function(a){return a=[e[86],e[87],e[88],e[89]],e[82]=a[0],e[83]=a[1],e[84]=a[2],e[85]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[97]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[98]=void 0:e[98]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[97],d.i64.cast([0,1e6])),e[9]),e[98]],e[86]=b[0],e[87]=b[1],e[88]=b[2],e[89]=b[3],e[90]=b[4],e[91]=b[5],e[92]=b[6],b):(f=c.item,e[97]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[98]=void 0:e[98]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[97],d.i64.cast([0,1e6])),e[9]),e[98]],e[86]=b[0],e[87]=b[1],e[88]=b[2],e[89]=b[3],e[90]=b[4],e[91]=b[5],e[92]=b[6],b)})},function(a){return e[94]=new d.Map(),e[94].set("task_id",e[86]),e[94].set("queue_name",e[87]),e[94].set("enqueue_timestamp_ms",e[88]),e[94].set("priority",e[89]),e[94].set("first_executed_timestamp_ms",e[90]),e[94].set("execution_time_ns",e[91]),e[94].set("echo_encoding_execution_time_ns",e[92]),e[95]=new d.Map(),e[95].set("task_metadata",e[94]),e[95].set("action_type",e[40]),e[95].set("content_type",e[41]),e[95].set("identifiers",void 0),e[95].set("identifiers_v2",e[35]),e[95].set("task_creation_source",void 0),e[95].set("message_payload_source",d.i64.cast([0,2])),e[96]=d.createArray(),e[97]=(e[96].push(e[71]),e[96]),a=[void 0,void 0,e[95],e[96]],e[82]=a[0],e[83]=a[1],e[84]=a[2],e[85]=a[3],a}])},function(a){return a=[e[82],e[83],e[84],e[85]],e[73]=a[0],e[74]=a[1],e[75]=a[2],e[76]=a[3],a}]):d.sequence([function(c){return d.i64.eq(e[40],d.i64.cast([0,1]))?(e[86]=e[45]===""?void 0:e[45],e[86]!==void 0?(c=[e[86],void 0],e[84]=c[0],e[85]=c[1],c):(e[87]=new d.Map(),e[87].set("error_code",d.i64.cast([0,30])),e[87].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[87].set("error_message",""),c=[void 0,e[87]],e[84]=c[0],e[85]=c[1],c),c=[e[84],e[85]],e[78]=c[0],e[79]=c[1],c):(c=["",void 0],e[78]=c[0],e[79]=c[1],c),e[78]!==void 0?d.sequence([function(a){return d.i64.eq(e[40],d.i64.cast([0,1]))?d.sequence([function(a){return e[90]=e[35].get("backup_id"),e[35],e[91]=e[35].get("act_thread_id"),e[35],d.storedProcedure(b("LSEncryptMessagePayloadV2"),e[90],e[91],e[53],e[78]).then(function(a){return a=a,e[92]=a[0],e[93]=a[1],a})},function(a){return a=[e[92],e[93]],e[84]=a[0],e[85]=a[1],a}]):d.resolve((e[90]=new d.Map(),e[90].set("encrypted_message_payload",""),e[90].set("value_secret_ref",""),a=[e[90],void 0],e[84]=a[0],e[85]=a[1],a))},function(c){return e[84]!==void 0?d.sequence([function(a){return e[90]=e[63].get("act_thread_id_ocmf_partial"),e[63],e[91]=e[63].get("otid_ocmf_partial"),e[63],e[92]=e[63].get("timestamp_encrypted"),e[63],e[93]=new d.Map(),e[93].set("list_key",e[90]),e[93].set("unique_key",e[91]),e[93].set("sort_key",e[92]),e[84]!==void 0?(e[125]=e[84].get("encrypted_message_payload"),e[84],e[126]=e[84].get("value_secret_ref"),e[84],e[127]=new d.Map(),e[127].set("value",e[125]),e[127].set("value_secret_ref",e[126]),e[94]=e[127]):e[94]=void 0,e[95]=new d.Map(),e[95].set("list_item_id",e[93]),e[95].set("list_item",e[94]),e[95].set("action_type",e[40]),e[96]=e[35].get("timestamp"),e[35],e[97]=e[35].get("otid"),e[35],e[98]=e[35].get("act_thread_id"),e[35],e[99]=new d.Map(),e[99].set("timestamp",e[96]),e[99].set("otid",e[97]),e[99].set("wa_thread_id",d.i64.from_string(e[98])),e[100]=e[53].get("mailbox_base_salt"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[100]).then(function(a){return a=a,e[101]=a[0],a})},function(a){return e[102]=e[53].get("ocmf_shared_key"),e[53],d.nativeOperation(b("LSBase64Encode.nop"),e[102]).then(function(a){return a=a,e[103]=a[0],a})},function(a){return e[104]=new d.Map(),e[104].set("mailbox_root_key",e[101]==null?"":e[101]),e[104].set("ocmf_client_state_blob",e[103]==null?"":e[103]),e[105]=e[63].get("backup_id_ocmf_partial"),e[63],e[106]=e[53].get("message_payload_encryption_keys"),e[53],e[107]=e[106].get("epoch_id"),e[106],e[108]=e[53].get("message_payload_encryption_keys"),e[53],e[109]=e[108].get("encryption_version"),e[108],e[124]=e[43]==null?"":e[43],e[110]=new d.Map(),e[110].set("mailbox_partial_id",e[105]),e[110].set("action",e[95]),e[110].set("device_id",e[29]),e[110].set("echo_version",d.i64.cast([0,0])),e[110].set("epoch_id",e[107]),e[110].set("trace_id",void 0),e[110].set("encryption_version",e[109]),e[110].set("is_thread",d.i64.eq(e[41],d.i64.cast([0,2]))),e[110].set("raw_identifiers",e[99]),e[110].set("raw_tokens",e[104]),e[110].set("request_id",e[124]),e[110].set("tam_thread_subtype",e[46]==null?d.i64.cast([0,0]):e[46]),e[110].set("is_instamadillo",e[47]==null?!1:e[47]),e[70]!==void 0?d.sequence([function(a){return e[125]=e[70].get("supplemental_data_encrypted"),e[70],e[125]!==void 0?d.sequence([function(a){return e[127]=e[70].get("protobuf_encrypted"),e[70],e[128]=e[70].get("backup_action"),e[70],e[129]=e[70].get("timestamp_ms"),e[70],e[130]=e[125].get("sk_ciphertext"),e[125],d.nativeOperation(b("LSBase64Encode.nop"),e[130]).then(function(a){return a=a,e[131]=a[0],a})},function(a){return e[132]=e[125].get("sk_hash"),e[125],d.nativeOperation(b("LSBase64Encode.nop"),e[132]).then(function(a){return a=a,e[133]=a[0],a})},function(a){return e[134]=e[70].get("message_tags"),e[70],e[135]=new d.Map(),e[135].set("supplementary_data_key",void 0),e[135].set("encrypted_protobuf",e[127]),e[135].set("key_value_backup_action",e[128]),e[135].set("protobuf_ts_ms",e[129]),e[135].set("supplemental_key_ciphertext",e[131]),e[135].set("supplemental_key_hash",e[133]),e[135].set("message_tags",e[134]),e[126]=e[135]}]):d.resolve((e[127]=e[70].get("protobuf_encrypted"),e[70],e[128]=e[70].get("backup_action"),e[70],e[129]=e[70].get("timestamp_ms"),e[70],e[130]=e[70].get("message_tags"),e[70],e[131]=new d.Map(),e[131].set("supplementary_data_key",void 0),e[131].set("encrypted_protobuf",e[127]),e[131].set("key_value_backup_action",e[128]),e[131].set("protobuf_ts_ms",e[129]),e[131].set("message_tags",e[130]),e[126]=e[131]))},function(a){return e[110].set("key_value_backup_payload",e[126])}]):d.resolve()},function(a){return e[42]!==void 0?e[110].set("attachment_backup_payload",e[42]):function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),e[124]!==void 0?d.nativeOperation(b("LSLogWebQpl.nop"),e[124],d.i64.cast([0,521481602]),"upload_start",d.i64.cast([0,0]),void 0,void 0):d.resolve()},function(a){return d.sequence([function(a){return e[43]!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),e[43],d.i64.cast([0,1463]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[125]=a[0],a})},function(a){return e[125]?e[126]=!0:e[126]=!1,e[126]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[127]=d.createArray(),void 0!==void 0?e[128]=(e[127].push(void 0),e[127]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[127],d.i64.cast([0,3]))):d.resolve()}])},function(b){return e[111]=d.toJSON(e[110]),d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[125]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[126]=void 0:e[126]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[125],d.i64.cast([0,1e6])),e[9]),e[126]],e[112]=b[0],e[113]=b[1],e[114]=b[2],e[115]=b[3],e[116]=b[4],e[117]=b[5],e[118]=b[6],b):(f=c.item,e[125]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[126]=void 0:e[126]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[125],d.i64.cast([0,1e6])),e[9]),e[126]],e[112]=b[0],e[113]=b[1],e[114]=b[2],e[115]=b[3],e[116]=b[4],e[117]=b[5],e[118]=b[6],b)})},function(a){return e[120]=new d.Map(),e[120].set("task_id",e[112]),e[120].set("queue_name",e[113]),e[120].set("enqueue_timestamp_ms",e[114]),e[120].set("priority",e[115]),e[120].set("first_executed_timestamp_ms",e[116]),e[120].set("execution_time_ns",e[117]),e[120].set("echo_encoding_execution_time_ns",e[118]),e[121]=new d.Map(),e[121].set("task_metadata",e[120]),e[121].set("action_type",e[40]),e[121].set("content_type",e[41]),e[121].set("identifiers",void 0),e[121].set("identifiers_v2",e[35]),e[121].set("task_creation_source",void 0),e[121].set("message_payload_source",d.i64.cast([0,2])),e[122]=new d.Map(),e[122].set("payload",e[111]),e[123]=d.createArray(),e[125]=(e[123].push(e[71]),e[123]),a=[e[122],void 0,e[121],e[123]],e[86]=a[0],e[87]=a[1],e[88]=a[2],e[89]=a[3],a}]):d.sequence([function(b){return d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[105]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[106]=void 0:e[106]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[105],d.i64.cast([0,1e6])),e[9]),e[106]],e[94]=b[0],e[95]=b[1],e[96]=b[2],e[97]=b[3],e[98]=b[4],e[99]=b[5],e[100]=b[6],b):(f=c.item,e[105]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[106]=void 0:e[106]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[105],d.i64.cast([0,1e6])),e[9]),e[106]],e[94]=b[0],e[95]=b[1],e[96]=b[2],e[97]=b[3],e[98]=b[4],e[99]=b[5],e[100]=b[6],b)})},function(a){return e[102]=new d.Map(),e[102].set("task_id",e[94]),e[102].set("queue_name",e[95]),e[102].set("enqueue_timestamp_ms",e[96]),e[102].set("priority",e[97]),e[102].set("first_executed_timestamp_ms",e[98]),e[102].set("execution_time_ns",e[99]),e[102].set("echo_encoding_execution_time_ns",e[100]),e[103]=new d.Map(),e[103].set("task_metadata",e[102]),e[103].set("action_type",e[40]),e[103].set("content_type",e[41]),e[103].set("identifiers",void 0),e[103].set("identifiers_v2",e[35]),e[103].set("task_creation_source",void 0),e[103].set("message_payload_source",d.i64.cast([0,2])),e[104]=d.createArray(),e[105]=(e[104].push(e[71]),e[104]),a=[void 0,e[85],e[103],e[104]],e[90]=a[0],e[91]=a[1],e[92]=a[2],e[93]=a[3],a}])},function(a){return a=[e[90],e[91],e[92],e[93]],e[86]=a[0],e[87]=a[1],e[88]=a[2],e[89]=a[3],a}])},function(a){return a=[e[86],e[87],e[88],e[89]],e[80]=a[0],e[81]=a[1],e[82]=a[2],e[83]=a[3],a}]):d.sequence([function(b){return d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[99]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[100]=void 0:e[100]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[99],d.i64.cast([0,1e6])),e[9]),e[100]],e[88]=b[0],e[89]=b[1],e[90]=b[2],e[91]=b[3],e[92]=b[4],e[93]=b[5],e[94]=b[6],b):(f=c.item,e[99]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[100]=void 0:e[100]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[99],d.i64.cast([0,1e6])),e[9]),e[100]],e[88]=b[0],e[89]=b[1],e[90]=b[2],e[91]=b[3],e[92]=b[4],e[93]=b[5],e[94]=b[6],b)})},function(a){return e[96]=new d.Map(),e[96].set("task_id",e[88]),e[96].set("queue_name",e[89]),e[96].set("enqueue_timestamp_ms",e[90]),e[96].set("priority",e[91]),e[96].set("first_executed_timestamp_ms",e[92]),e[96].set("execution_time_ns",e[93]),e[96].set("echo_encoding_execution_time_ns",e[94]),e[97]=new d.Map(),e[97].set("task_metadata",e[96]),e[97].set("action_type",e[40]),e[97].set("content_type",e[41]),e[97].set("identifiers",void 0),e[97].set("identifiers_v2",e[35]),e[97].set("task_creation_source",void 0),e[97].set("message_payload_source",d.i64.cast([0,2])),e[98]=d.createArray(),e[99]=(e[98].push(e[71]),e[98]),a=[void 0,e[79],e[97],e[98]],e[84]=a[0],e[85]=a[1],e[86]=a[2],e[87]=a[3],a}])},function(a){return a=[e[84],e[85],e[86],e[87]],e[80]=a[0],e[81]=a[1],e[82]=a[2],e[83]=a[3],a}])},function(a){return a=[e[80],e[81],e[82],e[83]],e[73]=a[0],e[74]=a[1],e[75]=a[2],e[76]=a[3],a}])},function(a){return a=[e[73],e[74],e[75],e[76]],e[65]=a[0],e[66]=a[1],e[67]=a[2],e[68]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[80]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[81]=void 0:e[81]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[80],d.i64.cast([0,1e6])),e[9]),e[81]],e[69]=b[0],e[70]=b[1],e[71]=b[2],e[72]=b[3],e[73]=b[4],e[74]=b[5],e[75]=b[6],b):(f=c.item,e[80]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[81]=void 0:e[81]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[80],d.i64.cast([0,1e6])),e[9]),e[81]],e[69]=b[0],e[70]=b[1],e[71]=b[2],e[72]=b[3],e[73]=b[4],e[74]=b[5],e[75]=b[6],b)})},function(a){return e[77]=new d.Map(),e[77].set("task_id",e[69]),e[77].set("queue_name",e[70]),e[77].set("enqueue_timestamp_ms",e[71]),e[77].set("priority",e[72]),e[77].set("first_executed_timestamp_ms",e[73]),e[77].set("execution_time_ns",e[74]),e[77].set("echo_encoding_execution_time_ns",e[75]),e[78]=new d.Map(),e[78].set("task_metadata",e[77]),e[78].set("action_type",e[40]),e[78].set("content_type",e[41]),e[78].set("identifiers",void 0),e[78].set("identifiers_v2",e[35]),e[78].set("task_creation_source",void 0),e[78].set("message_payload_source",d.i64.cast([0,2])),e[79]=d.createArray(),e[80]=(e[79].push(void 0),e[79]),a=[void 0,e[64],e[78],e[79]],e[65]=a[0],e[66]=a[1],e[67]=a[2],e[68]=a[3],a}])},function(a){return a=[e[65],e[66],e[67],e[68]],e[55]=a[0],e[56]=a[1],e[57]=a[2],e[58]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[70]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[71]=void 0:e[71]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[70],d.i64.cast([0,1e6])),e[9]),e[71]],e[59]=b[0],e[60]=b[1],e[61]=b[2],e[62]=b[3],e[63]=b[4],e[64]=b[5],e[65]=b[6],b):(f=c.item,e[70]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[71]=void 0:e[71]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[70],d.i64.cast([0,1e6])),e[9]),e[71]],e[59]=b[0],e[60]=b[1],e[61]=b[2],e[62]=b[3],e[63]=b[4],e[64]=b[5],e[65]=b[6],b)})},function(a){return e[67]=new d.Map(),e[67].set("task_id",e[59]),e[67].set("queue_name",e[60]),e[67].set("enqueue_timestamp_ms",e[61]),e[67].set("priority",e[62]),e[67].set("first_executed_timestamp_ms",e[63]),e[67].set("execution_time_ns",e[64]),e[67].set("echo_encoding_execution_time_ns",e[65]),e[68]=new d.Map(),e[68].set("task_metadata",e[67]),e[68].set("action_type",e[40]),e[68].set("content_type",e[41]),e[68].set("identifiers",void 0),e[68].set("identifiers_v2",e[35]),e[68].set("task_creation_source",void 0),e[68].set("message_payload_source",d.i64.cast([0,2])),e[69]=d.createArray(),e[70]=(e[69].push(void 0),e[69]),a=[void 0,e[54],e[68],e[69]],e[55]=a[0],e[56]=a[1],e[57]=a[2],e[58]=a[3],a}])},function(a){return a=[e[55],e[56],e[57],e[58]],e[36]=a[0],e[37]=a[1],e[38]=a[2],e[39]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[61]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[62]=void 0:e[62]=e[44],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[61],d.i64.cast([0,1e6])),e[9]),e[62]],e[49]=b[0],e[50]=b[1],e[51]=b[2],e[52]=b[3],e[53]=b[4],e[54]=b[5],e[55]=b[6],b):(f=c.item,e[61]=d.i64.of_float(Date.now()),d.i64.eq(e[44],d.i64.cast([0,0]))||d.i64.eq(e[44],void 0)?e[62]=void 0:e[62]=e[44],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[61],d.i64.cast([0,1e6])),e[9]),e[62]],e[49]=b[0],e[50]=b[1],e[51]=b[2],e[52]=b[3],e[53]=b[4],e[54]=b[5],e[55]=b[6],b)})},function(a){return e[57]=new d.Map(),e[57].set("task_id",e[49]),e[57].set("queue_name",e[50]),e[57].set("enqueue_timestamp_ms",e[51]),e[57].set("priority",e[52]),e[57].set("first_executed_timestamp_ms",e[53]),e[57].set("execution_time_ns",e[54]),e[57].set("echo_encoding_execution_time_ns",e[55]),e[58]=new d.Map(),e[58].set("task_metadata",e[57]),e[58].set("action_type",e[40]),e[58].set("content_type",e[41]),e[58].set("identifiers",void 0),e[58].set("identifiers_v2",e[35]),e[58].set("task_creation_source",void 0),e[58].set("message_payload_source",d.i64.cast([0,2])),e[59]=new d.Map(),e[59].set("error_code",e[48]),e[59].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[59].set("error_message",""),e[60]=d.createArray(),a=[void 0,e[59],e[58],e[60]],e[36]=a[0],e[37]=a[1],e[38]=a[2],e[39]=a[3],a}])},function(a){return a=[e[36],e[37],e[38],e[39]],e[30]=a[0],e[31]=a[1],e[32]=a[2],e[33]=a[3],a}]))})},function(a){return a=[e[30],e[31],e[32],e[33]],e[22]=a[0],e[23]=a[1],e[24]=a[2],e[25]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[42]=d.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[42],d.i64.cast([0,1e6])),e[9]),void 0],e[30]=b[0],e[31]=b[1],e[32]=b[2],e[33]=b[3],e[34]=b[4],e[35]=b[5],e[36]=b[6],b):(f=c.item,e[42]=d.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[42],d.i64.cast([0,1e6])),e[9]),void 0],e[30]=b[0],e[31]=b[1],e[32]=b[2],e[33]=b[3],e[34]=b[4],e[35]=b[5],e[36]=b[6],b)})},function(a){return e[38]=new d.Map(),e[38].set("task_id",e[30]),e[38].set("queue_name",e[31]),e[38].set("enqueue_timestamp_ms",e[32]),e[38].set("priority",e[33]),e[38].set("first_executed_timestamp_ms",e[34]),e[38].set("execution_time_ns",e[35]),e[38].set("echo_encoding_execution_time_ns",e[36]),e[39]=new d.Map(),e[39].set("task_metadata",e[38]),e[39].set("action_type",void 0),e[39].set("content_type",void 0),e[39].set("identifiers",void 0),e[39].set("identifiers_v2",void 0),e[39].set("task_creation_source",void 0),e[39].set("message_payload_source",d.i64.cast([0,2])),e[40]=new d.Map(),e[40].set("error_code",d.i64.cast([0,24])),e[40].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[40].set("error_message",""),e[41]=d.createArray(),a=[void 0,e[40],e[39],e[41]],e[22]=a[0],e[23]=a[1],e[24]=a[2],e[25]=a[3],a}])},function(a){return a=[e[22],e[23],e[24],e[25]],e[13]=a[0],e[14]=a[1],e[15]=a[2],e[16]=a[3],a}]))})},function(a){return a=[e[13],e[14],e[15],e[16]],e[2]=a[0],e[3]=a[1],e[4]=a[2],e[5]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(b,c){var f=b.done;b=b.value;return f?(e[25]=d.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[25],d.i64.cast([0,1e6])),e[9]),void 0],e[13]=f[0],e[14]=f[1],e[15]=f[2],e[16]=f[3],e[17]=f[4],e[18]=f[5],e[19]=f[6],f):(c=b.item,e[25]=d.i64.of_float(Date.now()),f=[a[0],c.queueName,c.enqueueTimestampMs,void 0,c.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[25],d.i64.cast([0,1e6])),e[9]),void 0],e[13]=f[0],e[14]=f[1],e[15]=f[2],e[16]=f[3],e[17]=f[4],e[18]=f[5],e[19]=f[6],f)})},function(a){return e[21]=new d.Map(),e[21].set("task_id",e[13]),e[21].set("queue_name",e[14]),e[21].set("enqueue_timestamp_ms",e[15]),e[21].set("priority",e[16]),e[21].set("first_executed_timestamp_ms",e[17]),e[21].set("execution_time_ns",e[18]),e[21].set("echo_encoding_execution_time_ns",e[19]),e[22]=new d.Map(),e[22].set("task_metadata",e[21]),e[22].set("action_type",void 0),e[22].set("content_type",void 0),e[22].set("identifiers",void 0),e[22].set("identifiers_v2",void 0),e[22].set("task_creation_source",void 0),e[22].set("message_payload_source",d.i64.cast([0,2])),e[23]=new d.Map(),e[23].set("error_code",d.i64.cast([0,4])),e[23].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[23].set("error_message",""),e[24]=d.createArray(),a=[void 0,e[23],e[22],e[24]],e[2]=a[0],e[3]=a[1],e[4]=a[2],e[5]=a[3],a}])},function(a){return e[6]=d.i64.of_float(Date.now()),e[7]=d.i64.random(),e[10]="Finishing execution. Execution time: ",e[11]=d.i64.to_string(d.i64.sub(e[6],e[0])),e[12]=" ms",e[8]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][serializeBackupPayloadV2] ",e[8],e[10],e[8],e[11],e[8],e[12]].join("")),d.i64.eq(d.i64.mod_(e[7],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[13]=",",e[14]=d.createArray(),void 0!==void 0?e[15]=(e[14].push(void 0),e[14]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"serializeBackupPayloadV2",[e[10],e[13],e[11],e[13],e[12]].join(""),e[14],d.i64.cast([0,4]))):d.resolve()},function(a){return a=[e[2],e[3],e[4],e[5]],f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],a}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure";d=a;g["default"]=d}),98);
__d("LSTaskSerializerEncryptedBackupsUpload",["LSArrayGetObjectAt","LSLogMebClientEvent.nop","LSSerializeBackupPayloadV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.forEach(c.db.table(177).fetch([[[a[0]]],"fk_pending_tasks"]),function(a){var b=a.update;a.item;return b({backupStatus:c.i64.cast([0,2])})})},function(e){return c.storedProcedure(b("LSSerializeBackupPayloadV2"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],d[5]=a[3],a})},function(a){return d[6]=c.i64.of_int32(d[5].length),c.i64.gt(d[6],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[5],c.i64.cast([0,0])).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(a){return d[7]=d[20]}]):c.resolve(d[7]=void 0)},function(a){return d[2]?d[8]=!1:d[8]=!0,d[8]?(d[3]?d[20]=!1:d[20]=!0,d[20]?(a=[void 0,void 0,d[7],d[4]],d[21]=a[0],d[22]=a[1],d[23]=a[2],d[24]=a[3],a):(a=[void 0,d[3],d[7],d[4]],d[21]=a[0],d[22]=a[1],d[23]=a[2],d[24]=a[3],a),a=[d[21],d[22],d[23],d[24]],d[9]=a[0],d[10]=a[1],d[11]=a[2],d[12]=a[3],a):(d[20]=d[2].get("payload"),d[2],a=[d[20],d[3],d[7],d[4]],d[9]=a[0],d[10]=a[1],d[11]=a[2],d[12]=a[3],a),d[20]=new c.Map(),d[21]=d[20].set("success",d[9]),d[22]=d[20].set("failure",d[10]),d[23]=d[20].set("protobuf_failure",d[11]),d[24]=d[20].set("context",d[12]),d[25]=c.toJSON(d[20]),d[13]=d[25],d[14]=c.i64.of_float(Date.now()),d[15]=c.i64.random(),d[17]="Finishing execution. Execution time: ",d[18]=c.i64.to_string(c.i64.sub(d[14],d[0])),d[19]=" ms",d[16]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsUpload] ",d[16],d[17],d[16],d[18],d[16],d[19]].join("")),c.i64.eq(c.i64.mod_(d[15],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[20]=",",d[21]=c.createArray(),void 0!==void 0?d[22]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUpload",[d[17],d[20],d[18],d[20],d[19]].join(""),d[21],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[13],c.i64.cast([0,50026])],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadStoredProcedure";e.exports=a}),null);
__d("LSLoadProtobufBackupSerializedPayloadData",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSEncryptIdentifiersV2","LSGetBlobFromString.nop","LSGetLatestEpochKeys","LSIsEncryptionVersionSecure","LSLoadAndEncryptProtobufV2","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadProtobufBackupSerializedPayloadData] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[19]=c.i64.mul(d[1],c.i64.cast([0,1e6])),c.db.table(2).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?(d[23]=c.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f):(e=b.item,d[23]=c.i64.of_float(Date.now()),f=[a[0],e.queueName,e.enqueueTimestampMs,e.priority,e.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[23],c.i64.cast([0,1e6])),d[19]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],f)})},function(e){return d[10]=new c.Map(),d[10].set("task_id",d[2]),d[10].set("queue_name",d[3]),d[10].set("enqueue_timestamp_ms",d[4]),d[10].set("priority",d[5]),d[10].set("first_executed_timestamp_ms",d[6]),d[10].set("execution_time_ns",d[7]),d[10].set("echo_encoding_execution_time_ns",d[8]),d[11]=new c.Map(),d[11].set("task_metadata",d[10]),d[11].set("action_type",void 0),d[11].set("content_type",void 0),d[11].set("identifiers",void 0),d[11].set("identifiers_v2",void 0),d[11].set("task_creation_source",void 0),d[11].set("message_payload_source",c.i64.cast([0,2])),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[23]=new c.Map(),d[23].set("error_code",c.i64.cast([0,1])),d[23].set("stored_procedure","LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure"),d[23].set("error_message",""),g=[void 0,d[23],d[11]],d[12]=g[0],d[13]=g[1],d[14]=g[2],g):(f=e.item,c.sequence([function(a){return d[32]=f.backupId,d[33]=f.mailboxRootKeyBlob,d[34]=f.deviceId,d[31]=f.backupTenancy,d[30]=f.encryptionVersion,d[23]=void 0,c.i64.neq(d[23],void 0)?c.resolve(d[24]=d[23]):c.sequence([function(a){return d[35]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[45]=(d[35].push(c.i64.cast([0,0])),d[35]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[45]=(d[35].push(c.i64.cast([0,2])),d[35]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[38]?d[45]=(d[35].push(c.i64.cast([0,3])),d[35]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[39]=a[0],a})},function(a){return d[39]?d[45]=(d[35].push(c.i64.cast([0,4])),d[35]):0,d[40]=c.createArray(),d[41]=c.i64.of_int32(d[35].length),c.i64.gt(d[41],c.i64.cast([0,0]))?c.loopAsync(d[41],function(a){return d[45]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[35],d[45]).then(function(a){return a=a,d[46]=a[0],d[47]=a[1],a})},function(a){return d[48]=(d[40].push(d[46]),d[40])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[45]=c.createArray(),d[46]=c.i64.of_int32(d[40].length),c.i64.gt(d[46],c.i64.cast([0,0]))?c.loopAsync(d[46],function(a){return d[48]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[40],d[48]).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=(d[45].push(c.i64.to_string(d[49])),d[45])}])}):c.resolve()},function(a){return d[47]=d[45].join(","),d[42]=d[47]}])},function(a){return d[40].some(function(a){return c.i64.eq(d[30],a)})?d[43]=d[30]:d[43]=void 0,c.i64.neq(d[43],void 0)?d[44]=d[43]:d[44]=void 0,d[24]=d[44]}])},function(e){return c.i64.neq(d[24],void 0)?d[25]=d[24]:d[25]=c.i64.cast([0,0]),c.i64.neq(d[31],void 0)?d[26]=d[31]:d[26]=c.i64.cast([0,1]),c.i64.neq(d[34],void 0)?c.sequence([function(e){return c.filter(c.db.table(305).fetch(),function(b){return c.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(h,i){var e=h.done;h=h.value;return e?(d[39]=new c.Map(),d[39].set("error_code",c.i64.cast([0,5])),d[39].set("stored_procedure","LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure"),d[39].set("error_message",""),e=[void 0,d[39],d[11]],d[35]=e[0],d[36]=e[1],d[37]=e[2],e):(i=h.item,c.sequence([function(b){return d[61]=i.actThreadId,d[62]=i.toplevelOfflineThreadingId,d[40]=i.messageTimestampMs,d[39]=new c.Map(),d[39].set("backup_id",c.i64.to_string(d[32])),d[39].set("act_thread_id",d[61]),d[39].set("server_thread_id",d[61]),d[39].set("timestamp",c.i64.to_string(d[40])),d[39].set("otid",d[62]),d[41]=new c.Map(),d[41].set("backup_id",c.i64.to_string(d[32])),d[41].set("act_thread_id",d[61]),d[41].set("timestamp",c.i64.to_string(d[40])),d[41].set("otid",d[62]),c.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var b=e.done;e=e.value;return b?(d[63]=c.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[63],c.i64.cast([0,1e6])),d[19]),void 0],d[42]=b[0],d[43]=b[1],d[44]=b[2],d[45]=b[3],d[46]=b[4],d[47]=b[5],d[48]=b[6],b):(f=e.item,d[63]=c.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,f.priority,f.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[63],c.i64.cast([0,1e6])),d[19]),void 0],d[42]=b[0],d[43]=b[1],d[44]=b[2],d[45]=b[3],d[46]=b[4],d[47]=b[5],d[48]=b[6],b)})},function(a){return d[50]=new c.Map(),d[50].set("task_id",d[42]),d[50].set("queue_name",d[43]),d[50].set("enqueue_timestamp_ms",d[44]),d[50].set("priority",d[45]),d[50].set("first_executed_timestamp_ms",d[46]),d[50].set("execution_time_ns",d[47]),d[50].set("echo_encoding_execution_time_ns",d[48]),d[51]=new c.Map(),d[51].set("task_metadata",d[50]),d[51].set("action_type",c.i64.cast([0,1])),d[51].set("content_type",c.i64.cast([0,1])),d[51].set("identifiers",void 0),d[51].set("identifiers_v2",d[41]),d[51].set("task_creation_source",void 0),d[51].set("message_payload_source",c.i64.cast([0,2])),d[52]=d[39].get("act_thread_id"),d[39],d[53]=d[39].get("otid"),d[39],c.storedProcedure(b("LSGetLatestEpochKeys"),!1).then(function(a){return a=a,d[54]=a[0],d[55]=a[1],a})},function(a){return d[54]!==void 0?c.sequence([function(a){return c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))?c.sequence([function(a){return d[66]=c.createArray(),d[71]=(d[66].push(c.i64.cast([0,32])),d[66]),c.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",d[52]].join("")).then(function(a){return a=a,d[67]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[67],void 0,d[33],d[66]).then(function(a){return a=a,d[68]=a[0],a})},function(a){return d[68]?d[69]=!1:d[69]=!0,d[69]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),d[71]=c.createArray(),void 0!==void 0?d[72]=(d[71].push(void 0),d[71]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",d[71],c.i64.cast([0,3]))},function(a){return d[70]=void 0}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[68],c.i64.cast([0,0])).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return d[70]=d[71]}])},function(a){return d[63]=d[70]}]):c.sequence([function(a){return c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,2]))?c.sequence([function(a){return d[67]=c.createArray(),d[72]=(d[67].push(c.i64.cast([0,32])),d[67]),c.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",d[53]].join("")).then(function(a){return a=a,d[68]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[68],void 0,d[33],d[67]).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[69]?d[70]=!1:d[70]=!0,d[70]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),d[72]=c.createArray(),void 0!==void 0?d[73]=(d[72].push(void 0),d[72]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",d[72],c.i64.cast([0,3]))},function(a){return d[71]=void 0}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[69],c.i64.cast([0,0])).then(function(a){return a=a,d[72]=a[0],d[73]=a[1],a})},function(a){return d[71]=d[72]}])},function(a){return d[66]=d[71]}]):c.resolve(d[66]=void 0)},function(a){return d[63]=d[66]}])},function(a){return c.blobs.neq(d[63],void 0)?c.sequence([function(a){return d[66]=d[54].get("epoch_keys"),d[54],d[67]=d[66].get("epoch_anon_id"),d[66],d[68]=d[66].get("epoch_root_key"),d[66],d[69]=c.createArray(),d[80]=(d[69].push(c.i64.cast([0,32])),d[69]),c.i64.ge(d[25],c.i64.cast([0,3]))?c.resolve(d[70]=void 0):c.sequence([function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[52]).then(function(a){return a=a,d[80]=a[0],a})},function(a){return d[70]=d[80]}])},function(a){return c.i64.ge(d[25],c.i64.cast([0,4]))?(d[80]="_",d[71]=["message_key_in_epoch",d[80],c.blobs.to_string(d[67]),d[80],"cipher_version",d[80],c.i64.to_string(d[25]),d[80],"thread",d[80],d[52]==null?"":d[52]].join("")):(c.i64.ge(d[25],c.i64.cast([0,3]))?(d[81]="_",d[80]=["message_key_in_epoch",d[81],c.blobs.to_string(d[67]),d[81],"cipher_version",d[81],c.i64.to_string(d[25]),d[81],"thread",d[81],d[52]==null?"":d[52]].join("")):(c.i64.ge(d[25],c.i64.cast([0,2]))?(d[82]="_",d[81]=["message_key_in_epoch",d[82],c.blobs.to_string(d[67]),d[82],"cipher_version",d[82],c.i64.to_string(d[25])].join("")):d[81]=["message_key_in_epoch","_",c.blobs.to_string(d[67])].join(""),d[80]=d[81]),d[71]=d[80]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[71]).then(function(a){return a=a,d[72]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[72],d[70],d[68],d[69]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return d[73]?d[74]=!1:d[74]=!0,d[74]?c.resolve(d[75]=void 0):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[73],c.i64.cast([0,0])).then(function(a){return a=a,d[80]=a[0],d[81]=a[1],a})},function(a){return d[75]=d[80]}])},function(a){return c.filter(c.db.table(169).fetch(),function(a){return c.blobs.eq(a.epochAnonIdBlob,c.blob("MA=="))}).next().then(function(e,f){var a=e.done;e=e.value;return a?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTableUtils] Failed to get mailbox_root_key_v2: epoch 0 is not available."),d[80]=c.createArray(),void 0!==void 0?d[81]=(d[80].push(void 0),d[80]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTableUtils","Failed to get mailbox_root_key_v2: epoch 0 is not available.",d[80],c.i64.cast([0,3]))},function(a){return d[76]=void 0}]):(f=e.item,c.sequence([function(a){return d[80]=c.createArray(),d[88]=(d[80].push(c.i64.cast([0,32])),d[80]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5zYWx0X21haWxib3hfcm9vdF9rZXlfdjI="),void 0,d[33],d[80]).then(function(a){return a=a,d[81]=a[0],a})},function(a){return d[81]!==void 0?c.sequence([function(a){return d[88]=c.i64.of_int32(d[81].length),c.i64.ge(d[88],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[81],c.i64.cast([0,0])).then(function(a){return a=a,d[90]=a[0],d[91]=a[1],a})},function(a){return d[89]=d[90]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[90]=c.createArray(),void 0!==void 0?d[91]=(d[90].push(void 0),d[90]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[90],c.i64.cast([0,3]))},function(a){return d[89]=void 0}])},function(a){return d[82]=d[89]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[88]=c.createArray(),void 0!==void 0?d[89]=(d[88].push(void 0),d[88]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[88],c.i64.cast([0,3]))},function(a){return d[82]=void 0}])},function(a){return c.blobs.neq(d[82],void 0)?d[83]=!0:d[83]=!1,d[83]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d[84]=c.createArray(),d[88]=(d[84].push(c.i64.cast([0,32])),d[84]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5tYWlsYm94X3Jvb3Rfa2V5X3Yy"),d[82],f.epochRootKeyBlob,d[84]).then(function(a){return a=a,d[85]=a[0],a})},function(a){return d[85]!==void 0?c.sequence([function(a){return d[88]=c.i64.of_int32(d[85].length),c.i64.ge(d[88],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[85],c.i64.cast([0,0])).then(function(a){return a=a,d[90]=a[0],d[91]=a[1],a})},function(a){return d[89]=d[90]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[90]=c.createArray(),void 0!==void 0?d[91]=(d[90].push(void 0),d[90]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[90],c.i64.cast([0,3]))},function(a){return d[89]=void 0}])},function(a){return d[86]=d[89]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[88]=c.createArray(),void 0!==void 0?d[89]=(d[88].push(void 0),d[88]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[88],c.i64.cast([0,3]))},function(a){return d[86]=void 0}])},function(a){return c.blobs.neq(d[86],void 0)?d[87]=!0:d[87]=!1,d[87]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d[76]=d[86]}]))})},function(a){return c.blobs.neq(d[75],void 0)?c.sequence([function(a){return c.blobs.neq(d[76],void 0)?c.sequence([function(a){return d[86]=c.createArray(),d[90]=(d[86].push(c.i64.cast([0,32])),d[86]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5mYWxsYmFja19rZXk="),void 0,d[76],d[86]).then(function(a){return a=a,d[87]=a[0],a})},function(a){return d[87]!==void 0?c.sequence([function(a){return d[90]=c.i64.of_int32(d[87].length),c.i64.ge(d[90],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[87],c.i64.cast([0,0])).then(function(a){return a=a,d[92]=a[0],d[93]=a[1],a})},function(a){return d[91]=d[92]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[92]=c.createArray(),void 0!==void 0?d[93]=(d[92].push(void 0),d[92]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[92],c.i64.cast([0,3]))},function(a){return d[91]=void 0}])},function(a){return d[88]=d[91]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[90]=c.createArray(),void 0!==void 0?d[91]=(d[90].push(void 0),d[90]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[90],c.i64.cast([0,3]))},function(a){return d[88]=void 0}])},function(a){return c.blobs.neq(d[88],void 0)?d[89]=!0:d[89]=!1,d[89]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d[80]=d[88]}]):c.resolve(d[80]=void 0)},function(a){return d[81]=d[66].get("epoch_root_key"),d[66],d[82]=d[66].get("epoch_anon_id"),d[66],d[83]=d[66].get("epoch_id"),d[66],d[84]=new c.Map(),d[84].set("payload_key",d[75]),d[84].set("payload_fallback_key",d[80]),d[84].set("encryption_version",d[25]),d[84].set("epoch_root_key",d[81]),d[84].set("epoch_anon_id",d[82]),d[84].set("epoch_id",d[83]),d[85]=new c.Map(),d[85].set("ope_key",d[63]),d[85].set("message_payload_encryption_keys",d[84]),d[85].set("ocmf_shared_key",f.ocmfClientStateBlob),d[85].set("mailbox_base_salt",d[33]),d[85].set("mailbox_root_key_v2",d[76]),a=[d[85],void 0],d[78]=a[0],d[79]=a[1],a}]):c.resolve((d[80]=new c.Map(),d[80].set("error_code",c.i64.cast([0,26])),d[80].set("stored_procedure","MEBKeyDeriver"),d[80].set("error_message",""),a=[void 0,d[80]],d[78]=a[0],d[79]=a[1],a))},function(a){return a=[d[78],d[79]],d[64]=a[0],d[65]=a[1],a}]):c.resolve((d[66]=new c.Map(),d[66].set("error_code",c.i64.cast([0,25])),d[66].set("stored_procedure","MEBKeyDeriver"),d[66].set("error_message",""),a=[void 0,d[66]],d[64]=a[0],d[65]=a[1],a))},function(a){return a=[d[64],d[65]],d[56]=a[0],d[57]=a[1],a}]):c.resolve((a=[void 0,d[55]],d[56]=a[0],d[57]=a[1],a))},function(e){return d[56]!==void 0?c.sequence([function(a){return d[63]=d[39].get("backup_id"),d[39],d[64]=d[39].get("act_thread_id"),d[39],d[65]=d[39].get("timestamp"),d[39],d[66]=d[39].get("otid"),d[39],c.storedProcedure(b("LSEncryptIdentifiersV2"),c.i64.cast([0,1]),c.i64.cast([0,1]),d[63],d[64],c.i64.from_string(d[65]),d[66],d[56]).then(function(a){return a=a,d[67]=a[0],d[68]=a[1],a})},function(a){return d[69]=d[56].get("message_payload_encryption_keys"),d[56],d[70]=d[69].get("encryption_version"),d[69],d[71]=d[69].get("epoch_anon_id"),d[69],d[72]=d[69].get("epoch_root_key"),d[69],d[73]=d[39].get("act_thread_id"),d[39],d[74]=d[69].get("payload_key"),d[69],d[75]=d[39].get("backup_id"),d[39],d[76]=c.createArray(),d[106]=(d[76].push(c.i64.cast([0,6])),d[76]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[77]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[77],void 0,d[71],d[76]).then(function(a){return a=a,d[78]=a[0],a})},function(a){return d[78]?d[79]=!1:d[79]=!0,d[79]?c.resolve(d[80]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[78],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[80]=d[108]==null?"":d[108]}])},function(a){return d[81]=c.createArray(),d[106]=(d[81].push(c.i64.cast([0,6])),d[81]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[82]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[82],void 0,d[72],d[81]).then(function(a){return a=a,d[83]=a[0],a})},function(a){return d[83]?d[84]=!1:d[84]=!0,d[84]?c.resolve(d[85]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[83],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[85]=d[108]==null?"":d[108]}])},function(a){return d[86]=c.createArray(),d[106]=(d[86].push(c.i64.cast([0,6])),d[86]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[87]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[87],void 0,d[74],d[86]).then(function(a){return a=a,d[88]=a[0],a})},function(a){return d[88]?d[89]=!1:d[89]=!0,d[89]?c.resolve(d[90]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[88],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[90]=d[108]==null?"":d[108]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[72]).then(function(a){return a=a,d[91]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[91]==null?"":d[91],d[73]].join("")).then(function(a){return a=a,d[92]=a[0],a})},function(a){return d[93]=c.createArray(),d[106]=(d[93].push(c.i64.cast([0,6])),d[93]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[94]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[94],void 0,d[92],d[93]).then(function(a){return a=a,d[95]=a[0],a})},function(a){return d[95]?d[96]=!1:d[96]=!0,d[96]?c.resolve(d[97]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[95],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[106]).then(function(a){return a=a,d[108]=a[0],a})},function(a){return d[97]=d[108]==null?"":d[108]}])},function(a){return d[98]=":",c.blobs.neq(d[72],void 0)?c.sequence([function(a){return d[106]=c.createArray(),d[112]=(d[106].push(c.i64.cast([0,18])),d[106]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[72],d[106]).then(function(a){return a=a,d[107]=a[0],a})},function(a){return d[107]!==void 0?c.sequence([function(a){return d[112]=c.i64.of_int32(d[107].length),c.i64.ge(d[112],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[107],c.i64.cast([0,0])).then(function(a){return a=a,d[114]=a[0],d[115]=a[1],a})},function(a){return d[113]=d[114]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[114]=c.createArray(),void 0!==void 0?d[115]=(d[114].push(void 0),d[114]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[114],c.i64.cast([0,3]))},function(a){return d[113]=void 0}])},function(a){return d[108]=d[113]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[112]=c.createArray(),void 0!==void 0?d[113]=(d[112].push(void 0),d[112]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[112],c.i64.cast([0,3]))},function(a){return d[108]=void 0}])},function(a){return c.blobs.neq(d[108],void 0)?d[109]=!0:d[109]=!1,d[109]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[108]).then(function(a){return a=a,d[110]=a[0],a})},function(a){return d[110]!==void 0?d[111]=d[110]:d[111]="encodingfailed",d[99]=d[111]}]):c.resolve(d[99]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[71]).then(function(a){return a=a,d[100]=a[0],a})},function(e){return d[101]=new c.Map(),d[101].set("encryption_version",d[70]),d[101].set("epoch_anon_id",d[100]==null?"":d[100]),d[101].set("message_encryption_values",[d[80],d[98],d[85],d[98],d[90],d[98],d[97]].join("")),d[101].set("root_key_fingerprint",d[99]),d[101].set("backup_id",d[75]),d[102]=c.toJSON(d[101]),d[67]!==void 0?c.sequence([function(e){return d[106]=d[39].get("act_thread_id"),d[39],c.storedProcedure(b("LSLoadAndEncryptProtobufV2"),a[0],d[56],d[106]).then(function(a){return a=a,d[107]=a[0],d[108]=a[1],a})},function(a){return d[107]!==void 0?(d[112]=new c.Map(),d[112].set("protobuf_backup_payload",d[107]),d[112].set("encrypted_identifiers",d[67]),d[112].set("device_id",d[34]),d[112].set("identifiers",d[39]),d[112].set("encryption_keys",d[56]),d[112].set("content_type",c.i64.cast([0,1])),d[112].set("action_type",c.i64.cast([0,1])),d[112].set("value_secret_ref",d[102]),d[112].set("attachment_backup_payload",i.attachmentPayload),d[112].set("extra_data_for_eb_upload",void 0),a=[d[112],void 0,d[51]],d[109]=a[0],d[110]=a[1],d[111]=a[2],a):(a=[void 0,d[108],d[51]],d[109]=a[0],d[110]=a[1],d[111]=a[2],a),a=[d[109],d[110],d[111]],d[103]=a[0],d[104]=a[1],d[105]=a[2],a}]):c.resolve((e=[void 0,d[68],d[51]],d[103]=e[0],d[104]=e[1],d[105]=e[2],e))},function(a){return a=[d[103],d[104],d[105]],d[58]=a[0],d[59]=a[1],d[60]=a[2],a}]):c.resolve((e=[void 0,d[57],d[51]],d[58]=e[0],d[59]=e[1],d[60]=e[2],e))},function(a){return a=[d[58],d[59],d[60]],d[35]=a[0],d[36]=a[1],d[37]=a[2],a}]))})},function(a){return a=[d[35],d[36],d[37]],d[27]=a[0],d[28]=a[1],d[29]=a[2],a}]):c.resolve((d[35]=new c.Map(),d[35].set("error_code",c.i64.cast([0,24])),d[35].set("stored_procedure","LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure"),d[35].set("error_message",""),e=[void 0,d[35],d[11]],d[27]=e[0],d[28]=e[1],d[29]=e[2],e))},function(a){return a=[d[27],d[28],d[29]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return d[16]=c.i64.of_float(Date.now()),d[17]=c.i64.random(),d[20]="Finishing execution. Execution time: ",d[21]=c.i64.to_string(c.i64.sub(d[16],d[0])),d[22]=" ms",d[18]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadProtobufBackupSerializedPayloadData] ",d[18],d[20],d[18],d[21],d[18],d[22]].join("")),c.i64.eq(c.i64.mod_(d[17],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[23]=",",d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadProtobufBackupSerializedPayloadData",[d[20],d[23],d[21],d[23],d[22]].join(""),d[24],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[12],d[13],d[14]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadProtobufBackupSerializedPayloadDataStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsUploadProtobufOnly",["LSArrayGetObjectAt","LSBase64Encode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSLoadProtobufBackupSerializedPayloadData","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsUploadProtobufOnly] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSLoadProtobufBackupSerializedPayloadData"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],a})},function(a){return d[2]!==void 0?c.sequence([function(a){return d[15]=d[2].get("encrypted_identifiers"),d[2],d[16]=d[2].get("identifiers"),d[2],d[17]=d[2].get("encryption_keys"),d[2],d[18]=d[2].get("protobuf_backup_payload"),d[2],d[19]=d[15].get("act_thread_id_ocmf_partial"),d[15],d[20]=d[15].get("otid_ocmf_partial"),d[15],d[21]=d[15].get("timestamp_encrypted"),d[15],d[22]=new c.Map(),d[22].set("list_key",d[19]),d[22].set("unique_key",d[20]),d[22].set("sort_key",d[21]),d[23]=d[2].get("value_secret_ref"),d[2],d[24]=new c.Map(),d[24].set("value",""),d[24].set("value_secret_ref",d[23]),d[25]=d[2].get("action_type"),d[2],d[26]=new c.Map(),d[26].set("list_item_id",d[22]),d[26].set("list_item",d[24]),d[26].set("action_type",d[25]),d[27]=d[16].get("server_thread_id"),d[16],d[28]=d[16].get("timestamp"),d[16],d[29]=d[16].get("otid"),d[16],d[30]=d[16].get("act_thread_id"),d[16],d[31]=new c.Map(),d[31].set("server_thread_key",d[27]),d[31].set("timestamp",d[28]),d[31].set("otid",d[29]),d[31].set("wa_thread_id",c.i64.from_string(d[30])),d[32]=d[17].get("mailbox_base_salt"),d[17],c.nativeOperation(b("LSBase64Encode.nop"),d[32]).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[34]=d[17].get("ocmf_shared_key"),d[17],c.nativeOperation(b("LSBase64Encode.nop"),d[34]).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[36]=new c.Map(),d[36].set("mailbox_root_key",d[33]==null?"":d[33]),d[36].set("ocmf_client_state_blob",d[35]==null?"":d[35]),d[37]=d[2].get("extra_data_for_eb_upload"),d[2],d[37]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[37]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return d[53]=new c.Map(),d[60]="ttd",d[54]=d[52].get(d[60]),d[52],d[54]?d[55]=!1:d[55]=!0,d[55]?c.resolve():c.sequence([function(a){return d[54]?d[62]=!1:d[62]=!0,d[62]?c.resolve(d[63]=void 0):c.sequence([function(a){return d[64]=new c.Map(),d[67]="message_tags",d[65]=d[54].get(d[67]),d[54],d[65]?d[66]=!1:d[66]=!0,d[66]?c.resolve():c.sequence([function(a){return d[68]=c.createArray(),d[69]=c.i64.of_int32(d[65].length),c.i64.gt(d[69],c.i64.cast([0,0]))?c.loopAsync(d[69],function(a){return d[70]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[65],d[70]).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return d[73]=(d[68].push(d[71]),d[68])}])}):c.resolve()},function(a){return d[64].set(d[67],d[68])}])},function(a){return d[63]=d[64]}])},function(a){return d[53].set(d[60],d[63])}])},function(a){return d[61]="mt",d[56]=d[52].get(d[61]),d[52],d[56]?d[57]=!1:d[57]=!0,d[57]?c.resolve():c.sequence([function(a){return d[56]?d[62]=!1:d[62]=!0,d[62]?c.resolve(d[63]=void 0):c.sequence([function(a){return d[64]=new c.Map(),d[67]="message_tags",d[65]=d[56].get(d[67]),d[56],d[65]?d[66]=!1:d[66]=!0,d[66]?c.resolve():c.sequence([function(a){return d[68]=c.createArray(),d[69]=c.i64.of_int32(d[65].length),c.i64.gt(d[69],c.i64.cast([0,0]))?c.loopAsync(d[69],function(a){return d[70]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[65],d[70]).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return d[73]=(d[68].push(d[71]),d[68])}])}):c.resolve()},function(a){return d[64].set(d[67],d[68])}])},function(a){return d[63]=d[64]}])},function(a){return d[53].set(d[61],d[63])}])},function(a){return d[58]=d[53].get("mt"),d[53],d[58]!==void 0?(d[62]=new c.Map(),d[66]="message_tags",d[63]=d[58].get(d[66]),d[58],d[63]?d[64]=!1:d[64]=!0,d[64]?0:d[62].set(d[66],d[63]),d[65]=c.toJSON(d[62]),d[59]=d[65]):d[59]=void 0,d[38]=d[59]}]):c.resolve(d[38]=void 0)},function(a){return d[39]=d[15].get("backup_id_ocmf_partial"),d[15],d[40]=d[2].get("device_id"),d[2],d[41]=d[17].get("message_payload_encryption_keys"),d[17],d[42]=d[41].get("epoch_id"),d[41],d[43]=d[17].get("message_payload_encryption_keys"),d[17],d[44]=d[43].get("encryption_version"),d[43],d[45]=d[2].get("content_type"),d[2],d[46]=new c.Map(),d[46].set("mailbox_partial_id",d[39]),d[46].set("action",d[26]),d[46].set("device_id",d[40]),d[46].set("echo_version",c.i64.cast([0,0])),d[46].set("epoch_id",d[42]),d[46].set("trace_id",void 0),d[46].set("encryption_version",d[44]),d[46].set("is_thread",c.i64.eq(d[45],c.i64.cast([0,2]))),d[46].set("raw_identifiers",d[31]),d[46].set("raw_tokens",d[36]),d[46].set("request_id",""),d[46].set("is_instamadillo",!0),d[47]=d[18].get("supplemental_data_encrypted"),d[18],d[47]!==void 0?c.sequence([function(a){return d[52]=d[18].get("protobuf_encrypted"),d[18],d[53]=d[18].get("backup_action"),d[18],d[54]=d[18].get("timestamp_ms"),d[18],d[55]=d[47].get("sk_ciphertext"),d[47],c.nativeOperation(b("LSBase64Encode.nop"),d[55]).then(function(a){return a=a,d[56]=a[0],a})},function(a){return d[57]=d[47].get("sk_hash"),d[47],c.nativeOperation(b("LSBase64Encode.nop"),d[57]).then(function(a){return a=a,d[58]=a[0],a})},function(a){return d[59]=new c.Map(),d[59].set("supplementary_data_key",void 0),d[59].set("encrypted_protobuf",d[52]),d[59].set("key_value_backup_action",d[53]),d[59].set("protobuf_ts_ms",d[54]),d[59].set("supplemental_key_ciphertext",d[56]),d[59].set("supplemental_key_hash",d[58]),d[59].set("message_tags",d[38]),d[48]=d[59]}]):c.resolve((d[52]=d[18].get("protobuf_encrypted"),d[18],d[53]=d[18].get("backup_action"),d[18],d[54]=d[18].get("timestamp_ms"),d[18],d[55]=new c.Map(),d[55].set("supplementary_data_key",void 0),d[55].set("encrypted_protobuf",d[52]),d[55].set("key_value_backup_action",d[53]),d[55].set("protobuf_ts_ms",d[54]),d[55].set("message_tags",d[38]),d[48]=d[55]))},function(a){return d[46].set("key_value_backup_payload",d[48]),d[49]=d[2].get("attachment_backup_payload"),d[2],d[49]!==void 0?d[46].set("attachment_backup_payload",d[49]):0,d[50]=d[2].get("extra_data_for_eb_upload"),d[2],d[50]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[50]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return d[53]=new c.Map(),d[59]="ttd",d[54]=d[52].get(d[59]),d[52],d[54]?d[55]=!1:d[55]=!0,d[55]?c.resolve():c.sequence([function(a){return d[54]?d[61]=!1:d[61]=!0,d[61]?c.resolve(d[62]=void 0):c.sequence([function(a){return d[63]=new c.Map(),d[66]="message_tags",d[64]=d[54].get(d[66]),d[54],d[64]?d[65]=!1:d[65]=!0,d[65]?c.resolve():c.sequence([function(a){return d[67]=c.createArray(),d[68]=c.i64.of_int32(d[64].length),c.i64.gt(d[68],c.i64.cast([0,0]))?c.loopAsync(d[68],function(a){return d[69]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[64],d[69]).then(function(a){return a=a,d[70]=a[0],d[71]=a[1],a})},function(a){return d[72]=(d[67].push(d[70]),d[67])}])}):c.resolve()},function(a){return d[63].set(d[66],d[67])}])},function(a){return d[62]=d[63]}])},function(a){return d[53].set(d[59],d[62])}])},function(a){return d[60]="mt",d[56]=d[52].get(d[60]),d[52],d[56]?d[57]=!1:d[57]=!0,d[57]?c.resolve():c.sequence([function(a){return d[56]?d[61]=!1:d[61]=!0,d[61]?c.resolve(d[62]=void 0):c.sequence([function(a){return d[63]=new c.Map(),d[66]="message_tags",d[64]=d[56].get(d[66]),d[56],d[64]?d[65]=!1:d[65]=!0,d[65]?c.resolve():c.sequence([function(a){return d[67]=c.createArray(),d[68]=c.i64.of_int32(d[64].length),c.i64.gt(d[68],c.i64.cast([0,0]))?c.loopAsync(d[68],function(a){return d[69]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[64],d[69]).then(function(a){return a=a,d[70]=a[0],d[71]=a[1],a})},function(a){return d[72]=(d[67].push(d[70]),d[67])}])}):c.resolve()},function(a){return d[63].set(d[66],d[67])}])},function(a){return d[62]=d[63]}])},function(a){return d[53].set(d[60],d[62])}])},function(a){return d[58]=d[53].get("ttd"),d[53],d[58]!==void 0?(d[61]=new c.Map(),d[65]="message_tags",d[62]=d[58].get(d[65]),d[58],d[62]?d[63]=!1:d[63]=!0,d[63]?0:d[61].set(d[65],d[62]),d[64]=c.toJSON(d[61]),d[46].set("tags_to_delete",d[64])):0}]):c.resolve()},function(a){return d[51]=c.toJSON(d[46]),a=[d[51],void 0,d[4]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a}]):c.resolve((d[3]?d[15]=!1:d[15]=!0,d[15]?(a=[void 0,void 0,d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a):(a=[void 0,d[3],d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a),a=[d[16],d[17],d[18]],d[5]=a[0],d[6]=a[1],d[7]=a[2],a))},function(a){return d[15]=new c.Map(),d[16]=d[15].set("success",d[5]),d[17]=d[15].set("failure",d[6]),d[18]=d[15].set("context",d[7]),d[19]=c.toJSON(d[15]),d[8]=d[19],d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsUploadProtobufOnly] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUploadProtobufOnly",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[8],c.i64.cast([0,50042]),void 0],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadProtobufOnlyStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("TaskSerializerMuteThreadV2: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?(c[9]=b.createArray(),c[10]=(c[9].push("TaskSerializerMuteThreadV2: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),a=[void 0,void 0,void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a):(e=d.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("mailbox_type",b.i64.cast([0,0])),c[11].set("mute_expire_time_ms",e.muteExpireTimeMs),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,144]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerMuteThreadV2StoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerRemoveThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("TaskSerializerRemoveThreadV2: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,c[7]=e.removeType,b.i64.neq(c[7],void 0)?(c[8]=new b.Map(),c[8].set("thread_key",e.threadKey),c[8].set("remove_type",c[7]),c[8].set("sync_group",e.syncGroup==null?b.i64.cast([0,1]):e.syncGroup),c[9]=b.toJSON(c[8]),f=[c[9],b.i64.cast([0,146]),void 0],c[4]=f[0],c[5]=f[1],c[6]=f[2],f):(d=[void 0,void 0,void 0],c[4]=d[0],c[5]=d[1],c[6]=d[2],d),e=[c[4],c[5],c[6]],c[0]=e[0],c[1]=e[1],c[2]=e[2],e)})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerRemoveThreadStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerSendMessageV2",["LSSymmetricEncryptionCreateEncryptedString.nop","gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,b=a[a.length-1],d=[],e=[];return b.sequence([function(f){return b.sequence([function(e){return b.db.table(31).fetch([[[a[0]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[4]=b.createArray(),d[5]=(d[4].push("task ID not found"),d[4]),d[6]=(d[4].push(a[0]),d[4]),d[7]=b.toJSON(d[4]),function(a){b.logger(a).mustfix(a)}(d[7]),g=[void 0,void 0,void 0],d[0]=g[0],d[1]=g[1],d[2]=g[2],g):(f=e.item,b.sequence([function(e){return d[11]=f.offlineThreadingId,d[12]=f.messageId,d[21]=f.threadAttributionSource,d[9]=f.platformRef,d[10]=f.platformToken,d[8]=f.replySourceId,d[13]=f.replySourceType,d[20]=f.sendType,d[22]=f.markThreadRead,d[14]=f.initiatingSource,d[15]=f.skipUrlPreviewGen,d[17]=f.textHasLinks,d[18]=f.dataclassParams,d[19]=f.multitabEnv,d[16]=f.richTextFormatType,b.db.table(12).fetch([[[d[11]]],"optimistic"]).next().then(function(f,g){var e=f.done;f=f.value;return e?(d[23]=b.createArray(),d[24]=(d[23].push("OTID not found"),d[23]),d[25]=(d[23].push(d[11]),d[23]),d[26]=b.toJSON(d[23]),function(a){b.logger(a).mustfix(a)}(d[26]),e=[void 0,void 0,void 0],d[4]=e[0],d[5]=e[1],d[6]=e[2],e):(g=f.item,b.sequence([function(e){return d[30]=g.text,d[27]=g.threadKey,d[31]=g.messageId,d[39]=g.senderId,d[29]=g.stickerId,d[33]=g.mentionOffsets,d[34]=g.mentionLengths,d[28]=g.mentionIds,d[35]=g.mentionTypes,d[38]=g.replyType,d[36]=g.isForwarded,d[32]=g.forwardScore,d[37]=g.hotEmojiSize,b.db.table(9).fetch([[[d[27]]]]).next().then(function(f,h){var e=f.done;f=f.value;return e?(d[40]=b.createArray(),d[41]=(d[40].push("thread not found"),d[40]),d[42]=(d[40].push(d[27]),d[40]),d[43]=b.toJSON(d[40]),function(a){b.logger(a).mustfix(a)}(d[43]),e=[void 0,void 0,void 0],d[23]=e[0],d[24]=e[1],d[25]=e[2],e):(h=f.item,b.sequence([function(c){return d[47]=h.threadName,d[46]=h.threadKey,d[48]=h.mailboxType,d[40]=h.threadType,d[49]=h.capabilities,d[50]=h.capabilities2,d[51]=h.capabilities3,d[52]=h.capabilities4,b.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var c=e.done;e=e.value;return c?d[41]=!1:(f=e.item,b.sequence([function(c){return b.islc(b.db.table(2).fetch([[[f.queueName]],"queueNameTaskId"]),0,b.i64.to_float(b.i64.cast([0,1]))).next().then(function(e,f){var c=e.done;e=e.value;return c?d[53]=!1:(f=e.item,d[53]=b.i64.eq(f.taskId,a[0]))})},function(a){return d[41]=d[53]}]))})},function(a){return b.i64.eq(h.authorityLevel,b.i64.cast([0,20]))&&(b.i64.eq(d[40],b.i64.cast([0,2]))||b.i64.eq(d[40],b.i64.cast([0,5]))||b.i64.eq(d[40],b.i64.cast([0,26])))&&d[41]?b.sequence([function(a){return d[56]=d[20]==null?b.i64.cast([0,1]):d[20],b.db.table(9).fetch([[[d[27]]]]).next().then(function(c,e){var a=c.done;c=c.value;return a?d[53]=b.i64.cast([0,1]):(e=c.item,d[71]=e.syncGroup,b.i64.neq(d[71],void 0)?d[70]=d[71]:d[70]=b.i64.cast([0,1]),d[53]=d[70])})},function(a){return d[55]=new b.Map(),d[55].set("thread_id",d[27]),d[55].set("otid",d[11]),d[55].set("source",d[21]==null?b.i64.cast([0,0]):d[21]),d[55].set("send_type",b.i64.cast([0,1])),d[55].set("sync_group",d[53]),d[55].set("mark_thread_read",d[22]),b.i64.eq(d[56],b.i64.cast([0,1]))?b.resolve(d[55].set("text",d[30])):b.i64.eq(d[56],b.i64.cast([0,2]))?b.resolve(b.i64.neq(d[29],void 0)?(d[55].set("sticker_id",d[29]),d[55].set("send_type",d[56])):0):b.i64.eq(d[56],b.i64.cast([0,7]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[70]=a[0],d[71]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[70]=a[0],d[71]=a[1],a)})},function(a){return d[70]!==void 0?b.i64.neq(d[71],void 0)?(d[55].set("url",d[70]),d[55].set("attribution_app_id",d[71]),d[55].set("send_type",d[56])):0:0}]):b.i64.eq(d[56],b.i64.cast([0,3]))?b.sequence([function(a){return d[55].set("text",d[30]),d[70]=b.createArray(),d[71]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[72]=a.offlineAttachmentId,d[73]=(d[70].push(b.i64.from_string(a.attachmentFbid)),d[70]),d[72]!==void 0?d[73]=(d[71].push(d[72]),d[71]):0})},function(a){return d[55].set("attachment_fbids",d[70]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[71]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,9]))?b.sequence([function(a){return d[55].set("text",d[30]),d[70]=b.createArray(),d[71]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[72]=a.offlineAttachmentId,d[73]=(d[70].push(b.i64.from_string(a.attachmentFbid)),d[70]),d[72]!==void 0?d[73]=(d[71].push(d[72]),d[71]):0})},function(a){return d[55].set("attachment_fbids",d[70]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[71]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,10]))?b.sequence([function(a){return d[55].set("text",d[30]),d[70]=b.createArray(),d[71]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[72]=a.offlineAttachmentId,d[73]=(d[70].push(b.i64.from_string(a.attachmentFbid)),d[70]),d[72]!==void 0?d[73]=(d[71].push(d[72]),d[71]):0})},function(a){return d[55].set("attachment_fbids",d[70]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[71]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,4]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[70]=void 0:(c=b.item,d[70]=c.attachmentFbid)})},function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[72]=void 0:(c=b.item,d[72]=c.actionUrl)})},function(a){return d[70]!==void 0?(d[55].set("text",d[30]),d[72]!==void 0?d[55].set("url",d[72]):0,d[55].set("forwarded_share_id",d[70]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,5]))?b.resolve(d[12]!==void 0?(d[55].set("forwarded_msg_id",d[12]),d[55].set("send_type",d[56]),b.i64.neq(d[32],void 0)?d[55].set("forward_score",d[32]):0,d[55].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(d[56],b.i64.cast([0,6]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[70]=a[0],d[71]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[70]=a[0],d[71]=a[1],a)})},function(a){return d[70]!==void 0?(d[55].set("url",d[70]),d[55].set("text",d[30]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,11]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[70]=a[0],d[71]=a[1],a):(c=b.item,a=[c.actionUrl,c.attributionAppId],d[70]=a[0],d[71]=a[1],a)})},function(a){return d[70]!==void 0?(d[55].set("url",d[70]),c("gkx")("3272")?d[55].set("text",d[30]):0,d[55].set("send_type",d[56])):0}]):b.resolve(0)},function(a){return d[66]=d[8]===""?void 0:d[8],d[66]!==void 0?b.i64.neq(d[13],void 0)?(d[70]=new b.Map(),d[70].set("reply_source_id",d[66]),d[70].set("reply_source_type",d[13]),d[70].set("reply_type",d[38]==null?b.i64.cast([0,0]):d[38]),d[70].set("reply_source_attachment_id",void 0),d[55].set("reply_metadata",d[70])):0:0,d[67]=d[28]===""?void 0:d[28],d[67]!==void 0?(d[70]=d[33]===""?void 0:d[33],d[70]!==void 0?(d[71]=d[34]===""?void 0:d[34],d[71]!==void 0?(d[72]=new b.Map(),d[72].set("mention_ids",d[67]),d[72].set("mention_offsets",d[70]),d[72].set("mention_lengths",d[71]),d[72].set("mention_types",d[35]===""?void 0:d[35]),d[55].set("mention_data",d[72])):0):0):0,d[36]!==void 0?d[55].set("is_forwarded",d[36]):0,d[68]=d[9]===""?void 0:d[9],d[68]!==void 0?d[55].set("platform_ref",d[68]):0,d[69]=d[10]===""?void 0:d[10],d[69]!==void 0?d[55].set("platform_token",d[69]):0,[b.i64.cast([0,1]),b.i64.cast([0,2])].some(function(a){return b.i64.eq(d[56],a)})?b.i64.neq(d[37],void 0)?d[55].set("hot_emoji_size",d[37]):0:0,b.i64.neq(d[14],void 0)?d[55].set("initiating_source",d[14]):0,d[15]!==void 0?d[55].set("skip_url_preview_gen",d[15]):0,b.i64.neq(d[16],void 0)?d[55].set("rich_text_format_type",d[16]):0,b.resolve()},function(a){return d[17]!==void 0?d[55].set("text_has_links",d[17]):0,d[18]!==void 0?d[55].set("dataclass_params",d[18]):0,d[19]!==void 0?d[55].set("multitab_env",d[19]):0,b.filter(b.db.table(14).fetch([[[d[46],d[39]]]]),function(a){return b.i64.eq(a.threadKey,d[46])&&b.i64.eq(b.i64.cast([0,0]),d[48])&&b.i64.eq(a.contactId,d[39])}).next().then(function(c,e){var a=c.done;c=c.value;return a?d[57]=!1:(e=c.item,b.i64.eq(d[40],b.i64.cast([0,152]))?(d[71]=e.threadRoles,b.i64.lt(b.i64.cast([0,7]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,7]),b.i64.cast([0,7]))?d[72]=!1:d[72]=!b.i64.eq(b.i64.and_(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.cast([0,7]))),d[71]),b.i64.cast([0,0])),d[73]=d[49],d[74]=d[50],d[75]=d[51],d[76]=d[52],d[78]=b.i64.div(b.i64.cast([0,223]),b.i64.cast([0,64])),d[79]=b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.sub(b.i64.cast([0,223]),b.i64.mul(d[78],b.i64.cast([0,64]))))),b.i64.lt(b.i64.cast([0,223]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,223]),b.i64.cast([0,252]))?d[77]=!1:(b.i64.eq(d[78],b.i64.cast([0,0]))?d[80]=!b.i64.eq(b.i64.and_(d[79],d[73]),b.i64.cast([0,0])):(b.i64.eq(d[78],b.i64.cast([0,1]))?d[81]=!b.i64.eq(b.i64.and_(d[79],d[74]),b.i64.cast([0,0])):(b.i64.eq(d[78],b.i64.cast([0,2]))?d[82]=!b.i64.eq(b.i64.and_(d[79],d[75]),b.i64.cast([0,0])):(b.i64.eq(d[78],b.i64.cast([0,3]))?d[83]=!b.i64.eq(b.i64.and_(d[79],d[76]),b.i64.cast([0,0])):d[83]=!1,d[82]=d[83]),d[81]=d[82]),d[80]=d[81]),d[77]=d[80]),d[72]===d[77]?0:(function(a){b.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),b["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),d[70]=d[72]):d[70]=!1,d[57]=d[70])})},function(a){return d[57]?d[55].set("perform_action_as_page",!0):0,d[59]=b.createArray(),b.forEach(b.db.table(14).fetch([[[d[27]]]]),function(a){a=a.item;return d[70]=(d[59].push(a.contactId),d[59])})},function(a){return d[60]=new b.Map(),d[60].set("participants",d[59]),d[60].set("send_payload",d[55]),d[47]!==void 0?d[60].set("thread_name",d[47]):0,b.db.table(312).fetch([[[d[27]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[61]=void 0:(c=b.item,d[61]=c.metadata)})},function(a){return d[60].set("thread_metadata",d[61]),b.forEach(b.db.table(9).fetch([[[d[46]]]]),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:g.offlineThreadingId})})},function(a){return d[61]===void 0||!1?(b.i64.eq(d[40],b.i64.cast([0,5]))||b.i64.eq(d[40],b.i64.cast([0,26]))?(function(a){b.logger(a).mustfix(a)}("For Marketplace & community chat subthreads, thread metadata cannot be null"),a=[void 0,void 0,void 0],d[70]=a[0],d[71]=a[1],d[72]=a[2],a):(d[73]=b.toJSON(d[60]),a=[d[73],b.i64.cast([0,130]),void 0],d[70]=a[0],d[71]=a[1],d[72]=a[2],a),a=[d[70],d[71],d[72]],d[63]=a[0],d[64]=a[1],d[65]=a[2],a):(b.i64.eq(d[40],b.i64.cast([0,5]))?(d[73]=b.toJSON(d[60]),a=[d[73],b.i64.cast([0,645]),void 0],d[70]=a[0],d[71]=a[1],d[72]=a[2],a):(b.i64.eq(d[40],b.i64.cast([0,26]))?(d[76]=b.toJSON(d[60]),a=[d[76],b.i64.cast([0,696]),void 0],d[73]=a[0],d[74]=a[1],d[75]=a[2],a):(b.i64.eq(d[40],b.i64.cast([0,2]))?(d[79]=b.toJSON(d[60]),a=[d[79],b.i64.cast([0,787]),void 0],d[76]=a[0],d[77]=a[1],d[78]=a[2],a):(d[79]=b.toJSON(d[60]),a=[d[79],b.i64.cast([0,645]),void 0],d[76]=a[0],d[77]=a[1],d[78]=a[2],a),a=[d[76],d[77],d[78]],d[73]=a[0],d[74]=a[1],d[75]=a[2],a),a=[d[73],d[74],d[75]],d[70]=a[0],d[71]=a[1],d[72]=a[2],a),a=[d[70],d[71],d[72]],d[63]=a[0],d[64]=a[1],d[65]=a[2],a),a=[d[63],d[64],d[65]],d[43]=a[0],d[44]=a[1],d[45]=a[2],a}]):b.sequence([function(a){return d[56]=d[20]==null?b.i64.cast([0,1]):d[20],b.db.table(9).fetch([[[d[27]]]]).next().then(function(c,e){var a=c.done;c=c.value;return a?d[53]=b.i64.cast([0,1]):(e=c.item,d[65]=e.syncGroup,b.i64.neq(d[65],void 0)?d[64]=d[65]:d[64]=b.i64.cast([0,1]),d[53]=d[64])})},function(a){return d[55]=new b.Map(),d[55].set("thread_id",d[27]),d[55].set("otid",d[11]),d[55].set("source",d[21]==null?b.i64.cast([0,0]):d[21]),d[55].set("send_type",b.i64.cast([0,1])),d[55].set("sync_group",d[53]),d[55].set("mark_thread_read",d[22]),b.i64.eq(d[56],b.i64.cast([0,1]))?b.resolve(d[55].set("text",d[30])):b.i64.eq(d[56],b.i64.cast([0,2]))?b.resolve(b.i64.neq(d[29],void 0)?(d[55].set("sticker_id",d[29]),d[55].set("send_type",d[56])):0):b.i64.eq(d[56],b.i64.cast([0,7]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[64]=a[0],d[65]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[64]=a[0],d[65]=a[1],a)})},function(a){return d[64]!==void 0?b.i64.neq(d[65],void 0)?(d[55].set("url",d[64]),d[55].set("attribution_app_id",d[65]),d[55].set("send_type",d[56])):0:0}]):b.i64.eq(d[56],b.i64.cast([0,3]))?b.sequence([function(a){return d[55].set("text",d[30]),d[64]=b.createArray(),d[65]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[66]=a.offlineAttachmentId,d[67]=(d[64].push(b.i64.from_string(a.attachmentFbid)),d[64]),d[66]!==void 0?d[67]=(d[65].push(d[66]),d[65]):0})},function(a){return d[55].set("attachment_fbids",d[64]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[65]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,9]))?b.sequence([function(a){return d[55].set("text",d[30]),d[64]=b.createArray(),d[65]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[66]=a.offlineAttachmentId,d[67]=(d[64].push(b.i64.from_string(a.attachmentFbid)),d[64]),d[66]!==void 0?d[67]=(d[65].push(d[66]),d[65]):0})},function(a){return d[55].set("attachment_fbids",d[64]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[65]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,10]))?b.sequence([function(a){return d[55].set("text",d[30]),d[64]=b.createArray(),d[65]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[d[27],d[31]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return d[66]=a.offlineAttachmentId,d[67]=(d[64].push(b.i64.from_string(a.attachmentFbid)),d[64]),d[66]!==void 0?d[67]=(d[65].push(d[66]),d[65]):0})},function(a){return d[55].set("attachment_fbids",d[64]),b.i64.eq(d[56],b.i64.cast([0,9]))?d[55].set("offline_attachment_ids",d[65]):0,d[55].set("send_type",d[56])}]):b.i64.eq(d[56],b.i64.cast([0,4]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[64]=void 0:(c=b.item,d[64]=c.attachmentFbid)})},function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?d[66]=void 0:(c=b.item,d[66]=c.actionUrl)})},function(a){return d[64]!==void 0?(d[55].set("text",d[30]),d[66]!==void 0?d[55].set("url",d[66]):0,d[55].set("forwarded_share_id",d[64]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,5]))?b.resolve(d[12]!==void 0?(d[55].set("forwarded_msg_id",d[12]),d[55].set("send_type",d[56]),b.i64.neq(d[32],void 0)?d[55].set("forward_score",d[32]):0,d[55].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(d[56],b.i64.cast([0,6]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[64]=a[0],d[65]=a[1],a):(c=b.item,a=[c.filename,c.attributionAppId],d[64]=a[0],d[65]=a[1],a)})},function(a){return d[64]!==void 0?(d[55].set("url",d[64]),d[55].set("text",d[30]),d[55].set("send_type",d[56])):0}]):b.i64.eq(d[56],b.i64.cast([0,11]))?b.sequence([function(a){return b.db.table(16).fetch([[[d[27],d[31]]]]).next().then(function(b,c){var a=b.done;b=b.value;return a?(a=[void 0,void 0],d[64]=a[0],d[65]=a[1],a):(c=b.item,a=[c.actionUrl,c.attributionAppId],d[64]=a[0],d[65]=a[1],a)})},function(a){return d[64]!==void 0?(d[55].set("url",d[64]),c("gkx")("3272")?d[55].set("text",d[30]):0,d[55].set("send_type",d[56])):0}]):b.resolve(0)},function(a){return d[60]=d[8]===""?void 0:d[8],d[60]!==void 0?b.i64.neq(d[13],void 0)?(d[64]=new b.Map(),d[64].set("reply_source_id",d[60]),d[64].set("reply_source_type",d[13]),d[64].set("reply_type",d[38]==null?b.i64.cast([0,0]):d[38]),d[64].set("reply_source_attachment_id",void 0),d[55].set("reply_metadata",d[64])):0:0,d[61]=d[28]===""?void 0:d[28],d[61]!==void 0?(d[64]=d[33]===""?void 0:d[33],d[64]!==void 0?(d[65]=d[34]===""?void 0:d[34],d[65]!==void 0?(d[66]=new b.Map(),d[66].set("mention_ids",d[61]),d[66].set("mention_offsets",d[64]),d[66].set("mention_lengths",d[65]),d[66].set("mention_types",d[35]===""?void 0:d[35]),d[55].set("mention_data",d[66])):0):0):0,d[36]!==void 0?d[55].set("is_forwarded",d[36]):0,d[62]=d[9]===""?void 0:d[9],d[62]!==void 0?d[55].set("platform_ref",d[62]):0,d[63]=d[10]===""?void 0:d[10],d[63]!==void 0?d[55].set("platform_token",d[63]):0,[b.i64.cast([0,1]),b.i64.cast([0,2])].some(function(a){return b.i64.eq(d[56],a)})?b.i64.neq(d[37],void 0)?d[55].set("hot_emoji_size",d[37]):0:0,b.i64.neq(d[14],void 0)?d[55].set("initiating_source",d[14]):0,d[15]!==void 0?d[55].set("skip_url_preview_gen",d[15]):0,b.i64.neq(d[16],void 0)?d[55].set("rich_text_format_type",d[16]):0,b.resolve()},function(a){return d[17]!==void 0?d[55].set("text_has_links",d[17]):0,d[18]!==void 0?d[55].set("dataclass_params",d[18]):0,d[19]!==void 0?d[55].set("multitab_env",d[19]):0,b.filter(b.db.table(14).fetch([[[d[46],d[39]]]]),function(a){return b.i64.eq(a.threadKey,d[46])&&b.i64.eq(b.i64.cast([0,0]),d[48])&&b.i64.eq(a.contactId,d[39])}).next().then(function(c,e){var a=c.done;c=c.value;return a?d[57]=!1:(e=c.item,b.i64.eq(d[40],b.i64.cast([0,152]))?(d[65]=e.threadRoles,b.i64.lt(b.i64.cast([0,7]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,7]),b.i64.cast([0,7]))?d[66]=!1:d[66]=!b.i64.eq(b.i64.and_(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.cast([0,7]))),d[65]),b.i64.cast([0,0])),d[67]=d[49],d[68]=d[50],d[69]=d[51],d[70]=d[52],d[72]=b.i64.div(b.i64.cast([0,223]),b.i64.cast([0,64])),d[73]=b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.sub(b.i64.cast([0,223]),b.i64.mul(d[72],b.i64.cast([0,64]))))),b.i64.lt(b.i64.cast([0,223]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,223]),b.i64.cast([0,252]))?d[71]=!1:(b.i64.eq(d[72],b.i64.cast([0,0]))?d[74]=!b.i64.eq(b.i64.and_(d[73],d[67]),b.i64.cast([0,0])):(b.i64.eq(d[72],b.i64.cast([0,1]))?d[75]=!b.i64.eq(b.i64.and_(d[73],d[68]),b.i64.cast([0,0])):(b.i64.eq(d[72],b.i64.cast([0,2]))?d[76]=!b.i64.eq(b.i64.and_(d[73],d[69]),b.i64.cast([0,0])):(b.i64.eq(d[72],b.i64.cast([0,3]))?d[77]=!b.i64.eq(b.i64.and_(d[73],d[70]),b.i64.cast([0,0])):d[77]=!1,d[76]=d[77]),d[75]=d[76]),d[74]=d[75]),d[71]=d[74]),d[66]===d[71]?0:(function(a){b.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),b["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),d[64]=d[66]):d[64]=!1,d[57]=d[64])})},function(a){return d[57]?d[55].set("perform_action_as_page",!0):0,d[59]=b.toJSON(d[55]),a=[d[59],b.i64.cast([0,46]),void 0],d[43]=a[0],d[44]=a[1],d[45]=a[2],a}])},function(a){return a=[d[43],d[44],d[45]],d[23]=a[0],d[24]=a[1],d[25]=a[2],a}]))})},function(a){return a=[d[23],d[24],d[25]],d[4]=a[0],d[5]=a[1],d[6]=a[2],a}]))})},function(a){return a=[d[4],d[5],d[6]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}]))})},function(a){return a=[d[0],d[1]],e[0]=a[0],e[1]=a[1],a}])},function(a){return b.resolve(e)}])}a.__sproc_name__="LSMailboxTaskSerializerSendMessageV2StoredProcedure";b=a;g["default"]=b}),98);
__d("LSTaskSerializerSyncThreadCapabilities",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,void 0,void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],a,c.resolve(d)}a.__sproc_name__="LSMailboxTaskSerializerSyncThreadCapabilitiesStoredProcedure";e.exports=a}),null);
__d("LSIsExperimentCapabilityEnabled.nop",["LSACSExperimentCapability","LSIntEnum","MetaConfig","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("MetaConfig")._("87"),k=c("MetaConfig")._("156");a=function(a,e,f,g){switch((i||(i=d("LSIntEnum"))).toNumber(f)){case c("LSACSExperimentCapability").BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:return(h||(h=b("Promise"))).resolve([k]);case c("LSACSExperimentCapability").INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:return(h||(h=b("Promise"))).resolve([!1]);case c("LSACSExperimentCapability").RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:return(h||(h=b("Promise"))).resolve([j])}return(h||(h=b("Promise"))).resolve([!1])};g["default"]=a}),98);
__d("LSMailboxTaskCompletionApiOnTaskCompletion",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(233).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({success:a[1]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSCoreMailboxTaskCompletionApiOnTaskCompletionStoredProcedure";e.exports=a}),null);
__d("LSVoprfHmac.nop",["ACSCipherSuiteModule","ACSTokenHmacUtil","Promise","XPlatReactTextEncoder","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f){a=d("ACSCipherSuiteModule").getACSCipherSuiteByValue(d("ACSCipherSuiteModule").VOPRF_RISTRETTO_HMACSHA512.value);if(!a)return(h||(h=b("Promise"))).resolve([void 0]);c=(yield d("ACSTokenHmacUtil").hmac(a.macAlgorithm,new Uint8Array(f).slice(),new(d("XPlatReactTextEncoder").TextEncoder)().encode(e)));return(h||(h=b("Promise"))).resolve([c.buffer])});function c(b,c,d,e){return a.apply(this,arguments)}return c}();g["default"]=a}),98);
__d("LSTaskSerializerUnauthenticatedTask",["LSArrayGetObjectAt","LSBase64Encode.nop","LSIsExperimentCapabilityEnabled.nop","LSMailboxTaskCompletionApiOnTaskCompletion","LSRemoveUsedTokens","LSVoprfHmac.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return c.db.table(311).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=void 0:(b=a.item,d[0]=b.projectName)})},function(e){return d[0]!==void 0?c.sequence([function(e){return a[1]!==void 0?c.sequence([function(a){return d[9]=c.createArray(),d[10]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(307).fetch(),function(a){return d[0]===a.projectName&&c.i64.gt(a.expirationTimestampMs,d[10])}),function(a){a=a.item;return d[16]=(d[9].push(a.configId),d[9])})},function(a){return c.sequence([function(a){return d[16]=c.createArray(),d[17]=c.i64.of_int32(d[9].length),c.i64.gt(d[17],c.i64.cast([0,0]))?c.loopAsync(d[17],function(a){return d[19]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[9],d[19]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(a){return d[22]=(d[16].push(d[20]),d[16])}])}):c.resolve()},function(a){return d[18]=d[16].join(","),d[11]=d[18]}])},function(e){return c.filter(c.db.table(309).fetch(),function(a){return d[9].includes(a.configId)&&c.i64.gt(a.redeemLimit,c.i64.cast([0,0]))}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(a){return c.nativeOperation(b("LSIsExperimentCapabilityEnabled.nop"),c.i64.cast([0,0]),d[0]).then(function(a){return a=a,d[16]=a[0],a})},function(e){return d[16]?c.sequence([function(b){return c.db.table(311).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[20]=c.i64.cast([0,0]):(e=b.item,d[20]=e.failureCount)})},function(b){return c.forEach(c.db.table(311).fetch([[[a[0]]]]),function(a){a=a.item;return c.forEach(c.db.table(311).fetch([[[a.taskId]]]),function(a){var b=a.update;a.item;return b({failureCount:c.i64.add(d[20],c.i64.cast([0,1]))})})})},function(a){return a=[void 0,void 0,c.i64.mul(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.mod_(d[20],c.i64.cast([0,7])))),c.i64.cast([0,500]))],d[17]=a[0],d[18]=a[1],d[19]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[20]=c.createArray(),d[21]=(d[20].push("Unauthenticated Task Serializer: no valid tokens"),d[20]),d[22]=(d[20].push(a[0]),d[20]),d[23]=(d[20].push(d[0]),d[20]),d[24]=c.toJSON(d[20]),function(a){c.logger(a).mustfix(a)}(d[24]),b=[void 0,void 0,void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2],b}])},function(a){return a=[d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]):(f=e.item,c.sequence([function(e){return d[20]=f.tokenId,c.nativeOperation(b("LSVoprfHmac.nop"),a[2]==null?"":a[2],f.sharedSecret).then(function(a){return a=a,d[16]=a[0],a})},function(e){return c.blobs.neq(d[16],void 0)?c.sequence([function(a){return c.forEach(c.db.table(309).fetch([[[d[20]]]]),function(a){var b=a.update;a=a.item;return b({redeemLimit:c.i64.sub(a.redeemLimit,c.i64.cast([0,1]))})})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[16]).then(function(a){return a=a,d[21]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),f.nonce).then(function(a){return a=a,d[22]=a[0],a})},function(b){return d[23]=new c.Map(),d[23].set("config_id",f.configId),d[23].set("tag",d[21]==null?"":d[21]),d[23].set("aux",d[22]==null?"":d[22]),d[23].set("project_name",d[0]),d[24]=c.toJSON(d[23]),d[25]=new c.Map(),d[25].set("payload",a[2]==null?"":a[2]),d[25].set("token",d[24]),d[26]=c.toJSON(d[25]),b=[d[26],c.i64.from_string(a[1]),void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2],b}]):c.sequence([function(a){return c.forEach(c.db.table(309).fetch([[[d[20]]]]),function(a){return a["delete"]()})},function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[21]=c.createArray(),d[22]=(d[21].push("Unauthenticated Task Serializer: hmac failed"),d[21]),d[23]=(d[21].push(a[0]),d[21]),d[24]=c.toJSON(d[21]),function(a){c.logger(a).mustfix(a)}(d[24]),b=[void 0,void 0,void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2],b}])},function(a){return a=[d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return a=[d[12],d[13],d[14]],d[6]=a[0],d[7]=a[1],d[8]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[9]=c.createArray(),d[10]=(d[9].push("Unauthenticated Task Serializer: task has no write label"),d[9]),d[11]=(d[9].push(a[0]),d[9]),d[12]=c.toJSON(d[9]),function(a){c.logger(a).mustfix(a)}(d[12]),b=[void 0,void 0,void 0],d[6]=b[0],d[7]=b[1],d[8]=b[2],b}])},function(a){return a=[d[6],d[7],d[8]],d[2]=a[0],d[3]=a[1],d[4]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[6]=c.createArray(),d[7]=(d[6].push("Unauthenticated Task Serializer: anonymous_task_context row not found"),d[6]),d[8]=(d[6].push(a[0]),d[6]),d[9]=c.toJSON(d[6]),function(a){c.logger(a).mustfix(a)}(d[9]),b=[void 0,void 0,void 0],d[2]=b[0],d[3]=b[1],d[4]=b[2],b}])},function(a){return c.storedProcedure(b("LSRemoveUsedTokens"))},function(a){return d[0]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSIsExperimentCapabilityEnabled.nop"),c.i64.cast([0,1]),d[0]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[6]?c.sequence([function(a){return c.i64.neq(d[4],void 0)?c.resolve(d[8]=!0):c.sequence([function(a){return d[10]=c.createArray(),d[11]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(307).fetch(),function(a){return d[0]===a.projectName&&c.i64.gt(a.expirationTimestampMs,d[11])}),function(a){a=a.item;return d[15]=(d[10].push(a.configId),d[10])})},function(a){return c.sequence([function(a){return d[15]=c.createArray(),d[16]=c.i64.of_int32(d[10].length),c.i64.gt(d[16],c.i64.cast([0,0]))?c.loopAsync(d[16],function(a){return d[18]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[10],d[18]).then(function(a){return a=a,d[19]=a[0],d[20]=a[1],a})},function(a){return d[21]=(d[15].push(d[19]),d[15])}])}):c.resolve()},function(a){return d[17]=d[15].join(","),d[12]=d[17]}])},function(a){return c.filter(c.db.table(309).fetch(),function(a){return d[10].includes(a.configId)&&c.i64.gt(a.redeemLimit,c.i64.cast([0,0]))}).next().then(function(a,b){b=a.done;a=a.value;return b?d[13]=!0:(a.item,d[13]=!1)})},function(a){return d[8]=d[13]}])},function(a){return d[8]?c.sequence([function(a){return c.filter(c.db.table(310).fetch(),function(a){return a.projectName===d[0]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[10]=void 0:(b=a.item,d[10]=b.taskId)})},function(a){return d[9]=d[10]}]):c.resolve(d[9]=void 0)},function(a){return d[7]=d[9]}]):c.resolve(d[7]=void 0)},function(a){return d[5]=d[7]}]):c.resolve(d[5]=void 0)},function(a){return a=[d[2],d[3],d[4],d[5]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsTaskSerializerUnauthenticatedTaskStoredProcedure";e.exports=a}),null);
__d("LSTaskSerializerUpdateThreadName",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("taskSerializerUpdateThreadName: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2],f):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?(c[9]=b.createArray(),c[10]=(c[9].push("taskSerializerUpdateThreadName: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),a=[void 0,void 0,void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a):(e=d.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("thread_name",e.threadName==null?"":e.threadName),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,32]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2],a}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerUpdateThreadNameStoredProcedure";e.exports=a}),null);
__d("LSSerializeTask",["LSForceTaskExecutionImmediately","LSTaskSerializerAcsIssueNextSync","LSTaskSerializerDeleteChatHistory","LSTaskSerializerE2eeMessageIntegrityCheckV2","LSTaskSerializerE2eeMetadataThreadIntegrityCheck","LSTaskSerializerEncryptedBackupAction","LSTaskSerializerEncryptedBackupsLoopingUpload","LSTaskSerializerEncryptedBackupsOpenUpload","LSTaskSerializerEncryptedBackupsRestoreWithSerializer","LSTaskSerializerEncryptedBackupsUpload","LSTaskSerializerEncryptedBackupsUploadProtobufOnly","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2","LSTaskSerializerSyncThreadCapabilities","LSTaskSerializerUnauthenticatedTask","LSTaskSerializerUpdateThreadName"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return a[1]==="46"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerSendMessageV2"),a[0]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return a=[d[8],c.i64.to_string(d[9]),void 0,void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}]):c.sequence([function(e){return a[1]==="144"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerMuteThreadV2"),a[0]).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(a){return a=[d[12],c.i64.to_string(d[13]),void 0,void 0],d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a}]):c.sequence([function(e){return a[1]==="146"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerRemoveThread"),a[0]).then(function(a){return a=a,d[16]=a[0],d[17]=a[1],a})},function(a){return a=[d[16],c.i64.to_string(d[17]),void 0,void 0],d[12]=a[0],d[13]=a[1],d[14]=a[2],d[15]=a[3],a}]):c.sequence([function(e){return a[1]==="32"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerUpdateThreadName"),a[0]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],d[22]=a[2],a})},function(a){return a=[d[20],c.i64.to_string(d[21]),void 0,void 0],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a}]):c.sequence([function(e){return a[1]==="362"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerAcsIssueNextSync"),a[0]).then(function(a){return a=a,d[24]=a[0],d[25]=a[1],d[26]=a[2],a})},function(a){return a=[d[24],c.i64.to_string(d[25]),void 0,void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2],d[23]=a[3],a}]):c.sequence([function(e){return a[1]==="50015"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsRestoreWithSerializer"),a[0]).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],d[30]=a[2],a})},function(a){return a=[d[28],c.i64.to_string(d[29]),void 0,void 0],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],a}]):c.sequence([function(e){return a[1]==="319"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupAction"),a[0]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],d[34]=a[2],a})},function(a){return a=[d[32],c.i64.to_string(d[33]),void 0,void 0],d[28]=a[0],d[29]=a[1],d[30]=a[2],d[31]=a[3],a}]):c.sequence([function(e){return a[1]==="50026"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsUpload"),a[0]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(a){return a=[d[36],c.i64.to_string(d[37]),void 0,void 0],d[32]=a[0],d[33]=a[1],d[34]=a[2],d[35]=a[3],a}]):c.sequence([function(e){return a[1]==="50042"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsUploadProtobufOnly"),a[0]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],d[42]=a[2],a})},function(a){return a=[d[40],c.i64.to_string(d[41]),void 0,void 0],d[36]=a[0],d[37]=a[1],d[38]=a[2],d[39]=a[3],a}]):c.sequence([function(e){return a[1]==="700"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerE2eeMetadataThreadIntegrityCheck"),a[0]).then(function(a){return a=a,d[44]=a[0],d[45]=a[1],d[46]=a[2],a})},function(a){return a=[d[44],c.i64.to_string(d[45]),void 0,void 0],d[40]=a[0],d[41]=a[1],d[42]=a[2],d[43]=a[3],a}]):c.sequence([function(e){return a[1]==="705"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerE2eeMessageIntegrityCheckV2"),a[0]).then(function(a){return a=a,d[48]=a[0],d[49]=a[1],d[50]=a[2],a})},function(a){return a=[d[48],c.i64.to_string(d[49]),void 0,void 0],d[44]=a[0],d[45]=a[1],d[46]=a[2],d[47]=a[3],a}]):c.sequence([function(e){return a[1]==="50043"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsLoopingUpload"),a[0]).then(function(a){return a=a,d[52]=a[0],d[53]=a[1],d[54]=a[2],a})},function(a){return a=[d[52],c.i64.to_string(d[53]),void 0,void 0],d[48]=a[0],d[49]=a[1],d[50]=a[2],d[51]=a[3],a}]):c.sequence([function(e){return a[1]==="50048"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsOpenUpload"),a[0]).then(function(a){return a=a,d[56]=a[0],d[57]=a[1],a})},function(a){return a=[d[56],c.i64.to_string(d[57]),void 0,void 0],d[52]=a[0],d[53]=a[1],d[54]=a[2],d[55]=a[3],a}]):c.sequence([function(e){return a[1]==="160013"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerSyncThreadCapabilities"),a[0]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],d[62]=a[2],a})},function(a){return a=[d[60],c.i64.to_string(d[61]),void 0,void 0],d[56]=a[0],d[57]=a[1],d[58]=a[2],d[59]=a[3],a}]):c.sequence([function(e){return a[1]==="903"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerDeleteChatHistory"),a[0]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],d[66]=a[2],a})},function(a){return a=[d[64],c.i64.to_string(d[65]),void 0,void 0],d[60]=a[0],d[61]=a[1],d[62]=a[2],d[63]=a[3],a}]):c.resolve((e=[a[2],a[1],void 0,void 0],d[60]=e[0],d[61]=e[1],d[62]=e[2],d[63]=e[3],e))},function(a){return a=[d[60],d[61],d[62],d[63]],d[56]=a[0],d[57]=a[1],d[58]=a[2],d[59]=a[3],a}])},function(a){return a=[d[56],d[57],d[58],d[59]],d[52]=a[0],d[53]=a[1],d[54]=a[2],d[55]=a[3],a}])},function(a){return a=[d[52],d[53],d[54],d[55]],d[48]=a[0],d[49]=a[1],d[50]=a[2],d[51]=a[3],a}])},function(a){return a=[d[48],d[49],d[50],d[51]],d[44]=a[0],d[45]=a[1],d[46]=a[2],d[47]=a[3],a}])},function(a){return a=[d[44],d[45],d[46],d[47]],d[40]=a[0],d[41]=a[1],d[42]=a[2],d[43]=a[3],a}])},function(a){return a=[d[40],d[41],d[42],d[43]],d[36]=a[0],d[37]=a[1],d[38]=a[2],d[39]=a[3],a}])},function(a){return a=[d[36],d[37],d[38],d[39]],d[32]=a[0],d[33]=a[1],d[34]=a[2],d[35]=a[3],a}])},function(a){return a=[d[32],d[33],d[34],d[35]],d[28]=a[0],d[29]=a[1],d[30]=a[2],d[31]=a[3],a}])},function(a){return a=[d[28],d[29],d[30],d[31]],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],a}])},function(a){return a=[d[24],d[25],d[26],d[27]],d[20]=a[0],d[21]=a[1],d[22]=a[2],d[23]=a[3],a}])},function(a){return a=[d[20],d[21],d[22],d[23]],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a}])},function(a){return a=[d[16],d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],d[15]=a[3],a}])},function(a){return a=[d[12],d[13],d[14],d[15]],d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a}])},function(a){return a=[d[8],d[9],d[10],d[11]],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}])},function(e){return a[3]?c.resolve((d[1]==="60009"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60009"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[8]=e[0],d[9]=e[1],d[10]=e[2],d[11]=e[3],e):(d[1]==="60006"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60006"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[12]=e[0],d[13]=e[1],d[14]=e[2],d[15]=e[3],e):(d[1]==="60008"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60008"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[16]=e[0],d[17]=e[1],d[18]=e[2],d[19]=e[3],e):(d[1]==="60011"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","60011"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[20]=e[0],d[21]=e[1],d[22]=e[2],d[23]=e[3],e):(d[1]==="765"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","765"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[24]=e[0],d[25]=e[1],d[26]=e[2],d[27]=e[3],e):(d[1]==="1006"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","1006"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[28]=e[0],d[29]=e[1],d[30]=e[2],d[31]=e[3],e):(d[1]==="160009"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","160009"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[32]=e[0],d[33]=e[1],d[34]=e[2],d[35]=e[3],e):(d[1]==="761"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","761"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[36]=e[0],d[37]=e[1],d[38]=e[2],d[39]=e[3],e):(d[1]==="1018"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","1018"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[40]=e[0],d[41]=e[1],d[42]=e[2],d[43]=e[3],e):(d[1]==="632"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","632"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[44]=e[0],d[45]=e[1],d[46]=e[2],d[47]=e[3],e):(d[1]==="384"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","384"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[48]=e[0],d[49]=e[1],d[50]=e[2],d[51]=e[3],e):(d[1]==="384"?(function(a){c.logger(a).mustfix(a)}(["Deidentified task with label ","384"," is being executed through the 'identified' path. This should never happen!"].join("")),e=[void 0,void 0,void 0,void 0],d[52]=e[0],d[53]=e[1],d[54]=e[2],d[55]=e[3],e):(e=[d[0],d[1],d[2],d[3]],d[52]=e[0],d[53]=e[1],d[54]=e[2],d[55]=e[3],e),e=[d[52],d[53],d[54],d[55]],d[48]=e[0],d[49]=e[1],d[50]=e[2],d[51]=e[3],e),e=[d[48],d[49],d[50],d[51]],d[44]=e[0],d[45]=e[1],d[46]=e[2],d[47]=e[3],e),e=[d[44],d[45],d[46],d[47]],d[40]=e[0],d[41]=e[1],d[42]=e[2],d[43]=e[3],e),e=[d[40],d[41],d[42],d[43]],d[36]=e[0],d[37]=e[1],d[38]=e[2],d[39]=e[3],e),e=[d[36],d[37],d[38],d[39]],d[32]=e[0],d[33]=e[1],d[34]=e[2],d[35]=e[3],e),e=[d[32],d[33],d[34],d[35]],d[28]=e[0],d[29]=e[1],d[30]=e[2],d[31]=e[3],e),e=[d[28],d[29],d[30],d[31]],d[24]=e[0],d[25]=e[1],d[26]=e[2],d[27]=e[3],e),e=[d[24],d[25],d[26],d[27]],d[20]=e[0],d[21]=e[1],d[22]=e[2],d[23]=e[3],e),e=[d[20],d[21],d[22],d[23]],d[16]=e[0],d[17]=e[1],d[18]=e[2],d[19]=e[3],e),e=[d[16],d[17],d[18],d[19]],d[12]=e[0],d[13]=e[1],d[14]=e[2],d[15]=e[3],e),e=[d[12],d[13],d[14],d[15]],d[8]=e[0],d[9]=e[1],d[10]=e[2],d[11]=e[3],e),e=[d[8],d[9],d[10],d[11]],d[4]=e[0],d[5]=e[1],d[6]=e[2],d[7]=e[3],e)):c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerUnauthenticatedTask"),a[0],d[1],d[0]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a})},function(a){return c.i64.neq(d[11],void 0)?c.storedProcedure(b("LSForceTaskExecutionImmediately"),d[11]):c.resolve()},function(a){return a=[d[8],c.i64.to_string(d[9]),void 0,d[10]],d[4]=a[0],d[5]=a[1],d[6]=a[2],d[7]=a[3],a}])},function(a){return a=[d[4],d[5],d[6],d[7]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSCoreSerializeTaskStoredProcedure";e.exports=a}),null);
__d("LSSerializeTaskStoredProcedure",["LSSerializeTask","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSSerializeTask")(b.taskId,b.taskLabel,b.taskValue,b.requiresAuthentication,a)}g["default"]=a}),98);
__d("LSBeginHandlingPendingTasksForQueue2",["I64","LSFactory","LSIntEnum","LSPendingTasksPluginType","LSSerializeTaskStoredProcedure","LSShape","LSVec","Promise","ReQL","XPlatReactCrypto","asyncToGeneratorRuntime","gkx","isNativeTask"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=500,l=3e4,m=5,n=50,o=7;function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield a.lightspeed_task_context.get(b));return a==null||a.requiresAuthentication});return q.apply(this,arguments)}function r(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b)));return a==null?{context:void 0,failureCount:(i||(i=d("I64"))).neg_one,httpUrlOverride:void 0,minTimeToSyncTimestampMs:i.neg_one,pluginType:(j||(j=d("LSIntEnum"))).ofNumber(c("LSPendingTasksPluginType").LS_BROKER),queueName:""}:a});return s.apply(this,arguments)}function t(a,b){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange(b)));return a==null?0:(i||(i=d("I64"))).to_float(a.lastSyncRequestTimestampMs)});return u.apply(this,arguments)}function v(a,b,c){b=(i||(i=d("I64"))).equal(a.failureCount,(i||(i=d("I64"))).zero)||b;if(b)return 0;b=(i||(i=d("I64"))).to_float(a.failureCount)>o?(i||(i=d("I64"))).to_float(a.failureCount)-o:(i||(i=d("I64"))).to_float(a.failureCount);a=Math.min((1<<Math.min(b-1,o))*k,l);b=c+a;return Math.max(b-Date.now(),0)}function w(){var a=Array.from(d("XPlatReactCrypto").getRandomValues(new Uint32Array(2)));a[0]>>>=1;return(i||(i=d("I64"))).add(i.lsl_(i.of_float(a[0]),32),i.of_float(a[1]))}function x(){var a=(i||(i=d("I64"))).of_float(Date.now());return i.and_(i.or_(i.lsl_(a,22),i.and_(w(),i.castExn([0,4194303]))),i.castExn([2147483647,4294967295]))}function y(a,b){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=x(),e=(yield a.network_requests.get(b,(i||(i=d("I64"))).neg_one));e==null?yield a.network_requests.add({epochId:c,failureCount:(i||(i=d("I64"))).zero,lastSentTimestampMs:i.zero,lastSyncRequestTimestampMs:i.of_float(Date.now()),syncDatabaseId:i.neg_one,taskQueueName:b}):yield a.network_requests.put(babelHelpers["extends"]({},e,{epochId:c,lastSyncRequestTimestampMs:(i||(i=d("I64"))).of_float(Date.now())}));return c});return z.apply(this,arguments)}function A(a,b){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){return(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange(b).filter(function(a){return a.epochId!=null})))!=null});return B.apply(this,arguments)}function C(a,b,c){var e=(i||(i=d("I64"))).to_float(a.minTimeToSyncTimestampMs),f=Date.now();e=e-f;f=e<=0;return f?v(a,b,c):e}function D(a){return a.httpUrlOverride!=null||(i||(i=d("I64"))).to_float(a.failureCount)>o}function E(a){return a.timeoutTimestampMs!=null?(i||(i=d("I64"))).to_float(a.timeoutTimestampMs)<=Date.now():!1}function F(a){return a===90..toString()||a===130..toString()||a===153..toString()}function G(a,b,c,d,e){e=e===0?void 0:e;return{failureCount:e,label:a,payload:b,queueName:c,taskId:d}}function H(a,b,c){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){a=(yield c("LSSerializeTaskStoredProcedure")(c("LSFactory")(a),{requiresAuthentication:e,taskId:b.taskId,taskLabel:b.context,taskValue:b.taskValue}));e=a[0];var f=a[1];a[2];a=a[3];if(e==null){if(a!=null)return{minRetryDelayMs:a};return}return G(f,e,b.queueName,b.taskId,(i||(i=d("I64"))).to_float(b.failureCount))});return I.apply(this,arguments)}function J(a,b,c){return K.apply(this,arguments)}function K(){K=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(b.context==null){yield a.pending_tasks["delete"](b.taskId);return}var d=E(b);if(d){yield a.pending_tasks["delete"](b.taskId);return}return H(a,b,c)});return K.apply(this,arguments)}function L(a,b){b=b>=(c("gkx")("26373")&&a===String(207)?n:m)||F(a);return!b}function M(a,b){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield a.pending_tasks.get(b.taskId));c!=null&&(i||(i=d("I64"))).equal(b.firstExecutedTimestampMs,(i||(i=d("I64"))).zero)&&(yield a.pending_tasks.put(babelHelpers["extends"]({},c,{firstExecutedTimestampMs:(i||(i=d("I64"))).of_float(Date.now())})))});return N.apply(this,arguments)}function O(a,b){return P.apply(this,arguments)}function P(){P=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){if(c.length===0)return{epochId:void 0,tasks:[]};var e=[],f=c[0].httpUrlOverride,g=(yield (h||(h=b("Promise"))).all(c.map(function(b){return p(a,b.taskId)}))).some(Boolean);for(c of c){var j=c.httpUrlOverride===f,k=(yield p(a,c.taskId))===g;yield M(a,c);if(!j||!k)break;j=(yield J(a,c,g));if(j!=null&&j.payload!=null)e.push(j);else if((j==null?void 0:j.minRetryDelayMs)!=null){k=(yield a.pending_tasks.get(c.taskId));if(k!=null){yield a.pending_tasks.put(babelHelpers["extends"]({},k,{failureCount:(i||(i=d("I64"))).add((k=k.failureCount)!=null?k:(i||(i=d("I64"))).zero,i.one),minTimeToSyncTimestampMs:i.add(j.minRetryDelayMs,i.of_float(Date.now()))}))}}else yield a.pending_tasks["delete"](c.taskId);if(!L(c.context,e.length))break}return{epochId:void 0,tasks:e}});return P.apply(this,arguments)}function Q(a,b,c,d,e){return R.apply(this,arguments)}function R(){R=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d,e){e===void 0&&(e=!0);b=(yield O(a,b));var f=b.tasks;if(f.length===0)return{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:c,skipRealtimeGateway:!1,workItemType:4};if(e===!0){f=(yield y(a,c));b.epochId=f}e=(yield r(a,c));return{httpUrlOverride:e.httpUrlOverride,networkPayload:b,nextSyncMs:void 0,queueName:c,skipRealtimeGateway:D(e),workItemType:d}});return R.apply(this,arguments)}function S(a,b,c){return T.apply(this,arguments)}function T(){T=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(yield r(a,b)),g=(yield t(a,b));f=C(f,e,g);e=f!==0;if(e)return[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:f,queueName:b,skipRealtimeGateway:!1,workItemType:3}];g=[];e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b)));f=e.filter(c("isNativeTask"));if(f.length>0){f=(yield Q(a,f,b,2,c("gkx")("4778")===!0));g.push(f)}f=e.filter(function(a){return!c("isNativeTask")(a)});if(f.length>0){e=(yield Q(a,f,b,1));g.push(e)}return g});return T.apply(this,arguments)}function U(a,b,c){return V.apply(this,arguments)}function V(){V=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var d=!(yield A(a,b));return d?S(a,b,c):[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:b,skipRealtimeGateway:!1,workItemType:4}]});return V.apply(this,arguments)}function a(a,b){return W.apply(this,arguments)}function W(){W=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.ignoreSoftDelay;b=b.queueName;a=(yield U(a,b,e));return a.map(function(a){var b;return d("LSShape").ofRecord({network_payload:d("LSShape").ofRecord({epoch_id:(b=a.networkPayload)==null?void 0:b.epochId,tasks:c("LSVec").ofArray(((b=(b=a.networkPayload)==null?void 0:b.tasks)!=null?b:[]).map(function(a){var b;return d("LSShape").ofRecord({failure_count:a.failureCount!=null?(i||(i=d("I64"))).of_float(a.failureCount):void 0,label:(b=a.label)!=null?b:void 0,payload:a.payload,queue_name:a.queueName,task_id:a.taskId})}))}),next_sync_ms:a.nextSyncMs!=null?(i||(i=d("I64"))).of_float(a.nextSyncMs):void 0,queue_name:a.queueName,skip_realtime_gateway:a.skipRealtimeGateway,work_item_type:(j||(j=d("LSIntEnum"))).ofNumber(a.workItemType)})})});return W.apply(this,arguments)}a._updateTaskIfNeeded=M;a._getHeadOfNormalQueue=r;a._lastSyncRequestTimestampForQueue=t;a._exponentialBackoffForNormalQueue=v;a._generateNewEpoch=x;a._openNewEpochForQueue=y;a._isEpochOpenForQueue=A;a._calculateDelayForNormalQueue=C;a._queueShouldSkipRealtimeGateway=D;a._isNativeTask=c("isNativeTask");a._taskIsTimedOut=E;a._taskShouldStopBatching=F;a._buildTaskPayloadExpressionForNormalTaskWithParameters=G;a._buildTaskPayloadExpressionForValidatedNormalTask=H;a._buildTaskPayloadExpressionForUnvalidatedNormalTask=J;a._workForNormalQueueWithoutDelay=Q;a._workForNormalQueueWithClosedEpoch=S;a._buildWorkForNormalQueue=U;a._buildNetworkPayloadShapeForTasks=O;a._canContinueBatchingForQueue=L;g["default"]=a}),98);
__d("LSCookie",["$InternalEnum","Cookie","CookieCore","CurrentEnvironment","CurrentMessengerUser","FBLogger","I64","LSE2EEMetadataSyncGroupUtils","LSIntEnum","MessengerLogHistory","MqttWebDeviceID","ReQL","SortedAsyncIterable","isPromise","isStringNullOrEmpty","pageID","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=b("$InternalEnum")({SYNCING:"1",NOT_SYNCING:"0"}),l=d("MessengerLogHistory").getInstance("client_init"),m=c("CurrentEnvironment").instagramdotcom?"igd_ls":"m_ls",n={c:{},d:c("MqttWebDeviceID").clientID,s:k.NOT_SYNCING,u:c("pageID")};function o(a){function b(a){d("CookieCore").setWithDomain_FOR_MESSENGER_LS_ONLY(m,JSON.stringify(a),window.location.hostname)}var e=c("Cookie").get(m);if(e==null){var f;b((f={},f[d("CurrentMessengerUser").getIDorEIMU()]=a,f));return}f=JSON.parse(e);if(f.u==null){b(babelHelpers["extends"]({},f,(e={},e[d("CurrentMessengerUser").getIDorEIMU()]=a,e)))}else{b((f={},f[d("CurrentMessengerUser").getIDorEIMU()]=a,f))}}function a(){c("Cookie").clear(m)}function p(a){if(typeof a!=="object")return null;if(a==null)return null;var b=a.c,c=a.d,d=a.s;a=a.u;d=typeof d==="string"?k.cast(d):null;b=typeof b==="object"&&b!=null?Object.entries(b).reduce(function(a,b){var c=b[0];b=b[1];if(a==null||typeof b!=="string")return null;a[c]=b;return a},{}):null;if(typeof c!=="string")return null;if(d==null)return null;if(b==null)return null;return typeof a!=="string"?null:{c:b,d:c,s:d,u:a}}function q(){var a=c("Cookie").get(m);if(c("isStringNullOrEmpty")(a))return n;a=JSON.parse(a);var b=d("CurrentMessengerUser").getIDorEIMU(),e=p(a);a=typeof a==="object"&&a!=null?p(a[b]):null;return(a=(b=a)!=null?b:e)!=null?a:n}function r(a){var b=q();if(b.u!==c("pageID"))return;var e={};a.forEach(function(a){a[0];a=a[1];var b=a.currentCursor;a=a.groupId;b!=null&&(e[(i||(i=d("I64"))).to_string(a)]=b)});l.debug("Updated sync cookie to set syncing=false, saving latest cursors");o(babelHelpers["extends"]({},b,{c:e,s:k.NOT_SYNCING}))}var s=[1,2,d("LSE2EEMetadataSyncGroupUtils").shouldAlwaysResetE2EEMetadata()?null:95];function e(a){var b=d("SortedAsyncIterable").toArray(d("ReQL").union.apply(void 0,s.map(function(b){return b==null?d("ReQL").empty():d("ReQL").fromTableAscending(a.tables.sync_groups).getKeyRange((j||(j=d("LSIntEnum"))).ofNumber(b))})));if((h||(h=c("isPromise")))(b)){c("promiseDone")(b.then(function(a){r(a)}));return}r(b)}function f(){try{var a=q();l.debug("Updated sync cookie to set syncing=true");o(babelHelpers["extends"]({},a,{s:k.SYNCING,u:c("pageID")}))}catch(a){c("FBLogger")("ls_web_init").catching(a).warn("Failed to sync cookie")}}g.Status=k;g.DEFAULT_COOKIE=n;g.clear=a;g.get=q;g.syncBeforeUnload=e;g.setSyncing=f}),98);
__d("LSDataTraceFlushDeferred",["MetaConfig","Promise","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("LSDataTraceFlush").__setRef("LSDataTraceFlushDeferred");function a(a){if(!c("MetaConfig")._("62"))return(h||(h=b("Promise"))).resolve(function(){});else return i.load().then(function(b){return b.flushExpiredDataTraces(a)})}g.watchForExpiredTraces=a}),98);
__d("LSJSONOp",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({BLOCK:1,LOAD:2,STORE:3,STORE_ARRAY:4,CALL_STORED_PROCEDURE:5,CALL_NATIVE_TYPE_OPERATION:6,CALL_NATIVE_OPERATION:7,LIST:8,UNDEFINED:9,INFINITY:10,NAN:11,RETURN:12,BOOL_TO_STR:13,BLOBS_TO_STRING:14,BLOBS_OF_STRING:15,TO_BLOB:16,I64_OF_FLOAT:17,I64_TO_FLOAT:18,I64_FROM_STRING:19,I64_TO_STRING:20,READ_GK:21,READ_QE:22,IF:23,OR:24,AND:25,NOT:26,IS_NULL:27,ENFORCE_NOT_NULL:28,GENERIC_EQUAL:29,I64_EQUAL:30,BLOB_EQUAL:31,GENERIC_NOT_EQUAL:32,I64_NOT_EQUAL:33,BLOB_NOT_EQUAL:34,GENERIC_GREATER_THAN:35,I64_GREATER_THAN:36,BLOB_GREATER_THAN:37,GENERIC_GREATER_THAN_OR_EQUAL:38,I64_GREATER_THAN_OR_EQUAL:39,BLOB_GREATER_THAN_OR_EQUAL:40,GENERIC_LESS_THAN:41,I64_LESS_THAN:42,BLOB_LESS_THAN:43,GENERIC_LESS_THAN_OR_EQUAL:44,I64_LESS_THAN_OR_EQUAL:45,BLOB_LESS_THAN_OR_EQUAL:46,THROW:47,LOG_CONSOLE:48,LOGGER_LOG:49,NATIVE_OP_ARRAY_CREATE:50,NATIVE_OP_ARRAY_APPEND:51,NATIVE_OP_ARRAY_GET_SIZE:52,NATIVE_OP_MAP_CREATE:53,NATIVE_OP_MAP_GET:54,NATIVE_OP_MAP_SET:55,NATIVE_OP_MAP_KEYS:56,NATIVE_OP_MAP_DELETE:57,NATIVE_OP_MAP_HAS:58,NATIVE_OP_STR_JOIN:59,NATIVE_OP_CURRENT_TIME:60,NATIVE_OP_JSON_STRINGIFY:61,NATIVE_OP_RNG_NUM:62,NATIVE_OP_LOCALIZATION_SUPPORTED:63,NATIVE_OP_LOCALIZATION_SUPPORTED_V2:64,NATIVE_OP_RESOLVE_LOCALIZED:65,NATIVE_OP_RESOLVE_LOCALIZED_V2:66,ADD:68,I64_ADD:69,I64_CAST:70,READ_JUSTKNOB:71,READ_IGGK:72,GET_RUN_MODE:73,STR_TRIM:74,STR_REPLACE:75,JOIN:76,STR_LIKE:77,LENGTH:78,IN:79,IN_VEC:80,SUB:81,MUL:82,DIV:83,MOD:84,I64_SUB:85,I64_MUL:86,I64_DIV:87,I64_MOD:88,I64_IN:89,I64_IN_VEC:90,BITWISE_LEFT_SHIFT:91,BITWISE_RIGHT_SHIFT:92,ARITHMETIC_RIGHT_SHIFT:93,BITWISE_AND:94,BITWISE_OR:95,BITWISE_XOR:96,TERNARY:97,XOR:98,NULLISH_COALESE:99,READ_COLUMN:100,READ_COLUMN_REF:101,READ_GROUP_COUNT:102,COMMENT:103,IMPORT:104,LOOP:105,QUERY_COMPARISON_EQUAL:106,QUERY_COMPARISON_NOT_EQUAL:107,QUERY_COMPARISON_GREATER_THAN:108,QUERY_COMPARISON_GREATER_THAN_OR_EQUAL:109,QUERY_COMPARISON_LESS_THAN:110,QUERY_COMPARISON_LESS_THAN_OR_EQUAL:111,QUERY_MERGE_CONSTRAINTS:112,QUERY_FETCH_ROWS:113,QUERY_FILTER_ROWS:114,QUERY_SORT_ROWS_BY:115,QUERY_DELETE_ROWS:116,QUERY_SLICE_ROWS:117,QUERY_COUNT_ROWS:118,QUERY_PEEK_NEXT_ROW_ID:119,QUERY_UPDATE_ROWS:120,QUERY_INSERT_ROWS:121,QUERY_PUT_ROWS:122,QUERY_FOREACH_ROW:123,QUERY_SELECT_MATCH_ROW:124,QUERY_CURSOR_SLICE:125,QUERY_GROUP_BY:126,SUB_STRING:127});c=a;f["default"]=c}),66);
__d("LSSelectOrder",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["ASC","DESC"]);c=a;f["default"]=c}),66);
__d("LSDatascriptJSONEval",["FBLogger","LS","isPromise"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["2"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["0"]);j=function(){return a};return a}function k(a,b,d){if((h||(h=c("isPromise")))(a))return a.then(b,d);try{return b(a)}catch(a){if(d)return d(a);else throw a}}a=function(){function a(a,b,d,e){var f=this;e===void 0&&(e=[]);this.$4={};this.$5=[];this.$6=null;this.$7=function(a){return k(f.$8(a),function(a){return a},function(b){c("FBLogger")("messenger_web_product").catching(b).mustfix("Error evaluating step op: %s",Array.isArray(a)?a[0]:"<primitive value>");throw b})};this.$1=b;this.$2=a;this.$3=d;for(b=0;b<e.length;b++)this.$4[b]=e[b]}var d=a.prototype;d.eval=function(){return this.$2==null?this.$1.resolve([]):this.$1.resolve(this.$7(this.$2.step))};d.$8=function(a){var d=this;if(!Array.isArray(a))return a;var e=a[0];a=a.slice(1);var f=a;switch(e){case 8:return f.map(this.$7);case 2:return this.$4[f[0]];case 3:return k(this.$7(f[1]),function(a){return d.$4[f[0]]=a});case 4:return k(this.$7(f[2]),function(a){var b=f[0],c=f[1];for(var e=0;e<c;e++,b++)d.$4[b]=a[e];return a});case 12:a=f[0];e=f[1];var g=[];for(a=a;a<e;a++)g[a]=this.$4[a];return g;case 1:var h;a=function(a){h=k(h,function(){return d.$7(f[a])})};for(e=0;e<f.length;e++)a(e);return h;case 5:return(g=this.$1).storedProcedure.apply(g,f.map(this.$7));case 6:return(e=this.$1).nativeTypeOperation.apply(e,f.map(this.$7));case 7:return(a=this.$1).nativeOperation.apply(a,f.map(this.$7));case 9:return;case 10:return Infinity;case 11:return NaN;case 13:return this.$7(f[0])?"1":"0";case 14:return this.$1.blobs.to_string(this.$7(f[0]));case 15:return this.$1.blobs.of_string(this.$7(f[0]));case 16:return this.$1.blob(this.$7(f[0]));case 17:return this.$1.i64.of_float(this.$7(f[0]));case 18:g=this.$7(f[0]);return g!=null?this.$1.i64.to_float(g):void 0;case 19:return this.$1.i64.from_string(this.$7(f[0]));case 70:return this.$1.i64.cast(this.$7(f[0]));case 20:return this.$1.i64.to_string(this.$7(f[0]));case 21:return(e=this.$3)==null?void 0:(a=e.gk)==null?void 0:a[f[0]];case 22:var l;g=f[0];e=f[1];a=f[2];var m=f[3];l=(l=this.$3)==null?void 0:(l=l.qe)==null?void 0:(l=l[g])==null?void 0:(g=l[e])==null?void 0:g[a];if(l==null)return l;switch(m){case"BOOL":case"STR":return l;case"I64":if(typeof l!=="object")throw c("FBLogger")("messenger_web_product").mustfixThrow("Cannot convert value to string");return this.$1.i64.from_string(l.toString())}return;case 23:if(this.$7(f[0]))return this.$7(f[1]);else if(f[2]!=null)return this.$7(f[2]);return;case 24:return this.$7(f[0])||this.$7(f[1]);case 25:return this.$7(f[0])&&this.$7(f[1]);case 26:return!this.$7(f[0]);case 27:return this.$7(f[0])==null;case 28:return this.$1.notnull(this.$7(f[0]));case 29:return this.$7(f[0])===this.$7(f[1]);case 30:return this.$1.i64.eq(this.$7(f[0]),this.$7(f[1]));case 31:return this.$1.blobs.eq(this.$7(f[0]),this.$7(f[1]));case 32:return this.$7(f[0])!==this.$7(f[1]);case 33:return this.$1.i64.neq(this.$7(f[0]),this.$7(f[1]));case 34:return this.$1.blobs.neq(this.$7(f[0]),this.$7(f[1]));case 35:return this.$7(f[0])>this.$7(f[1]);case 36:return this.$1.i64.gt(this.$7(f[0]),this.$7(f[1]));case 37:return this.$1.blobs.gt(this.$7(f[0]),this.$7(f[1]));case 38:return this.$7(f[0])>=this.$7(f[1]);case 39:return this.$1.i64.ge(this.$7(f[0]),this.$7(f[1]));case 40:return this.$1.blobs.ge(this.$7(f[0]),this.$7(f[1]));case 41:return this.$7(f[0])<this.$7(f[1]);case 42:return this.$1.i64.lt(this.$7(f[0]),this.$7(f[1]));case 43:return this.$1.blobs.lt(this.$7(f[0]),this.$7(f[1]));case 44:return this.$7(f[0])<=this.$7(f[1]);case 45:return this.$1.i64.le(this.$7(f[0]),this.$7(f[1]));case 46:return this.$1.blobs.le(this.$7(f[0]),this.$7(f[1]));case 47:return this.$1["throw"](f[0]);case 48:return this.$1.print(this.$7(f[0]));case 49:e=this.$7(f[0]);g=f[1];a=this.$1.logger(e);switch(g){case"mustfix":return a.mustfix(e);case"info":return a.info(e);case"warn":return a.warn(e);case"debug":return a.debug(e);default:throw c("FBLogger")("messenger_web_product").mustfixThrow("Invalid logger level %s",g)}case 50:return f.length===0?this.$1.createArray():(m=this.$1).createArrayWithElements.apply(m,this.$7(f[0]));case 51:l=this.$7(f[0]);l.push(this.$7(f[1]));return l;case 52:return this.$1.i64.of_int32(this.$7(f[0]).length);case 53:return new this.$1.Map();case 54:return this.$7(f[0]).get(this.$7(f[1]));case 55:return this.$7(f[0]).set(this.$7(f[1]),this.$7(f[2]));case 56:return this.$7(f[0]).keys();case 57:return this.$7(f[0])["delete"](this.$7(f[1]));case 58:return this.$7(f[0]).has(this.$7(f[1]));case 59:return this.$7(f[0]).join(this.$7(f[1])||"");case 60:return this.$1.i64.of_float(Date.now());case 61:return this.$1.toJSON(this.$7(f[0]));case 62:return this.$1.i64.random();case 63:case 64:return!0;case 65:return this.$1.localizeAsync(this.$7(f[0]),this.$7(f[1]));case 66:return this.$1.localizeV2Async(this.$7(f[0]),this.$7(f[1]));case 68:return this.$7(f[0])+this.$7(f[1]);case 69:return this.$1.i64.add(this.$7(f[0]),this.$7(f[1]));case 71:return(a=this.$3)==null?void 0:(e=a.justknob)==null?void 0:e[f[0]];case 72:return(g=this.$3)==null?void 0:(m=g.iggk)==null?void 0:m[f[0]];case 100:return this.$5[f[0]][f[1]];case 101:if(this.$6==null)throw c("FBLogger")("messenger_web_product").mustfixThrow("Attempting to read column ref when none exist!");return this.$6[f[0]];case 102:return this.$5[this.$7(f[0])].group_count;case 73:return this.$1.rm;case 74:return this.$7(f[0]).trim();case 75:return this.$7(f[0]).split(this.$7(f[1])).join(this.$7(f[2]));case 76:return f.map(this.$7).join("");case 77:return this.$1.like(this.$7(f[0]),this.$7(f[1]));case 78:return[0,this.$7(f[0]).length];case 79:l=f.map(this.$7);a=l[0];e=l.slice(1);return e.includes(a);case 80:return this.$7(f[1]).includes(this.$7(f[0]));case 81:return this.$7(f[0])-this.$7(f[1]);case 82:return this.$7(f[0])*this.$7(f[1]);case 83:return this.$7(f[0])/this.$7(f[1]);case 84:return this.$7(f[0])%this.$7(f[1]);case 91:return this.$1.i64.lsl_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 92:return this.$1.i64.lsr_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 93:return this.$1.i64.asr_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 94:return this.$1.i64.and_(this.$7(f[0]),this.$7(f[1]));case 95:return this.$1.i64.or_(this.$7(f[0]),this.$7(f[1]));case 96:return this.$1.i64.xor(this.$7(f[0]),this.$7(f[1]));case 85:return this.$1.i64.sub(this.$7(f[0]),this.$7(f[1]));case 86:return this.$1.i64.mul(this.$7(f[0]),this.$7(f[1]));case 87:return this.$1.i64.div(this.$7(f[0]),this.$7(f[1]));case 88:return this.$1.i64.mod_(this.$7(f[0]),this.$7(f[1]));case 89:g=f.map(this.$7);var n=g[0];m=g.slice(1);return m.some(function(a){return d.$1.i64.eq(n,a)});case 90:var o=this.$7(f[0]);return this.$7(f[1]).some(function(a){return d.$1.i64.eq(o,a)});case 97:return this.$7(f[0])?this.$7(f[1]):this.$7(f[2]);case 98:l=this.$7(f[0]);e=this.$7(f[1]);return(l||e)&&!(l&&e);case 99:return(a=this.$7(f[0]))!=null?a:this.$7(f[1]);case 103:return;case 104:return b.call(null,f[0]);case 105:g=function(){var b=d.$7(f[0]),e=f[1],g=c("LS").n,a,h=function(b){a=k(a,function(){d.$4[e]=b;return d.$7(f[2])})};for(var l=g(j());d.$1.i64.lt(l,b);l=d.$1.i64.add(l,g(i())))h(l);return{v:a}}();if(typeof g==="object")return g.v;case 106:return this.$7(f[0]);case 107:throw c("FBLogger")("messenger_web_product").mustfixThrow("not equal query comparison operator not supported");case 108:return{gt:this.$7(f[0])};case 109:return{gte:this.$7(f[0])};case 110:return{lt:this.$7(f[0])};case 111:return{lte:this.$7(f[0])};case 112:return f.length===1?this.$7(f[0]):(m=this.$1).merge.apply(m,f.map(this.$7));case 113:l=f[0];e=f[1];a=f.slice(2);g=a.map(this.$7);switch(e){case"ASC":return(m=this.$1.db.table(l)).fetch.apply(m,g);case"DESC":return(a=this.$1.db.table(l)).fetchDesc.apply(a,g)}return;case 114:return this.$1.filter(this.$7(f[0]),function(a){d.$6=a;a=d.$7(f[1]);d.$6=null;return a});case 115:return(e=this.$1).sortBy.apply(e,f.map(this.$7));case 116:return this.$1.forEach(this.$7(f[0]),function(a){return a["delete"]()});case 117:return this.$1.islc(this.$7(f[0]),0,this.$7(f[1]));case 118:return this.$1.count(this.$7(f[0]));case 119:return this.$1.db.table(f[0]).peekNextAutoIncrementId();case 120:return this.$1.forEach(this.$7(f[0]),function(a){var b=a.item;a=a.update;var c={};d.$6=b;for(b=1;b<f.length;b+=2)c[f[b]]=d.$7(f[b+1]);d.$6=null;return a(c)});case 121:m=f[0];l={};for(a=1;a<f.length;a+=2)l[f[a]]=this.$7(f[a+1]);return this.$1.db.table(m).add(l);case 122:g=f[0];e={};for(a=1;a<f.length;a+=2)e[f[a]]=this.$7(f[a+1]);return this.$1.db.table(g).put(e);case 123:return this.$1.forEach(this.$7(f[0]),function(a){a=a.item;d.$5[f[1]]=a;return d.$7(f[2])});case 124:return this.$7(f[0]).next().then(function(a){var b=a.done;a=a.value;if(b)return d.$7(f[3]);else{b=f[1];if(b!=null){d.$5[b]=a.item;return d.$7(f[2])}}return 0});case 125:return this.$7(f[0]).slice(0,this.$7(f[1]));case 126:return this.$1.groupBy(this.$7(f[0]),f[1]).forEach(function(a){d.$5[f[2]]=a;return d.$7(f[3])});case 127:return this.$7(f[0]).substr(this.$1.i64.to_int32(this.$7(f[1])),this.$1.i64.to_int32(this.$7(f[2])))}};return a}();g["default"]=a}),98);
__d("TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE",["Env","TrustedTypes","err"],(function(a,b,c,d,e,f,g){"use strict";var h;d={createScript:function(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];d.forEach(function(a){if(typeof window!=="undefined"&&typeof window.trustedTypes!=="undefined"&&!window.trustedTypes.isScript(a))throw c("err")("Trusted Function requires TrustedScripts args only.")});var f=d.slice(0,-1).join(","),g=d.pop().toString();return"(function anonymous(\n     "+f+"\n     ) {\n     "+g+"\n     })"}};var i=c("TrustedTypes").createPolicy("unsafe-function-do-not-use",d);function b(){for(var b=arguments.length,d=new Array(b),e=0;e<b;e++)d[e]=arguments[e];if(c("TrustedTypes").isSupportedNatively()&&(h||(h=c("Env"))).useTrustedTypes){var f=i.createScript.apply(i,[""].concat(d));return a.eval(f)}else return babelHelpers.construct(Function,d)}g.TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE=i;g.createTrustedFunction=b}),98);
__d("LSDatascriptEvaluator",["FBLogger","LSDatascriptJSONEval","LSFactory","MWPBumpEntityKey","TrustedTypesNoOpPolicy_DO_NOT_USE","TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var e=function(b){return function(c,d){var e;return a==null?void 0:(e=a.qe)==null?void 0:(e=e[c])==null?void 0:(c=e[b])==null?void 0:c[d]}},f=new Proxy({getBool:e("fb"),getNumber:e("fb"),getString:e("fb")},{get:function(a,b){return b in a?a[b]:{getBool:e(b),getNumber:e(b),getString:e(b)}}}),g=function(b){var c;return a==null?void 0:(c=a.gk)==null?void 0:c[b]};g.ig=function(b){var c;return a==null?void 0:(c=a.iggk)==null?void 0:c[b]};var h={getBool:function(b){var c;return a==null?void 0:(c=a.justknob)==null?void 0:c[b]}};return function(a){var e;e=d("TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE").createTrustedFunction((e=c("TrustedTypesNoOpPolicy_DO_NOT_USE")).createScript("gkx"),e.createScript("qex"),e.createScript("justknobx"),e.createScript("return "+b));return e(g,f,h)(c("LSFactory")(a,{dynamic:!0}))}}function i(a,b){var d=JSON.parse(b),e=(b=a)!=null?b:{gk:{},iggk:{},justknob:{},qe:{}};return function(a){return new(c("LSDatascriptJSONEval"))(d,c("LSFactory")(a,{dynamic:!0}),e).eval()}}function j(a,b,d){if(d==null){c("FBLogger")("lightspeed","null_target").mustfix("Received <null> target field for sync script!");return h(a,b)}switch(d){case 3:return i(a,b);case 2:return h(a,b);case 1:throw c("FBLogger")("messenger_web_product","invalid_sync_script_target").mustfixThrow("Received a sync script with LSProgramTarget of DASM, this should never happen!")}}function a(a){return function(b){if(b==null)throw c("FBLogger")("messenger_comet").mustfixThrow("Error creating eval function, db is undefined. This is likely a currying error in the definition for LSDatascriptEvaluator");return function(e){var g=e.experiments,h=e.priority,i=e.syncScript,k=e.target;e=e.taskNames;g=g!=null?JSON.parse(g):null;try{var l=j(g,i,k);return b.runInTransaction(function(b){a&&a();return l(b)},"readwrite",h,{taskNames:e,type:"sync_script"},f.id+":194")}catch(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform","eval_datascript_failure");c("FBLogger")("messenger_web_product").catching(a).mustfix("Error executing sync script");throw a}}}}a.__debugModuleName="LSDatascriptEvaluator";g.default=a}),98);
__d("LSDatascriptEvaluatorMaybeDeferred",["cr:6586"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:6586")}),98);
__d("LSTruncateTableAndSetShowError",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.sequence([function(a){return b.forEach(b.db.table(115).fetch(),function(a){return a["delete"]()})},function(d){return c[0]=b.i64.of_float(Date.now()),b.db.table(115).add({statusId:b.i64.cast([0,0]),timestampMs:c[0],errorShouldBeShown:a[0]})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSConnectivityTruncateTableAndSetShowErrorStoredProcedure";e.exports=a}),null);
__d("LSDeleteAllAndInsertConnectivityStatus",["LSTruncateTableAndSetShowError"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.forEach(c.db.table(114).fetch(),function(a){return a["delete"]()})},function(b){return d[0]=c.i64.of_float(Date.now()),c.db.table(114).add({statusId:void 0,timestampMs:d[0],internetConnectionState:a[0]})},function(d){return c.storedProcedure(b("LSTruncateTableAndSetShowError"),c.i64.neq(a[0],c.i64.cast([0,1])))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSConnectivityDeleteAllAndInsertConnectivityStatusStoredProcedure";e.exports=a}),null);
__d("LSDeleteAllAndInsertConnectivityStatusStoredProcedure",["LSDeleteAllAndInsertConnectivityStatus","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSDeleteAllAndInsertConnectivityStatus")(b.internetConnectionState,a)}g["default"]=a}),98);
__d("LSSyncStoredProcedureUtils",["I64","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){c=c!=null?(h||(h=d("I64"))).of_float(Date.now()+c):b.minTimeToSyncTimestampMs;yield a.pending_tasks.put(babelHelpers["extends"]({},b,{failureCount:(h||(h=d("I64"))).add(b.failureCount,h.one),minTimeToSyncTimestampMs:c}))});return j.apply(this,arguments)}function a(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b)));if(b==null)return;return i(a,b,c)});return k.apply(this,arguments)}function c(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield a.network_requests.get(b,c));if(b==null)return;yield a.network_requests.put(babelHelpers["extends"]({},b,{failureCount:(h||(h=d("I64"))).add(b==null?void 0:b.failureCount,h.one)}))});return l.apply(this,arguments)}function e(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){b=(yield a.network_requests.get(b,c));if(b==null)return;yield a.network_requests.put(babelHelpers["extends"]({},b,{epochId:void 0,networkTaskIdentifier:void 0}))});return m.apply(this,arguments)}g.incrementPendingTaskFailureCount=i;g.incrementPendingTasksTaskFailureCount=a;g.incrementNetworkRequestsTaskFailureCount=c;g.closeEpoch=e}),98);
__d("LSHandleTaskSendFailureForQueue2",["I64","LSSyncStoredProcedureUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){yield d("LSSyncStoredProcedureUtils").incrementPendingTasksTaskFailureCount(a,b,c),yield d("LSSyncStoredProcedureUtils").incrementNetworkRequestsTaskFailureCount(a,b,(h||(h=d("I64"))).neg_one),yield d("LSSyncStoredProcedureUtils").closeEpoch(a,b,h.neg_one)});return i.apply(this,arguments)}g["default"]=a}),98);
__d("LSHandleTaskSendSuccessForQueue2",["I64","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=(yield a.network_requests.get(b,(h||(h=d("I64"))).neg_one));if(c==null||c.epochId==null)return;yield a.network_requests["delete"](b,h.neg_one)});return i.apply(this,arguments)}g["default"]=a}),98);
__d("LSPlatformDefaultUnderlyingApi",["Promise","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return c("emptyFunction")}function d(){return(h||(h=b("Promise"))).resolve()}e={cleanup:c("emptyFunction"),onConnectionStatusChange:a,onReconnect:a,publish:d,subscribe:a};g["default"]=e}),98);
__d("LSPlatformDeviceId",["ChannelClientID","FBLogger","LSCookie","MqttWebDeviceID","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){if(c("gkx")("21118"))return c("MqttWebDeviceID").clientID;else return c("ChannelClientID").getID()}b=h();function a(a){a==null&&c("FBLogger")("messenger_browser_clients").info("Missed provider type for deviceId");return a==="persisted"?d("LSCookie").get().d:h()}g.deviceId=b;g.getDeviceIdForProviderType=a}),98);
__d("MessengerPWAVersionForUserAgent",["isMessengerPWA","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(!c("justknobx")._("3005"))return void 0;var a=c("isMessengerPWA")();if(!a)return void 0;a=(a=new URL(window.location.href).searchParams.get("__pwa"))!=null?a:"1.0.0";return a}g["default"]=a}),98);
__d("LSPlatformRealtimeTransport",["I64","LSDynamicDependencies","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSShape","MessengerPWAVersionForUserAgent","Promise","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e="LSPlatformRealtimeTransport.NotConnected";var k="LSPlatformRealtimeTransport.Timeout";function l(a){var b=new Map();return{getAll:function(){return Array.from(b.values())},getOrStart:function(c){var d=c.toString(),e=b.get(d);e==null&&(e=a(c),b.set(d,e));return e}}}function m(){}function a(a,e,f){var g=new Map(),n={contents:m},o=new Set(),p=new Map(),q=[],r=l(function(b){b=a(b,f);q.push(b.subscribe(function(a){var b=JSON.parse(a),e=d("LSDynamicDependencies").downloadBootloaderDependencies(b.sp,b.nop,b.ntop);a=b.request_id;var f;if(a!=null){var h=g.get(a);h==null?f=!1:(c("clearTimeout")(h.timeoutId),h.resolve({downloadTask:e,payload:b,type:"taskresponse"}),g["delete"](a),f=!0)}else f=!1;if(!f){Array.from(p.entries()).forEach(function(a){return a[1](e,b)});return}}));q.push(b.onReconnect(function(){return n.contents()}));q.push(b.onConnectionStatusChange(function(a){o.forEach(function(b){return b(a)})}));return b});r.getOrStart((j||(j=d("LSIntEnum"))).unwrapIntEnum(d("LSMailboxInitialSyncCursor").syncChannel));return{cleanup:function(){q.forEach(function(a){return a()}),r.getAll().forEach(function(a){return a.cleanup()})},onConnectionStatusChange:function(a){o.add(a);return function(){o["delete"](a)}},onReconnect:function(a){n.contents=a;return function(){n.contents=m}},publish:function(a){var f=a.payload,l=a.queueName,m=a.requestId,n=a.syncChannel,o=a.type_;return new(h||(h=b("Promise")))(function(a,b){if((i||(i=d("I64"))).equal(o,(j||(j=d("LSIntEnum"))).ofNumber(3))){var h=c("setTimeout")(function(){var a=g.get(m);a!=null&&(g["delete"](m),a.reject({RE_EXN_ID:k}));return b({RE_EXN_ID:k})},3e4);g.set(m,{queueName:l,reject:b,resolve:a,timeoutId:h,timestamp:Date.now()})}h=c("MessengerPWAVersionForUserAgent")();c("promiseDone")(r.getOrStart((j||(j=d("LSIntEnum"))).unwrapIntEnum(n)).publish(d("LSJson").stringify(d("LSShape").ofRecord(babelHelpers["extends"]({app_id:e,payload:f},h!=null?{pwa_version:h}:{},{request_id:m,type:o}))),o),function(){if(!(i||(i=d("I64"))).equal(o,(j||(j=d("LSIntEnum"))).ofNumber(3)))return a({type:"noresponseexpected"})},function(a){return b(a)})})},subscribeToNonTaskResponses:function(a){var b={};p.set(b,a);return function(){p["delete"](b)}}}}g.NotConnected=e;g.Timeout=k;g.LSPlatformRealtimeTransport=a}),98);
__d("shouldStubUnderlyingTransport",["ExecutionEnvironment"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return!(h||(h=c("ExecutionEnvironment"))).canUseDOM&&!(h||(h=c("ExecutionEnvironment"))).isInWorker}g["default"]=a}),98);
__d("LSPlatformMqttRealtimeTransport",["I64","LSIntEnum","LSPlatformDefaultUnderlyingApi","LSPlatformRealtimeTransport","Promise","promiseDone","shouldStubUnderlyingTransport"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a){return[{payload:JSON.stringify({ls_fdid:"",ls_sv:a}),qos:1,topic:"/ls_app_settings"}]}function l(a){var e={contents:a.getConnectionState()},f={contents:function(){}},g={contents:new(j||(j=b("Promise")))(function(a,b){f.contents=a})},k={onMQTTStateChanged:function(a){a==="Connected"?f.contents():a==="Disconnected"&&e.contents==="Connected"&&(g.contents=new(j||(j=b("Promise")))(function(a,b){f.contents=a})),e.contents=a}};e.contents==="Connected"&&f.contents();a.subscribeChannelEvents(k);return[function(){a.unsubscribeChannelEvents(k)},function(e,f){return g.contents.then(function(){return new(j||(j=b("Promise")))(function(b,g){c("promiseDone")(a.publish("/ls_req",e,{listener:{onEvent:function(a){if(a==="NOT_CONNECTED")return g({RE_EXN_ID:d("LSPlatformRealtimeTransport").NotConnected})}},qos:(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(4))?0:1,skipBuffer:!1}),function(){return b()},function(a){if(a.message==="Publish Timed Out")return g({RE_EXN_ID:d("LSPlatformRealtimeTransport").Timeout});else return g(a)})})})}]}var m={contents:void 0};function a(a,b,d){if(c("shouldStubUnderlyingTransport")())return c("LSPlatformDefaultUnderlyingApi");var e=d.getInstance(b),f={getPublishMessages:function(){return k(a)}};e.registerExtraConnectPayloadProvider(f);var g={onMQTTStateChanged:function(a){var b=m.contents;if(b!=null)return b(a)}};e.subscribeChannelEvents(g);var h=e.subscribe("/ls_foreground_state",function(){});b=l(e);var i=b[0];b=b[1];return{cleanup:function(){e.unregisterExtraConnectPayloadProvider(f),d.shutdownAndClear(),e.unsubscribeChannelEvents(g),h(),i()},onConnectionStatusChange:function(a){m.contents=a;return function(){m.contents=void 0}},onReconnect:function(a){var b={contents:e.getConnectionState()},c={contents:b.contents==="Connected"},d={onMQTTStateChanged:function(d){d==="Connected"&&(c.contents&&b.contents!=="Connected"&&a(),c.contents=!0),b.contents=d}};e.subscribeChannelEvents(d);return function(){e.unsubscribeChannelEvents(d)}},publish:b,subscribe:function(a){return e.subscribe("/ls_resp",function(b){return a(b)})}}}g["default"]=a}),98);
__d("LSPlatformRequestId",[],(function(a,b,c,d,e,f){"use strict";var g=4;function a(){var a=g;g+=1;return a}b={generate:a};f["default"]=b}),66);
__d("LSPlatformRequestScheduler",["clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.requests=new Map()}var b=a.prototype;b.schedule=function(a,b,d){var e=this.requests.get(b);e!=null&&c("clearTimeout")(e);this.requests.set(b,c("setTimeout")(a,d))};b.cleanup=function(){this.requests.forEach(function(a){return c("clearTimeout")(a)})};return a}();g["default"]=a}),98);
__d("LSPlatformServerResponseHandler",["FBLogger","Promise","asyncToGeneratorRuntime","clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.eval=a,this.currentlyRunning=(h||(h=b("Promise"))).resolve()}var d=a.prototype;d.evalWhenReady=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var d=[];try{var e=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").mustfix("waited longer than 30 seconds to download dependencies")},3e4);d.push(e);yield a;c("clearTimeout")(e);a=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").mustfix("waited longer than 30 seconds to eval sync script")},3e4);d.push(a);yield this.eval(b);c("clearTimeout")(a)}catch(a){d.forEach(function(a){return c("clearTimeout")(a)}),c("FBLogger")("messenger_web_product").catching(a).mustfix("syncscript execution failed "+(a==null?void 0:a.message))}});function d(b,c){return a.apply(this,arguments)}return d}();d.evalInOrderReceived=function(a,b){var c=this,d=this.currentlyRunning.then(function(){return c.evalWhenReady(a,babelHelpers["extends"]({},b,{priority:"sync_script"}))});this.currentlyRunning=d;return d};return a}();g["default"]=a}),98);
__d("MWPBeginHandlingPendingTasksForQueue",["LSBeginHandlingFireForgetTasksForQueueStoredProcedure","LSBeginHandlingPendingTasksForQueue2","LSFactory","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,d){var e=d.fireAndForgetTask,g=d.ignoreSoftDelay,h=d.queueName;d=(yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(e===!0){var b=(yield c("LSBeginHandlingFireForgetTasksForQueueStoredProcedure")(c("LSFactory")(a),{queueName:h}));b=b[0];return[b]}return c("LSBeginHandlingPendingTasksForQueue2")(a,{ignoreSoftDelay:g,queueName:h})});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":37"));return d});return h.apply(this,arguments)}g["default"]=a}),98);
__d("MWPlatformTaskUtils",["FBLogger","I64","JSScheduler","MetaConfig","Promise","ReQL","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,e){function f(){return g.apply(this,arguments)}function g(){g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{yield a(e)}catch(a){c("FBLogger")("messenger_web_product").catching(a).warn("Failed to calculate work for task queue %s",e.queueName)}});return g.apply(this,arguments)}if((j||(j=d("I64"))).gt(e.priority,(j||(j=d("I64"))).zero)&&c("MetaConfig")._("78")){var h=function(){f()};(i||(i=c("JSScheduler"))).scheduleLoggingPriCallback(h)}else c("promiseDone")(f())}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{yield a(b)}catch(a){c("FBLogger")("messenger_web_product").catching(a).warn("Failed to calculate work for fire forget queue %s",b.queueName)}});return m.apply(this,arguments)}function a(a,c){var e=new Set(),f=[],g=[];g.push(a.tables.pending_tasks.index("queueNameTaskId").subscribe(function(a,b){var c;if(b.operation==="delete"){e.add(a[0]);return}a=b.operation==="put"&&b.prevValue==null||b.operation==="add";c=b.operation==="put"&&(j||(j=d("I64"))).compare(b.value.failureCount,(c=(c=b.prevValue)==null?void 0:c.failureCount)!=null?c:(j||(j=d("I64"))).zero)>0;(a||c)&&e.add(b.value.queueName);(b.operation==="add"&&b.value.dataTraceId==null||b.value.dataTraceId==="")&&f.push(b.value)}));g.push(a.tables.network_requests.subscribe(function(a,b){a=a[0];if(a==="")return;b.operation==="delete"?e.add(a):b.value.epochId==null&&e.add(a)}));g.push(a.subscribeToCommit(function(){var g=Array.from(e);e.clear();f=[];g.forEach(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.pending_tasks.index("queueNameTaskId")).bounds({gte:[b]})));b!=null&&k(c,b)});return function(a){return e.apply(this,arguments)}}())}));return g}function e(a,e){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.pending_tasks))),c=new Set();for(b of b){if(c.has(b.queueName))continue;c.add(b.queueName);k(e,b)}})())}function n(a,e){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var g=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.pending_fire_and_forget_tasks)));yield (h||(h=b("Promise"))).all(g.map(function(a){return l(e,a)}));c("promiseDone")(a.runInTransaction(function(a){return(h||(h=b("Promise"))).all(g.map(function(b){return a.pending_fire_and_forget_tasks["delete"](b.taskId)}))},"readwrite","background",void 0,f.id+":196"))})())}function o(a,b){var c=!1,d=[];d.push(a.tables.pending_fire_and_forget_tasks.subscribe(function(a,b){if(b.operation==="delete")return;a=b.operation==="put"&&b.prevValue==null||b.operation==="add";a&&(c=!0)}));d.push(a.subscribeToCommit(function(){c&&n(a,b),c=!1}));return d}g.checkQueuesWhenPendingTaskTableUpdates=a;g.checkAllPendingTasksForWork=e;g.checkAllFireForgetTasksForWork=n;g.checkQueuesWhenPendingFireForgetTaskTableUpdates=o}),98);
__d("LSPlatformTaskSystemTransport",["CurrentMessengerUser","FBLogger","I64","JSResourceForInteraction","JSScheduler","LSDatabaseProviderType","LSHandleTaskSendFailureForQueue2","LSHandleTaskSendSuccessForQueue2","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSPlatformRealtimeTransport","LSPlatformRequestId","LSPlatformRequestScheduler","LSPlatformServerResponseHandler","LSShape","LSVec","MWPBeginHandlingPendingTasksForQueue","MWPBumpEntityKey","MWPlatformTaskUtils","Promise","ReQL","asyncToGeneratorRuntime","cr:4031","cr:6668","gkx","isInstamadillo","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=500,m=c("JSResourceForInteraction")("publishLSPlatformDeidentifiedPayload").__setRef("LSPlatformTaskSystemTransport"),n=new Set([632,765,60011,1006,1018].map(function(a){return a.toString()}));a=function(){function a(a,e,f,g){var h=this;this.key="ls";this.$8=!1;this.$18=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield c("MWPBeginHandlingPendingTasksForQueue")(h.$1,{ignoreSoftDelay:b,queueName:a}));for(a of b)yield h.$17(d("LSShape").toRecord(a))});return function(b,c){return a.apply(this,arguments)}}();this.$1=a;this.$2=e;this.$3=f;this.$4=g;this.$8=d("LSDatabaseProviderType").isProviderPersisted(a);this.$5=new(c("LSPlatformRequestScheduler"))();this.$6=new(c("LSPlatformServerResponseHandler"))(f);this.$7=this.$9();this.$10()}var e=a.prototype;e.$11=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!(c("gkx")("5962")||c("isInstamadillo")())){var d=(yield this.$2.publish(b));return d}d=a.filter(function(a){return a.label!=null&&n.has(a.label)});if(d.length<a.length){d.length>0&&c("FBLogger")("maw_ohai").mustfix("Deidentifed tasks label %s sent together with normal tasks",d[0].label);a=(yield this.$2.publish(b));return a}a=d[0];d=(yield m.load());d=(yield d(babelHelpers["extends"]({},b,{taskLabel:a.label})));return d});function d(b,c){return a.apply(this,arguments)}return d}();e.$12=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$1.runInTransaction(function(b){return c("LSHandleTaskSendFailureForQueue2")(b,a)},"readwrite",void 0,void 0,f.id+":153")});function d(b){return a.apply(this,arguments)}return d}();e.$13=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield this.$1.runInTransaction(function(b){return c("LSHandleTaskSendSuccessForQueue2")(b,a)},"readwrite","background",void 0,f.id+":162")});function d(b){return a.apply(this,arguments)}return d}();e.$14=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=c("LSVec").toArray(a.tasks).slice(0).map(function(a){return d("LSShape").toRecord(a)});a=a[0];if(a==null)return;a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(this.$1.tables.pending_tasks).getKeyRange(a.task_id)));return a==null?void 0:a.dataTraceId});function e(b){return a.apply(this,arguments)}return e}();e.$15=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=this;if(a.network_payload==null)return;var g=d("LSShape").toRecord(a.network_payload);(k||(k=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return g&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSending(g.tasks))});var i=this.$4;try{yield (j||(j=b("Promise"))).all(c("LSVec").toArray(g.tasks).map(function(a){return d("LSShape").toRecord(a)}).map(function(b){var g=c("LSPlatformRequestId").generate();return f.$11([b],{payload:d("LSJson").stringify(d("LSShape").ofRecord({label:b.label,payload:b.payload,version:i})),queueName:a.queue_name,requestId:g,syncChannel:d("LSMailboxInitialSyncCursor").syncChannel,type_:(h||(h=d("I64"))).of_int32(e)})}))}catch(a){}});function e(b,c){return a.apply(this,arguments)}return e}();e.$16=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){if(a.network_payload==null)return;var f=d("LSShape").toRecord(a.network_payload),g=c("LSVec").toArray(f.tasks).map(function(a){return d("LSShape").toRecord(a)}),j=(yield this.$14(f));(k||(k=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return f&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSending(f.tasks))});var l=c("LSPlatformRequestId").generate(),m,n=c("qex")._("789");if(n!=null&&n!=="default"){var o=n+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel)+"."+e.toString();d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o)}try{m=(yield this.$11(g,{payload:d("LSJson").stringify(d("LSShape").ofRecord(babelHelpers["extends"]({},f,{version_id:this.$4},j==null?{}:{data_trace_id:j}))),queueName:a.queue_name,requestId:l,syncChannel:d("LSMailboxInitialSyncCursor").syncChannel,type_:(h||(h=d("I64"))).of_int32(e)}))}catch(b){if(n!=null&&n!=="default"){o=n+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel)+"."+e.toString();d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception");b.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception.timeout"):b.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception.notconnected")}b.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout"):b.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected?(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_notconnected"),c("FBLogger")("messenger_web_product").warn("Publishing a task to the server not connected")):(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic"),c("FBLogger")("messenger_web_product").warn("Error while publishing a task for request: %s, error %s",e,JSON.stringify(b)));yield this.$12(a.queue_name)}if(m!=null&&m.type==="taskresponse")try{j=m.downloadTask;var p=m.payload;l={experiments:p.ex,sp:p.sp,syncScript:p.payload,target:p.target,taskNames:g.map(function(a){return a.label}).filter(Boolean)};this.$8?yield this.$6.evalWhenReady(j,l):yield this.$3(l);yield this.$13(a.queue_name);(k||(k=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return f&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSent(f.tasks,p.payload))})}catch(b){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure"),c("FBLogger")("messenger_web_product").catching(b).mustfix("Encountered an error while processing a task response via realtime transport"),yield this.$12(a.queue_name)}});function e(b,c){return a.apply(this,arguments)}return e}();e.decideWhatToDoWithTask=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h=this,i=(yield c("MWPBeginHandlingPendingTasksForQueue")(a,{fireAndForgetTask:g,ignoreSoftDelay:!1,queueName:e,transportKey:f}));c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){for(var a of i)yield h.$17(d("LSShape").toRecord(a))})())});function e(b,c,d,e){return a.apply(this,arguments)}return e}();e.$17=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=this.$5,f=this.$18;function g(a,b){e.schedule(function(){c("promiseDone")(f(a,!1))},a,b!=null?(h||(h=d("I64"))).to_float(b):l)}var i=(h||(h=d("I64"))).to_int32(a.work_item_type);switch(i){case 1:yield this.$16(a,3);break;case 5:yield this.$15(a,4);break;case 3:g(a.queue_name,a.next_sync_ms);break;case 2:yield b("cr:4031").handleLSWork(this.$1,a,d("CurrentMessengerUser").getAccountID());break;case 4:break;default:c("FBLogger")("messenger_web_product").warn("Unknown Task type of %s",i)}});function e(b){return a.apply(this,arguments)}return e}();e.$9=function(){var a=this,e=this.$1;return this.$2.onReconnect(function(){c("promiseDone")(e.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.network_requests).bounds({gte:d("ReQL").key("")})));yield (j||(j=b("Promise"))).all(e.map(function(b){b=b.taskQueueName;return c("LSHandleTaskSendFailureForQueue2")(a,b)}))});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":467")),a.$10()})};e.$10=function(){var a=this;d("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(b){b=b.queueName;return a.decideWhatToDoWithTask(a.$1,b)})};e.cleanup=function(){this.$7()};return a}();g["default"]=a}),98);
__d("LSVersion",[],(function(a,b,c,d,e,f){e.exports="8204800716312237"}),null);
__d("MWPExecuteTaskBridge",["FBLogger","QuickPerformanceLogger","cr:6551"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,d,e){var f=d.event,g=d.taskID;(h||(h=c("QuickPerformanceLogger"))).markerPoint(f,"execute_task_through_bridge",{instanceKey:g});if(b("cr:6551")==null||b("cr:6551")[e]==null){(h||(h=c("QuickPerformanceLogger"))).markerPoint(f,"handler_not_found",{instanceKey:g});throw c("FBLogger")("ls_web_init").mustfixThrow("No bridge task handler found for %s",e)}h.markerPoint(f,"bridge_api_call",{instanceKey:g});return b("cr:6551")[e](a,d)}g.executeTask=a}),98);
__d("MWPHandleNativeTaskBatched",["FBLogger","I64","LSHandleTaskSendSuccessForQueue2","LSJson","LSShape","LSSyncStoredProcedureUtils","LSVec","MWPExecuteTaskBridge","Promise","QuickPerformanceLogger","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=new Set();function l(a){try{var b=a.payload!==""?d("LSJson").parse(a.payload):"";return b}catch(b){throw c("FBLogger")("ls_web_init").catching(b).mustfix("parseLSTaskReqType: Error parsing native task payload for queue: %s, falling back to null payload",a.queue_name)}}function m(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g){if(k.has((j||(j=d("I64"))).to_string(e.task_id))){c("FBLogger")("ls_web_init").warn("MWPHAndleNativeTask: Task is already being processed, skipping");return(i||(i=b("Promise"))).resolve()}k.add((j||(j=d("I64"))).to_string(e.task_id));var m=j.to_float(e.task_id),n=c("qpl")._(164763515,"1216");(h||(h=c("QuickPerformanceLogger"))).markerStart(n,m);if(e.label==null){c("FBLogger")("ls_web_init").warn("MWPHandleNativeTask: Cannot find a handler for task if task label is empty");(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"null_task_label",{instanceKey:m});h.markerEnd(n,3,m);k["delete"]((j||(j=d("I64"))).to_string(e.task_id));return a.runInTransaction(function(a){return a.pending_tasks["delete"](e.task_id)},"readwrite",void 0,void 0,f.id+":81")}var o;try{(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"parse_task",{instanceKey:m}),o=l(e)}catch(a){(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"parse_task_failed",{instanceKey:m});c("FBLogger")("ls_web_init").catching(a);k["delete"]((j||(j=d("I64"))).to_string(e.task_id));return}var p=e.label;h.markerAnnotate(n,{string:{source:"MWPHandleNativeTaskBatched_handleTask",taskName:p}},{instanceKey:m});try{(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"task_execute",{instanceKey:m}),yield d("MWPExecuteTaskBridge").executeTask(o,{actorID:g,event:n,source:"MWPHandleNativeTaskBatched_handleTask",taskID:(j||(j=d("I64"))).to_float(e.task_id)},p),yield a.runInTransaction(function(a){return a.pending_tasks["delete"](e.task_id)},"readwrite",void 0,void 0,f.id+":130"),h.markerEnd(n,2,m)}catch(g){yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield a.pending_tasks.get(e.task_id));if(b!=null)return d("LSSyncStoredProcedureUtils").incrementPendingTaskFailureCount(a,b)});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":141"),(h||(h=c("QuickPerformanceLogger"))).markerPoint(n,"task_execute_failed",{instanceKey:m}),h.markerEnd(n,3,m),c("FBLogger")("ls_web_init").catching(g).mustfix("Error handling native task for %s.",e.label)}k["delete"](j.to_string(e.task_id))});return n.apply(this,arguments)}function a(a,b,c){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,g){var h=e.network_payload,k=e.queue_name;if(h==null){c("FBLogger")("ls_web_init").warn("MWPHAndleNativeTask: network_payload is empty, there's nothing to handle");return(i||(i=b("Promise"))).resolve()}e=d("LSShape").toRecord(h);h=c("LSVec").toArray(e.tasks).map(function(a){return d("LSShape").toRecord(a)});e=h.map(function(b){return m(a,b,g)});try{yield (i||(i=b("Promise"))).all(e),yield a.runInTransaction(function(a){return c("LSHandleTaskSendSuccessForQueue2")(a,k)},"readwrite",void 0,void 0,f.id+":184")}catch(e){c("FBLogger")("ls_web_init").warn("MWPHAndleNativeTask: tasks network_payload is empty, there's nothing to handle",k);try{yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("LSSyncStoredProcedureUtils").incrementNetworkRequestsTaskFailureCount(a,k,(j||(j=d("I64"))).neg_one),yield d("LSSyncStoredProcedureUtils").closeEpoch(a,k,j.neg_one)});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":194")}catch(a){c("FBLogger")("ls_web_init").catching(a).mustfix("Error bumping failure cound for task")}}});return o.apply(this,arguments)}e={handleLSWork:a};g["default"]=e}),98);
__d("MWPlatformTaskSystem",["LSPlatformRequestScheduler","MWPlatformTaskUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){var e=this;this.$1=a;this.$2=b;this.$3=new(c("LSPlatformRequestScheduler"))();this.$4=d("MWPlatformTaskUtils").checkQueuesWhenPendingTaskTableUpdates(a,function(b){var c=b.queueName;b=b.transportKey;return e.$6(a,c,b,!1)});this.$5=d("MWPlatformTaskUtils").checkQueuesWhenPendingFireForgetTaskTableUpdates(a,function(b){var c=b.queueName;b=b.transportKey;return e.$6(a,c,b,!0)});this.$7()}var e=a.prototype;e.$6=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){yield this.$2.decideWhatToDoWithTask(a,b,c,d)});function c(b,c,d,e){return a.apply(this,arguments)}return c}();e.$7=function(){var a=this;d("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(b){b=b.queueName;return a.$6(a.$1,b)})};e.cleanup=function(){this.$4.forEach(function(a){return a()}),this.$5.forEach(function(a){return a()}),this.$2.cleanup()};return a}();g["default"]=a}),98);
__d("XPlatRelayEnvironment",["CometRelayEnvironment","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){throw c("err")("RelayEnvironment is already set")}function b(){return c("CometRelayEnvironment")}g.setRelayEnvironment=a;g.getRelayEnvironment=b}),98);
__d("getMWLSRegion",["MessengerWebRegion"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("MessengerWebRegion").regionNullable;return a==null?"":a}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("DisappearingMessagesMode",[],(function(a,b,c,d,e,f){a=Object.freeze({OFF:0,ON:1,OPEN_ON_DEPRECATED_DO_NOT_USE:2});f["default"]=a}),66);
__d("IGDXMAAttachmentUtil",["bx"],(function(a,b,c,d,e,f,g){"use strict";d=c("bx").getURL(c("bx")("13341"));var h=String.fromCodePoint(128293),i=String.fromCodePoint(128546),j=String.fromCodePoint(128079),k=String.fromCodePoint(128558),l=String.fromCodePoint(128514),m=String.fromCodePoint(128525);function a(a){return a!=null?a===h||a===i||a===j||a===k||a===l?!0:a===m:!1}function b(a,b){return a==="xma_ig_comment_action_url"&&b==="xma_ig_comment_media_action_url"}g.DEFAULT_PROFILE_URL=d;g.isEmojiReaction=a;g.isXmaPostComment=b}),98);
__d("MAWUnsafeCoerce",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.unsafeCoerce=a}),66);
__d("WAAssertUnreachable",["err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){throw c("err")("Impossible value, the default statement should never be reached for value: "+a)}g["default"]=a}),98);
__d("WAJids",["WAAssertUnreachable","err"],(function(a,b,c,d,e,f,g){"use strict";var h=0,i="@me",j="@system",k="status@broadcast",aa="0@s.whatsapp.net",l="@g.us",m=/^([1-9][0-9]{0,19}|(?!10)[1-9][0-9]{4,19}-[1-9][0-9]{9})@g.us$/,ba="@call",n="@msgr",ca="msgr",o="@interop",da="interop",p=/^([1-9][0-9]{0,2}-[1-9][0-9]{0,14}(:[0])?)@interop$/,q=/^([1-9][0-9]{0,2}-[1-9][0-9]{0,14}(:[0])?)@interop$/,r=/^([1-9][0-9]{0,19}(:[1-9][0-9]{0,2})?)@msgr$/,s=/^([1-9][0-9]{0,19})@msgr$/,t=/^([1-9][0-9]{0,19})(:0)?@msgr$/,ea="@s.whatsapp.net",fa="s.whatsapp.net",u="@s.whatsapp.net",v="s.whatsapp.net",w="lid",x="@newsletter",y=/^([1-9][0-9]{0,19})@newsletter$/,z=/^(0|((?!10)[1-9][0-9]{4,19}(\.[0-9]{1,2})?(:[0-9]{1,2})))@s.whatsapp.net$/,A=/^(0|((?!10)[1-9][0-9]{4,19})(\.[0-9]{1,2})?)@s.whatsapp.net$/,B="@lid",ga="lid",C=/^([1-9][0-9]{0,14})@lid$/,D=/^([1-9][0-9]{0,14}(:[0-9]{1,2})?)@lid$/,ha="@broadcast",E=/^(status|location|[1-9][0-9]{0,19})@broadcast$/,F=/^([0-9a-fA-F]{18,32})@call$/,G="@hosted",H="hosted",I=/^(((?!10)[1-9][0-9]{4,19})):99@hosted$/,J="@hosted.lid",K="hosted.lid",L=/^([1-9][0-9]{0,14}):99@hosted.lid$/,M="@bot",ia=/^[1-9][0-9]{0,19}(:0)?@bot$/,ja="16505361212"+u,ka=/([0-9a-zA-Z-:]+)@(g\.us|call|s\.whatsapp\.net|broadcast|msgr|lid)/g;function a(a){return""+a+u}function b(a){return""+a+B}function N(a){return""+a+n}function d(a){return a.endsWith(l)?a:""+a+l}function e(a){return a.endsWith(x)?a:""+a+x}function f(a){return a.endsWith(G)?a:""+a+G}function la(a){return a.endsWith(J)?a:""+a+J}function ma(){return l}function O(a){if(a.endsWith(u))return a.slice(0,-u.length);else if(a.endsWith(n))return a.slice(0,-n.length);else if(a.endsWith(o))return a.slice(0,-o.length);else if(a.endsWith(B))return a.slice(0,-B.length);else if(a.endsWith(M))return a.slice(0,-M.length);else throw c("err")('userIdFromJid called with non-user jid "'+a+'"')}function na(a,b){return Y(O(a)+":"+b+u)}function oa(a,b){return Z(O(a)+":"+b+n)}function pa(a,b){return xb(P(a)+":"+b+B)}function qa(a,b){return X(O(a)+":"+b+W(a))}function ra(a){return""+a+ha}function sa(a){return a.split("@")[0]}function ta(a){a=a.split("@")[0];a=a.split(":");var b=a[0];a=a[1];a=parseInt(a,10);return{userId:b,deviceID:a}}function ua(a){a=ta(a);return a.deviceID}function va(a,b){if(a===i||a===j)return b;else return sa(a)}function wa(a){return a===i||a===j?null:a}function xa(a){if(a===i||a===j)return null;return!a.endsWith(u)?null:a}function ya(a){if(!a.endsWith(u))throw c("err")('phoneNumberFromJid called with non-user jid "'+a+'"');return a.slice(0,-u.length)}function za(a){if(a.endsWith(u))return ya(a);else if(a.endsWith(B))return P(a);throw c("err")('lidOrPhoneFromUserJid called with non phone or lid jid "'+a+'"')}function Aa(a){return a.endsWith(u)||a.endsWith(o)||a.endsWith(n)||a.endsWith(B)?a:null}function Ba(a){return a.endsWith(u)?a:null}function Ca(a){return a===k?null:$(a)}function Da(a){return a===k?null:$(a)}function Ea(a){return a===k?k:null}function P(a){if(!a.endsWith(B))throw c("err")('lidFromLidUserJid called with non-LidUserJid "'+a+'"');return a.slice(0,-B.length)}function Q(a){a=a.split("@");var b=a[0];a=a[1];b=b.split(":")[0];b=b.split(".")[0];a===H&&(a=v);a===K&&(a=w);return yb(b+"@"+a)}function Fa(a){return Q(a)}function Ga(a){return Q(a)}function Ha(a){if(a.jidType==="phoneDevice")return a.deviceJid;else if(a.jidType==="interopDevice")return a.deviceJid;else if(a.jidType==="lidDevice")return a.deviceJid;else if(a.jidType==="msgrDevice")return a.deviceJid;else if(a.jidType==="lidUser")return a.userJid;else if(a.jidType==="interopUser")return a.userJid;else if(a.jidType==="msgrUser")return a.userJid;else if(a.jidType==="phoneUser")return a.userJid;else if(a.jidType==="group")return a.groupJid;else if(a.jidType==="status")return a.statusJid;else if(a.jidType==="call")return a.callJid;else if(a.jidType==="newsletter")return a.newsletterJid;else if(a.jidType==="hosted")return a.hostedDeviceJid;else if(a.jidType==="hostedLid")return a.hostedLidDeviceJid;else if(a.jidType==="bot")return a.userJid;else{a.jidType;return a.broadcastJid}}function Ia(a){return Y(O(a)+":"+h+u)}function Ja(a){return Z(O(a)+":"+h+n)}function Ka(a){return pa(a,h)}function La(a){return ua(a)===h}function Ma(a){return Cb(a)}function Na(a){return a}function R(a){a=a.split("@");var b=a[0];a=a[1];b=b.split(":");var c=b[0];b=b[1];c=c.split(".");var d=c[0];c=c[1];return{user:d,device:b,agent:c,server:a}}function Oa(a){a=R(a);var b=a.user,c=a.agent;c=c===void 0?"0":c;var d=a.device;d=d===void 0?"0":d;a=a.server;return b+"."+c+":"+d+"@"+a}function Pa(a){switch(a.jidType){case"interopUser":return a.userJid;case"lidUser":return a.userJid;case"msgrUser":return a.userJid;case"phoneUser":return a.userJid;case"group":return a.groupJid;case"status":return a.statusJid;case"interopDevice":return a.deviceJid;case"lidDevice":return a.deviceJid;case"msgrDevice":return a.deviceJid;case"phoneDevice":return a.deviceJid;case"broadcast":return a.broadcastJid;case"call":return a.callJid;case"newsletter":return a.newsletterJid;case"hosted":return a.hostedDeviceJid;case"hostedLid":return a.hostedLidDeviceJid;case"bot":return a.userJid;default:return c("WAAssertUnreachable")(a.jidType)}}function Qa(a){if(a===k)return{jidType:"status",statusJid:k};else if(A.test(a))return{jidType:"phoneUser",userJid:zb(a)};else if(q.test(a))return{jidType:"interopUser",userJid:Ab(a)};else if(s.test(a))return{jidType:"msgrUser",userJid:Bb(a)};else if(t.test(a)){var b=a.substr(0,a.indexOf(":"));return{jidType:"msgrUser",userJid:N(b)}}else if(z.test(a))return{jidType:"phoneDevice",deviceJid:Y(a)};else if(p.test(a))return{jidType:"interopDevice",deviceJid:wb(a)};else if(r.test(a))return{jidType:"msgrDevice",deviceJid:Z(a)};else if(m.test(a))return{jidType:"group",groupJid:a.endsWith(l)?a:""+a+l};else if(E.test(a))return{jidType:"broadcast",broadcastJid:a};else if(F.test(a))return{jidType:"call",callJid:a};else if(C.test(a))return{jidType:"lidUser",userJid:a};else if(D.test(a))return{jidType:"lidDevice",deviceJid:a};else if(y.test(a))return{jidType:"newsletter",newsletterJid:a};else if(I.test(a))return{jidType:"hosted",hostedDeviceJid:a};else if(L.test(a))return{jidType:"hostedLid",hostedLidDeviceJid:a};else if(ia.test(a))return{jidType:"bot",userJid:a};else return{jidType:"unknown"}}function Ra(a){return a==="status@broadcast"?a:null}function Sa(a){if(A.test(a)||q.test(a)||s.test(a)||C.test(a))return a;else if(t.test(a)){a=a.substr(0,a.indexOf(":"));return N(a)}else return null}function Ta(a){return E.test(a)?a:null}function Ua(a){if(z.test(a)||r.test(a)||p.test(a)||D.test(a)||I.test(a)||L.test(a))return a;if(A.test(a))return sb(a);return ia.test(a)?tb(a):null}function Va(a){return p.test(a)?a:null}function S(a){return m.test(a)?a:null}function Wa(a){return Ra(a)||S(a)||Ta(a)?a:null}function Xa(a){return F.test(a)?a:null}function Ya(a){return a==="s.whatsapp.net"||a==="g.us"||a==="call"?a:null}function Za(a){return Sa(a)||S(a)}function $a(a){return y.test(a)?a:null}function ab(a){return I.test(a)?a:null}function bb(a){return L.test(a)?a:null}function cb(a){return Aa(a)==null?$(a):null}function db(a){a=R(a);var b=a.user,c=a.device;c=c===void 0?"0":c;a=a.server;return Y(b+":"+c+"@"+a)}function eb(a){if(a.endsWith(l))return a.slice(0,-l.length);else throw c("err")('groupId called with non-group jid "'+a+'"')}function fb(a){var b=Qa(a);if(b.jidType==="unknown")return a;if(b.jidType==="status")return b.statusJid;b.jidType;return Pa(b).replace(/^([^@]*)([^@][^@][^@][^@])@(.*)$/,"...$2@$3")}function gb(a){return!a.includes("@")?a:a.replace(ka,fb)}function T(a){if(a.endsWith(l))return $(a);else return null}function U(a,b){if(a.endsWith(u))return b.phoneUser(a);else if(a.endsWith(n))return b.msgrUser(a);else if(a.endsWith(o))return b.interopUser(a);else if(a.endsWith(B))return b.lidUser(a);else if(T(a)!=null)return b.group($(a));throw c("err")("Can not switch on chat jid "+a)}function hb(a,b){if(a.endsWith(n))return b.user(a);else if(T(a)!=null)return b.group(a);throw c("err")("Can not switch on chat jid "+a)}function V(a,b){if(a.endsWith(u))return b.user(a);else if(T(a)!=null)return b.group(a);throw c("err")("Can not switch on chat jid "+a)}function ib(a,b){return U(a,{lidUser:function(a){return b.user(a)},interopUser:function(a){return b.user(a)},msgrUser:function(a){return b.user(a)},phoneUser:function(a){return b.user(a)},group:function(a){return b.group(a)}})}function jb(a,b){return a===k?b.status():V(a,{user:b.user,group:b.group})}function kb(a,b){return a===k?b.status():U(a,{interopUser:b.interopUser,phoneUser:b.phoneUser,msgrUser:b.msgrUser,lidUser:b.lidUser,group:b.group})}function lb(a,b){return a===k?b.multicast(k):V(a,{user:b.user,group:b.multicast})}function mb(a){return a.endsWith(B)}function nb(a){return a==="@me"}function ob(a){return a==="@system"}function pb(){return n}function qb(){return u}function rb(){return ea}function W(a){if(a.endsWith(u))return u;else if(a.endsWith(n))return n;else if(a.endsWith(B))return B;else if(a.endsWith(M))return M;else throw c("err")('userDomainFromJid called with non-user jid "'+a+'"')}function sb(a){return X(O(a)+":"+h+W(a))}function tb(a){return X(""+O(a)+W(a))}function ub(a){a=a.platform;var b=a==="msgr"?n:u;function c(a){return""+a+b}function d(){return b}return{toUserJid:c,getUserDomain:d}}function vb(a){return a}function X(a){return a}function Y(a){return a}function Z(a){return a}function wb(a){return a}function xb(a){return a}function yb(a){return a}function zb(a){return a}function Ab(a){return a}function Bb(a){return a}function $(a){return a}function Cb(a){return a}function Db(a){return a}function Eb(a){return a}function Fb(a){return a}function Gb(a){return U(a,{group:function(a){return eb(a)},lidUser:function(a){return O(a)},interopUser:function(a){return O(a)},phoneUser:function(a){return O(a)},msgrUser:function(a){return O(a)}})}function Hb(){return ba}g.DEFAULT_DEVICE_ID=h;g.AUTHOR_ME=i;g.AUTHOR_SYSTEM=j;g.STATUS_JID=k;g.PSA_JID=aa;g.MSGR_USER_DOMAIN=n;g.MSGR_USER_JID_SUFFIX=ca;g.INTEROP_DOMAIN=o;g.INTEROP_USER_JID_SUFFIX=da;g.WA_SERVER_JID_SUFFIX=fa;g.WA_USER_DOMAIN=u;g.WA_USER_JID_SUFFIX=v;g.WA_LID_SUFFIX=w;g.WA_NEWSLETTER_JID_DOMAIN=x;g.LID_DOMAIN=B;g.LID_SUFFIX=ga;g.HOSTED_DOMAIN=G;g.HOSTED_SUFFIX=H;g.HOSTED_LID_DOMAIN=J;g.HOSTED_LID_SUFFIX=K;g.BOT_DOMAIN=M;g.SURVEY_USER_JID=ja;g.toPhoneUserJid=a;g.toLidUserJid=b;g.toMsgrUserJid=N;g.toGroupJid=d;g.toNewsletterJid=e;g.toHostedDeviceJid=f;g.toHostedLidDeviceJid=la;g.getGroupDomain=ma;g.userIdFromJid=O;g.toPhoneDeviceJid=na;g.toMsgrDeviceJid=oa;g.toLidDeviceJid=pa;g.toDeviceJid=qa;g.toBroadcastJid=ra;g.extractUserId=sa;g.extractDeviceIDParts=ta;g.extractDeviceId=ua;g.authorToUserId=va;g.authorAsUserJid=wa;g.authorAsPhoneUserJid=xa;g.phoneNumberFromJid=ya;g.lidOrPhoneFromUserJid=za;g.interpretAsUserJid=Aa;g.interpretAsPhoneUserJid=Ba;g.asChatJid=Ca;g.asPhoneChatJid=Da;g.asStatusJid=Ea;g.lidFromLidUserJid=P;g.extractUserJid=Q;g.extractPhoneUserJid=Fa;g.extractLidUserJid=Ga;g.extractJidFromJidWithType=Ha;g.defaultPhoneDeviceJidForUser=Ia;g.defaultMsgrDeviceJidForUser=Ja;g.defaultLidDeviceJidForLidUserJid=Ka;g.isPrimaryDevice=La;g.interpretAsDeviceId=Ma;g.interpretAsNumber=Na;g.parseJidParts=R;g.fullFormDeviceJidString=Oa;g.extractFromJid=Pa;g.interpretAndValidateJid=Qa;g.validateStatusJid=Ra;g.validateUserJid=Sa;g.validateBroadcastJid=Ta;g.validateDeviceJid=Ua;g.validateInteropDeviceJid=Va;g.validateGroupJid=S;g.validateMulticastJid=Wa;g.validateCallJid=Xa;g.validateDomainJid=Ya;g.validateChatJid=Za;g.validateNewsletterJid=$a;g.validateHostedDeviceJid=ab;g.validateHostedLidDeviceJid=bb;g.asMulticastJid=cb;g.stripAgentIdFromPhoneDeviceJid=db;g.groupIdFromJid=eb;g.sanitizeJidForLogging=fb;g.maybeSanitizeLogLineText=gb;g.interpretAsGroupJid=T;g.switchOnChatJidType=U;g.switchOnMsgrChatJidType=hb;g.switchOnPhoneChatJidType=V;g.switchOnUserChatJidType=ib;g.switchOnPhoneJidType=jb;g.switchOnJidType=kb;g.switchOnMulticastJidType=lb;g.isLidUser=mb;g.isAuthorMe=nb;g.isAuthorSystem=ob;g.getMsgrUserDomain=pb;g.getWhatsappUserDomain=qb;g.getServerDomain=rb;g.defaultDeviceJidForUser=sb;g.defaultDeviceJidForBot=tb;g.createJidUtils=ub;g.unsafeCoerceToChatJid=vb;g.unsafeCoerceToDeviceJid=X;g.unsafeCoerceToPhoneDeviceJid=Y;g.unsafeCoerceToMsgrDeviceJid=Z;g.unsafeCoerceToInteropDeviceJid=wb;g.unsafeCoerceToLidDeviceJid=xb;g.unsafeCoerceToUserJid=yb;g.unsafeCoerceToPhoneUserJid=zb;g.unsafeCoerceToInteropUserJid=Ab;g.unsafeCoerceToMsgrUserJid=Bb;g.unsafeCoerceToGroupJid=$;g.unsafeCoerceToDeviceId=Cb;g.unsafeCoerceToNewsletterJid=Db;g.unsafeCoerceToHostedDeviceJid=Eb;g.unsafeCoerceToHostedLidDeviceJid=Fb;g.threadIdForChatJid=Gb;g.getGroupCallDomain=Hb}),98);
__d("InstamadilloMessageIdUtils",["FBLogger","I64","MAWUnsafeCoerce","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){var c;(h||(h=d("I64"))).isI64(a)?c=(h||(h=d("I64"))).to_string(a):c=a;return c+":"+b}function a(a){a=a.split(":");if(a.length!==2)throw c("FBLogger")("igd_web_on_msgr").mustfixThrow("Invalid instamadillo message id format. Format is <threadKey>:<stanzaId>.");return{stanzaId:a[1],threadKey:a[0]}}function b(a){a=a.split(":");if(a.length!==2){c("FBLogger")("igd_web_on_msgr").warn("Invalid instamadillo message id format. Format is <threadKey>:<stanzaId>.");return null}return{stanzaId:a[1],threadKey:a[0]}}function e(a){a=a.message.decrypted.id;return j(a)}function j(a){var b=a.externalId;a=d("WAJids").threadIdForChatJid(a.chat);return i(a,b)}function f(a,b,c){return{author:d("WAJids").toMsgrUserJid(c),chat:d("WAJids").toMsgrUserJid((h||(h=d("I64"))).to_string(a)),externalId:d("MAWUnsafeCoerce").unsafeCoerce(b)}}g.toInstamadilloMessageId=i;g.fromInstamadilloMessageId=a;g.maybeFromInstamadilloMessageId=b;g.getInstamadilloMessageIdFromStanza=e;g.getInstamadilloMessageIdFromProtocolMsgId=j;g.toProtocolMsgId=f}),98);
__d("IntervalList",["FBLogger","ReQLBounds","ReStoreKeyComparer"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){if(a==null)throw c("FBLogger")("messenger_web_product").mustfixThrow("must not be null");return a}function a(a,b){var c=new Map(),e=new Map(),f=new Map();function g(b,c){return c==null?!0:(c.gt!==void 0?a(b,c.gt)>0:c.gte!==void 0?a(b,c.gte)>=0:!0)&&(c.lt!==void 0?a(b,c.lt)<0:c.lte!==void 0?a(b,c.lte)<=0:!0)}function* k(a){var f=0;while(f<a.length&&e.size){f++;var i=a.slice(0,f);f<b&&i.push((h||(h=d("ReStoreKeyComparer"))).MAX_KEY);i=e.get(JSON.stringify(i));if(i!=null)for(i of i)yield i}for(i of c.entries()){f=i[0];var j=i[1];c.has(f)&&g(a,j)&&(yield f)}}function l(a){var b=f.get(a);if(b!=null){f["delete"](a);var d=j(e.get(b));d["delete"](a);d.size===0&&e["delete"](b)}else c["delete"](a)}function m(a,g){var h;if(a&&a.gte!=null&&a.lte!=null&&(h=JSON.stringify((i||(i=d("ReQLBounds"))).nextKey(a.gte,b)))===JSON.stringify(a.lte)){var j=e.get(h);j==null&&(j=new Set(),e.set(h,j));j.add(g);f.set(g,h)}else c.set(g,a)}return{"delete":l,findIntersecting:k,set:m}}g["default"]=a}),98);
__d("LSClientSchemaType",[],(function(a,b,c,d,e,f){"use strict";a="maw";f.MAW_SCHEMA_NAME=a}),66);
__d("LSDatabaseSingletonLazyWrapper",["LSDatabaseSingleton"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return(h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton}g["default"]=a}),98);
__d("LSDeleteAllCommunityChannelCategories",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.sequence([function(a){return b.forEach(b.db.table(182).fetch(),function(a){return a["delete"]()})},function(a){return b.forEach(b.db.table(9).fetch([[[b.i64.cast([0,20])]],"threadTypeLastActivityTimestampMs"]),function(a){return a["delete"]()})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteAllCommunityChannelCategoriesStoredProcedure";e.exports=a}),null);
__d("LSDeleteAllCommunityFolders",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.sequence([function(a){return b.forEach(b.db.table(162).fetch(),function(a){return a["delete"]()})},function(a){return b.forEach(b.db.table(9).fetch([[[b.i64.cast([0,17])]],"threadTypeLastActivityTimestampMs"]),function(a){return a["delete"]()})}])},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteAllCommunityFoldersStoredProcedure";e.exports=a}),null);
__d("LSDeleteThenInsertCmCommunityList",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(166).put({communityId:a[0]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSOmnistoreSettingsDeleteThenInsertCmCommunityListStoredProcedure";e.exports=a}),null);
__d("LSDeleteThenInsertCommunityFolder",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.filter(b.db.table(162).fetch([[[a[0]]]]),function(c){return b.i64.eq(c.folderId,a[0])&&b.i64.gt(b.i64.cast([0,80]),a[52])}).next().then(function(c){var d=c.done;c.value;return d?b.db.table(162).put({folderId:a[0],fbGroupId:a[1],name:a[2],memberCount:a[4],description:a[3],pictureUrl:a[5],pictureUrlFallback:a[6],pictureUrlExpirationTimestampMs:a[7],joiningChannelTaskId:a[8],afterJoiningOpenChannelId:a[10],capabilities:a[11],capabilities2:a[12],capabilities3:a[13],notificationSetting:a[14],notificationMutedUntil:a[15],sendsBlockedUntil:a[17],isHidden:a[18],hasSeenDisablingAlert:a[19],inviteLink:a[21],communityType:a[22],directInviteLink:a[23],enableState:a[24],takedownState:a[25],fbGroupType:a[28],threadCount:a[29],disableTimestamp:a[32],readTimestampMs:a[33],inviteStatus:a[37],blockedFromCommunityMemberCount:a[40],categoryCount:a[41],snippetText:a[42],coverPicUrl:a[43],coverPicUrlFallback:a[44],coverPicUrlExpirationTimestampMs:a[45],invitedThreadId:a[47],fbGroupUserParticipationApprovalStatus:a[48],ccAdminAssistRegistrationStatus:a[49],pauseStatus:a[50],isMember:a[51]}):0})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteThenInsertCommunityFolderStoredProcedure";e.exports=a}),null);
__d("LSSetThreadImageURL",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({threadPictureUrl:a[1]===""?void 0:a[1],threadPictureUrlFallback:a[2],threadPictureUrlExpirationTimestampMs:a[3],isCustomThreadPicture:a[4],shouldRoundThreadPicture:a[5]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxSetThreadImageURLStoredProcedure";e.exports=a}),null);
__d("LSDeleteThenInsertContact",["LSSetThreadImageURL"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.i64.eq(a[23],c.i64.cast([0,39423]))?d[0]=c.i64.cast([0,1]):(c.i64.eq(a[23],c.i64.cast([0,14342874]))?d[1]=c.i64.cast([0,2]):d[1]=void 0,d[0]=d[1]),c.filter(c.db.table(7).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.id,a[0])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))&&c.i64.gt(b.authorityLevel,a[21])}).next().then(function(b){var e=b.done;b.value;return e?c.db.table(7).put({id:a[0],profilePictureUrl:a[2],profilePictureFallbackUrl:a[3],profilePictureUrlExpirationTimestampMs:a[4],profilePictureLargeUrl:a[5],profilePictureLargeFallbackUrl:a[6],profilePictureLargeUrlExpirationTimestampMs:a[7],name:a[9],secondaryName:a[41],normalizedNameForSearch:a[10],normalizedSearchTerms:a[33],isMessengerUser:a[11],isMemorialized:a[12],isManagedByViewer:a[35],blockedByViewerStatus:a[14],rank:a[17],firstName:a[18],contactType:a[19],contactTypeExact:a[20],authorityLevel:a[21],messengerCallLogThirdPartyId:a[22],profileRingColor:a[23],requiresMultiway:a[24],blockedSinceTimestampMs:a[25],fbUnblockedSinceTimestampMs:a[47],canViewerMessage:a[26],profileRingColorExpirationTimestampMs:a[27],phoneNumber:a[28],emailAddress:a[29],workCompanyId:a[30],workCompanyName:a[31],workJobTitle:a[32],deviceContactId:a[34],workForeignEntityType:a[36],capabilities:a[37],capabilities2:a[38],profileRingState:d[0],contactViewerRelationship:a[39],gender:a[40],username:a[43],contactReachabilityStatusType:a[44],restrictionType:a[45],waConnectStatus:a[46],isEmployee:!1,pageType:a[48]}):0})},function(d){return c.storedProcedure(b("LSSetThreadImageURL"),a[0],a[2],a[3],a[4],!1,!0)}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSContactDeleteThenInsertContactStoredProcedure";e.exports=a}),null);
__d("LSDeleteThenInsertNotificationsSettingsGraphQLSnapshot",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(175).put({id:a[0],globalMuteUntil:a[1],showMessagePreview:a[4],isSoundOn:a[7],groupNotificationSetting:a[8],oneToOneNotificationSetting:a[9],replyReminderSetting:a[10],messageReminderDisabled:a[12],messageSound:a[13],ringtoneSound:a[14],newFriendBumpDisabledSetting:a[15],globalMuteMessageUntil:a[2],globalMuteCallUntil:a[3],includeInSwitchAccountBadges:a[11],dismissNfbThreadsCount:a[16],mutePageAccountMessageReminder:a[17]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSOmnistoreSettingsDeleteThenInsertNotificationsSettingsGraphQLSnapshotStoredProcedure";e.exports=a}),null);
__d("LSGroupRoomTruncate",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.forEach(b.filter(b.db.table(63).fetch(),function(a){return b.i64.neq(a.groupRoomType,void 0)&&b.i64.neq(a.groupRoomType,b.i64.cast([0,5]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSStoriesGroupRoomTruncateStoredProcedure";e.exports=a}),null);
__d("LSMessageRenderingType",[],(function(a,b,c,d,e,f){a=Object.freeze({DEFAULT:0,NON_COLLAPSIBLE_ADMIN_MESSAGE:1,HIDDEN:2,RICH_TEXT_COMMON_MARK:3});f["default"]=a}),66);
__d("LSMessageReplySourceType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,MESSAGE:1,STORY:2,FORWARD:3,FB_STORY_SHARE:4,IG_STORY_SHARE:5,LIGHTWEIGHT_STATUS:6,LIGHTWEIGHT_STATUS_REACTION:7,FB_FEED_POST:13,HIGHLIGHTS_TAB_POST_REPLY:14,HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:15,SHARED_ALBUM:16,AVATAR_DETAIL:17,NOTE_REPLY_ARMADILLO:18,HIGHLIGHTS_TAB_CARDS_FOR_MOM:19,HIGHLIGHTS_TAB_CARDS_FOR_BIRTHDAY:20,NOTE_MENTION:21});f["default"]=a}),66);
__d("LSMessageReplySourceTypeV2",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,MESSAGE:1,STORY:2,FORWARD:3,FB_STORY_SHARE:4,IG_STORY_SHARE:5,STORY_BASE64_ENCODED:6,LIGHTWEIGHT_STATUS:7,CLOSE_FRIENDS:8,XMA:9,IG_NOTE:10,CLOSE_FRIENDS_NOTE_REPLY:11,LIGHTWEIGHT_STATUS_REACTION:12,FB_FEED_POST:13,HIGHLIGHTS_TAB_POST_REPLY:14,HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:15,SHARED_ALBUM:16,AVATAR_DETAIL:17,NOTE_REPLY_ARMADILLO:18,HIGHLIGHTS_TAB_CARDS_FOR_MOM:19,HIGHLIGHTS_TAB_CARDS_FOR_BIRTHDAY:20,NOTE_MENTION:21,FB_STORY_MENTION:22});f["default"]=a}),66);
__d("LSMessageSendStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,SENDING_TO_SERVER:1,SERVER_RECEIVED:2,NON_RETRIABLE_ERROR:4,RETRIABLE_ERROR:5});f["default"]=a}),66);
__d("XPlatReactEventEmitter",["BaseEventEmitter"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("BaseEventEmitter")}),98);
__d("LSPlatformErrorChannel",["FBLogger","ODS","XPlatReactEventEmitter"],(function(a,b,c,d,e,f,g){"use strict";var h,i="onLSError",j=new(c("XPlatReactEventEmitter"))(),k=0,l=null;function a(a){l===null&&((h||(h=d("ODS"))).bumpEntityKey(3185,"lsplatform_error","first_error_emitted_to_"+k+"listeners"),k===0&&c("FBLogger")("messenger_web_product").mustfix("No listeners when emitting LS error %s",a.name)),l=a,j.emit(i,a)}function b(a){var b=j.addListener(i,a);k++;return function(){return b.remove()}}function e(){return l}function f(){j.removeAllListeners(i),l=null}f={TEST_ONLY_clear:f,emit:a,lastError:e,subscribe:b};g["default"]=f}),98);
__d("LSUpdateOrInsertThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(9).fetch([[[a[7]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?b.db.table(9).add({threadKey:a[7],lastReadWatermarkTimestampMs:a[1],authorityLevel:a[6],mailboxType:a[8],threadType:a[9],folderName:a[10],ongoingCallState:a[32],parentThreadKey:a[38],lastActivityTimestampMs:a[0],snippet:a[2],threadName:a[3],threadPictureUrl:a[4],needsAdminApprovalForNewParticipant:a[5],threadPictureUrlFallback:a[11],threadPictureUrlExpirationTimestampMs:a[12],removeWatermarkTimestampMs:a[13],muteExpireTimeMs:a[14],muteMentionExpireTimeMs:a[15],muteCallsExpireTimeMs:a[16],groupNotificationSettings:a[19],isAdminSnippet:a[20],snippetSenderContactId:a[21],snippetText:a[23],snippetStringHash:a[24],snippetStringArgument1:a[25],snippetAttribution:a[26],snippetAttributionStringHash:a[27],disappearingSettingTtl:a[28],disappearingSettingUpdatedTs:a[29],disappearingSettingUpdatedBy:a[30],cannotReplyReason:a[33],customEmoji:a[34],customEmojiImageUrl:a[35],outgoingBubbleColor:a[36],themeFbid:a[37],nullstateDescriptionText1:a[39],nullstateDescriptionType1:a[40],nullstateDescriptionText2:a[41],nullstateDescriptionType2:a[42],nullstateDescriptionText3:a[43],nullstateDescriptionType3:a[44],snippetHasEmoji:a[45],hasPersistentMenu:a[46],disableComposerInput:a[47],cannotUnsendReason:a[48],viewedPluginKey:a[49],viewedPluginContext:a[50],clientThreadKey:a[51],capabilities:a[52],shouldRoundThreadPicture:a[53],proactiveWarningDismissTime:a[54],isCustomThreadPicture:a[55],otidOfFirstMessage:a[56],normalizedSearchTerms:a[57],additionalThreadContext:a[58],disappearingThreadKey:a[59],isDisappearingMode:a[60],disappearingModeInitiator:a[61],unreadDisappearingMessageCount:a[62],lastMessageCtaId:a[64],lastMessageCtaType:a[65],lastMessageCtaTimestampMs:a[66],consistentThreadFbid:a[67],threadDescription:a[69],unsendLimitMs:a[70],capabilities2:a[78],capabilities3:a[79],syncGroup:a[82],threadInvitesEnabled:a[83],threadInviteLink:a[84],isAllUnreadMessageMissedCallXma:a[85],numUnreadSubthreads:a[86],subthreadCount:a[87],lastNonMissedCallXmaMessageTimestampMs:a[88],isHidden:a[89],threadInvitesEnabledV2:a[90],joinRequestApprovalSetting:a[93],hasPendingInvitation:a[94],eventStartTimestampMs:a[95],eventEndTimestampMs:a[96],takedownState:a[97],secondaryParentThreadKey:a[98],igFolder:a[99],inviterId:a[100],threadTags:a[101],isReadReceiptsDisabled:a[102],readReceiptsDisabledV2:a[103],threadStatus:a[104],threadSubtype:a[105],pauseThreadTimestamp:a[106],capabilities4:a[107],syncSource:a[108]}):(e=d.item,c[1]=e.lastActivityTimestampMs,c[3]=e.parentThreadKey,c[2]=e.disappearingThreadKey,c[4]=e.isDisappearingMode,b.i64.le(e.authorityLevel,a[6])?b.i64.gt(c[1],a[0])&&b.i64.neq(c[2],void 0)?(b.i64.eq(a[38],b.i64.cast([-1,4294967286]))&&b.i64.eq(c[3],b.i64.cast([0,0]))?(f=[c[3],e.folderName],c[5]=f[0],c[6]=f[1],f):(d=[a[38],a[10]],c[5]=d[0],c[6]=d[1],d),b.forEach(b.db.table(9).fetch([[[a[7]]]]),function(b){var d=b.update;b.item;return d({lastReadWatermarkTimestampMs:e.lastReadWatermarkTimestampMs,authorityLevel:a[6],threadType:a[9],folderName:c[6],ongoingCallState:a[32],parentThreadKey:c[5],lastActivityTimestampMs:c[1],snippet:a[2],threadName:a[3],threadPictureUrl:a[4],needsAdminApprovalForNewParticipant:a[5],threadPictureUrlFallback:a[11],threadPictureUrlExpirationTimestampMs:a[12],removeWatermarkTimestampMs:a[13],muteExpireTimeMs:a[14],muteMentionExpireTimeMs:a[15],muteCallsExpireTimeMs:a[16],groupNotificationSettings:a[19],isAdminSnippet:a[20],snippetSenderContactId:a[21],snippetText:a[23],snippetStringHash:a[24],snippetStringArgument1:a[25],snippetAttribution:a[26],snippetAttributionStringHash:a[27],disappearingSettingTtl:a[28],disappearingSettingUpdatedTs:a[29],disappearingSettingUpdatedBy:a[30],cannotReplyReason:a[33],customEmoji:a[34],customEmojiImageUrl:a[35],outgoingBubbleColor:a[36],themeFbid:a[37],nullstateDescriptionText1:a[39],nullstateDescriptionType1:a[40],nullstateDescriptionText2:a[41],nullstateDescriptionType2:a[42],nullstateDescriptionText3:a[43],nullstateDescriptionType3:a[44],snippetHasEmoji:a[45],hasPersistentMenu:a[46],disableComposerInput:a[47],cannotUnsendReason:a[48],viewedPluginKey:a[49],viewedPluginContext:a[50],clientThreadKey:a[51],capabilities:a[52],shouldRoundThreadPicture:a[53],proactiveWarningDismissTime:a[54],isCustomThreadPicture:a[55],otidOfFirstMessage:a[56],normalizedSearchTerms:a[57],additionalThreadContext:a[58],disappearingThreadKey:c[2],isDisappearingMode:c[4],disappearingModeInitiator:a[61],unreadDisappearingMessageCount:a[62],lastMessageCtaId:a[64],lastMessageCtaType:a[65],lastMessageCtaTimestampMs:a[66],consistentThreadFbid:a[67],threadDescription:a[69],unsendLimitMs:a[70],capabilities2:a[78],capabilities3:a[79],syncGroup:a[82],threadInvitesEnabled:a[83],threadInviteLink:a[84],isAllUnreadMessageMissedCallXma:a[85],numUnreadSubthreads:a[86],subthreadCount:a[87],lastNonMissedCallXmaMessageTimestampMs:a[88],isHidden:a[89],threadInvitesEnabledV2:a[90],joinRequestApprovalSetting:a[93],hasPendingInvitation:a[94],eventStartTimestampMs:a[95],eventEndTimestampMs:a[96],takedownState:a[97],secondaryParentThreadKey:a[98],igFolder:a[99],inviterId:a[100],threadTags:a[101],isReadReceiptsDisabled:a[102],readReceiptsDisabledV2:a[103],threadStatus:a[104],threadSubtype:a[105],pauseThreadTimestamp:a[106],capabilities4:a[107],syncSource:a[108],avatarStickerInstructionKeyId:void 0,avatarStickerId:void 0,avatarStickerThumbnailImageUrl:void 0,avatarStickerThumbnailImageMimeType:void 0,avatarStickerOriginalImageUrl:void 0,avatarStickerOriginalImageMimeType:void 0,hasPendingJoinRequest:void 0,pendingJoinRequestsCount:void 0,memberCount:void 0,admodCount:void 0,ctmAdId:void 0,ctmAdgroupId:void 0,ctmAdCampaignId:void 0,ctmAdCampaignGroupId:void 0,ctmAdAccountId:void 0,metadata:void 0})})):b.forEach(b.db.table(9).fetch([[[a[7]]]]),function(b){var d=b.update;b.item;return d({lastReadWatermarkTimestampMs:a[1],authorityLevel:a[6],threadType:a[9],folderName:a[10],ongoingCallState:a[32],parentThreadKey:a[38],lastActivityTimestampMs:a[0],snippet:a[2],threadName:a[3],threadPictureUrl:a[4],needsAdminApprovalForNewParticipant:a[5],threadPictureUrlFallback:a[11],threadPictureUrlExpirationTimestampMs:a[12],removeWatermarkTimestampMs:a[13],muteExpireTimeMs:a[14],muteMentionExpireTimeMs:a[15],muteCallsExpireTimeMs:a[16],groupNotificationSettings:a[19],isAdminSnippet:a[20],snippetSenderContactId:a[21],snippetText:a[23],snippetStringHash:a[24],snippetStringArgument1:a[25],snippetAttribution:a[26],snippetAttributionStringHash:a[27],disappearingSettingTtl:a[28],disappearingSettingUpdatedTs:a[29],disappearingSettingUpdatedBy:a[30],cannotReplyReason:a[33],customEmoji:a[34],customEmojiImageUrl:a[35],outgoingBubbleColor:a[36],themeFbid:a[37],nullstateDescriptionText1:a[39],nullstateDescriptionType1:a[40],nullstateDescriptionText2:a[41],nullstateDescriptionType2:a[42],nullstateDescriptionText3:a[43],nullstateDescriptionType3:a[44],snippetHasEmoji:a[45],hasPersistentMenu:a[46],disableComposerInput:a[47],cannotUnsendReason:a[48],viewedPluginKey:a[49],viewedPluginContext:a[50],clientThreadKey:a[51],capabilities:a[52],shouldRoundThreadPicture:a[53],proactiveWarningDismissTime:a[54],isCustomThreadPicture:a[55],otidOfFirstMessage:a[56],normalizedSearchTerms:a[57],additionalThreadContext:a[58],disappearingThreadKey:c[2],isDisappearingMode:c[4],disappearingModeInitiator:a[61],unreadDisappearingMessageCount:a[62],lastMessageCtaId:a[64],lastMessageCtaType:a[65],lastMessageCtaTimestampMs:a[66],consistentThreadFbid:a[67],threadDescription:a[69],unsendLimitMs:a[70],capabilities2:a[78],capabilities3:a[79],syncGroup:a[82],threadInvitesEnabled:a[83],threadInviteLink:a[84],isAllUnreadMessageMissedCallXma:a[85],numUnreadSubthreads:a[86],subthreadCount:a[87],lastNonMissedCallXmaMessageTimestampMs:a[88],isHidden:a[89],threadInvitesEnabledV2:a[90],joinRequestApprovalSetting:a[93],hasPendingInvitation:a[94],eventStartTimestampMs:a[95],eventEndTimestampMs:a[96],takedownState:a[97],secondaryParentThreadKey:a[98],igFolder:a[99],inviterId:a[100],threadTags:a[101],isReadReceiptsDisabled:a[102],readReceiptsDisabledV2:a[103],threadStatus:a[104],threadSubtype:a[105],pauseThreadTimestamp:a[106],capabilities4:a[107],syncSource:a[108],avatarStickerInstructionKeyId:void 0,avatarStickerId:void 0,avatarStickerThumbnailImageUrl:void 0,avatarStickerThumbnailImageMimeType:void 0,avatarStickerOriginalImageUrl:void 0,avatarStickerOriginalImageMimeType:void 0,hasPendingJoinRequest:void 0,pendingJoinRequestsCount:void 0,memberCount:void 0,admodCount:void 0,ctmAdId:void 0,ctmAdgroupId:void 0,ctmAdCampaignId:void 0,ctmAdCampaignGroupId:void 0,ctmAdAccountId:void 0,metadata:void 0})}):b.resolve())})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxUpdateOrInsertThreadStoredProcedure";e.exports=a}),null);
__d("LSPopulateCommunityFolderData",["LSDeleteThenInsertCommunityFolder","LSUpdateOrInsertThread"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[];return c.sequence([function(d){return c.sequence([function(d){return c.storedProcedure(b("LSDeleteThenInsertCommunityFolder"),a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],void 0,void 0,void 0,a[11],a[12],a[13],a[14],a[15],void 0,a[16],a[17],a[18],void 0,a[19],a[20],a[21],a[22],a[23],void 0,void 0,a[24],a[26],void 0,void 0,a[25],a[37],void 0,void 0,c.i64.cast([0,0]),a[29],void 0,c.i64.cast([0,1]),a[28],a[27],a[30],a[31],a[32],a[33],void 0,a[34],a[35],a[36],a[38],a[39],c.i64.cast([0,80]))},function(d){return c.storedProcedure(b("LSUpdateOrInsertThread"),a[8],a[9],a[10],a[2],a[5],void 0,c.i64.cast([0,80]),a[0],c.i64.cast([0,0]),c.i64.cast([0,17]),"community",a[6],a[7],c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,!1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,c.i64.cast([-1,4294967282]),void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,!1,void 0,void 0,void 0,void 0,c.i64.cast([0,0]),void 0,void 0,!1,void 0,void 0,void 0,void 0,!1,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,void 0,c.i64.cast([0,0]),void 0,!1,void 0,void 0,void 0,!1,c.i64.cast([0,0]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,a[40],void 0,void 0,void 0,!1,c.i64.cast([0,0]),void 0,void 0,void 0,c.i64.cast([0,0]),void 0)}])},function(a){return c.resolve(d)}])}a.__sproc_name__="LSMailboxPopulateCommunityFolderDataStoredProcedure";e.exports=a}),null);
__d("LSQuickReplyType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,HORIZONTAL:1,VERTICAL:2});f["default"]=a}),66);
__d("LSTransactionLogger",["cr:8879"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:8879")}),98);
__d("LSReStoreQplLogger",["LSTransactionLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{startTracking:function(b,d){var e=c("LSTransactionLogger")==null?void 0:c("LSTransactionLogger").startTracking(b,a,d);return{addAnnotations:function(b){c("LSTransactionLogger")==null?void 0:c("LSTransactionLogger").addAnnotations(a,e,b)},end:function(){c("LSTransactionLogger")==null?void 0:c("LSTransactionLogger").end(a,e)},fail:function(b){c("LSTransactionLogger")==null?void 0:c("LSTransactionLogger").fail(a,e,b)},mark:function(b){c("LSTransactionLogger")==null?void 0:c("LSTransactionLogger").mark(a,e,b)},recordLogicalWrite:function(){c("LSTransactionLogger")==null?void 0:c("LSTransactionLogger").recordLogicalWrite(e)}}}}}g.createQplLogger=a}),98);
__d("ReStoreMigrateUtil",["$InternalEnum","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;f=b("$InternalEnum").Mirrored(["UPDATE_METADATA","UPGRADE_COMPLETE","NO_UPGRADE_NEEDED"]);function a(a,b){b="V"+b;return b in a?b:null}function i(a,b){return j.apply(this,arguments)}function j(){j=babelHelpers.wrapAsyncGenerator(function*(a,b){a=a.iterator(new WeakMap());var c=[],d=(yield babelHelpers.awaitAsyncGenerator(a.next()));while(!d.done){var e=d.value;e[0];e=e[1];c.push(e);c.length===b&&(yield c,c=[]);d=(yield babelHelpers.awaitAsyncGenerator(a.next()))}c.length&&(yield c)});return j.apply(this,arguments)}function c(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e){var f=!0,g=!1,j;try{for(var k=babelHelpers.asyncIterator(i(d("ReQL").fromTableAscending(a),100)),l,l;l=(yield k.next()),f=l.done,l=(yield l.value),!f;f=!0){l=l;yield (h||(h=b("Promise"))).all(l.map(function(b){return c(b).then(a.put)}));e==null?void 0:e()}}catch(a){g=!0,j=a}finally{try{!f&&k["return"]!=null&&(yield k["return"]())}finally{if(g)throw j}}});return k.apply(this,arguments)}function e(a,b){function c(b){if(b==null)return void 0;var c={};for(var d in b)c[a+"_"+d]=b[d];return c}return{bool:c(b.bool),"int":c(b["int"]),string:c(b.string)}}g.ReStoreMigrateResult=f;g.getVersionFromNumber=a;g.fetchReQLBatch=i;g.upgradeTableEntries=c;g.prefixAnnotations=e}),98);
__d("ReStoreDefaultValuesMetadata",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b={c:"string",t:"string"};for(var d in b){if(!Object.prototype.hasOwnProperty.call(a,d)||a[d]==null){c("FBLogger")("messenger_web_product").warn('Malformed default values data, missing key "%s"',d);return null}var e=a[d],f=b[d];e=typeof e;if(e!==f){c("FBLogger")("messenger_web_product").warn('Malformed default values data, key "%s" has type "%s" but expected "%s"',d,e,f);return null}}if(typeof a.c!=="string"||typeof a.t!=="string")return null;e=[];f=a.t;try{e=JSON.parse(a.c);for(d=0;d<e.length;d++){b=e[d];if(typeof b!=="string")return null}}catch(a){return null}return{columns:e,tableName:f}}function b(a){return{c:JSON.stringify(a.columns),t:a.tableName}}d="_db_defaults_meta";g.tryParseDefaultValuesData=a;g.defaultValuesColumnToValue=b;g.defaultValuesTableName=d}),98);
__d("ReStoreOperationLock",["isPromise","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;b=function(){function a(a){var b=this;this.waitFor=null;this.waitFor=a.then(function(a){return b.waitFor=null})}var b=a.prototype;b.chainPromiseOrValue=function(a){if(this.waitFor!=null)return this.waitFor.then(function(){return a("\ud83d\udd12")});else return a("\ud83d\udd12")};return a}();d=function(){function a(){this.$1=Promise.resolve()}var b=a.prototype;b.chainPromiseOrValue=function(a){var b=this;return new Promise(function(c,d){b.$1=b.$1.then(async function(){try{c(await a("\ud83d\udd12"))}catch(a){d(a)}})})};return a}();function i(a,b){function d(b){if(b.done)return b.value;if(!(h||(h=c("isPromise")))(b.value))throw c("unrecoverableViolation")("expected promise","messenger_web_product");return b.value.then(function(b){return d(a.next(b))})}return d(a.next(b))}function a(a,b){return{next:function(c){return b.chainPromiseOrValue(function(b){return i(a.next(b,c))})}}}g.WaitForPromiseLock=b;g.ReStoreOperationLock=d;g.lockIterator=a}),98);
__d("ReStoreIndex",["ReQLBounds","ReStoreOperationLock","ReStoreUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a,b,c,e,f){var g=this;this.entries=function(a,b,c){b===void 0&&(b="asc");return d("ReStoreOperationLock").lockIterator(d("ReStoreUtils").entries(g.$5,a,g.$1,g.$3,b,c,g.$2),g.$4)};this.get=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return g.$4.chainPromiseOrValue(function(a){return d("ReStoreUtils").getLocked(g.$5,new WeakMap(),g.$1.name,g.$3,b,a,g.$2)})};this.getKey=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return g.$4.chainPromiseOrValue(function(a){return g.$6(g.$5,new WeakMap(),b,a)})};this.keys=function(a,b,c){b===void 0&&(b="asc");return d("ReStoreOperationLock").lockIterator(d("ReStoreUtils").keys(g.$5,a,g.$1,g.$3,b,c),g.$4)};this.$3=a;this.keyFields=b.indexes[a];this.$1=b;this.$2=c;this.$4=e;this.$5=f}var b=a.prototype;b.$6=async function(a,b,c,e){a=await d("ReStoreUtils").getLocked(a,b,this.$1.name,this.$3,c,e,this.$2);return a===void 0?void 0:d("ReStoreUtils").searchKey(this.$1,a)};return a}();b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(a);c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,e,f,g,i){var j;j=a.call(this,b,c,e,f,g)||this;j.subscribe=function(a,b,c){return j.$ReStoreIndex$p_3.subscribeIndex(j.$ReStoreIndex$p_1.name,j.$ReStoreIndex$p_2,a,(h||(h=d("ReQLBounds"))).extendBounds(b,j.$ReStoreIndex$p_1.indexes[j.$ReStoreIndex$p_2].length),c)};j.$ReStoreIndex$p_2=b;j.$ReStoreIndex$p_1=c;j.$ReStoreIndex$p_3=i;return j}return b}(a);g.ReStoreTransactionIndex=b;g.ReStoreIndex=c}),98);
__d("ReStoreTable",["I64","PromiseOrValue","ReQLBounds","ReStoreIndex","ReStoreOperationLock","ReStoreUtils","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a){a=(h||(h=d("I64"))).cast(a);if(a===void 0)throw c("unrecoverableViolation")("Expected int64","messenger_web_product");return h.to_float(a)}function l(a,b,c,d,e){b=JSON.stringify([b,c]);c=a.get(b);a.set(b,[c==null?d:c[0],e])}a=function(a,b,e,f){var g=this;this.entries=function(a,b,c){b===void 0&&(b="asc");return d("ReStoreOperationLock").lockIterator(d("ReStoreUtils").entries(g.$4,a,g.$1,void 0,b,c,g.$2),g.$3)};this.get=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return g.$3.chainPromiseOrValue(function(a){return d("ReStoreUtils").getLocked(g.$4,new WeakMap(),g.$1.name,void 0,b,a,g.$2)})};this.keys=function(a,b,c){b===void 0&&(b="asc");return d("ReStoreOperationLock").lockIterator(d("ReStoreUtils").keys(g.$4,a,g.$1,void 0,b,c),g.$3)};this.peekNextAutoIncrementId=function(){return Promise.resolve(g.$3.chainPromiseOrValue(async function(a){a=g.$1.autoIncrement;if(!a)throw c("unrecoverableViolation")("only supported for auto-incrementing tables","maw_db");a=await d("ReStoreUtils").gen(g.$4.table(g.$1.name).readSeed(new WeakMap()));if(a===void 0)throw c("unrecoverableViolation")("unexpected undefined autoIncrementSeed","maw_db");return(h||(h=d("I64"))).of_float(a)}))};this.keyFields=a.primaryKeyIds;this.$1=a;this.$2=b;this.$3=e;this.$4=f};b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,e,f,g,h,j,k,l,m){var n;b=c.tableNames[b];n=a.call(this,b,e,f,g)||this;n.$ReStoreTransactionTable$p_1=new Map();n.$ReStoreTransactionTable$p_10=new Map();n.add=function(a){return Promise.resolve((i||(i=d("PromiseOrValue"))).map(i.map(n.$ReStoreTransactionTable$p_4.beforeAdd({tableName:n.$ReStoreTransactionTable$p_3.name,transaction:n.$ReStoreTransactionTable$p_8,value:a}),function(a){return n.$ReStoreTransactionTable$p_12(function(b,c){var e;(e=n.$ReStoreTransactionTable$p_9)==null?void 0:e.recordLogicalWrite();return d("ReStoreUtils").gen(n.$ReStoreTransactionTable$p_13(n.$ReStoreTransactionTable$p_10,c,new WeakMap(),n.$ReStoreTransactionTable$p_3.name,a,b))})}),function(b){return(i||(i=d("PromiseOrValue"))).map(n.$ReStoreTransactionTable$p_4.afterAdd({key:b,tableName:n.$ReStoreTransactionTable$p_3.name,transaction:n.$ReStoreTransactionTable$p_8,value:a}),function(){return b})}))};n.delete=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return Promise.resolve((i||(i=d("PromiseOrValue"))).map(n.$ReStoreTransactionTable$p_4.beforeDelete({key:b,tableName:n.$ReStoreTransactionTable$p_3.name,transaction:n.$ReStoreTransactionTable$p_8}),function(a){return n.$ReStoreTransactionTable$p_12(function(b,c){var e=babelHelpers.assertThisInitialized(n);return d("ReStoreUtils").gen(function*(){var f;(f=e.$ReStoreTransactionTable$p_9)==null?void 0:f.recordLogicalWrite();yield* d("ReStoreUtils").deleteItemLocked(e.$ReStoreTransactionTable$p_2,e.$ReStoreTransactionTable$p_10,c,new WeakMap(),e.$ReStoreTransactionTable$p_3.name,a,b);yield* d("ReStoreUtils").cascadeKeyUpdatesLocked(e.$ReStoreTransactionTable$p_2,e.$ReStoreTransactionTable$p_10,c,new WeakMap(),e.$ReStoreTransactionTable$p_3.name,a,void 0,e.$ReStoreTransactionTable$p_4,b,e.$ReStoreTransactionTable$p_11)}())})}))};n.put=function(a){return Promise.resolve((i||(i=d("PromiseOrValue"))).map(i.map(n.$ReStoreTransactionTable$p_4.beforePut({tableName:n.$ReStoreTransactionTable$p_3.name,transaction:n.$ReStoreTransactionTable$p_8,value:a}),function(a){return n.$ReStoreTransactionTable$p_12(function(b,c){var e;(e=n.$ReStoreTransactionTable$p_9)==null?void 0:e.recordLogicalWrite();return d("ReStoreUtils").gen(d("ReStoreUtils").putLocked(n.$ReStoreTransactionTable$p_2,n.$ReStoreTransactionTable$p_10,c,new WeakMap(),n.$ReStoreTransactionTable$p_3.name,a,n.$ReStoreTransactionTable$p_4,b,n.$ReStoreTransactionTable$p_11))})}),function(b){return(i||(i=d("PromiseOrValue"))).map(n.$ReStoreTransactionTable$p_4.afterPut({key:b,tableName:n.$ReStoreTransactionTable$p_3.name,transaction:n.$ReStoreTransactionTable$p_8,value:a}),function(){return b})}))};n.upsert=function(a,b){return Promise.resolve((i||(i=d("PromiseOrValue"))).map(n.$ReStoreTransactionTable$p_4.beforeUpsert({tableName:n.$ReStoreTransactionTable$p_3.name,transaction:n.$ReStoreTransactionTable$p_8,value:b}),function(c){return n.$ReStoreTransactionTable$p_12(function(e,f){var g=babelHelpers.assertThisInitialized(n);return d("ReStoreUtils").gen(function*(){var h;(h=g.$ReStoreTransactionTable$p_9)==null?void 0:h.recordLogicalWrite();yield* d("ReStoreUtils").upsertLocked(g.$ReStoreTransactionTable$p_2,g.$ReStoreTransactionTable$p_10,f,new WeakMap(),g.$ReStoreTransactionTable$p_3.name,a,c,g.$ReStoreTransactionTable$p_4,e,g.$ReStoreTransactionTable$p_11);yield* d("ReStoreUtils").cascadeKeyUpdatesLocked(g.$ReStoreTransactionTable$p_2,g.$ReStoreTransactionTable$p_10,f,new WeakMap(),g.$ReStoreTransactionTable$p_3.name,a,d("ReStoreUtils").searchKey(g.$ReStoreTransactionTable$p_3,b),g.$ReStoreTransactionTable$p_4,e,g.$ReStoreTransactionTable$p_11)}())})}))};n.index=function(a){return d("ReStoreUtils").getOrCreate(n.$ReStoreTransactionTable$p_1,a,function(){return new(d("ReStoreIndex").ReStoreTransactionIndex)(a,n.$ReStoreTransactionTable$p_3,n.$ReStoreTransactionTable$p_4,n.$ReStoreTransactionTable$p_5,n.$ReStoreTransactionTable$p_6)})};n.$ReStoreTransactionTable$p_3=b;n.$ReStoreTransactionTable$p_2=c;n.$ReStoreTransactionTable$p_4=e;n.$ReStoreTransactionTable$p_5=f;n.$ReStoreTransactionTable$p_6=g;n.$ReStoreTransactionTable$p_7=h;n.$ReStoreTransactionTable$p_8=j;n.$ReStoreTransactionTable$p_9=k;n.$ReStoreTransactionTable$p_10=l;n.$ReStoreTransactionTable$p_11=m;return n}var c=b.prototype;c.$ReStoreTransactionTable$p_12=function(a){var b=this;return this.$ReStoreTransactionTable$p_5.chainPromiseOrValue(function(c){var e=b.$ReStoreTransactionTable$p_6.createNested(b.$ReStoreTransactionTable$p_9);return(i||(i=d("PromiseOrValue"))).map(a(c,e),function(a){e.flush();return a})})};c.$ReStoreTransactionTable$p_13=function*(a,b,c,e,f,g){var i=b.table(e),j=this.$ReStoreTransactionTable$p_2.tableNames[e];if(j.autoIncrement){var m=f[j.primaryKeyIds[0]];m=(h||(h=d("I64"))).of_float(yield* i.incrementSeed(c,m===void 0?m:k(m)));f[j.primaryKeyIds[0]]=m}m=d("ReStoreUtils").appendDefaultValues(f,j.name,this.$ReStoreTransactionTable$p_11);f=d("ReStoreUtils").searchKey(j,m);if(f==null)throw new Error("Evaluating the object store's key path did not yield a value");if((yield* i.tableGet(c,f))==null){j=d("ReStoreUtils").indicesWithKeyForValue(this.$ReStoreTransactionTable$p_3,Object.keys(j.indexes),m);yield* d("ReStoreUtils").deconflictIndicesLocked(this.$ReStoreTransactionTable$p_2,a,b,c,e,j,this.$ReStoreTransactionTable$p_4,g,this.$ReStoreTransactionTable$p_11);g=(yield* i.tableSet(c,f,m));i=g[0];yield* d("ReStoreUtils").addIdToIndices(b,c,e,i,j);l(a,e,f,void 0,m)}return f};return b}(a);e=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,e,f,g){var h;h=a.call(this,b,c,e,f)||this;h.$ReStoreTable$p_1=new Map();h.index=function(a){return d("ReStoreUtils").getOrCreate(h.$ReStoreTable$p_1,a,function(){return new(d("ReStoreIndex").ReStoreIndex)(a,h.$ReStoreTable$p_2,h.$ReStoreTable$p_3,h.$ReStoreTable$p_4,h.$ReStoreTable$p_5,h.$ReStoreTable$p_6)})};h.subscribe=function(a,b,c){return h.$ReStoreTable$p_6.subscribeTable(h.$ReStoreTable$p_2.name,a,(j||(j=d("ReQLBounds"))).extendBounds(b,h.$ReStoreTable$p_2.primaryKeyIds.length),c)};h.$ReStoreTable$p_2=b;h.$ReStoreTable$p_3=c;h.$ReStoreTable$p_4=e;h.$ReStoreTable$p_5=f;h.$ReStoreTable$p_6=g;return h}return b}(a);g.ReStoreTransactionTable=b;g.ReStoreTable=e}),98);
__d("LSStorage",["ReStoreKeyComparer"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return(h||(h=d("ReStoreKeyComparer"))).compareKey(a,b)===0}g.areKeysEqual=a}),98);
__d("ReStoreUtils",["I64","LSStorage","Random","ReQLBounds","ReStoreKeyComparer","ReStoreOperationLock","ReStoreTable","isPromise","nullthrows","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=500;async function a(a){var b=[],c=await a.next();while(!c.done)b.push(c.value),c=await a.next();return b}function m(a,b,d){var e=a.indexes;a=a.primaryKeyIds;a=d==null?a:e[d];return a.map(function(a){if(b[a]!==void 0||d!=null)return b[a];throw c("unrecoverableViolation")("primary key must be defined on object","maw_db")})}function n(a,b,c){var d=c[b];return!d?a:Object.keys(d).reduce(function(a,b){Object.prototype.hasOwnProperty.call(a,b)||(a[b]=d[b]);return a},babelHelpers.extends({},a))}function o(a,b,c,e,f,g,h){function i(){var j=a.table(c.name),l=babelHelpers.extends({},(k||(k=d("ReQLBounds"))).extendBounds(g,(e===void 0?c.primaryKeyIds:c.indexes[e]).length),{dir:f}),m=e==null?j.tableEntries(b,l):j.indexEntries(b,e,l);return j={next:function*(a,b){a=(yield* m.next(b));if(a.done)return{done:!0};b=a.value[1];return{done:!1,value:[a.value[0],h==null?b:h.afterEntriesNext({tableName:c.name,value:b})]}}},j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=i,j}return i()}function b(a,b,c,e,f,g){function h(){var i=a.table(c.name),j=i.keys(b,e,babelHelpers.extends({},(k||(k=d("ReQLBounds"))).extendBounds(g,(e===void 0?c.primaryKeyIds:c.indexes[e]).length),{dir:f}));return i={next:function*(a,b){return yield* j.next(b)}},i[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=h,i}return h()}function p(a,b){function d(b){if(b.done)return b.value;if(!(h||(h=c("isPromise")))(b.value))throw c("unrecoverableViolation")("expected promise","messenger_web_product");return b.value.then(function(b){return d(a.next(b))})}return d(a.next(b))}async function e(a,b,c,d,e,f,g){f=a.table(c);d!=null?a=await p(f.indexGet(b,d,e)):a=await p(f.tableGet(b,e));return a===void 0?void 0:g.afterGet({tableName:c,value:a})}function q(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function r(a){a=(i||(i=d("I64"))).cast(a);if(a===void 0)throw c("unrecoverableViolation")("Expected int64","messenger_web_product");return i.to_float(a)}function s(a,b,c,d,e){b=JSON.stringify([b,c]);c=a.get(b);(c==null?d:c[0])==null&&e==null?a.delete(b):a.set(b,[c==null?d:c[0],e])}function* t(a,b,c,e,f,g,h,i,k,l){function n(a,b){return a.length>=b?a:[].concat(a,[(j||(j=d("ReStoreKeyComparer"))).MAX_KEY])}if(h!=null&&(j||(j=d("ReStoreKeyComparer"))).compareKey(g,h)===0)return;f=a.tableNames[f];var p=f.cascadeUpdates,q=f.primaryKeyIds;f=function*(d){var f=d.indexName;d=d.tableName;var j=a.tableNames[d],p=j.indexes,r=j.primaryKeyIds,s=f==null?r:p[f];r={gte:g,lte:n(g,s.length)};p=o(c,e,j,f,"asc",r);j=[];f=(yield* p.next(k));while(!f.done)j.push(f.value),f=(yield* p.next(k));for(r of j){r[0];p=r[1];f=m(a.tableNames[d],p);if(h===void 0)yield* w(a,b,c,e,d,f,k),yield* t(a,b,c,e,d,f,void 0,i,k,l);else{j=q.reduce(function(a,b,c){if(c>=h.length)return a;a[s[c]]=h[c];return a},babelHelpers.extends({},p));yield* v(a,b,c,e,d,f,j,i,k,l);yield* t(a,b,c,e,d,f,m(a.tableNames[d],j),i,k,l)}}};for(p of p)yield* f(p)}function* u(a,b,c,e,f,g,h,k,l){var o=c.table(f),p=a.tableNames[f];if(p.autoIncrement){var q=g[p.primaryKeyIds[0]];q=(i||(i=d("I64"))).of_float(yield* o.incrementSeed(e,q===void 0?q:r(q)));g[p.primaryKeyIds[0]]=q}q=m(p,g);var t={},u=(yield* o.tableGet(e,q)),v=g;u!==void 0?t=x(p,Object.keys(p.indexes),u):v=n(g,p.name,l);g=(yield* o.tableSet(e,q,v));var w=g[0];g=g[1];p=x(p,Object.keys(p.indexes),v);var A=babelHelpers.extends({},p);for(var B of Object.keys(A))t[B]!==void 0&&(j||(j=d("ReStoreKeyComparer"))).compareKey(t[B],A[B])===0&&(delete A[B],delete t[B]);yield* y(a,b,c,e,f,A,h,k,l);yield* z(c,e,f,w,g?p:A);for(B of Object.keys(t))yield* o.indexDelete(e,B,t[B]);s(b,f,q,u,v);return q}function* v(a,b,c,e,f,g,h,i,j,k){var l=m(a.tableNames[f],h);d("LSStorage").areKeysEqual(g,l)||(yield* w(a,b,c,e,f,g,j));yield* u(a,b,c,e,f,h,i,j,k)}function* w(a,b,c,d,e,f,g){g=c.table(e);c=a.tableNames[e];a=(yield* g.tableGet(d,f));if(a!==void 0){if(Object.keys(c.indexes).length)for(var h of Object.keys(c.indexes)){var i=m(c,a,h);i!=null&&(yield* g.indexDelete(d,h,i))}yield* g.tableDelete(d,f);s(b,e,f,a,void 0)}}function x(a,b,c){return b.reduce(function(b,d){var e;e=(e=a.indexPredicates)==null?void 0:e[d];if(e!=null&&!e(c))return b;e=m(a,c,d);b[d]=e;return b},{})}function* y(a,b,c,d,e,f,g,h,i){var j=c.table(e);for(var k of Object.keys(f)){var l=f[k];l=(yield* j.indexGet(d,k,l));if(l!=null){l=m(a.tableNames[e],l);yield* w(a,b,c,d,e,l,h);yield* t(a,b,c,d,e,l,void 0,g,h,i)}}}function* z(a,b,c,d,e){a=a.table(c);for(c of Object.keys(e)){var f=e[c];f===void 0?yield* a.indexDelete(b,c,f):yield* a.indexSet(b,c,f,d)}}function* f(a,b,d,e,f,g,h,i,j,k){var m=d.table(i),n=g.tableNames[i];for(var p of j)yield* m.clearIds(e,p);p=j.filter(function(a){return(n==null?void 0:n.indexes[a])!=null});if(p.length===0)return;j=o(d,e,n,void 0,"asc",void 0,f);var q=[],r=(yield* j.next(k));while(!r.done){while(!r.done&&q.length<=l)q.push(r.value),r=(yield* j.next(k));for(var s of q){var t=s[0],u=s[1];u=x(g.tableNames[i],p,u);yield* y(g,a,d,e,i,u,f,k,h);t=c("nullthrows")(yield* m.getId(e,t));yield* z(d,e,i,t,u)}q.length=0;b==null?void 0:b()}}var A="__internal__transaction_id";function B(a,b,e,f,g,h,i){var j=new(d("ReStoreOperationLock").ReStoreOperationLock)(),k=i==null?void 0:i.qplFlow,l=new Map(),m=new Proxy((i={},i[A]=c("Random").uint32(),i.table=function(c){return new(d("ReStoreTable").ReStoreTransactionTable)(c,a,e,j,g,f,m,k,h,b)},i),{get:function(c,i){return!Object.prototype.hasOwnProperty.call(a.tableNames,i)?Reflect.get.apply(Reflect,arguments):q(l,i,function(){return new(d("ReStoreTable").ReStoreTransactionTable)(i,a,e,j,g,f,m,k,h,b)})}});return m}function C(a){return a.types.includes("indexeddb")}g.collectIterator=a;g.searchKey=m;g.appendDefaultValues=n;g.entries=o;g.keys=b;g.gen=p;g.getLocked=e;g.getOrCreate=q;g.cascadeKeyUpdatesLocked=t;g.putLocked=u;g.upsertLocked=v;g.deleteItemLocked=w;g.indicesWithKeyForValue=x;g.deconflictIndicesLocked=y;g.addIdToIndices=z;g.rebuildIndicesLocked=f;g.createReStoreTransaction=B;g.isPDB=C}),98);
__d("ReStoreDefaultValueMigration",["LSPlatformLsInitLog","ReStoreDefaultValuesMetadata","ReStoreUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={};b=(yield d("ReStoreUtils").collectIterator(b[d("ReStoreDefaultValuesMetadata").defaultValuesTableName].entries(a)));for(a of b){b=a[0];var e=a[1];if(b!=null){var f;b=d("ReStoreDefaultValuesMetadata").tryParseDefaultValuesData(e);if(b==null)continue;e=b.columns;b=b.tableName;c[b]=(f=c[b])!=null?f:new Set();for(f of e)c[b].add(f)}}return c});return i.apply(this,arguments)}function j(a,b,c,d){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){a=(yield h(a,b));b={};for(c in c.tableNames){var e=d[c];if(e!=null)for(var f in e){var g;g=(g=a[c])==null?void 0:g.has(f);if(!g){b[c]=(g=b[c])!=null?g:{};b[c][f]=e[f]}}}return b});return k.apply(this,arguments)}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){for(b in b){var e=Object.keys(c[b]||{});e={columns:e,tableName:b};yield a[d("ReStoreDefaultValuesMetadata").defaultValuesTableName].put(d("ReStoreDefaultValuesMetadata").defaultValuesColumnToValue(e))}});return m.apply(this,arguments)}function a(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=new WeakMap();d("LSPlatformLsInitLog").addPoint("default_values_update_start");var g=function(a,b){d("LSPlatformLsInitLog").addPoint("default_values_update_end_failure",{string:{default_values_update_failure_point:b,default_values_update_failure_reason:String(a)}})};try{b=(yield j(f,a,b,e));try{if(c===!1)for(c in b){var h=a[c].entries(f),i=(yield h.next());while(!i.done){var k=babelHelpers["extends"]({},i.value[1]);k=d("ReStoreUtils").appendDefaultValues(k,c,e);yield a[c].put(k);i=(yield h.next())}}yield l(a,b,e);d("LSPlatformLsInitLog").addPoint("default_values_update_end")}catch(a){g(a,"setDefaultValues")}}catch(a){g(a,"findDefaultValuesToUpdate")}});return n.apply(this,arguments)}g.runMigrationForTableDefaultValuesIfNeeded=a}),98);
__d("ReStoreIndexMetadata",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=typeof a==="string"?a:null;if(a==null)return null;try{a=JSON.parse(a);for(var b=a,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;if(typeof e!=="string")return null}return a}catch(a){return null}}function a(a){var b={indexName:"string",keyIds:"string","predicate?":"string",tableName:"string"};for(var d in b){var e=d.endsWith("?");if(e)e=a[d.slice(0,-1)];else{if(!Object.prototype.hasOwnProperty.call(a,d)||a[d]==null){c("FBLogger")("messenger_web_product").warn('Malformed index data, missing key "%s"',d);return null}e=a[d]}var f=b[d],g=typeof e;if(e!=null&&g!==f){c("FBLogger")("messenger_web_product").warn('Malformed index data, key "%s" has type "%s" but expected "%s"',d,g,f);return null}}e=h(a.keyIds);if(e==null){c("FBLogger")("messenger_web_product").warn('Malformed index data, key IDs "%s" are invalid',typeof a.keyIds==="string"?a.keyIds:"<"+typeof a.keyIds+">");return null}return typeof a.indexName!=="string"||typeof a.tableName!=="string"||typeof a.predicate!=="string"&&a.predicate!=null?null:babelHelpers["extends"]({data:e,indexName:a.indexName,tableName:a.tableName},a.predicate==null?{}:{predicate:a.predicate})}function b(a,b){if(a[0]==null)return!0;if(a[0].length!==b[0].length)return!0;for(var c=0;c<a[0].length;c++)if(a[0][c]!==b[0][c])return!0;return a[1]!==b[1]?!0:!1}function d(a){return babelHelpers["extends"]({indexName:a.indexName,keyIds:JSON.stringify(a.data),tableName:a.tableName},a.predicate==null?{}:{predicate:a.predicate})}e="_db_indices_meta";g.tryParseIndexData=a;g.indicesDiffer=b;g.indexDataToValue=d;g.indicesTableName=e}),98);
__d("ReStoreIndicesMigration",["LSPlatformLsInitLog","ReStoreIndexMetadata","ReStoreOperationLock","ReStoreUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={};b=(yield d("ReStoreUtils").collectIterator(b[d("ReStoreIndexMetadata").indicesTableName].entries(a)));for(a of b){b=a[0];var e=a[1];if(b!=null){var f;e=d("ReStoreIndexMetadata").tryParseIndexData(e);if(e==null)continue;var g=e.indexName,h=e.tableName;c[h]=(f=c[h])!=null?f:{};c[h][g]=babelHelpers["extends"]({index:e.data,key:b},e.predicate==null?{}:{predicate:e.predicate})}}return c});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield h(a,b));b={};for(var e in c.tableNames){var f=c.tableNames[e];for(var g in f.indexes){var i,j;i=[f.indexes[g],(i=f.indexPredicates)==null?void 0:(i=i[g])==null?void 0:i.toString()];j=(j=a[e])==null?void 0:j[g];if(d("ReStoreIndexMetadata").indicesDiffer([j==null?void 0:j.index,j==null?void 0:j.predicate],i)){b[e]=(j=b[e])!=null?j:{};b[e][g]=i}}}j={};for(i in c.tableNames)if(i in a){g=a[i];for(f in g){var k;e=g[f];k=(k=c.tableNames[i])==null?void 0:(k=k.indexes)==null?void 0:k[f];if(k==null){j[i]=(k=j[i])!=null?k:{};j[i][f]=e}}}return{toRemove:j,toUpdate:b}});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var c in b){var e=b[c];for(var f in e){var g=e[f],h=g[0];g=g[1];h=babelHelpers["extends"]({data:h,indexName:f,tableName:c},g==null?{}:{predicate:g});yield a[d("ReStoreIndexMetadata").indicesTableName].put(d("ReStoreIndexMetadata").indexDataToValue(h))}}});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var c in b){var e=b[c];for(var f in e){var g,h=e[f].key;yield (g=a[d("ReStoreIndexMetadata").indicesTableName])["delete"].apply(g,h)}}});return o.apply(this,arguments)}function p(a,b,c,e,f){return new(d("ReStoreOperationLock").ReStoreOperationLock)().chainPromiseOrValue(function(g){return d("ReStoreUtils").gen(d("ReStoreUtils").rebuildIndicesLocked(a.changedKeys,a.clearCache,a.storeTx,new WeakMap(),a.hooksManager,c,e,b,f,g))})}function a(a,c,e,f){var g=new WeakMap();d("LSPlatformLsInitLog").addPoint("index_migration_start");var h=function(a,b){d("LSPlatformLsInitLog").addPoint("index_migration_end_failure",{string:{index_migration_failure_point:b,index_migration_failure_reason:String(a)}})};return j(g,a.transaction,c).then(function(){var g=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var g=b.toRemove;b=b.toUpdate;var h=Array.from(new Set([].concat(Object.keys(b),Object.keys(g))));d("LSPlatformLsInitLog").addAnnotations({"int":{index_migration_rebuild_tables_count:h.length}});if(f===!1)for(h of h)if(c.tableNames[h]!=null){var i;i=Array.from(new Set([].concat(Object.keys((i=b[h])!=null?i:{}),Object.keys((i=g[h])!=null?i:{}))));yield p(a,h,c,e,i)}yield l(a.transaction,b);yield n(a.transaction,g);d("LSPlatformLsInitLog").addPoint("index_migration_end")});return function(a){return g.apply(this,arguments)}}(),function(a){return h(a,"findIndicesToUpdateOrRemove")})["catch"](function(a){return h(a,"rebuildIndices")})}g.runMigrationForIndicesIfNeeded=a}),98);
__d("ReStoreHashMigration",["ReStoreDefaultValueMigration","ReStoreIndicesMigration","ReStoreMigrateUtil","ReStorePersistedMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=Object.values(a.tableNames).map(function(a){return babelHelpers["extends"]({},a,{indexPredicates:Object.entries((a=a.indexPredicates)!=null?a:{}).map(function(a){var b=a[0];a=a[1];return[b,a.toString()]})})});return JSON.stringify(a)}function c(a,b,c,d){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f,g,h,i=e.loggers,j=i.logHistory;i=i.userFlow;var k=e.storeTx,l=e.transaction,m=d("ReStorePersistedMetadata").ReStorePersistedDefaultValuesVersion.hash(c),n=d("ReStorePersistedMetadata").ReStorePersistedSchemaVersion.hash(b);i==null?void 0:i.addAnnotations(d("ReStoreMigrateUtil").prefixAnnotations(a,{"int":{defaultValuesVersion:m,schemaVersion:n}}));var o=new(d("ReStorePersistedMetadata").ReStorePersistedSchemaVersion)(a),p=new(d("ReStorePersistedMetadata").ReStorePersistedDefaultValuesVersion)(a);f=(f=(yield o.read(k)))==null?void 0:f.schemaVersion;g=(g=(yield p.read(k)))==null?void 0:g.defaultValuesVersion;j==null?void 0:j.debug("storeSchemaVersion: "+((h=f)!=null?h:"null"));j==null?void 0:j.debug("storeDefaultValuesVersion: "+((h=g)!=null?h:"null"));f!=null&&(i==null?void 0:i.addAnnotations(d("ReStoreMigrateUtil").prefixAnnotations(a,{"int":{storeDefaultValuesVersion:g,storeSchemaVersion:f}})));if(f===n&&g===m)return d("ReStoreMigrateUtil").ReStoreMigrateResult.NO_UPGRADE_NEEDED;h=f==null;yield d("ReStoreDefaultValueMigration").runMigrationForTableDefaultValuesIfNeeded(l,b,h,c);j==null?void 0:j.debug("migration default values finished");yield d("ReStoreIndicesMigration").runMigrationForIndicesIfNeeded(e,b,c,h);j==null?void 0:j.debug("migration indices finished");o.write(k,{schemaVersion:n});p.write(k,{defaultValuesVersion:m});j==null?void 0:j.debug("version is written");j==null?void 0:j.debug("migration hash end");i==null?void 0:i.addPoint("migration_hash_end");if(h)return d("ReStoreMigrateUtil").ReStoreMigrateResult.UPDATE_METADATA;else return d("ReStoreMigrateUtil").ReStoreMigrateResult.UPGRADE_COMPLETE});return h.apply(this,arguments)}g.serializeTableData=a;g.runHashMigration=c}),98);
__d("ReStorePersistenceIds",[],(function(a,b,c,d,e,f){"use strict";b="nextId";c="seed";function a(a){return a}f.idForNextId=b;f.idForSeed=c;f.castPersistenceId=a}),66);
__d("hashString",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=0;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);b=(b<<5)-b+d;b|=0}return b}f["default"]=a}),66);
__d("ReStorePersistedMetadata",["ReStoreHashMigration","ReStorePersistenceIds","ReStoreUtils","hashString"],(function(a,b,c,d,e,f,g){"use strict";var h="_db_schema_meta";a=function(){function a(a){this.$1=d("ReStorePersistenceIds").castPersistenceId(a)}var b=a.prototype;b.read=async function(a){a=await d("ReStoreUtils").gen(a.table(h).readData(new WeakMap(),this.$1));return a};b.write=function(a,b){a.table(h).writeData(new WeakMap(),this.$1,b)};b.getId=function(){return this.$1};return a}();b=function(a){babelHelpers.inheritsLoose(b,a);function b(b){return a.call(this,b+"_schema_version")||this}b.hash=function(a){return c("hashString")(d("ReStoreHashMigration").serializeTableData(a))};return b}(a);e=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"custom_migration_value_version")||this}return b}(a);f=function(a){babelHelpers.inheritsLoose(b,a);function b(b){return a.call(this,b+"_default_value_version")||this}b.hash=function(a){return c("hashString")(JSON.stringify(a))};return b}(a);g.schemaMetadataTableName=h;g.ReStorePersistedMetadata=a;g.ReStorePersistedSchemaVersion=b;g.ReStorePersistedCustomMigrationVersion=e;g.ReStorePersistedDefaultValuesVersion=f}),98);
__d("ReStoreCustomMigration",["ReStoreMigrateUtil","ReStorePersistedMetadata","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c,e=b.storeTx;b=b.transaction;if(a==null)return d("ReStoreMigrateUtil").ReStoreMigrateResult.NO_UPGRADE_NEEDED;var f=new(d("ReStorePersistedMetadata").ReStorePersistedCustomMigrationVersion)();c=(c=(yield f.read(e)))==null?void 0:c.customMigrationVersion;if(a.targetVersion===c)return d("ReStoreMigrateUtil").ReStoreMigrateResult.NO_UPGRADE_NEEDED;yield a.migration((c=c)!=null?c:0,b);f.write(e,{customMigrationVersion:a.targetVersion});return d("ReStoreMigrateUtil").ReStoreMigrateResult.UPGRADE_COMPLETE});return h.apply(this,arguments)}g.runCustomMigration=a}),98);
__d("ReStoreHooks",["PromiseOrValue"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return{afterAdd:a.reduce(function(a,b){var c=b.onAfterAdd;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a}),afterEntriesNext:a.reduce(function(a,b){var c=b.onAfterEntriesNext;return c?function(b){return c({tableName:b.tableName,value:a(b)})}:a},function(a){a=a.value;return a}),afterGet:a.reduce(function(a,b){var c=b.onAfterGet;return c?function(b){return c({tableName:b.tableName,value:a(b)})}:a},function(a){a=a.value;return a}),afterPut:a.reduce(function(a,b){var c=b.onAfterPut;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeAdd:a.reduce(function(a,b){var c=b.onBeforeAdd;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeDelete:a.reduce(function(a,b){var c=b.onBeforeDelete;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.key;return a}),beforeNotify:a.reduce(function(a,b){var c=b.onBeforeNotify;return c?function(b){var d=a(b),e=d.newValue;d=d.prevValue;return c({newValue:e,prevValue:d,tableName:b.tableName})}:a},function(a){var b=a.newValue;a=a.prevValue;return{newValue:b,prevValue:a}}),beforePut:a.reduce(function(a,b){var c=b.onBeforePut;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeUpsert:a.reduce(function(a,b){var c=b.onBeforeUpsert;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a})}}g.createHookManager=a}),98);
__d("ReStoreIndexeddbPersistenceInitFailure",[],(function(a,b,c,d,e,f){"use strict";var g="ReStoreIndexeddbPersistenceInitFailure";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.message=b;c.name=g;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.ERROR_NAME=g;f.ReStoreIndexeddbPersistenceInitFailure=a}),66);
__d("ReStorePersistence",["FBLogger","ReStoreKeyComparer","ReStorePersistenceIds","ReStoreUtils","gkx","isPromise","promiseDone","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j={},k={gt:[!1,0],gte:[!0,0],lt:[!0,1],lte:[!1,1]},l=new Set(["encrypted_backups_virtual_devices","secure_encrypted_backups_recovery_code_status","device_metadata","secure_encrypted_backups_epochs","secure_encrypted_backups_client_state","encrypted_backups","experiences_shared_state","occamadillo_most_recent_message_per_thread"]),m=16,n=64,o=64,p=Math.floor(m/2),q=Math.floor(n/2),r=Math.floor(o/2);function s(b){if(b==null)return b;var c=Object.getOwnPropertyNames(b),a={},d,e;for(d=0;d<c.length;d++)e=b[c[d]],a[c[d]]=e;return a}function t(a,b){b===void 0&&(b=j);return a===b}function u(a,b,c){var e=0,f=a.length-1;while(e<=f){var g=e+f>>1;(c[0]?(i||(i=d("ReStoreKeyComparer"))).compareKey(a[g],b)<0:(i||(i=d("ReStoreKeyComparer"))).compareKey(a[g],b)<=0)?e=g+1:f=g-1}g=[e,f][c[1]];return g===a.length?-1:g}var v=function(){function a(a,b,c,d,e,f){this.$2=b,this.$3=c,this.$1=a,this.$4=d,this.$5=e,this.$6=f}var b=a.prototype;b.$7=function(a){return a==null?"root":"index("+a+")"};b.$8=function(a,b){return d("ReStoreUtils").getOrCreate(this.$1,b,function(){return{children:[].concat(a.children),isLeaf:!0,keys:[].concat(a.keys),nextId:a.nextId,prevId:a.prevId}})};b.$9=function(a,b){return d("ReStoreUtils").getOrCreate(this.$1,b,function(){return{children:[].concat(a.children),isLeaf:!1,keys:[].concat(a.keys)}})};b.$10=function(a,b){return d("ReStoreUtils").getOrCreate(this.$1,b,function(){return{headId:a.headId,rootId:a.rootId,tailId:a.tailId}})};b.$11=function(a,b){if(!a.length)return[0,0];var c=u(a,b,k.gte);if(c===-1)return[a.length,0];else if((i||(i=d("ReStoreKeyComparer"))).compareKey(a[c],b)===0)return[c,1];return[c,0]};b.$12=function*(a,b,c,d){var e=(yield* this.$13(a,b));e=e;b=b;var f=-1;while(!e.isLeaf)d==null?void 0:d.push([e,b,f]),f=u(e.keys,c,k.gt),f===-1&&(f=e.keys.length),b=e.children[f],e=(yield* this.$13(a,b));return[e,b,f]};b.$14=function*(a,b){this.$3();var d=this.$1.get(b);if(t(d))return void 0;if(d!==void 0)return d;d=this.$4.get(a,this.$2,b,this.$5);return(h||(h=c("isPromise")))(d)?yield d:d};b.$13=function*(a,b){a=(yield* this.$14(a,b));if(a===void 0){var d=this.$1.get(b);this.$4.logError==null?void 0:this.$4.logError(this.$2,this.$5,"dbCorruption",{deletedInThisTxn:t(d)?"true":"false",id:JSON.stringify(b)||""});throw c("unrecoverableViolation")("value not found","messenger_web_product")}return a};b.$15=function*(a,b){a=(a=(yield* this.$14(a,d("ReStorePersistenceIds").idForNextId)))!=null?a:0;this.$1.set("nextId",a+1);this.$1.set(a,b);return a};b.$16=function(a,b){this.$3(),this.$1.set(a,b)};b.incrementSeed=function*(a,b){a=(a=(yield* this.$14(a,"seed")))!=null?a:0;if(b===void 0){this.$1.set("seed",a+1);return a}b>=a&&this.$1.set("seed",b+1);return b};b.readData=function*(a,b){return yield* this.$14(a,b)};b.$17=function*(a,b,c){b=(yield* this.$14(a,this.$7(b)));if(b==null)return;a=(yield* this.$12(a,b.rootId,c));b=a[0];a=u(b.keys,c,k.gte);if(a===-1||(i||(i=d("ReStoreKeyComparer"))).compareKey(b.keys[a],c)!==0)return;return b.children[a]};b.tableGet=function*(a,b){b=(yield* this.$17(a,void 0,b));if(b===void 0)return;return yield* this.$18(a,b)};b.$18=function*(a,b){return Array.isArray(b)?b[0]:yield* this.$13(a,b)};b.$19=function*(a,b,d,e){if(Array.isArray(b)){var f=(yield* this.$17(a,void 0,b));if(f==null){c("gkx")("3570")&&this.$6(d,e,this.$2);throw c("FBLogger")("messenger_web_product").mustfixThrow("Encountered value in index %s but not found in table %s",d,this.$2)}return yield* this.$18(a,f)}return yield* this.$13(a,b)};b.indexGet=function*(a,b,c){var d=(yield* this.$17(a,b,c));if(d==null)return;return yield* this.$19(a,d,b,c)};b.getId=function*(a,b){a=(yield* this.$17(a,void 0,b));return Array.isArray(a)?b:a};b.tableSet=function*(a,b,c){var d,e=this.$4.shouldInline(this.$2,c),f=this.$7(),g=(yield* this.$14(a,f));if(g==null){var h;e||(d=(yield* this.$15(a,c)));h={children:[(h=d)!=null?h:[c]],isLeaf:!0,keys:[b]};h=(yield* this.$15(a,h));this.$16(f,{headId:h,rootId:h,tailId:h});return[(h=d)!=null?h:b,!1]}h=[];var i=(yield* this.$12(a,g.rootId,b,h)),k=i[0];i=i[1];var l=this.$11(k.keys,b),m=l[0];l=l[1];var n=!1;if(l===1){var o=k.children[m];if(!Array.isArray(o)){n=!0;if(!e){this.$16(o,c);return[o,!1]}else this.$1.set(o,j)}}o=this.$8(k,i);e||(d=(yield* this.$15(a,c)));l===0&&o.keys.splice(m,0,b);o.children.splice(m,l,(k=d)!=null?k:[c]);yield* this.$20(a,o,i,h,g,f,!0);return[(m=d)!=null?m:b,l===1&&!(e&&!n)]};b.indexSet=function*(a,b,c,d){b=this.$7(b);var e=(yield* this.$14(a,b));if(e==null){var f={children:[d],isLeaf:!0,keys:[c]};f=(yield* this.$15(a,f));this.$16(b,{headId:f,rootId:f,tailId:f});return}f=[];var g=(yield* this.$12(a,e.rootId,c,f)),h=g[0];g=g[1];var i=this.$11(h.keys,c),j=i[0];i=i[1];if(i===1&&h.children[j]===d)return;h=this.$8(h,g);h.keys.splice(j,i,c);h.children.splice(j,i,d);yield* this.$20(a,h,g,f,e,b,!1)};b.$20=function*(a,b,c,d,e,f,g){b=b;var h;c=c;for(;b.keys.length>=(b.isLeaf?g?m:n:o);b=h,c=i){var i;i=(i=d.pop())!=null?i:[];h=i[0];i=i[1];i!=null?h=this.$9(h,i):(h={children:[c],isLeaf:!1,keys:[]},this.$10(e,f).rootId=(yield* this.$15(a,h)));var j=Math.floor(b.keys.length/2),k=void 0;if(b.isLeaf){var l={children:b.children.slice(j),isLeaf:!0,keys:b.keys.slice(j),nextId:b.nextId,prevId:c},p=k=b.nextId=(yield* this.$15(a,l));l=l.nextId;l?this.$8(yield* this.$13(a,l),l).prevId=p:this.$10(e,f).tailId=k}else k=(yield* this.$15(a,{children:b.children.slice(j+1),isLeaf:!1,keys:b.keys.slice(j+1)}));l=this.$11(h.keys,b.keys[j]);p=l[0];l=l[1];h.keys.splice(p,l,b.keys[j]);h.children.splice(p+1,0,k);b.keys.length=j;b.children.length=j+(b.isLeaf?0:1)}};b.tableDelete=function*(a,b){a=(yield* this.$21(a,void 0,b));if(a==null)return!1;Array.isArray(a)||(this.$3(),this.$1.set(a,j));return!0};b.indexDelete=function*(a,b,c){return(yield* this.$21(a,b,c))!=null};b.$21=function*(a,b,e){var f=this.$7(b),g=(yield* this.$14(a,f));if(g==null)return;var h=[],m=(yield* this.$12(a,g.rootId,e,h)),n=m[0],o=m[1];m=m[2];var s=this.$8(n,o),t=u(n.keys,e,k.gte);if(t===-1||(i||(i=d("ReStoreKeyComparer"))).compareKey(n.keys[t],e)!==0)return;n=s.children[t];s.keys.splice(t,1);s.children.splice(t,1);e=s;t=o;s=m;var v;for(;e.keys.length<(e.isLeaf?b==null?p:q:r)&&h.length;x=[m,v,o],e=x[0],t=x[1],s=x[2],x){o=h.pop();m=o[0];v=o[1];o=o[2];m=this.$9(m,v);var w=[[{nodeId:m.children[s-1]},{node:e,nodeId:t},s-1],[{node:e,nodeId:t},{nodeId:m.children[s+1]},s]].filter(function(b){var a=b[0];b=b[1];return a.nodeId!==void 0&&b.nodeId!==void 0});for(var x of w){var y=x[0],z=x[1],A=x[2],B=y.node=y.node||(yield* this.$13(a,y.nodeId)),C=z.node=z.node||(yield* this.$13(a,z.nodeId)),D=e.isLeaf?b==null?p:q:r;if(B.keys.length+z.node.keys.length>=D*2){if(e.isLeaf){var E=this.$8(B,y.nodeId),F=this.$8(C,z.nodeId),G=[].concat(E.children,F.children),H=[].concat(B.keys,C.keys);E.children=(F.children=G).splice(0,D);E.keys=(F.keys=H).splice(0,D);m.keys[A]=H[0]}else{G=this.$9(B,y.nodeId);E=this.$9(C,z.nodeId);F=[].concat(G.children,E.children);H=[].concat(G.keys,[m.keys[A]],E.keys);G.children=(E.children=F).splice(0,D+1);m.keys[A]=H.splice(D,1)[0];G.keys=(E.keys=H).splice(0,D)}return n}}for(B of w){y=B[0];C=B[1];z=B[2];if(e.isLeaf){F=this.$8(y.node,y.nodeId);A=this.$8(C.node,C.nodeId);F.children=[].concat(F.children,A.children);F.keys=[].concat(F.keys,A.keys);A.keys.length=0;G=A.nextId;if(G){E=this.$8(yield* this.$13(a,G),G);E.prevId=y.nodeId}else this.$10(g,f).tailId=y.nodeId;F.nextId=A.nextId}else{H=this.$9(y.node,y.nodeId);D=this.$9(C.node,C.nodeId);H.children=[].concat(H.children,D.children);H.keys=[].concat(H.keys,[m.keys[z]],D.keys)}m.keys.splice(z,1);m.children.splice(z+1,1);this.$1.set(C.nodeId,j);break}}w=(yield* this.$13(a,g.rootId));if(!w.keys.length&&w.children.length){if(w.isLeaf){l.has(this.$2)&&(this.$4.logError==null?void 0:this.$4.logError(this.$2,this.$5,"dbCorruption",{}));throw c("unrecoverableViolation")("cannot be leaf","messenger_web_product")}this.$1.set(g.rootId,j);this.$10(g,f).rootId=w.children[0]}return n};b.btreeIterator=function(a,b,e){e=e===void 0?{}:e;var f=e.dir,g=f===void 0?"asc":f,h=babelHelpers.objectWithoutPropertiesLoose(e,["dir"]);function j(){if(g==="asc"){if(Object.prototype.hasOwnProperty.call(h,"gt"))return h.gt;else if(Object.prototype.hasOwnProperty.call(h,"gte"))return h.gte}else if(Object.prototype.hasOwnProperty.call(h,"lt"))return h.lt;else if(Object.prototype.hasOwnProperty.call(h,"lte"))return h.lte}function l(a){if(g==="asc")return Object.prototype.hasOwnProperty.call(h,"gt")?u(a.keys,h.gt,k.gt):Object.prototype.hasOwnProperty.call(h,"gte")?u(a.keys,h.gte,k.gte):0;else return Object.prototype.hasOwnProperty.call(h,"lt")?u(a.keys,h.lt,k.lt):Object.prototype.hasOwnProperty.call(h,"lte")?u(a.keys,h.lte,k.lte):a.keys.length-1}if(Object.prototype.hasOwnProperty.call(h,"gt")&&Object.prototype.hasOwnProperty.call(h,"gte"))throw c("unrecoverableViolation")("cannot specify both greater than and greater than or equal","maw_db");if(Object.prototype.hasOwnProperty.call(h,"lt")&&Object.prototype.hasOwnProperty.call(h,"lte"))throw c("unrecoverableViolation")("cannot specify both less than and less than or equal","maw_db");var m,n=this;return{next:function*(e){var f,o;if(m==null){var p=(yield* n.$14(a,n.$7(b)));if(p==null)return{done:!0};var q=j();if(q!==void 0){q=(yield* n.$12(a,p.rootId,q));f=q[0];q=q[1]}else if(g==="asc"){var r=[yield* n.$13(a,p.headId),p.headId];f=r[0];q=r[1]}else{r=[yield* n.$13(a,p.tailId),p.tailId];f=r[0];q=r[1]}p=l(f)}else{r=m;p=r.i;o=r.key;q=r.nodeId;f=(yield* n.$14(a,q));if(e!=null){if((i||(i=d("ReStoreKeyComparer"))).compareKey(e,o)===(g==="asc"?-1:1))throw c("unrecoverableViolation")("key must be ahead of current key","maw_db");if(f==null||(i||(i=d("ReStoreKeyComparer"))).compareKey(e,f.keys[0])<0||(i||(i=d("ReStoreKeyComparer"))).compareKey(e,f.keys[f.keys.length-1])>0){r=(yield* n.$14(a,n.$7(b)));if(r==null)return{done:!0};r=(yield* n.$12(a,r.rootId,e));f=r[0];q=r[1]}p=u(f.keys,e,k[g==="asc"?"gte":"lte"])}else{if(f==null||p<0||p>=f.keys.length||(i||(i=d("ReStoreKeyComparer"))).compareKey(f.keys[p],o)!==0){if(f==null||!f.keys.length||(i||(i=d("ReStoreKeyComparer"))).compareKey(o,f.keys[0])<0||(i||(i=d("ReStoreKeyComparer"))).compareKey(o,f.keys[f.keys.length-1])>0){r=(yield* n.$14(a,n.$7(b)));if(r==null)return{done:!0};e=(yield* n.$12(a,r.rootId,o));f=e[0];q=e[1]}p=u(f.keys,o,k[g==="asc"?"lte":"gte"])}p+=g==="asc"?1:-1}}if(p<0||p>=f.keys.length)if(g==="asc"){if(f.nextId===void 0)return{done:!0};q=f.nextId;f=(yield* n.$13(a,q));p=0}else{if(f.prevId===void 0)return{done:!0};q=f.prevId;f=(yield* n.$13(a,q));p=f.keys.length-1}o=f.keys[p];m={i:p,key:o,node:f,nodeId:q};if(p<0||p>=f.keys.length)return{done:!0};r=g==="asc"?Object.prototype.hasOwnProperty.call(h,"lt")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.lt)>=0||Object.prototype.hasOwnProperty.call(h,"lte")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.lte)>0:Object.prototype.hasOwnProperty.call(h,"gt")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.gt)<=0||Object.prototype.hasOwnProperty.call(h,"gte")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.gte)<0;return r?{done:!0}:{done:!1,value:[f.keys[p],f.children[p]]}}}};b.tableEntries=function(a,b){b===void 0&&(b={});var c=this.btreeIterator(a,void 0,b),d=this;return{next:function*(b){b=(yield* c.next(b));if(b.done)return b;b=b.value;var e=b[0];b=b[1];b=(yield* d.$18(a,b));return{done:!1,value:[e,b]}}}};b.indexEntries=function(a,b,c){c===void 0&&(c={});var d=this.btreeIterator(a,b,c),e=this;return{next:function*(c){c=(yield* d.next(c));if(c.done)return c;c=c.value;var f=c[0];c=c[1];c=(yield* e.$19(a,c,b,f));return{done:!1,value:[f,c]}}}};b.keys=function(a,b,c){c===void 0&&(c={});var d=this.btreeIterator(a,b,c);return{next:function*(a){a=(yield* d.next(a));if(a.done)return a;a=a.value;a=a[0];return{done:!1,value:a}}}};b.clearIds=function*(a,b){this.$3();b=this.$7(b);var c=(yield* this.$14(a,b));this.$3();if(c==null)return;var d=(yield* this.$13(a,c.rootId));c=[{id:c.rootId,node:d}];while(c.length>0){d=c.shift();var e=d.id;d=d.node;if(!d.isLeaf)for(d of d.children){var f=(yield* this.$14(a,d));f!=null&&c.push({id:d,node:f})}this.$1.set(e,j)}this.$1.set(b,j)};b.readSeed=function*(a){return(a=(yield* this.$14(a,d("ReStorePersistenceIds").idForSeed)))!=null?a:0};b.remove=function(a,b){this.$3(),this.$1.set(b,j)};b.writeData=function(a,b,c){this.$16(b,s(c))};b.writeNewData=function*(a,b){return yield* this.$15(a,s(b))};return a}(),w=function(){function a(a,b,e,f,g){var h=this;this.$2=new Map();this.$6=!1;this.$3=function(){if(h.$6){f==null?void 0:f.mark("transaction_closed");throw c("FBLogger")("messenger_web_product").mustfixThrow("Transaction has closed")}e()};this.$4=b;this.$1=a;this.$5={get:function(a,c,e){var f=d("ReStoreUtils").getOrCreate(h.$1,c,function(){return new Map()});f=f.get(e);if(t(f))return void 0;return f!==void 0?f:b.get(a,c,e,"readwrite")},logError:b.logError,shouldInline:b.shouldInline};this.$7=g}var b=a.prototype;b.flush=function(){for(var a of this.$2){var b=a[0],c=a[1];b=d("ReStoreUtils").getOrCreate(this.$1,b,function(){return new Map()});for(c of c){var e=c[0],f=c[1];b.set(e,f)}}this.$6=!0};b.table=function(a){return new v(d("ReStoreUtils").getOrCreate(this.$2,a,function(){return new Map()}),a,this.$3,this.$5,"readwrite",this.$7)};return a}(),x=function(){function a(a,b,d,e){var f=this;this.$1=new Map();this.$2=!1;this.$7=function(){if(f.$2)throw c("FBLogger")("messenger_web_product").mustfixThrow("Transaction has closed: %s",f.$5)};this.$3=a;this.$4=b;this.types=a.types;this.$5=d;this.$6=e}var b=a.prototype;b.close=function(){this.$2=!0};b.flush=async function(a){a===void 0&&(a={upgrade:!1}),await this.$3.flush(this.$1,a),this.$2=!0};b.table=function(a){return new v(d("ReStoreUtils").getOrCreate(this.$1,a,function(){return new Map()}),a,this.$7,this.$3,this.$4,this.$6)};b.createNested=function(a){return new w(this.$1,this.$3,this.$7,a,this.$6)};return a}();function a(a){function b(b,e,f){c("promiseDone")(async function(){await a.runExclusively(function(){return Promise.resolve([async function(){var c=new x(a,"readwrite",void 0,function(){});await d("ReStoreUtils").gen(c.table(f).indexDelete(new WeakMap(),b,e));await c.flush()},"readwrite"])},"fixBrokenIndex")}())}return{clearCache:a.clearCache,close:a.close,createTransaction:function(c,d){return new x(a,c,d,b)},isClosed:a.isClosed||function(){return!1},isPersistenceSupported:a.isPersistenceSupported,logError:a.logError,runExclusively:a.runExclusively}}g.sentinelDeleted=j;g.isDeletedValue=t;g.ReStoreDbStoreTransaction=x;g.createDbStore=a}),98);
__d("ReStoreTransactionDelay",["setTimeout"],(function(a,b,c,d,e,f,g){"use strict";async function a(a){a=a==="background"?new Promise(function(a){return c("setTimeout")(a,0)}):Promise.resolve();await a}g.default=a}),98);
__d("createReStoreSubscriptionManager",["ExecutionEnvironment","FBLogger","IntervalList","Promise","PromiseOrValue","ReStoreKeyComparer","ReStoreUtils","asyncToGeneratorRuntime","isPromise","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;function a(a,e,f){var g=new Map(),m=new Map();function n(a,b){return(l||(l=d("ReStoreKeyComparer"))).compareValue(a,b)===0}function o(a,b,c,d){a=(a=z.get(a))!=null?a:[];var e=[];for(var f=0;f<b.length;f++){var g=b[f];for(var h=0;h<32&&g!==0;h++){if(g&1){var i=a[(f<<5)+h];if(!n(c[i],d[i])){e[f]=((i=e[f])!=null?i:0)|1<<h%32}}g=g>>>1}}return e}function p(a,b){for(var c=0;c<Math.max(a.length,b.length);c++)if((a[c]&b[c])!==0)return!0;return!1}function q(a,b,d,e){try{a=a(b,d,e);if((j||(j=c("isPromise")))(a))return a["catch"](function(a){c("FBLogger")("messenger_web_product").catching(a).mustfix("error in ReStore subscription async handler")});else return a}catch(a){c("FBLogger")("messenger_web_product").catching(a).mustfix("error in ReStore subscription handlers")}}function r(a,c,e,f,g){var i=Array.from(c(f));if(g.operation==="put"&&g.prevValue!=null){c=function(){var b=g.prevValue,c=[];for(var h of i){h[0];var j=h[1];j!=null&&j.forEach(function(a,b){c[b]=((b=c[b])!=null?b:0)|a})}var l=o(a,c,b,g.value);return{v:(k||(k=d("PromiseOrValue"))).all(i.map(function(a){var b=a[0];a=a[1];if(a==null||p(l,a))return q(b,f,g,e)}))}}();if(typeof c==="object")return c.v}return(h||(h=b("Promise"))).all(i.map(function(a){var b=a[0];a[1];return q(b,f,g,e)}))}function s(b){return c("nullthrows")((g.has(b)?g:g.set(b,[c("IntervalList")((l||(l=d("ReStoreKeyComparer"))).compareKey,a.tableNames[b].primaryKeyIds.length),new Map()])).get(b))}function t(b,e){var f=s(b);f[0];f=f[1];return c("nullthrows")((f.has(e)?f:f.set(e,c("IntervalList")((l||(l=d("ReStoreKeyComparer"))).compareKey,a.tableNames[b].indexes[e].length))).get(e))}function u(b,e,f,g,h,i){var j=function(a,c){return r(e,b.findIntersecting,i,a,c)},m=f==null?void 0:d("ReStoreUtils").searchKey(a.tableNames[e],f,h),n=g==null?void 0:d("ReStoreUtils").searchKey(a.tableNames[e],g,h);if(n==null&&m!=null)return j(m,{operation:"delete",prevValue:c("nullthrows")(f)});if(m==null&&n!=null)return j(n,{operation:"add",value:c("nullthrows")(g)});if(m!=null&&n!=null)return(l||(l=d("ReStoreKeyComparer"))).compareKey(m,n)===0?j(m,{operation:"put",prevValue:c("nullthrows")(f),value:c("nullthrows")(g)}):(k||(k=d("PromiseOrValue"))).map(j(m,{operation:"delete",prevValue:c("nullthrows")(f)}),function(){return j(n,{operation:"add",value:c("nullthrows")(g)})})}function v(a,b,c,e){var f=s(a),g=f[0],h=f[1];return(k||(k=d("PromiseOrValue"))).map(u(g,a,b,c,null,e),function(){return(k||(k=d("PromiseOrValue"))).all(Array.from(h.entries()).map(function(d){var f=d[0];d=d[1];return u(d,a,b,c,f,e)}).filter(function(a){return a!=null}))})}function w(){m.forEach(function(a){return a()})}function x(a,b){function d(){var d=new Map();try{for(var f of a){var g=f[0],h=f[1];e(b,g)&&d.set(g,h)}}catch(a){c("FBLogger")("messenger_web_product").catching(a).mustfix("Couldnot format changes to broadcast")}return Array.from(d)}if((i||(i=c("ExecutionEnvironment"))).isInBrowser&&f!=null){d=d();if(d.length===0)return;f.postMessage(b,d)}}(i||(i=c("ExecutionEnvironment"))).isInBrowser&&(f!=null&&f.onEventReceive("notifyTableV2",function(a){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=new WeakMap(),c=a.values();yield (k||(k=d("PromiseOrValue"))).loop(function(a){if(a.done)return{action:"break",value:void 0};a=a.value;var e=a[0];a=a[1];var f=a.values();return(k||(k=d("PromiseOrValue"))).map(k.loop(function(a){if(a.done)return{action:"break",value:void 0};a=a.value;var c=a[0];a=a[1];return(k||(k=d("PromiseOrValue"))).map(v(e,c,a,b),function(){return{action:"continue",value:f.next()}})},f.next()),function(){return{action:"continue",value:c.next()}})},c.next());w()})())}));var y=new Map(),z=new Map();function A(a,b){if(b==null)return null;var c=y.get(a);c==null&&(c=new Map(),y.set(a,c));var d=[];for(b of b){var e=c.get(b);if(e==null){e=c.size;c.set(b,e);var f=z.get(a);f==null&&(f=[],z.set(a,f));f.push(b)}f=e>>5;e=e&31;d[f]=((f=d[f])!=null?f:0)|1<<e}return d}return{dispose:function(){g.clear(),m.clear()},notifyCommit:w,notifyTableAndIndexSubscribers:v,notifyTableV2:x,subscribeIndex:function(a,c,d,e,f){var g=t(a,c),i=!1;c=function(a,c,e){return i?(h||(h=b("Promise"))).resolve():q(d,a,c,e)};var j=[c,A(a,f)];g.set(e,j);return function(){i=!0,g["delete"](j)}},subscribeTable:function(a,c,d,e){var f=s(a),g=f[0],i=!1;f=function(a,d,e){return i?(h||(h=b("Promise"))).resolve():q(c,a,d,e)};var j=[f,A(a,e)];g.set(d,j);return function(){i=!0,g["delete"](j)}},subscribeToCommit:function(a){m.set(a,a);return function(){m["delete"](a)}}}}g["default"]=a}),98);
__d("setImmediate",["TimeSlice","TimerStorage","setImmediateAcrossTransitions"],(function(a,b,c,d,e,f,g){function a(a){var b,d=function(){c("TimerStorage").unset(c("TimerStorage").IMMEDIATE,b);for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];Function.prototype.apply.call(a,this,e)};c("TimeSlice").copyGuardForWrapper(a,d);for(var e=arguments.length,f=new Array(e>1?e-1:0),g=1;g<e;g++)f[g-1]=arguments[g];b=c("setImmediateAcrossTransitions").apply(void 0,[d].concat(f));c("TimerStorage").set(c("TimerStorage").IMMEDIATE,b);return b}g["default"]=a}),98);
__d("ReStore",["ExecutionEnvironment","FBLogger","PromiseOrValue","ReStoreCustomMigration","ReStoreHooks","ReStoreIndexeddbPersistenceInitFailure","ReStoreMigrateUtil","ReStoreOperationLock","ReStorePersistedMetadata","ReStorePersistence","ReStoreTable","ReStoreTransactionDelay","ReStoreUtils","clearTimeout","cr:1088","cr:6665","createReStoreSubscriptionManager","promiseDone","setImmediate","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.call(this,"ReStore transaction timed out")||this}return a}(babelHelpers.wrapNativeSuper(Error)),k={enableRejectingTransaction:!1,enableTransactionTimeout:!1,fbLoggerProject:"maw_db"},l=12e4;function a(a){var e=a.persistence,f=a.hooks;f=f===void 0?[]:f;var g=a.customMigration,m=a.loggers,n=m===void 0?{logHistory:void 0,transactionQplLogger:void 0,userFlow:void 0}:m;m=a.config;var o=m===void 0?k:m,p=a.schema,q=n.logHistory,r=n.transactionQplLogger,s=n.userFlow,t=d("ReStorePersistence").createDbStore(e);m=e.tabTablesNotifier==null?void 0:e.tabTablesNotifier();var u=p.defaults,v=c("createReStoreSubscriptionManager")(p,e.shouldSync,m),w=d("ReStoreHooks").createHookManager(f),x=t.createTransaction("readonly"),y=e.types.includes("indexeddb"),z={background:{first:null,last:null},sync_script:{first:null,last:null},ui:{first:null,last:null}},A;s==null?void 0:s.addPoint("migration_start");q==null?void 0:q.debug("restore migration start");var B=new(d("ReStoreOperationLock").WaitForPromiseLock)(e.types.includes("devtool")?Promise.resolve():t.runExclusively(function(){return Promise.resolve([async function(){s==null?void 0:s.addPoint("migration_execute_start");var a=new Map(),b=t.createTransaction("readwrite"),c=E(b,a);q==null?void 0:q.debug("migration transaction created");c={changedKeys:a,clearCache:D,hooksManager:w,loggers:n,storeTx:b,transaction:c};try{var e=await p.migrate(c);s==null?void 0:s.addPoint("migration_custom_start");c=await d("ReStoreCustomMigration").runCustomMigration(g,c);q==null?void 0:q.debug("migration custom end");s==null?void 0:s.addPoint("migration_custom_end");if(c===d("ReStoreMigrateUtil").ReStoreMigrateResult.NO_UPGRADE_NEEDED&&e===d("ReStoreMigrateUtil").ReStoreMigrateResult.NO_UPGRADE_NEEDED){b.close();q==null?void 0:q.debug("restore migration skipped");s==null?void 0:s.addPoint("migration_skipped");return}c=e!==d("ReStoreMigrateUtil").ReStoreMigrateResult.UPDATE_METADATA&&a.size!==0;await b.flush({upgrade:c});s==null?void 0:s.addPoint("migration_execute_end");q==null?void 0:q.debug("restore migration complete")}catch(a){b.close();throw a}s==null?void 0:s.addPoint("migration_end");q==null?void 0:q.debug("restore migration end")},"readwrite"])},"migration").catch(function(a){s==null?void 0:s.addAnnotations({string:{migration_error:a.message}});a instanceof d("ReStoreIndexeddbPersistenceInitFailure").ReStoreIndexeddbPersistenceInitFailure||(s==null?void 0:s.endFail("migration_error"));q==null?void 0:q.debug("restore migration error");c("FBLogger")("restore_init").catching(a).mustfix("migration failed");throw a}));async function C(a,b){var c=new WeakMap();await t.runExclusively(function(){return Promise.resolve([async function(){var e=new Map(),f=t.createTransaction("readwrite"),g=E(f,e),h=b.values();await (i||(i=d("PromiseOrValue"))).loop(function(b){if(b.done)return{action:"break",value:void 0};b=b.value;var e=b[0],f=b[1];return(i||(i=d("PromiseOrValue"))).map(i.map(f==null?g.table(a).delete(d("ReStoreUtils").searchKey(p.tableNames[a],e)):g.table(a).put(f),function(){return v.notifyTableAndIndexSubscribers(a,e,f,c)}),function(){return{action:"continue",value:h.next()}})},h.next());try{await f.flush({upgrade:!0})}catch(a){f.close();throw a}},"readwrite"])},"applyChangesToTable")}function D(){t.clearCache==null?void 0:t.clearCache()}function E(a,b,c){return d("ReStoreUtils").createReStoreTransaction(p,u,w,v,a,b,c)}var F;function G(a,b,c,d){return new Promise(function(e,f){o.enableRejectingTransaction&&(F=f);var g=function(){A=d;return a().then(e,f).finally(function(){return A=void 0})};z[b].last==null?z[b].first=z[b].last={value:{code:g,writemode:c}}:z[b].last=z[b].last.next={value:{code:g,writemode:c}}})}function H(a){return t.runExclusively(function(){var a=z.ui.first!=null?z.ui:z.sync_script.first!=null?z.sync_script:z.background;if(a.first==null){c("FBLogger")(o.fbLoggerProject).mustfix("Expected work is missing");return Promise.resolve([function(){return Promise.resolve({})},"readonly"])}var b=a.first;a.first===a.last&&(a.last=null);a.first=a.first.next;return Promise.resolve([b.value.code,b.value.writemode])},a)}async function I(a,b,d,e){d===void 0&&(d="background");e===void 0&&(e={source:"unknown",type:"user_initiated"});var f,g=arguments[4];try{f=await J(a,b,d,e,g)}catch(a){if(a instanceof j)throw c("FBLogger")(o.fbLoggerProject).blameToPreviousFrame().mustfixThrow("ReStore transaction took too long to execute: %s",g);throw a}return f}async function J(a,e,f,g,h){f===void 0&&(f="background");var j,k,m,n,p,q=r==null?void 0:r.startTracking(y,f);b("cr:1088")&&(j=Date.now());q==null?void 0:q.addAnnotations({string:{moduleAndLineNo:h}});async function s(){q==null?void 0:q.mark("execute_start");b("cr:1088")&&(k=Date.now());var e={ref:void 0},f=new Map(),l=t.createTransaction("readwrite",h),r;b("cr:1088")==null?void 0:b("cr:1088").trackingStoredProceduresForNewTransaction(g);b("cr:1088")==null?void 0:b("cr:1088").recordModuleName(h);try{var s=E(l,f,{qplFlow:q});r=await Promise.race([a(s),L(e,q,h)]);e.ref!=null&&c("clearTimeout")(e.ref);q==null?void 0:q.mark("execute_end");q==null?void 0:q.mark("flush_start");await l.flush({qplFlow:q});q==null?void 0:q.mark("flush_end");b("cr:1088")&&(m=Date.now())}catch(a){e.ref!=null&&c("clearTimeout")(e.ref);l.close();q==null?void 0:q.fail(a);c("FBLogger")(o.fbLoggerProject).catching(a).mustfix("Transaction failed: %s",h);b("cr:1088")==null?void 0:b("cr:1088").recordRestoreTransaction({broadcast:n,complete:m,flush:p,queue:j,start:k},{changedKeys:f});throw a}finally{b("cr:1088")==null?void 0:b("cr:1088").stopTrackingStoredProcedures()}b("cr:1088")&&(p=Date.now());q==null?void 0:q.mark("broadcast_start");var u=new WeakMap();s=new Map();for(e of f){l=e[0];var x=e[1];l=JSON.parse(l);var y=l[0];l[1];l=s.get(y);l==null&&(l=[],s.set(y,l));var z=x[0];x=x[1];x=w.beforeNotify({newValue:x,prevValue:z,tableName:y});z=x.newValue;y=x.prevValue;l.push([y,z])}var A=s.entries();await (i||(i=d("PromiseOrValue"))).loop(function(b){if(b.done)return{action:"break",value:void 0};b=b.value;var a=b[0];b=b[1];var c=b.values();return(i||(i=d("PromiseOrValue"))).map(i.loop(function(b){if(b.done)return{action:"break",value:void 0};b=b.value;var e=b[0];b=b[1];return(i||(i=d("PromiseOrValue"))).map(v.notifyTableAndIndexSubscribers(a,e,b,u),function(){return{action:"continue",value:c.next()}})},c.next()),function(){return{action:"continue",value:A.next()}})},A.next());v.notifyTableV2(s,"notifyTableV2");v.notifyTableV2(s,"notifyInMemoryTable");v.notifyCommit();if(b("cr:1088")){n=Date.now();x={broadcast:n,complete:m,flush:p,queue:j,start:k};b("cr:1088").recordRestoreTransaction(x,{changedKeys:f})}q==null?void 0:q.mark("broadcast_end");q==null?void 0:q.mark("post_commit_start");c("setImmediate")(function(){q==null?void 0:q.mark("post_commit_end"),q==null?void 0:q.end()});return r}await c("ReStoreTransactionDelay")(f);s=G(s,f,e,h);q==null?void 0:q.mark("enqueued");c("promiseDone")(H(h),function(){},function(a){F==null?void 0:F(a)});var u=c("setTimeout")(function(){var a;c("FBLogger")("messenger_e2ee_web").mustfix("Transaction not resolved after %s ms. Source: %s; currently processing: %s. Native ops: %s. Executed SP: %s",l,h,A,(a=JSON.stringify(b("cr:6665")==null?void 0:b("cr:6665").getCurrentlyExecutingNativeOps()))!=null?a:"<devtools not running>",b("cr:1088")==null?void 0:(a=b("cr:1088").getStoredProcedureCallLog())==null?void 0:a.sp.map(function(a){return a.spName}).join(","))},l);return s.finally(function(){return c("clearTimeout")(u)})}(h||(h=c("ExecutionEnvironment"))).isInBrowser&&(m!=null&&m.onEventReceive("notifyInMemoryTable",function(a){c("promiseDone")(async function(){for(var b of a){var c=b[0],d=b[1];e.shouldApplySync("notifyInMemoryTable",c)&&await C(c,d)}v.notifyCommit()}())}));var K=Object.keys(p.tableNames).reduce(function(a,b){return babelHelpers.extends({},a,(a={},a[b]=new(d("ReStoreTable").ReStoreTable)(p.tableNames[b],w,B,x,v),a))},{});return{clearCacheIfSupported:D,closeDb:function(){var a=t;a instanceof Object&&a.close!==void 0&&a.close()},getCustomMigrationVersion:async function(){var a=await new(d("ReStorePersistedMetadata").ReStorePersistedCustomMigrationVersion)().read(t.createTransaction("readonly"));return a==null?void 0:a.customMigrationVersion},getTableData:function(){return p},isClosed:function(){return t.isClosed()},isPersistenceSupported:function(){var a=t;return a instanceof Object&&a.isPersistenceSupported!==void 0&&a.isPersistenceSupported instanceof Function?a.isPersistenceSupported():Promise.resolve(!0)},persistence:e,persistenceTypes:e.types,runInTransaction:I,subscribeToCommit:function(a){return v.subscribeToCommit(a)},subscriptionManager:v,table:function(a){return K[a]},tables:K,uniqueId:e.uniqueId};function L(a,d,e){return!o.enableTransactionTimeout?new Promise(function(){var d=1e4;a.ref=c("setTimeout")(function(){var a;c("FBLogger")(o.fbLoggerProject).mustfix("ReStore transaction took too long to execute, check it: %s. Executed SP: %s.",e,b("cr:1088")==null?void 0:(a=b("cr:1088").getStoredProcedureCallLog())==null?void 0:a.sp.map(function(a){return a.spName}).join(","))},d)}):new Promise(function(b,e){b=5e3;a.ref=c("setTimeout")(function(){d==null?void 0:d.mark("slow_transaction"),e(new j())},b)})}}g.default=a}),98);
__d("ReStoreInstrumentation",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(a){g.set(a.uniqueId,{instance:a,persistence:a.persistence,tableNames:a.getTableData().tableNames});return a}function b(){return Array.from(g.entries()).map(function(a){var b=a[0];a=a[1];return{key:b,value:JSON.parse(JSON.stringify(a.tableNames))}})}f.instrument=a;f.getReStoreTables=b;f.reStoreInstancesMap=g}),66);
__d("LSReStoreWrapper",["LSReStoreQplLogger","MessengerLogHistory","ReStore","ReStoreInstrumentation","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f,g){e===void 0&&(e=[]);f=d("ReStoreInstrumentation").instrument(c("ReStore")({config:{enableRejectingTransaction:c("gkx")("2138"),enableTransactionTimeout:c("gkx")("2947"),fbLoggerProject:"maw_db"},customMigration:f,hooks:e,loggers:{logHistory:d("MessengerLogHistory").getInstance("db_init"),transactionQplLogger:d("LSReStoreQplLogger").createQplLogger(c("qpl")._(25306500,"1488")),userFlow:g},persistence:a,schema:b}));return f}g.createLSReStore=a}),98);
__d("LSRemoveTask",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?0:(e=d.item,b.forEach(b.db.table(2).fetch([[[e.queueName,{lte:a[0]}]],"queueNameTaskId"]),function(a){var d=a.item;return b.sequence([function(a){return b.forEach(b.filter(b.db.table(2).fetch([[[d.taskId]]]),function(a){return b.i64.eq(a.taskId,d.taskId)&&a.queueName===d.queueName}),function(a){return a["delete"]()})},function(a){return b.i64.eq(d.taskDispatchPriority,b.i64.cast([0,1e3]))?c[0]=b.i64.cast([0,734739218]):c[0]=b.i64.cast([0,734737036])}])}))})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreRemoveTaskStoredProcedure";e.exports=a}),null);
__d("LSReplyMessageAttachmentType",[],(function(a,b,c,d,e,f){a=Object.freeze({OTHER:0,PHOTO:1,VIDEO:2,GIF:3,STICKER:4,LINK:5,MULTIPHOTO:6,PERMANENT_RAVEN_PHOTO:7,PERMANENT_RAVEN_VIDEO:8,SOUND_BITE:9,AUDIO:10,ROLL_CALL_PHOTO_CONTRIBUTION:11,ROLL_CALL_VIDEO_CONTRIBUTION:12,FEED_POST:13,POWER_UP:14,XMA:15,ROLL_CALL_TEXT_CONTRIBUTION:16,BLOKS_XMA:17,EPHEMERAL_RAVEN_MESSAGE:18});f["default"]=a}),66);
__d("LSReplyMessageStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,VALID:1,DELETED:2,TEMPORARY_UNAVAILABLE:3,EXPIRED:4});f["default"]=a}),66);
__d("LSRoomTruncate",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.forEach(b.filter(b.db.table(63).fetch(),function(a){return b.i64.eq(a.groupRoomType,void 0)||b.i64.eq(a.groupRoomType,b.i64.cast([0,5]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSStoriesRoomTruncateStoredProcedure";e.exports=a}),null);
__d("LSTaskExists",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?c[0]=!1:(a.item,c[0]=!0)})},function(a){return d[0]=c[0]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreTaskExistsStoredProcedure";e.exports=a}),null);
__d("LSTruncateCommunityListTable",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.forEach(b.db.table(166).fetch(),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSOmnistoreSettingsTruncateCommunityListTableStoredProcedure";e.exports=a}),null);
__d("LSTruncateNotificationSettings",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.forEach(b.db.table(175).fetch(),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSOmnistoreSettingsTruncateNotificationSettingsStoredProcedure";e.exports=a}),null);
__d("LSUpdateLastSyncCompletedTimestampMsToNow",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return c[0]=b.i64.of_float(Date.now()),b.forEach(b.db.table(1).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({lastSyncCompletedTimestampMs:c[0]})})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreUpdateLastSyncCompletedTimestampMsToNowStoredProcedure";e.exports=a}),null);
__d("LSUpsertGradientColor",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(117).put({themeFbid:a[0],gradientIndex:a[1],color:a[2],type_:a[3]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSThreadThemeUpsertGradientColorStoredProcedure";e.exports=a}),null);
__d("LSUpsertTheme",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.i64.neq(a[12],void 0)?c[0]=a[12]:c[0]=a[0],b.db.table(116).put({fbid:a[0],themeIdx:a[1],fallbackColor:a[2],reverseGradiantsForRadial:a[3],accessibilityLabel:a[4],iconUrl:a[5],iconUrlFallback:a[6],backgroundUrl:a[8],description:a[9],isDeprecated:a[11],normalThemeId:c[0],appColorMode:a[13],titlebarBackgroundColor:a[14],titlebarButtonTintColor:a[15],titlebarTextColor:a[16],titlebarAttributionTextColor:a[17],composerTintColor:a[18],composerUnselectedTintColor:a[19],composerInputTextPlaceholderColor:a[20],composerInputBackgroundColor:a[21],composerInputBorderColor:a[22],composerInputBorderWidth:a[23],composerBackgroundColor:a[24],messageTextColor:a[25],messageBorderColor:a[26],messageBorderWidth:a[27],incomingMessageTextColor:a[28],incomingMessageBorderColor:a[29],incomingMessageBorderWidth:a[30],deliveryReceiptColor:a[31],tertiaryTextColor:a[32],primaryButtonBackgroundColor:a[33],hotLikeColor:a[34],reactionPillBackgroundColor:a[35],secondaryTextColor:a[36],quotedIncomingMessageBubbleColor:a[37],cornerRadius:a[38],blurredComposerBackgroundColor:a[39],composerSecondaryButtonColor:a[40],composerPlaceholderTextColor:a[41]})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSThreadThemeUpsertThemeStoredProcedure";e.exports=a}),null);
__d("LSStaticDependencies",["LSDeleteAllCommunityChannelCategories","LSDeleteAllCommunityFolders","LSDeleteThenInsertCmCommunityList","LSDeleteThenInsertContact","LSDeleteThenInsertMessageRequest","LSDeleteThenInsertNotificationsSettingsGraphQLSnapshot","LSDeleteThenInsertThread","LSExecuteFinallyBlockForSyncTransaction","LSExecuteFirstBlockForSyncTransaction","LSGroupRoomTruncate","LSPopulateCommunityFolderData","LSRemoveTask","LSRoomTruncate","LSSetRegionHint","LSTaskExists","LSTruncateCommunityListTable","LSTruncateNotificationSettings","LSUpdateLastSyncCompletedTimestampMsToNow","LSUpsertGradientColor","LSUpsertSequenceId","LSUpsertTheme","LSVerifyContactRowExists"],(function(a,b,c,d,e,f,g){"use strict";a={deleteAllCommunityChannelCategories:c("LSDeleteAllCommunityChannelCategories"),deleteAllCommunityFolders:c("LSDeleteAllCommunityFolders"),deleteThenInsertCmCommunityList:c("LSDeleteThenInsertCmCommunityList"),deleteThenInsertContact:c("LSDeleteThenInsertContact"),deleteThenInsertMessageRequest:c("LSDeleteThenInsertMessageRequest"),deleteThenInsertNotificationsSettingsGraphQLSnapshot:c("LSDeleteThenInsertNotificationsSettingsGraphQLSnapshot"),deleteThenInsertThread:c("LSDeleteThenInsertThread"),executeFinallyBlockForSyncTransaction:c("LSExecuteFinallyBlockForSyncTransaction"),executeFirstBlockForSyncTransaction:c("LSExecuteFirstBlockForSyncTransaction"),groupRoomTruncate:c("LSGroupRoomTruncate"),populateCommunityFolderData:c("LSPopulateCommunityFolderData"),removeTask:c("LSRemoveTask"),roomTruncate:c("LSRoomTruncate"),setRegionHint:c("LSSetRegionHint"),taskExists:c("LSTaskExists"),truncateCommunityListTable:c("LSTruncateCommunityListTable"),truncateNotificationSettings:c("LSTruncateNotificationSettings"),updateLastSyncCompletedTimestampMsToNow:c("LSUpdateLastSyncCompletedTimestampMsToNow"),upsertGradientColor:c("LSUpsertGradientColor"),upsertSequenceId:c("LSUpsertSequenceId"),upsertTheme:c("LSUpsertTheme"),verifyContactRowExists:c("LSVerifyContactRowExists")};b=a;g["default"]=b}),98);
__d("LSXmaContentType",[],(function(a,b,c,d,e,f){a=Object.freeze({TEST:-1,NONE:0,IG_SINGLE_IMAGE_POST_SHARE:1e3,IG_MULTIPOST_SHARE:1001,IG_STORY_REPLY:1002,IG_STORY_PHOTO_SHARE:1003,IG_STORY_PHOTO_MENTION:1004,IG_CLIPS_SHARE:1005,IG_SINGLE_VIDEO_POST_SHARE:1006,IG_STORY_VIDEO_SHARE:1007,IG_STORY_REACTION:1008,IG_IGTV_SHARE:1009,IG_SHOP_SHARE:1010,IG_PROFILE_SHARE:1011,IG_STORY_PHOTO_HIGHLIGHT_SHARE:1012,IG_STORY_VIDEO_HIGHLIGHT_SHARE:1013,IG_STORY_VIDEO_MENTION:1014,IG_STORY_HIGHLIGHT_REPLY:1015,IG_STORY_HIGHLIGHT_REACTION:1016,IG_EXTERNAL_LINK:1017,IG_RECEIVER_FETCH:1018,IG_TEXT_POST_APP_SHARE:1019,IG_MULTI_MEDIA_RESPONSE:1020,FB_FEED_SHARE:2e3,FB_STORY_REPLY:2001,FB_STORY_SHARE:2002,FB_STORY_MENTION:2003,FB_FEED_VIDEO_SHARE:2004,FB_GAMING_CUSTOM_UPDATE:2005,FB_PRODUCER_STORY_REPLY:2006,FB_EVENT:2007,FB_FEED_POST_PRIVATE_REPLY:2008,FB_SHORT:2009,FB_COMMENT_MENTION_SHARE:2010,FB_STORY_LWI_REPLY:2011,FB_COMMENT_SHARE:2012,MSG_EXTERNAL_LINK_SHARE:3e3,MSG_P2P_PAYMENT:3001,MSG_LOCATION_SHARING:3002,MSG_LOCATION_SHARING_V2:3003,MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY:3004,MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY:3005,MSG_RECEIVER_FETCH:3006,MSG_IG_MEDIA_SHARE:3007,MSG_GEN_AI_SEARCH_PLUGIN_RESPONSE:3008,MSG_REELS_LIST:3009,MSG_CONTACT:3010,MSG_THREADS_POST_SHARE:3011,MSG_FILE:3012,MSG_AVATAR_DETAILS:3013,MSG_AI_CONTACT:3014,MSG_MEMORIES_SHARE:3015,MSG_SHARED_ALBUM_REPLY:3016,MSG_SHARED_ALBUM:3017,MSG_OCCAMADILLO_XMA:3018,MSG_GEN_AI_1P_SEARCH_RESULT:3019,MSG_EARLY_ACCESS_FB_SHARE:3020,MSG_GEN_AI_SUBSCRIPTION:3021,MSG_GEN_AI_REMINDER:3022,MSG_GEN_AI_MEMU_ONBOARDING_RESPONSE:3023,MSG_MAGICAL_MESSENGER_PLACES:3024,MSG_RECEIVER_FETCH_FALLBACK:3025,MSG_MAGICAL_MESSENGER_TASKS:3026,MSG_NOTE_REPLY:3027,MSG_NOTE_MENTION:3028,RTC_AUDIO_CALL:4e3,RTC_VIDEO_CALL:4001,RTC_MISSED_AUDIO_CALL:4002,RTC_MISSED_VIDEO_CALL:4003,RTC_GROUP_AUDIO_CALL:4004,RTC_GROUP_VIDEO_CALL:4005,RTC_MISSED_GROUP_AUDIO_CALL:4006,RTC_MISSED_GROUP_VIDEO_CALL:4007,DATACLASS_SENDER_COPY:5e3,OC_AVATAR_STATIC_STICKER:6e3,LIVE_LOCATION:7e3});f["default"]=a}),66);
__d("MAWODSProxy",["CurrentMessengerUser","ODS","WABridge","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i=!((b=c("gkx")("23949"))!=null?b:!1);function a(a,b){var c=a.amount,e=a.entity;a=a.key;b===void 0&&(b=!0);i?(h||(h=d("ODS"))).bumpEntityKey(3185,e,a+"."+(d("CurrentMessengerUser").getAppID()||"unknown"),c):d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{amount:c,entity:e,key:a},b)}g.odsBumpEntityKey=a}),98);
__d("WAGlobals",["WAJids","WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);h=function(){return a};return a}var i=null;function a(a){i=a}function j(){if(i==null)throw c("err")("WaMsgr api called before set");return i}function k(){var a;return(a=j().myJids)==null?void 0:a.deviceJid}function b(){var a;return(a=j().myJids)==null?void 0:a.userJid}function e(a){return d("WAJids").extractUserJid(a)===d("WAJids").extractUserJid(k())}function f(){return j().config}function l(){return j().dependencies}var m="WAOneQueue is not defined";function n(){var a=j().waOneQueue;if(a==null){d("WALogger").ERROR(h(),m);throw c("err")(m)}return a}function o(){return j().hmacKey}g.setGlobals=a;g.getMyDeviceJid=k;g.getMyUserJid=b;g.isPeerDevice=e;g.getConfig=f;g.getDependencies=l;g.getWaOneQueue=n;g.getHMACKey=o}),98);
__d("WAOdsEnums",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({WA_CONNECTIVITY:"wa_connectivity",GET_DEVICES:"armadillo_get_devices",DECRYPTION:"armadillo_msg_decryption",DEVICE_REREG_CHECK:"armadillo_device_rereg_check",DEVICE_REGISTRATION:"armadillo_device_registration",DEVICE_REGISTRATION_NON_EMPLOYEE:"armadillo_device_registration_non_employee",PHASH_MISMATCH:"phash_mismatch",WEB_PLACEHOLDER:"armadillo_web_placeholder",PREKEY_UPLOAD:"armadillo_prekey_upload",PREKEY_DIGEST:"armadillo_prekey_digest",C2C_META_SYNC:"armadillo_c2c_meta_sync",ADMIN_MESSAGE:"armadillo_admin_message",PREVIEW_SNIPPET:"armadillo_snippet",TOTAL_INCOMING_MESSAGE:"armadillo_total_incoming_message",COMPARE_IDENTITY:"armadillo_compare_identity",GET_PREKEY:"armadillo_get_prekey",SECURITY_ALERT_FOR_CONTACT:"armadillo_security_alert_for_contact",SECURITY_ALERT_FOR_SELF:"armadillo_security_alert_for_self",MSG_SEND:"armadillo_message_send",RETRY_MISSING_MSG:"armadillo_retry_missing_msg",REGISTRATION_TYPE:"aramdillo_registration_type",CLOCK_SKEW_UPDATE:"clock_skew_update",STREAM_ERROR:"wajs_stream_error",ICDC:"wajs_icdc",LOAD_MORE_NO_ORIGINAL_MSG_IN_MAW:"load_more_no_original_msg_in_maw",POISON_QUEUE_ENTTITY:"armadillo_poison_queue_entity",PQ_MIGRATION:"wajs_pq_migration",WORM:"wajs_worm",CAT_ROTATION:"cat_rotation",EB_RESTORE:"eb_restore",WA_DISCONNECT:"armadillo_disconnect",GROUP_CREATE:"armadillo_group_create",GROUP_DELETE:"armadillo_group_delete",GROUP_ADD_PARTICIPANT:"armadillo_group_add_participant",GROUP_PROMOTE_PARTICIPANT:"armadillo_group_promote_participant",GROUP_DEMOTE_PARTICIPANT:"armadillo_group_demote_participant",GROUP_REMOVE_PARTICIPANT:"armadillo_group_remove_participant",GROUP_LEAVE_PARTICIPANT:"armadillo_group_leave_participant",GROUP_SKS_INVALID:"armadillo_group_sks_invalid",SEND_READ_RECEIPTS:"armadillo_send_read_receipts",MESSAGE_MISSING_THREAD_JID:"MESSAGE_MISSING_THREAD_JID",MESSAGE_MISSING:"MESSAGE_MISSING",MAW_NON_TIMEOUT:"maw_non_timeout",MAW_TIMEOUT:"maw_timeout",WA_FAIL_STANZA_QUEUE_ITEM:"wa_fail_stanza_queue_item",WA_QUERY_GROUP:"wa_query_group",MAW_MISMATCH_PARTICIPANT:"maw_mismatch_participant",MAW_ONE_TO_ONE_THREAD_PARTICIPANT_CLEANUP:"maw_one_to_one_thread_participant_cleanup",MAW_THREADID_DEPRECATION:"maw_threadid_deprecation",MAW_THREADID_DEPRECATION_DETAILS:"maw_threadid_deprecation_details",MAW_DELETE_DANGLING_PARTICIPANTS:"maw_delete_dangling_participants",S2S_QPL_MISSING_INSTANCE_KEY:"s2s_qpl_missing_instance_key",MAW_DEPRECATED_REDIRECT:"maw_deprecated_redirect",MAW_MUTATION_VALIDATOR:"maw_mutation_validator",MAW_THREAD_UPDATE_MIDDLEWARE:"maw_thread_update_middleware",MAW_MY_USER_JID_GETTER:"maw_my_user_jid_getter",WA_NO_SIGNED_PRE_KEY:"wa_no_signed_pre_key",WA_LONG_SESSION_DROP:"wa_long_session_drop",MAW_SEND_REACTION:"maw_send_reaction",MAW_MIGRATE_REACTION_TS_AS_INDEX:"maw_migrate_reaction_ts_as_index",MAW_S2S_INSTANCE_KEY_NULL:"maw_s2s_instance_key_null",MAW_XMA_PROTOCOL_PARSING:"maw_xma_protocol_parsing",IGDW_INSTAMADILLO_MESSAGE_ON_OLD_WORKER:"igdw_new_msg_old_worker",WORKER_SCHEDULER_STUCK:"worker_scheduler_stuck",MAW_DB_UNEXPECTED_VERSION:"maw_db_unexpected_version",MAW_DB_MIGRATION_CURRENT_VERSION:"maw_db_migration_current_version",MAW_MEDIA_DB_DUPLICATE_MEDIA:"maw_media_db_duplicate_media",MAW_MEDIA_DB_DUPLICATE_CHUNK:"maw_media_db_duplicate_chunk"});f.Entity=a}),66);
__d("MAWUserJidWrapper",["ExecutionEnvironment","MAWCurrentUser","MAWODSProxy","WAGlobals","WAJids","WAOdsEnums"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=d("WAJids").toMsgrUserJid(d("MAWCurrentUser").getID());if((h||(h=c("ExecutionEnvironment"))).isInWorker){var b=d("WAGlobals").getMyUserJid();d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_MY_USER_JID_GETTER,key:b===a?"same":"different"});return b}return a}g.getMyUserJid=a}),98);
__d("MAWAuthor",["MAWUserJidWrapper","WAJids","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){if(a==null||a===d("WAJids").AUTHOR_SYSTEM)return null;if(d("WAJids").isAuthorMe(a))return d("MAWUserJidWrapper").getMyUserJid();var b=d("WAJids").authorAsUserJid(a);if(b==null||c("isStringNullOrEmpty")(d("WAJids").userIdFromJid(b)))return null;else return d("WAJids").authorAsUserJid(a)};g.getAuthorUserJid=a}),98);
__d("MAWBridge",["WABridge"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("WABridge").getBridge()}g.getBridge=a}),98);
__d("MAWDbVersionList",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}b={V21:21,V22:22,V23:23,V24:24,V25:25,V26:26,V27:27,V28:28,V29:29,V30:30,V31:31,V32:32,V33:33,V34:34,V35:35,V36:36,V37:37,V38:38,V39:39,V40:40,V41:41,V42:42,V43:43,V44:44,V45:45,V46:46,V47:47,V48:48,V49:49,V50:50,V51:51,V52:52,V53:53,V54:54,V55:55,V56:56,V57:57,V58:58,V59:59,V60:60,V61:61,V62:62,V63:63,V64:64,V65:65,V66:66,V67:67,V68:68,V69:69,V70:70,V71:71,V72:72,V73:73,V74:74,V75:75,V76:76,V77:77,V78:78,V79:79,V80:80,V81:81,V82:82,V83:83,V84:84,V85:85,V86:86,V87:87,V88:88,V89:89,V90:90,V91:91,V92:92,V93:93,V94:94,V95:95,V96:96,V97:97,V98:98,V99:99,V100:100,V101:101,V102:102,V103:103,V104:104,V105:105,V106:106,V107:107,V108:108,V109:109,V110:110,V111:111,V112:112,V113:113,V114:114,V115:115,V116:116,V117:117};f.toVersion=a;f.VERSION=b}),66);
__d("MAWDbSchema",["MAWDbVersionList"],(function(a,b,c,d,e,f,g){"use strict";a=[{autoIncrement:!0,indexes:{externalId:{columns:["externalId"]}},name:"e2ee_appData",primaryKey:["appDataId"]},{autoIncrement:!1,indexes:{},name:"e2ee_meta",primaryKey:["key"]},{autoIncrement:!1,indexes:{},name:"e2ee_appMeta",primaryKey:["key"]},{autoIncrement:!1,indexes:{},name:"e2ee_prekey",primaryKey:["keyId"]},{autoIncrement:!1,indexes:{},name:"e2ee_prekeyGeneration",primaryKey:["generationId"]},{autoIncrement:!1,indexes:{},name:"e2ee_session",primaryKey:["id"]},{autoIncrement:!1,indexes:{},name:"e2ee_signedPrekey",primaryKey:["keyId"]},{autoIncrement:!1,indexes:{},name:"e2ee_tasks",primaryKey:["taskName"]},{autoIncrement:!1,indexes:{groupJid:{columns:["groupJid"],unique:!1},userJid:{columns:["userJid"],unique:!1}},name:"e2ee_senderKeySessions",primaryKey:["id"]},{autoIncrement:!1,indexes:{},name:"e2ee_personalSenderKeyStatuses",primaryKey:["groupJid"]},{autoIncrement:!0,indexes:{altIndex:{columns:["altIndex"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],unique:!1},thread:{columns:["thread"],unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]},{autoIncrement:!0,indexes:{externalId:{columns:["externalId"],unique:!1},msgId:{columns:["msgId"],unique:!1},thread:{columns:["thread"],unique:!1}},name:"e2ee_unrenderedMessages",primaryKey:["rowId"]},{autoIncrement:!0,indexes:{externalIdWithType:{columns:["externalIdWithType"],unique:!1}},name:"e2ee_pendingStanzas",primaryKey:["rowId"]},{autoIncrement:!1,indexes:{threadId:{columns:["threadId"],unique:!1},userJid:{columns:["userJid"],unique:!1}},name:"e2ee_participants",primaryKey:["id"]},{autoIncrement:!1,indexes:{},name:"e2ee_contacts",primaryKey:["contactJid"]},{autoIncrement:!1,indexes:{},name:"e2ee_receipts",primaryKey:["msgId"]},{autoIncrement:!0,indexes:{"*msgIds":{columns:["msgIds"],multiEntry_DO_NOT_USE:!0},hashedPlaintextHash:{columns:["hashedPlaintextHash"]}},name:"e2ee_media",primaryKey:["mediaId"]},{autoIncrement:!0,indexes:{externalId:{columns:["externalId"],unique:!1},reactionId:{columns:["reactionId"],unique:!1},reactToExternalId:{columns:["reactToExternalId"],unique:!1},reactToMsgId:{columns:["reactToMsgId"],unique:!1},threadJid:{columns:["threadJid"],unique:!1}},name:"e2ee_reactions",primaryKey:["rowId"]},{autoIncrement:!0,indexes:{hashedPlaintextHash:{columns:["hashedPlaintextHash"]}},name:"e2ee_chunk",primaryKey:["chunkId"]},{autoIncrement:!0,indexes:{jid:{columns:["jid"]},threadOrder:{columns:["threadOrder"],unique:!1}},name:"e2ee_threads",primaryKey:["chatId"]},{autoIncrement:!1,indexes:{},name:"e2ee_existingUsers",primaryKey:["id"]},{autoIncrement:!1,indexes:{},name:"e2ee_pendingReceipts",primaryKey:["id"]},{autoIncrement:!0,indexes:{version:{columns:["version"]}},name:"e2ee_browserEncryptionMeta",primaryKey:["id"]},{autoIncrement:!1,indexes:{},name:"e2ee_ftsBackloggedMessages",primaryKey:["rowId"]},{autoIncrement:!1,indexes:{},name:"e2ee_ftsEncryptionMeta",primaryKey:["key"]},{autoIncrement:!0,indexes:{"*prefixes":{columns:["prefixes"],multiEntry_DO_NOT_USE:!0,unique:!1},chatId:{columns:["chatId"],unique:!1},id:{columns:["id"],unique:!1}},name:"e2ee_ftsIndexV3",primaryKey:["ftsRowId"]},{autoIncrement:!0,indexes:{uniqKey:{columns:["uniqKey"]}},name:"e2ee_jobs",primaryKey:["jobId"]},{autoIncrement:!1,indexes:{},name:"e2ee_identity",primaryKey:["deviceJid"]},{autoIncrement:!1,indexes:{threadId:{columns:["threadId"],unique:!1}},name:"e2ee_groupInfo",primaryKey:["groupJid"]}];b=[{autoIncrement:!0,indexes:{altIndex:{columns:["altIndex"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],unique:!1},thread:{columns:["thread"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]}];c=[{autoIncrement:!0,indexes:{altIndex:{columns:["altIndex"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],unique:!1},revokedExternalId:{columns:["revokedExternalId"],unique:!1},thread:{columns:["thread"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]}];e=[{autoIncrement:!0,indexes:{},name:"e2ee_isDualSend",primaryKey:["rowId"]}];f=[{autoIncrement:!1,indexes:{},name:"e2ee_historySyncQRCodeSecretKey",primaryKey:["key"]}];var h=[{autoIncrement:!0,indexes:{externalId:{columns:["externalId"],unique:!1},messageDeleteForMeTs:{columns:["messageDeleteForMeTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},thread:{columns:["thread"],unique:!1}},name:"e2ee_unrenderedMessages",primaryKey:["rowId"]}],i=[{autoIncrement:!0,indexes:{altIndex:{columns:["altIndex"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],unique:!1},revokedExternalId:{columns:["revokedExternalId"],unique:!1},thread:{columns:["thread"],unique:!1},threadJid:{columns:["threadJid"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]},{autoIncrement:!0,indexes:{externalId:{columns:["externalId"],unique:!1},messageDeleteForMeTs:{columns:["messageDeleteForMeTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},thread:{columns:["thread"],unique:!1},threadJid:{columns:["threadJid"],unique:!1}},name:"e2ee_unrenderedMessages",primaryKey:["rowId"]}],j=[{autoIncrement:!1,indexes:{inviterJid:{columns:["inviterJid"],unique:!1}},name:"e2ee_groupInvites",primaryKey:["invitedParticipantId"]}],k=[{autoIncrement:!0,indexes:{deleteTs:{columns:["deleteTs"],unique:!1},externalIdWithType:{columns:["externalIdWithType"],unique:!1}},name:"e2ee_pendingStanzas",primaryKey:["rowId"]}],l=[{autoIncrement:!0,indexes:{"*msgIds":{columns:["msgIds"],multiEntry_DO_NOT_USE:!0},fbid:{columns:["fbid"]},hashedPlaintextHash:{columns:["hashedPlaintextHash"]},objectId:{columns:["objectId"]}},name:"e2ee_media",primaryKey:["mediaId"]}],m=[{autoIncrement:!0,indexes:{},name:"e2ee_dualSendMedia",primaryKey:["id"]}],n=[{autoIncrement:!0,indexes:{associatedMessageId:{columns:["associatedMessageId"],unique:!1},defaultPreviewMediaId:{columns:["defaultPreviewMediaId"],unique:!1},faviconMediaId:{columns:["faviconMediaId"],unique:!1},headerMediaId:{columns:["headerMediaId"],unique:!1},targetExpiringAtSec:{columns:["targetExpiringAtSec"],unique:!1}},name:"e2ee_xma",primaryKey:["xmaId"]}],o=[{autoIncrement:!1,indexes:{},name:"e2ee_historySyncQRCodeData",primaryKey:["rowId"]}],p=[{autoIncrement:!0,indexes:{associatedMessageId:{columns:["associatedMessageId"],unique:!1},defaultPreviewMediaId:{columns:["defaultPreviewMediaId"],unique:!1},externalId:{columns:["externalId"],unique:!1},faviconMediaId:{columns:["faviconMediaId"],unique:!1},headerMediaId:{columns:["headerMediaId"],unique:!1},targetExpiringAtSec:{columns:["targetExpiringAtSec"],unique:!1}},name:"e2ee_xma",primaryKey:["xmaId"]}],q=[{autoIncrement:!0,indexes:{},name:"e2ee_dyiBatch",primaryKey:["batchId"]}],r=[{autoIncrement:!1,indexes:{correspondingOpenThreadKey:{columns:["correspondingOpenThreadKey"],unique:!1},threadId:{columns:["threadId"],unique:!1}},name:"e2ee_groupInfo",primaryKey:["groupJid"]}],s=[{autoIncrement:!1,indexes:{},name:"e2ee_groupInvites",primaryKey:["invitedParticipantId","inviterJid"],removed:!0}],t=[{autoIncrement:!1,indexes:{inviterJid:{columns:["inviterJid"],unique:!1}},name:"e2ee_groupInvites",primaryKey:["invitedParticipantId","inviterJid"]}],u=[{autoIncrement:!0,indexes:{"[thread+sortOrderMs]":{columns:["thread","sortOrderMs"],unique:!1},altIndex:{columns:["altIndex"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],unique:!1},revokedExternalId:{columns:["revokedExternalId"],unique:!1},thread:{columns:["thread"],unique:!1},threadJid:{columns:["threadJid"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]},{autoIncrement:!0,indexes:{"[thread+sortOrderMs]":{columns:["thread","sortOrderMs"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteForMeTs:{columns:["messageDeleteForMeTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},thread:{columns:["thread"],unique:!1},threadJid:{columns:["threadJid"],unique:!1}},name:"e2ee_unrenderedMessages",primaryKey:["rowId"]}],v=[{autoIncrement:!1,indexes:{"[modelId+modelType+actionState]":{columns:["modelId","modelType","actionState"],unique:!1},action:{columns:["action"],unique:!1},actionState:{columns:["actionState"],unique:!1},collection:{columns:["collection"],unique:!1},indexMac:{columns:["indexMac"],unique:!1}},name:"e2ee_syncActions",primaryKey:["index"]}],w=[{autoIncrement:!1,indexes:{},name:"e2ee_missingKeys",primaryKey:["keyHex"]}],x=[{autoIncrement:!0,indexes:{action:{columns:["action"],unique:!1},collection:{columns:["collection"],unique:!1},index:{columns:["index"],unique:!1}},name:"e2ee_pendingMutations",primaryKey:["id"]}],y=[{autoIncrement:!0,indexes:{collection:{columns:["collection"]}},name:"e2ee_collectionVersions",primaryKey:["id"]}],z=[{autoIncrement:!0,indexes:{keyEpoch:{columns:["keyEpoch"],unique:!1},keyId:{columns:["keyId"]}},name:"e2ee_syncKeys",primaryKey:["id"]}],A=[{autoIncrement:!1,indexes:{userJid:{columns:["userJid"],unique:!1}},name:"e2ee_identity",primaryKey:["deviceJid"]}],B=[{autoIncrement:!1,indexes:{externalId:{columns:["externalId"],unique:!1},lastRetryTs:{columns:["lastRetryTs"],unique:!1},traceId:{columns:["traceId"],unique:!1}},name:"e2ee_uploadRetryStatus",primaryKey:["externalId","lastRetryTs"]}],C=[{autoIncrement:!0,indexes:{jid:{columns:["jid"],unique:!1},stanzaId:{columns:["stanzaId"],unique:!1},type:{columns:["type"],unique:!1}},name:"e2ee_stanzaQueue",primaryKey:["stanzaQueueId"]}],D=[{autoIncrement:!0,indexes:{},name:"e2ee_deviceChangeAlerts",primaryKey:["deviceChangeAlertsId"]}],E=[{autoIncrement:!1,indexes:{},name:"e2ee_retroactiveBackupsState",primaryKey:["threadId"]}],F=[{autoIncrement:!0,indexes:{deduplicationKey:{columns:["deduplicationKey"],predicate:function(a){return a.deduplicationKey!=null}},jid:{columns:["jid"]},threadOrder:{columns:["threadOrder"],unique:!1}},name:"e2ee_threads",primaryKey:["chatId"]}],G=[{autoIncrement:!0,indexes:{mediaId:{columns:["mediaId"],unique:!1},msgId:{columns:["msgId"],unique:!1},objectId:{columns:["objectId"]}},name:"e2ee_mediaBackup",primaryKey:["mediaBackupId"]}],H=[{autoIncrement:!0,indexes:{authoritativeThreadKey:{columns:["authoritativeThreadKey"]},deduplicationKey:{columns:["deduplicationKey"],predicate:function(a){return a.deduplicationKey!=null}},jid:{columns:["jid"]},threadOrder:{columns:["threadOrder"],unique:!1}},name:"e2ee_threads",primaryKey:["chatId"]}],I=[{autoIncrement:!0,indexes:{"[jid+type]":{columns:["jid","type"],unique:!1},jid:{columns:["jid"],unique:!1},stanzaId:{columns:["stanzaId"],unique:!1},type:{columns:["type"],unique:!1}},name:"e2ee_stanzaQueue",primaryKey:["stanzaQueueId"]}],J=[{autoIncrement:!0,indexes:{originalMsgExternalId:{columns:["originalMsgExternalId"],unique:!1},threadJid:{columns:["threadJid"],unique:!1}},name:"e2ee_editMsgHistory",primaryKey:["editMsgHistoryId"]}],K=[{autoIncrement:!1,indexes:{},name:"e2ee_ftsBackloggedMessages",primaryKey:["rowId"],removed:!0},{autoIncrement:!1,indexes:{},name:"e2ee_ftsEncryptionMeta",primaryKey:["key"],removed:!0},{autoIncrement:!0,indexes:{},name:"e2ee_ftsIndexV3",primaryKey:["ftsRowId"],removed:!0}],L=[{autoIncrement:!0,indexes:{"*msgIds":{columns:["msgIds"],multiEntry_DO_NOT_USE:!0},fbid:{columns:["fbid"],unique:!1},hashedPlaintextHash:{columns:["hashedPlaintextHash"]},objectId:{columns:["objectId"],unique:!1}},name:"e2ee_media",primaryKey:["mediaId"]}],M=[{autoIncrement:!0,indexes:{},name:"e2ee_ebRestoreQueue",primaryKey:["queueId"]},{autoIncrement:!0,indexes:{},name:"e2ee_ebUploadQueue",primaryKey:["queueId"]}],N=[{autoIncrement:!0,indexes:{"[uploadStatus+uploadTsSec]":{columns:["uploadStatus","uploadTsSec"],unique:!1},uploadStatus:{columns:["uploadStatus"],unique:!1},uploadTsSec:{columns:["uploadTsSec"],unique:!1}},name:"e2ee_ebRestoreQueue",primaryKey:["queueId"]},{autoIncrement:!0,indexes:{"[uploadStatus+uploadTsSec]":{columns:["uploadStatus","uploadTsSec"],unique:!1},uploadStatus:{columns:["uploadStatus"],unique:!1},uploadTsSec:{columns:["uploadTsSec"],unique:!1}},name:"e2ee_ebUploadQueue",primaryKey:["queueId"]}],O=[{autoIncrement:!0,indexes:{"[thread+serverTs]":{columns:["thread","serverTs"],unique:!1},"[thread+sortOrderMs]":{columns:["thread","sortOrderMs"],unique:!1},altIndex:{columns:["altIndex"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],unique:!1},revokedExternalId:{columns:["revokedExternalId"],unique:!1},thread:{columns:["thread"],unique:!1},threadJid:{columns:["threadJid"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]}],P=[{autoIncrement:!0,indexes:{},name:"e2ee_jobs",primaryKey:[],removed:!0}],Q=[{autoIncrement:!0,indexes:{},name:"e2ee_danglingQueue",primaryKey:["queueId"]}],R=[{autoIncrement:!0,indexes:{dbVersion:{columns:["dbVersion"],unique:!1}},name:"e2ee_staleQueue",primaryKey:["staleQueueId"]}],S=[{autoIncrement:!0,indexes:{"[offlineThreadingId+backupActionType]":{columns:["offlineThreadingId","backupActionType"],unique:!1},"[uploadStatus+uploadTsSec]":{columns:["uploadStatus","uploadTsSec"],unique:!1},backupActionType:{columns:["backupActionType"],unique:!1},msgIdKey:{columns:["msgIdKey"],unique:!1},offlineThreadingId:{columns:["offlineThreadingId"],unique:!1},uploadStatus:{columns:["uploadStatus"],unique:!1},uploadTsSec:{columns:["uploadTsSec"],unique:!1}},name:"e2ee_ebUploadQueue",primaryKey:["queueId"]}],T=[{autoIncrement:!1,indexes:{},name:"e2ee_ftsBackloggedMessages",primaryKey:["rowId"]},{autoIncrement:!1,indexes:{},name:"e2ee_ftsEncryptionMeta",primaryKey:["key"]},{autoIncrement:!0,indexes:{"*prefixes":{columns:["prefixes"],multiEntry_DO_NOT_USE:!0,unique:!1},chatId:{columns:["chatId"],unique:!1},id:{columns:["id"],unique:!1}},name:"e2ee_ftsIndexV3",primaryKey:["ftsRowId"]}],U=[{autoIncrement:!1,indexes:{"[threadJid+userJid]":{columns:["threadJid","userJid"],unique:!1},threadId:{columns:["threadId"],unique:!1},userJid:{columns:["userJid"],unique:!1}},name:"e2ee_participants",primaryKey:["id"]}],V=[{autoIncrement:!0,indexes:{},name:"e2ee_pendingMessageStanzaQueue",primaryKey:["pendingMessageStanzaQueueId"]}],W=[{autoIncrement:!0,indexes:{author:{columns:["author"],unique:!1},chat:{columns:["chat"],unique:!1},externalId:{columns:["externalId"],unique:!1}},name:"e2ee_deletedMessages",primaryKey:["rowId"]}],X=[{autoIncrement:!0,indexes:{threadJid:{columns:["threadJid"],unique:!1}},name:"e2ee_ebMsgRanges",primaryKey:["rangeId"]}],Y=[{autoIncrement:!1,indexes:{inviterJid:{columns:["inviterJid"],unique:!1},threadJid:{columns:["threadJid","inviteeJid"],unique:!1}},name:"e2ee_groupInvites",primaryKey:["invitedParticipantId","inviterJid"]}],Z=[{autoIncrement:!1,indexes:{waMsgId:{columns:["waMsgId"]}},name:"e2ee_receipts",primaryKey:["msgId"]}],$=[{autoIncrement:!0,indexes:{"[jid+priority]":{columns:["jid","priority"],unique:!1},"[jid+type]":{columns:["jid","type"],unique:!1},jid:{columns:["jid"],unique:!1},priority:{columns:["priority"],unique:!1},stanzaId:{columns:["stanzaId"],unique:!1},type:{columns:["type"],unique:!1}},name:"e2ee_stanzaQueue",primaryKey:["stanzaQueueId"]}],aa=[{autoIncrement:!0,indexes:{"[thread+serverTs]":{columns:["thread","serverTs"],unique:!1},"[thread+sortOrderMs]":{columns:["thread","sortOrderMs"],unique:!1},altIndex:{columns:["altIndex"],unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],unique:!1},revokedExternalId:{columns:["revokedExternalId"],unique:!1},threadJid:{columns:["threadJid"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]}],ba=[{autoIncrement:!0,indexes:{"[thread+serverTs]":{columns:["thread","serverTs"],predicate:function(a){return a.serverTs!=null},unique:!1},"[thread+sortOrderMs]":{columns:["thread","sortOrderMs"],unique:!1},"[threadJid+sortOrderMs]":{columns:["threadJid","sortOrderMs"],unique:!1},altIndex:{columns:["altIndex"],predicate:function(a){return a.altIndex!=null},unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],predicate:function(a){return a.messageDeleteTs!=null},unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],predicate:function(a){return a.messageExpirationTs!=null},unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],predicate:function(a){return a.quoteExternalId!=null},unique:!1},revokedExternalId:{columns:["revokedExternalId"],predicate:function(a){return a.revokedExternalId!=null},unique:!1},threadJid:{columns:["threadJid"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],predicate:function(a){return a.unsendMsgContentDeleteTs!=null},unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]}],ca=[{autoIncrement:!1,dexieOnly_primaryKeyUnique:!0,indexes:{ts:{columns:["ts"],unique:!1}},name:"e2ee_sentBytesCache",primaryKey:["waMsgId"]}],da=[{autoIncrement:!0,indexes:{"[thread+serverTs]":{columns:["thread","serverTs"],predicate:function(a){return a.serverTs!=null},unique:!1},"[threadJid+sortOrderMs]":{columns:["threadJid","sortOrderMs"],unique:!1},altIndex:{columns:["altIndex"],predicate:function(a){return a.altIndex!=null},unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],predicate:function(a){return a.messageDeleteTs!=null},unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],predicate:function(a){return a.messageExpirationTs!=null},unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],predicate:function(a){return a.quoteExternalId!=null},unique:!1},revokedExternalId:{columns:["revokedExternalId"],predicate:function(a){return a.revokedExternalId!=null},unique:!1},threadJid:{columns:["threadJid"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],predicate:function(a){return a.unsendMsgContentDeleteTs!=null},unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]}],ea=[{autoIncrement:!0,indexes:{"[originalMsgExternalId+threadJid]":{columns:["originalMsgExternalId","threadJid"],unique:!1}},name:"e2ee_editMsgHistory",primaryKey:["editMsgHistoryId"]}],fa=[{autoIncrement:!0,indexes:{deviceJid:{columns:["deviceJid"],unique:!1},displayOrder:{columns:["isArchived","ts"],unique:!1},isConfirmedActionTs:{columns:["isConfirmed","action","ts"],unique:!1},isNotifiedTs:{columns:["isNotified","ts"],unique:!1}},name:"e2ee_deviceChangeAlerts",primaryKey:["deviceChangeAlertsId"]},{autoIncrement:!1,indexes:{threadId:{columns:["threadId"],unique:!1}},name:"e2ee_groupInfo",primaryKey:["groupJid"]}],ga=[{autoIncrement:!0,indexes:{"[uploadStatus+uploadTsSec]":{columns:["uploadStatus","uploadTsSec"],unique:!1},backupActionType:{columns:["backupActionType"],unique:!1},msgIdKey:{columns:["msgIdKey"],unique:!1},uploadStatus:{columns:["uploadStatus"],unique:!1},uploadTsSec:{columns:["uploadTsSec"],unique:!1}},name:"e2ee_ebUploadQueue",primaryKey:["queueId"]}],ha=[{autoIncrement:!1,indexes:{},name:"e2ee_ephemeralSettings",primaryKey:["userJid"]}],ia=[{autoIncrement:!1,indexes:{ebClientRequired:{columns:["ebClientRequired","timestampMs"],unique:!1},restorable:{columns:["restorable","timestampMs"],unique:!1}},name:"e2ee_ebMessageRestoreTasks",primaryKey:["messageId"]}],ja=[{autoIncrement:!1,indexes:{},name:"e2ee_igMessageAuxiliaryInfo",primaryKey:["messageId"]}],ka=[{autoIncrement:!1,indexes:{plaintextHash:{columns:["plaintextHash"],unique:!1}},name:"e2ee_mediaKeys",primaryKey:["ciphertextHash"]}],la=[{autoIncrement:!0,indexes:{"[jid+priority]":{columns:["jid","priority"],unique:!1},jid:{columns:["jid"],unique:!1},priority:{columns:["priority"],unique:!1}},name:"e2ee_stanzaQueue",primaryKey:["stanzaQueueId"]}],ma=[{autoIncrement:!1,indexes:{"[threadJid+userJid]":{columns:["threadJid","userJid"],unique:!1},userJid:{columns:["userJid"],unique:!1}},name:"e2ee_participants",primaryKey:["id"]}],na=[{autoIncrement:!1,indexes:{},name:"e2ee_groupInfo",primaryKey:["groupJid"]}],oa=[{autoIncrement:!0,indexes:{},name:"e2ee_ebRestoreQueue",primaryKey:["queueId"]}],pa=[{autoIncrement:!1,indexes:{},name:"e2ee_ftsPurgeBacklog",primaryKey:["externalId"]},{autoIncrement:!1,indexes:{},name:"e2ee_ftsPurgeThreadBacklog",primaryKey:["chatJid"]}],qa=[{autoIncrement:!0,indexes:{"[threadJid+sortOrderMs]":{columns:["threadJid","sortOrderMs"],unique:!1},altIndex:{columns:["altIndex"],predicate:function(a){return a.altIndex!=null},unique:!1},externalId:{columns:["externalId"],unique:!1},messageDeleteTs:{columns:["messageDeleteTs"],predicate:function(a){return a.messageDeleteTs!=null},unique:!1},messageExpirationTs:{columns:["messageExpirationTs"],predicate:function(a){return a.messageExpirationTs!=null},unique:!1},msgId:{columns:["msgId"],unique:!1},quoteExternalId:{columns:["quoteExternalId"],predicate:function(a){return a.quoteExternalId!=null},unique:!1},revokedExternalId:{columns:["revokedExternalId"],predicate:function(a){return a.revokedExternalId!=null},unique:!1},threadJid:{columns:["threadJid"],unique:!1},unsendMsgContentDeleteTs:{columns:["unsendMsgContentDeleteTs"],predicate:function(a){return a.unsendMsgContentDeleteTs!=null},unique:!1}},name:"e2ee_messages",primaryKey:["rowId"]}],ra=[{autoIncrement:!0,indexes:{"*prefixes":{columns:["prefixes"],multiEntry_DO_NOT_USE:!0,unique:!1},chatId:{columns:["chatId"],unique:!1},id:{columns:["id"],unique:!1}},name:"e2ee_ftsIndexV3",primaryKey:["ftsRowId"],removed:!0}],sa=[{autoIncrement:!0,indexes:{fbid:{columns:["fbid"],unique:!1},hashedPlaintextHash:{columns:["hashedPlaintextHash"]},objectId:{columns:["objectId"],unique:!1}},name:"e2ee_media",primaryKey:["mediaId"]}],ta=[{autoIncrement:!1,indexes:{},name:"e2ee_retroactiveBackupsState",primaryKey:["threadId"],removed:!0}],ua=[{autoIncrement:!1,indexes:{},name:"e2ee_uploadRetryStatus",primaryKey:[],removed:!0}],va=[{autoIncrement:!1,indexes:{},name:"e2ee_receiverFetchInfo",primaryKey:["receiverFetchId"]}],wa=[{autoIncrement:!0,indexes:{"[threadJid+ts]":{columns:["threadJid","ts"],unique:!1},externalId:{columns:["externalId"],unique:!1},reactionId:{columns:["reactionId"],unique:!1},reactToExternalId:{columns:["reactToExternalId"],unique:!1},reactToMsgId:{columns:["reactToMsgId"],unique:!1},threadJid:{columns:["threadJid"],unique:!1},ts:{columns:["ts"],unique:!1}},name:"e2ee_reactions",primaryKey:["rowId"]}],xa=[{autoIncrement:!0,indexes:{"*msgIds":{columns:["msgIds"],multiEntry_DO_NOT_USE:!0},fbid:{columns:["fbid"],unique:!1},hashedPlaintextHash:{columns:["hashedPlaintextHash"]},objectId:{columns:["objectId"],unique:!1}},name:"e2ee_media",primaryKey:["mediaId"]}];a=new Map([[(d=d("MAWDbVersionList")).VERSION.V21,a],[d.VERSION.V22,b],[d.VERSION.V23,c],[d.VERSION.V24,e],[d.VERSION.V25,f],[d.VERSION.V30,h],[d.VERSION.V31,i],[d.VERSION.V32,j],[d.VERSION.V33,k],[d.VERSION.V34,l],[d.VERSION.V35,m],[d.VERSION.V36,n],[d.VERSION.V37,o],[d.VERSION.V38,p],[d.VERSION.V39,q],[d.VERSION.V40,r],[d.VERSION.V41,s],[d.VERSION.V42,t],[d.VERSION.V45,u],[d.VERSION.V48,v],[d.VERSION.V49,w],[d.VERSION.V50,x],[d.VERSION.V51,y],[d.VERSION.V52,z],[d.VERSION.V57,A],[d.VERSION.V59,B],[d.VERSION.V61,C],[d.VERSION.V62,D],[d.VERSION.V63,E],[d.VERSION.V64,F],[d.VERSION.V65,G],[d.VERSION.V67,H],[d.VERSION.V69,I],[d.VERSION.V70,J],[d.VERSION.V73,K],[d.VERSION.V74,L],[d.VERSION.V75,M],[d.VERSION.V77,N],[d.VERSION.V78,O],[d.VERSION.V79,P],[d.VERSION.V80,Q],[d.VERSION.V81,R],[d.VERSION.V83,S],[d.VERSION.V84,T],[d.VERSION.V85,U],[d.VERSION.V86,V],[d.VERSION.V88,W],[d.VERSION.V89,X],[d.VERSION.V90,Y],[d.VERSION.V91,Z],[d.VERSION.V92,$],[d.VERSION.V93,aa],[d.VERSION.V94,ba],[d.VERSION.V95,ca],[d.VERSION.V96,da],[d.VERSION.V97,ea],[d.VERSION.V98,fa],[d.VERSION.V99,ga],[d.VERSION.V100,ha],[d.VERSION.V102,ia],[d.VERSION.V103,ja],[d.VERSION.V104,ka],[d.VERSION.V105,la],[d.VERSION.V106,ma],[d.VERSION.V107,na],[d.VERSION.V108,oa],[d.VERSION.V109,pa],[d.VERSION.V110,qa],[d.VERSION.V111,ra],[d.VERSION.V112,sa],[d.VERSION.V113,ta],[d.VERSION.V114,ua],[d.VERSION.V115,va],[d.VERSION.V116,wa],[d.VERSION.V117,xa]]);b=["messages","unrenderedMessages","groupInfo","meta","identity","prekey","prekeyGeneration","session","signedPrekey","senderKeySessions","receipts","pendingReceipts","threads","contacts","participants","tasks","personalSenderKeyStatuses","appData","appMeta","chunk","mediaBackup","media","reactions","groupInvites","dyiBatch","syncActions","missingKeys","pendingMutations","collectionVersions","syncKeys","deviceChangeAlerts","xma","editMsgHistory","deletedMessages","ebMsgRanges","receiverFetchInfo"];g.dbSchema=a;g.TABLES_TO_ENCRYPT=b}),98);
__d("MAWGetDbVersion",["MAWDbVersionList","justknobx","objectValues"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(){var a;return(a=h)!=null?a:d("MAWDbVersionList").toVersion(c("justknobx")._("1716"))}function b(a){if(!c("justknobx")._("1495"))return;if(a==null){h=null;return h}if(a==="current"){h=null;return h}var b=Math.max.apply(Math,c("objectValues")(d("MAWDbVersionList").VERSION));if(a==="latest"){h=d("MAWDbVersionList").toVersion(b);return h}if(!Number.isInteger(a))return h;if(a<0){h=d("MAWDbVersionList").toVersion(b+a);return h}h=d("MAWDbVersionList").toVersion(a)}g.getArmadilloDbVersion=a;g.setArmadilloDbVersionForTest=b}),98);
__d("sortBy",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a=a.map(function(a,c){return{index:c,sortValue:b(a),value:a}});a.sort(function(a,b){var c=a.sortValue,d=b.sortValue;if(c>d)return 1;return c<d?-1:a.index-b.index});return a.map(function(a){return a.value})}f["default"]=a}),66);
__d("MAWDbSchema.restore",["MAWDbSchema","MAWGetDbVersion","objectEntries","sortBy"],(function(a,b,c,d,e,f,g){"use strict";a={e2ee_appData:!0,e2ee_appMeta:!0,e2ee_chunk:!0,e2ee_collectionVersions:!0,e2ee_deletedMessages:!0,e2ee_deviceChangeAlerts:!0,e2ee_dyiBatch:!0,e2ee_ebMessageRestoreTasks:!0,e2ee_ebMsgRanges:!0,e2ee_ebUploadQueue:!0,e2ee_editMsgHistory:!0,e2ee_ephemeralSettings:!0,e2ee_existingUsers:!0,e2ee_ftsBackloggedMessages:!0,e2ee_ftsEncryptionMeta:!0,e2ee_ftsIndexV3:!0,e2ee_ftsPurgeBacklog:!0,e2ee_ftsPurgeThreadBacklog:!0,e2ee_groupInfo:!0,e2ee_groupInvites:!0,e2ee_historySyncQRCodeData:!0,e2ee_historySyncQRCodeSecretKey:!0,e2ee_igMessageAuxiliaryInfo:!0,e2ee_isDualSend:!0,e2ee_media:!0,e2ee_mediaBackup:!0,e2ee_messages:!0,e2ee_missingKeys:!0,e2ee_participants:!0,e2ee_pendingMessageStanzaQueue:!0,e2ee_pendingMutations:!0,e2ee_pendingReceipts:!0,e2ee_pendingStanzas:!0,e2ee_reactions:!0,e2ee_receiverFetchInfo:!0,e2ee_syncActions:!0,e2ee_syncKeys:!0,e2ee_threads:!0,e2ee_unrenderedMessages:!0,e2ee_xma:!0};function h(a){var b=Object.fromEntries(c("objectEntries")(a.indexes).filter(function(a){a=a[1];return a.multiEntry_DO_NOT_USE!==!0}).map(function(b){var c=b[0];b=b[1];return[c,{columns:[].concat(b.columns,b.unique!==!1?[]:a.primaryKey),predicate:b.predicate}]}));b={auto_increment:a.autoIncrement===!0,indexes:b,name:a.name,primary_key:a.primaryKey};return b}var i=c("sortBy")(Array.from(d("MAWDbSchema").dbSchema.entries()),function(a){a=a[0];return a}).map(function(a){var b=a[0];a=a[1];return{schema:a,version:b}});b=function(a){return Array.from(i.filter(function(b){return b.version<=a&&b.schema!=null}).reduce(function(a,b){(b=b.schema)==null?void 0:b.forEach(function(b){if(b.removed===!0){a["delete"](b.name);return}a.set(b.name,h(b))});return a},new Map()).values())};e=b(d("MAWGetDbVersion").getArmadilloDbVersion());g.msgrDbStores=a;g.getSchemaForVersion=b;g.clientSchema=e}),98);
__d("WAStanzaUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.toStanzaId=a}),66);
__d("MAWExternalId",["I64","Random","WAStanzaUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i=131071;function j(a){return Math.floor(c("Random").random()*a)}function a(){return d("WAStanzaUtils").toStanzaId((h||(h=d("I64"))).to_string(h.and_(h.or_(h.lsl_(h.of_float(Date.now()),22),h.and_(h.of_float(j(i)),h.of_float(i))),h.max_int)))}g.generateExternalId=a}),98);
__d("MNLSXMALayoutType",[],(function(a,b,c,d,e,f){a=Object.freeze({SINGLE:0,HSCROLL:1,XCENTER:2,PORTRAIT:4,LAYERED:5,PLACEHOLDER:6,EXPIRED_PLACEHOLDER:7,PILE_PROMPT:8,STACK:9,SHARED_STACK:10,STACK_CARD:11,STANDARD_DXMA:12,DXMA_PLACEHOLDER:13,THREAD_SHORTCUT:14,LIST_DXMA:15,GRID:16,BLOKS_XMA:17,TWO_CARD:18,NOTE:19,VSTACK:20,SQUIRCLE:21});f["default"]=a}),66);
__d("MNXMAPreviewImageDecorationType",[],(function(a,b,c,d,e,f){a=Object.freeze({DEFAULT:0,COLLAGE:1,VIDEO:2,MESSENGER_ICON:3,INSTAGRAM_ICON:4,SHOPPING:5,UPCOMING_EVENT:6,LIVE:7,REEL:8,IGTV:9,YOUTUBE_VIDEO:10,YOUTUBE_SHORTS:11,COMMENT:12,BLUR:13,PILL:14,MESSENGER_CHANNEL_IMAGE:15,TROPHY:16,DXMA_LIVE:17,DXMA_LIVE_ENDED:18});f["default"]=a}),66);
__d("MessagingAttachmentType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,STICKER:1,IMAGE:2,ANIMATED_IMAGE:3,VIDEO:4,AUDIO:5,FILE:6,XMA:7,EPHEMERAL_IMAGE:8,EPHEMERAL_VIDEO:9,SELFIE_STICKER:10,SOUND_BITE:12,CATALOG_ITEM:13,POWER_UP:14,THIRD_PARTY_STICKER:15});f["default"]=a}),66);
__d("XPlatReactCrypto",["err"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h=self.crypto)==null?void 0:h.subtle;function a(a){var b;if(typeof ((b=self.crypto)==null?void 0:b.getRandomValues)!=="function")throw c("err")("crypto.getRandomValues: Not implemented");self.crypto.getRandomValues(a);return a}function b(){var a;if(typeof ((a=self.crypto)==null?void 0:a.randomUUID)!=="function")return null;a=self.crypto.randomUUID();return typeof a==="string"?a:null}function d(a,b,d,e,f){if(i==null)throw c("err")("crypto.subtle.importKey: Not implemented");return i.importKey(a,b,d,e,f)}function e(a,b){if(i==null)throw c("err")("crypto.subtle.exportKey: Not implemented");return i.exportKey(a,b)}function f(a,b,d){if(i==null)throw c("err")("crypto.subtle.generateKey: Not implemented");return i.generateKey(a,b,d)}function j(a,b,d){if(i==null)throw c("err")("crypto.subtle.encrypt: Not implemented");return i.encrypt(a,b,d)}function k(a,b,d){if(i==null)throw c("err")("crypto.subtle.decrypt: Not implemented");return i.decrypt(a,b,d)}function l(a,b,d){if(i==null)throw c("err")("crypto.subtle.sign: Not implemented");return i.sign(a,b,d)}function m(a,b){if(i==null)throw c("err")("crypto.subtle.digest: Not implemented");return i.digest(a,b)}function n(a,b,d){if(i==null)throw c("err")("crypto.subtle.deriveBits: Not implemented");return i.deriveBits(a,b,d)}function o(a,b,d,e,f){if(i==null)throw c("err")("crypto.subtle.deriveKey: Not implemented");return i.deriveKey(a,b,d,e,f)}g.getRandomValues=a;g.randomUUID=b;g.subtleImportKey=d;g.subtleExportKey=e;g.subtleGenerateKey=f;g.subtleEncrypt=j;g.subtleDecrypt=k;g.subtleSign=l;g.subtleDigest=m;g.subtleDeriveBits=n;g.subtleDeriveKey=o}),98);
__d("OfflineThreadingId",["I64","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("I64"))).of_string("4194303");function a(){return(h||(h=d("I64"))).to_string(j())}function j(){var a=d("XPlatReactCrypto").getRandomValues(new Uint8Array(8));a=new DataView(a.buffer);a=(h||(h=d("I64"))).add(h.lsl_(h.of_int32(a.getUint32(0)),32),h.of_int32(a.getUint32(4)));return k(Date.now(),a)}function k(a,b){return(h||(h=d("I64"))).and_(h.or_(h.lsl_(h.of_float(a),22),h.and_(b,i)),h.max_int)}function b(a){var b=j(),c=[];for(var e=0;e<a.length;e++)c.push([a[e],(h||(h=d("I64"))).to_string(b)]),b=l(b);return c}function l(a,b){b===void 0&&(b=(h||(h=d("I64"))).one);var c=m(a);a=n(a);return k(c,(h||(h=d("I64"))).add(a,b))}function m(a){return(h||(h=d("I64"))).to_float(h.lsr_(a,22))}function n(a){return(h||(h=d("I64"))).and_(a,i)}g.createOfflineThreadingID=a;g.createForItemsInOrder=b;g.extractTimestamp=m}),98);
__d("ReStoreDecryptionFailure",[],(function(a,b,c,d,e,f){"use strict";var g="ReStoreDecryptionFailure";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;b=b+" - Encrypted Restore was unable to decrypt an entity for table "+c;d=a.call(this,b)||this;d.message=b;d.name=g;d.tableName=c;return d}var c=b.prototype;c.getTableName=function(){return this.tableName};return b}(babelHelpers.wrapNativeSuper(Error));f.ERROR_NAME=g;f.ReStoreDecryptionFailure=a}),66);
__d("ReStoreEARSetupFailure",[],(function(a,b,c,d,e,f){"use strict";var g="Encryption keychain could not be setup",h="ReStoreEARSetupFailure";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;b=g+": "+b;c=a.call(this,b)||this;c.message=b;c.name=h;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.ERROR_MESSAGE=g;f.ERROR_NAME=h;f.ReStoreEARSetupFailure=a}),66);
__d("ReStoreEvent",[],(function(a,b,c,d,e,f){"use strict";a=function(){};f["default"]=a}),66);
__d("ReStoreMetadata",["ReStoreDefaultValuesMetadata","ReStoreIndexMetadata","ReStorePersistedMetadata"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return!0}function a(a){var b=a.reduce(function(a,b){return function(c){return c[b]!=null&&a(c)}},h);b.toString=function(){return"dynamic predicate on ["+a.join(",")+"]"};return b}function b(a){return function(b){var c={},d={};for(var b=b,e=Array.isArray(b),f=0,b=e?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=b.length)break;g=b[f++]}else{f=b.next();if(f.done)break;g=f.value}g=g;for(var g=g,h=Array.isArray(g),i=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j,k;if(h){if(i>=g.length)break;k=g[i++]}else{i=g.next();if(i.done)break;k=i.value}k=k;k.id!=null&&(c[k.id]=k.name);d[k.name]={autoIncrement:(j=k.auto_increment)!=null?j:!1,cascadeUpdates:(j=a[k.name])!=null?j:[],indexes:(j=Object.fromEntries(Object.entries((j=k.indexes)!=null?j:{}).map(function(a){var b=a[0];a=a[1].columns;return[b,a]})))!=null?j:{},indexPredicates:Object.fromEntries(Object.entries((j=k.indexes)!=null?j:{}).filter(function(a){a[0];a=a[1];return a.predicate}).map(function(a){var b=a[0];a=a[1];return[b,a.predicate]})),name:k.name,primaryKeyIds:k.primary_key}}}return{tableIds:c,tableNames:d}}}e=(c={},c[d("ReStoreDefaultValuesMetadata").defaultValuesTableName]={autoIncrement:!1,cascadeUpdates:[],indexes:{},name:d("ReStoreDefaultValuesMetadata").defaultValuesTableName,primaryKeyIds:["t"]},c[d("ReStoreIndexMetadata").indicesTableName]={autoIncrement:!1,cascadeUpdates:[],indexes:{},name:d("ReStoreIndexMetadata").indicesTableName,primaryKeyIds:["tableName","indexName"]},c[d("ReStorePersistedMetadata").schemaMetadataTableName]={autoIncrement:!1,cascadeUpdates:[],indexes:{},name:d("ReStorePersistedMetadata").schemaMetadataTableName,primaryKeyIds:[]},c);g.createPredicate=a;g.getBuildTableData=b;g.RESTORE_METADATA_TABLES=e}),98);
__d("ReStoreHashSchemaProvider",["ReStoreHashMigration","ReStoreMetadata","ReStoreMigrateUtil","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){var e=b.tableIds;b=b.tableNames;c===void 0&&(c={});this.$1=a;this.tableNames=babelHelpers["extends"]({},b,d("ReStoreMetadata").RESTORE_METADATA_TABLES);this.tableIds=e;this.defaults=(a=c)!=null?a:{}}var c=a.prototype;c.migrate=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c;(b=a.loggers.logHistory)==null?void 0:b.debug("["+this.$1+"][ReStoreHashSchemaProvider] Start migration");(b=a.loggers.userFlow)==null?void 0:b.addAnnotations(d("ReStoreMigrateUtil").prefixAnnotations(this.$1,{string:{schemaProviderType:"hash"}}));(b=a.loggers.userFlow)==null?void 0:b.addPoint(this.$1+"_migration_hash_start");b=(yield d("ReStoreHashMigration").runHashMigration(this.$1,{tableIds:this.tableIds,tableNames:this.tableNames},this.defaults,a));(c=a.loggers.logHistory)==null?void 0:c.debug("["+this.$1+"][ReStoreHashSchemaProvider] End migration. Result: "+b);(c=a.loggers.userFlow)==null?void 0:c.addPoint(this.$1+"_migration_hash_end");return b});function c(b){return a.apply(this,arguments)}return c}();return a}();g["default"]=a}),98);
__d("ReStoreIndexedDbClosedEvent",["ReStoreEvent"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this)||this;d.idb=b;d.error=c;return d}var c=b.prototype;c.getError=function(){return this.error};return b}(c("ReStoreEvent"));g["default"]=a}),98);
__d("ReStoreIndexedDbFailToOpenEvent",["ReStoreEvent"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c("ReStoreEvent"));g["default"]=a}),98);
__d("ReStoreIndexedDbUpgradedEvent",["ReStoreEvent"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c("ReStoreEvent"));g["default"]=a}),98);
__d("ReStoreUnexpectedlyClosed",[],(function(a,b,c,d,e,f){"use strict";a="ReStoreUnexpectedlyClosed";b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(babelHelpers.wrapNativeSuper(Error));f.ERROR_NAME=a;f.ReStoreUnexpectedlyClosed=b}),66);
__d("URLMatcherConfig",[],(function(a,b,c,d,e,f){e.exports={tlds:"(?:\\.(com|\ud55c\uad6d|\uc0bc\uc131|\ub2f7\ucef4|\ub2f7\ub137|\u9999\u6e2f|\u9999\u683c\u91cc\u62c9|\u9910\u5385|\u98df\u54c1|\u98de\u5229\u6d66|\u96fb\u8a0a\u76c8\u79d1|\u96c6\u56e2|\u901a\u8ca9|\u8d2d\u7269|\u8c37\u6b4c|\u8bfa\u57fa\u4e9a|\u8054\u901a|\u7f51\u7edc|\u7f51\u7ad9|\u7f51\u5e97|\u7f51\u5740|\u7ec4\u7ec7\u673a\u6784|\u79fb\u52a8|\u73e0\u5b9d|\u70b9\u770b|\u6fb3\u9580|\u6e38\u620f|\u6de1\u9a6c\u9521|\u673a\u6784|\u66f8\u7c4d|\u65f6\u5c1a|\u65b0\u95fb|\u65b0\u52a0\u5761|\u653f\u5e9c|\u653f\u52a1|\u624b\u8868|\u624b\u673a|\u6211\u7231\u4f60|\u6148\u5584|\u5fae\u535a|\u5e7f\u4e1c|\u5de5\u884c|\u5bb6\u96fb|\u5a31\u4e50|\u5929\u4e3b\u6559|\u5927\u62ff|\u5927\u4f17\u6c7d\u8f66|\u5728\u7ebf|\u5609\u91cc\u5927\u9152\u5e97|\u5609\u91cc|\u5546\u6807|\u5546\u5e97|\u5546\u57ce|\u53f0\u7063|\u53f0\u6e7e|\u516c\u76ca|\u516c\u53f8|\u516b\u5366|\u5065\u5eb7|\u4fe1\u606f|\u4f5b\u5c71|\u4f01\u4e1a|\u4e2d\u6587\u7f51|\u4e2d\u570b|\u4e2d\u56fd|\u4e2d\u4fe1|\u4e16\u754c|\u30dd\u30a4\u30f3\u30c8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|\u30bb\u30fc\u30eb|\u30b9\u30c8\u30a2|\u30b3\u30e0|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u307f\u3093\u306a|\u10d2\u10d4|\u0e44\u0e17\u0e22|\u0e04\u0e2d\u0e21|\u0dbd\u0d82\u0d9a\u0dcf|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u0cad\u0cbe\u0cb0\u0ca4|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|\u0b2d\u0b3e\u0b30\u0b24|\u0aad\u0abe\u0ab0\u0aa4|\u0a2d\u0a3e\u0a30\u0a24|\u09ad\u09be\u09f0\u09a4|\u09ad\u09be\u09b0\u09a4|\u09ac\u09be\u0982\u09b2\u09be|\u0938\u0902\u0917\u0920\u0928|\u092d\u093e\u0930\u094b\u0924|\u092d\u093e\u0930\u0924\u092e\u094d|\u092d\u093e\u0930\u0924|\u0928\u0947\u091f|\u0915\u0949\u092e|\u0680\u0627\u0631\u062a|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0647\u0645\u0631\u0627\u0647|\u0645\u0648\u0642\u0639|\u0645\u0648\u0628\u0627\u064a\u0644\u064a|\u0645\u0644\u064a\u0633\u064a\u0627|\u0645\u0635\u0631|\u0643\u0648\u0645|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0642\u0637\u0631|\u0641\u0644\u0633\u0637\u064a\u0646|\u0639\u0645\u0627\u0646|\u0639\u0631\u0628|\u0639\u0631\u0627\u0642|\u0634\u0628\u0643\u0629|\u0633\u0648\u0631\u064a\u0629|\u0633\u0648\u062f\u0627\u0646|\u062a\u0648\u0646\u0633|\u0628\u06be\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0628\u0627\u0632\u0627\u0631|\u0628\u0627\u0631\u062a|\u0627\u06cc\u0631\u0627\u0646|\u0627\u0645\u0627\u0631\u0627\u062a|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0628\u0648\u0638\u0628\u064a|\u05e7\u05d5\u05dd|\u0570\u0561\u0575|\u049b\u0430\u0437|\u0443\u043a\u0440|\u0441\u0440\u0431|\u0441\u0430\u0439\u0442|\u0440\u0444|\u0440\u0443\u0441|\u043e\u0440\u0433|\u043e\u043d\u043b\u0430\u0439\u043d|\u043c\u043e\u0441\u043a\u0432\u0430|\u043c\u043e\u043d|\u043c\u043a\u0434|\u043a\u043e\u043c|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0435\u044e|\u0434\u0435\u0442\u0438|\u0431\u0435\u043b|\u0431\u0433|\u03b5\u03bb|zw|zuerich|zone|zm|zippo|zip|zero|zara|zappos|za|yun|yt|youtube|you|yokohama|yoga|yodobashi|ye|yandex|yamaxun|yahoo|yachts|xyz|xxx|xperia|xn--zfr164b|xn--ygbi2ammx|xn--yfro4i67o|xn--y9a3aq|xn--xkc2dl3a5ee0h|xn--xkc2al3hye2a|xn--xhq521b|xn--wgbl6a|xn--wgbh1c|xn--w4rs40l|xn--w4r85el8fhu5dnra|xn--vuq861b|xn--vhquv|xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--unup4y|xn--tiq49xqyj|xn--tckwe|xn--t60b56a|xn--ses554g|xn--s9brj9c|xn--rvc1e0am3e|xn--rovu88b|xn--rhqv96g|xn--qxam|xn--qcka1pmc|xn--q9jyb4c|xn--pssy2u|xn--pgbs0dh|xn--pbt977c|xn--p1ai|xn--p1acf|xn--ogbpf8fl|xn--o3cw4h|xn--nyqy26a|xn--nqv7fs00ema|xn--nqv7f|xn--node|xn--ngbrx|xn--ngbe9e0a|xn--ngbc5azd|xn--mxtq1m|xn--mk1bu44c|xn--mix891f|xn--mgbx4cd0ab|xn--mgbtx2b|xn--mgbt3dhd|xn--mgbpl2fh|xn--mgbi4ecexp|xn--mgbgu82a|xn--mgberp4a5d4ar|xn--mgbca7dzdo|xn--mgbc0a9azcg|xn--mgbbh1a71e|xn--mgbbh1a|xn--mgbb9fbpob|xn--mgbayh7gpa|xn--mgbai9azgqp6j|xn--mgbab2bd|xn--mgbaam7a8h|xn--mgbaakc7dvf|xn--mgba7c0bbn0a|xn--mgba3a4f16a|xn--mgba3a3ejt|xn--mgb9awbf|xn--lgbbat1ad8j|xn--l1acc|xn--kput3i|xn--kpu716f|xn--kpry57d|xn--kprw13d|xn--kcrx77d1x4a|xn--jvr189m|xn--jlq61u9w7b|xn--j6w193g|xn--j1amh|xn--j1aef|xn--io0a7i|xn--imr513n|xn--i1b6b1a6a2e|xn--hxt814e|xn--h2brj9c8c|xn--h2brj9c|xn--h2breg3eve|xn--gk3at1e|xn--gecrj9c|xn--gckr3f0f|xn--g2xx48c|xn--fzys8d69uvgm|xn--fzc2c9e2c|xn--fpcrj9c3d|xn--flw351e|xn--fjq720a|xn--fiqz9s|xn--fiqs8s|xn--fiq64b|xn--fiq228c5hs|xn--fhbei|xn--fct429k|xn--estv75g|xn--efvy88h|xn--eckvdtc9d|xn--e1a4c|xn--d1alf|xn--d1acj3b|xn--czru2d|xn--czrs0t|xn--czr694b|xn--clchc0ea0b2g2a9gcd|xn--cg4bki|xn--cck2b3b|xn--c2br7g|xn--c1avg|xn--bck1b9a5dre4c|xn--b4w605ferd|xn--9krt00a|xn--9et52u|xn--9dbq2a|xn--90ais|xn--90ae|xn--90a3ac|xn--8y0a063a|xn--80aswg|xn--80asehdb|xn--80aqecdr1a|xn--80ao21a|xn--80adxhks|xn--6qq986b3xl|xn--6frz82g|xn--5tzm5g|xn--5su34j936bgsg|xn--55qx5d|xn--55qw42g|xn--54b7fta0cc|xn--4gbrim|xn--45q11c|xn--45brj9c|xn--45br5cyl|xn--42c2d9a|xn--3pxu8k|xn--3oq18vl8pn36a|xn--3hcrj9c|xn--3e0b707e|xn--3ds443g|xn--3bst00m|xn--30rr7y|xn--2scrj9c|xn--1qqw23a|xn--1ck2e1b|xn--11b4c3d|xin|xihuan|xfinity|xerox|xbox|wtf|wtc|ws|wow|world|works|work|woodside|wolterskluwer|wme|winners|wine|windows|win|williamhill|wiki|wien|whoswho|wf|weir|weibo|wedding|wed|website|weber|webcam|weatherchannel|weather|watches|watch|warman|wanggou|wang|walter|walmart|wales|vuelos|vu|voyage|voto|voting|vote|volvo|volkswagen|vodka|vn|vlaanderen|vivo|viva|vistaprint|vista|vision|visa|virgin|vip|vin|villas|viking|vig|video|viajes|vi|vg|vet|versicherung|verm\xf6gensberatung|verm\xf6gensberater|verisign|ventures|vegas|ve|vc|vanguard|vana|vacations|va|uz|uy|us|ups|uol|uno|university|unicom|uk|ug|uconnect|ubs|ubank|ua|tz|tw|tvs|tv|tushu|tunes|tui|tube|tt|trv|trust|travelersinsurance|travelers|travelchannel|travel|training|trading|trade|tr|toys|toyota|town|tours|total|toshiba|toray|top|tools|tokyo|today|to|tn|tmall|tm|tl|tkmaxx|tk|tjx|tjmaxx|tj|tirol|tires|tips|tiffany|tienda|tickets|tiaa|theatre|theater|thd|th|tg|tf|teva|tennis|temasek|telefonica|telecity|tel|technology|tech|team|tdk|td|tci|tc|taxi|tax|tattoo|tatar|tatamotors|target|taobao|talk|taipei|tab|sz|systems|symantec|sydney|sy|sx|swiss|swiftcover|swatch|sv|suzuki|surgery|surf|support|supply|supplies|sucks|su|style|study|studio|stream|store|storage|stockholm|stcgroup|stc|statoil|statefarm|statebank|starhub|star|staples|stada|st|srt|srl|sr|spreadbetting|spot|sport|spiegel|space|soy|sony|song|solutions|solar|sohu|software|softbank|social|soccer|so|sncf|sn|smile|smart|sm|sling|sl|skype|sky|skin|ski|sk|sj|site|singles|sina|silk|si|shriram|showtime|show|shouji|shopping|shop|shoes|shiksha|shia|shell|shaw|sharp|shangrila|sh|sg|sfr|sexy|sex|sew|seven|ses|services|sener|select|seek|security|secure|seat|search|se|sd|scot|scor|scjohnson|science|schwarz|schule|school|scholarships|schmidt|schaeffler|scb|sca|sc|sbs|sbi|sb|saxo|save|sas|sarl|sapo|sap|sanofi|sandvikcoromant|sandvik|samsung|samsclub|salon|sale|sakura|safety|safe|saarland|sa|ryukyu|rwe|rw|run|ruhr|rugby|ru|rsvp|rs|room|rogers|rodeo|rocks|rocher|ro|rmit|rip|rio|ril|rightathome|ricoh|richardli|rich|rexroth|reviews|review|restaurant|rest|republican|report|repair|rentals|rent|ren|reliance|reit|reisen|reise|rehab|redumbrella|redstone|red|recipes|realty|realtor|realestate|read|re|raid|radio|racing|qvc|quest|quebec|qpon|qa|py|pwc|pw|pub|pt|ps|prudential|pru|protection|property|properties|promo|progressive|prof|productions|prod|pro|prime|press|praxi|pramerica|pr|post|porn|politie|poker|pohl|pnc|pn|pm|plus|plumbing|playstation|play|place|pl|pk|pizza|pioneer|pink|ping|pin|pid|pictures|pictet|pics|piaget|physio|photos|photography|photo|phone|philips|phd|pharmacy|ph|pg|pfizer|pf|pet|pe|pccw|pay|passagens|party|parts|partners|pars|paris|panerai|panasonic|page|pa|ovh|ott|otsuka|osaka|origins|organic|org|orange|oracle|open|ooo|onyourside|online|onl|onion|ong|one|omega|om|ollo|oldnavy|olayangroup|olayan|okinawa|office|off|observer|obi|nz|nyc|nu|ntt|nrw|nra|nr|np|nowtv|nowruz|now|norton|northwesternmutual|nokia|no|nl|nissay|nissan|ninja|nikon|nike|nico|ni|nhk|ngo|ng|nfl|nf|nexus|nextdirect|next|news|newholland|new|neustar|network|netflix|netbank|net|nec|ne|nc|nba|navy|natura|nationwide|name|nagoya|nadex|nab|na|mz|my|mx|mw|mv|mutual|museum|mu|mtr|mtn|mt|msd|ms|mr|mq|mp|movistar|movie|mov|motorcycles|moto|moscow|mortgage|mormon|mopar|monster|money|monash|mom|moi|moe|moda|mobily|mobile|mobi|mo|mn|mma|mm|mls|mlb|ml|mk|mitsubishi|mit|mint|mini|mil|microsoft|miami|mh|mg|metlife|merckmsd|meo|menu|men|memorial|meme|melbourne|meet|media|med|me|md|mckinsey|mc|mba|mattel|maserati|marshalls|marriott|markets|marketing|market|map|mango|management|man|makeup|maison|maif|madrid|macys|ma|ly|lv|luxury|luxe|lupin|lundbeck|lu|ltda|ltd|lt|ls|lr|lplfinancial|lpl|love|lotto|lotte|london|lol|loft|locus|locker|loans|loan|lk|llc|lixil|living|live|lipsy|link|linde|lincoln|limo|limited|lilly|like|lighting|lifestyle|lifeinsurance|life|lidl|liaison|li|lgbt|lexus|lego|legal|lefrak|leclerc|lease|lds|lc|lb|lawyer|law|latrobe|latino|lat|lasalle|lanxess|landrover|land|lancome|lancia|lancaster|lamer|lamborghini|ladbrokes|lacaixa|la|kz|kyoto|ky|kw|kuokgroup|kred|krd|kr|kpn|kpmg|kp|kosher|komatsu|koeln|kn|km|kiwi|kitchen|kindle|kinder|kim|kia|ki|kh|kg|kfh|kerryproperties|kerrylogistics|kerryhotels|ke|kddi|kaufen|juniper|juegos|jprs|jpmorgan|jp|joy|jot|joburg|jobs|jo|jnj|jmp|jm|jll|jlc|jio|jewelry|jetzt|jeep|je|jcp|jcb|java|jaguar|iwc|iveco|itv|itau|it|istanbul|ist|ismaili|iselect|is|irish|ir|iq|ipiranga|io|investments|intuit|international|intel|int|insure|insurance|institute|ink|ing|info|infiniti|industries|inc|in|immobilien|immo|imdb|imamat|im|il|ikano|ifm|ieee|ie|id|icu|ice|icbc|ibm|hyundai|hyatt|hughes|hu|ht|hsbc|hr|how|house|hotmail|hotels|hoteles|hot|hosting|host|hospital|horse|honeywell|honda|homesense|homes|homegoods|homedepot|holiday|holdings|hockey|hn|hm|hkt|hk|hiv|hitachi|hisamitsu|hiphop|hgtv|hermes|here|helsinki|help|healthcare|health|hdfcbank|hdfc|hbo|haus|hangout|hamburg|hair|gy|gw|guru|guitars|guide|guge|gucci|guardian|gu|gt|gs|group|grocery|gripe|green|gratis|graphics|grainger|gr|gq|gp|gov|got|gop|google|goog|goodyear|goodhands|goo|golf|goldpoint|gold|godaddy|gn|gmx|gmo|gmbh|gmail|gm|globo|global|gle|glass|glade|gl|giving|gives|gifts|gift|gi|gh|ggee|gg|gf|george|genting|gent|gea|ge|gdn|gd|gbiz|gb|gay|garden|gap|games|game|gallup|gallo|gallery|gal|ga|fyi|futbol|furniture|fund|fun|fujixerox|fujitsu|ftr|frontier|frontdoor|frogans|frl|fresenius|free|fr|fox|foundation|forum|forsale|forex|ford|football|foodnetwork|food|foo|fo|fm|fly|flowers|florist|flir|flights|flickr|fk|fj|fitness|fit|fishing|fish|firmdale|firestone|fire|financial|finance|final|film|fido|fidelity|fiat|fi|ferrero|ferrari|feedback|fedex|fast|fashion|farmers|farm|fans|fan|family|faith|fairwinds|fail|fage|extraspace|express|exposed|expert|exchange|everbank|events|eus|eurovision|eu|etisalat|et|esurance|estate|esq|es|erni|ericsson|er|equipment|epson|epost|enterprises|engineering|engineer|energy|emerck|email|eg|ee|education|edu|edeka|eco|ec|eat|earth|dz|dvr|dvag|durban|dupont|duns|dunlop|duck|dubai|dtv|drive|download|dot|domains|doha|dog|dodge|doctor|docs|do|dnp|dm|dk|dj|diy|dish|discover|discount|directory|direct|digital|diet|diamonds|dhl|dev|design|desi|dentist|dental|democrat|delta|deloitte|dell|delivery|degree|deals|dealer|deal|de|dds|dclk|day|datsun|dating|date|data|dance|dad|dabur|cz|cyou|cymru|cy|cx|cw|cv|cuisinella|cu|csc|cruises|cruise|crs|crown|cricket|creditunion|creditcard|credit|cr|cpa|courses|coupons|coupon|country|corsica|coop|cool|cookingchannel|cooking|contractors|contact|consulting|construction|condos|comsec|computer|compare|company|community|commbank|comcast|com|cologne|college|coffee|codes|coach|co|cn|cm|clubmed|club|cloud|clothing|clinique|clinic|click|cleaning|claims|cl|ck|cityeats|city|citic|citi|citadel|cisco|circle|cipriani|ci|church|chrysler|chrome|christmas|chintai|cheap|chat|chase|channel|chanel|ch|cg|cfd|cfa|cf|cern|ceo|center|ceb|cd|cc|cbs|cbre|cbn|cba|catholic|catering|cat|casino|cash|caseih|case|casa|cartier|cars|careers|career|care|cards|caravan|car|capitalone|capital|capetown|canon|cancerresearch|camp|camera|cam|calvinklein|call|cal|cafe|cab|ca|bzh|bz|by|bw|bv|buzz|buy|business|builders|build|bugatti|budapest|bt|bs|brussels|brother|broker|broadway|bridgestone|bradesco|br|box|boutique|bot|boston|bostik|bosch|boots|booking|book|boo|bond|bom|bofa|boehringer|boats|bo|bnpparibas|bnl|bn|bmw|bms|bm|blue|bloomberg|blog|blockbuster|blanco|blackfriday|black|bj|biz|bio|bingo|bing|bike|bid|bible|bi|bharti|bh|bg|bf|bet|bestbuy|best|berlin|bentley|beer|beauty|beats|be|bd|bcn|bcg|bbva|bbt|bbc|bb|bayern|bauhaus|basketball|baseball|bargains|barefoot|barclays|barclaycard|barcelona|bar|bank|band|bananarepublic|banamex|baidu|baby|ba|azure|az|axa|ax|aws|aw|avianca|autos|auto|author|auspost|audio|audible|audi|auction|au|attorney|athleta|at|associates|asia|asda|as|arte|art|arpa|army|archi|aramco|arab|ar|aquarelle|aq|apple|app|apartments|aol|ao|anz|anquan|android|analytics|amsterdam|amica|amfam|amex|americanfamily|americanexpress|am|alstom|alsace|ally|allstate|allfinanz|alipay|alibaba|alfaromeo|al|akdn|airtel|airforce|airbus|aigo|aig|ai|agency|agakhan|ag|africa|afl|afamilycompany|af|aetna|aero|aeg|ae|adult|ads|adac|ad|actor|active|aco|accountants|accountant|accenture|academy|ac|abudhabi|abogado|able|abc|abbvie|abbott|abb|abarth|aarp|aaa))"}}),null);
__d("URLMatcher",["URLMatcherConfig","justknobx"],(function(a,b,c,d,e,f){d="!\"#%&'()*,-./:;<>?@[\\]^_`{|}";f="\u2000-\u206f\xab\xbb\uff08\uff09";var g="(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])",h="(?:https?)://",i=b("justknobx")._("287"),j="(?:(?:"+g+"[.]){3}"+g+")";g="(?:(^|\\s)(?:"+g+"[.]){3}"+g+")";g=i?g:j;j="\\[(?:(?:[A-Fa-f0-9]{1,4}::?){1,7}[A-Fa-f0-9]{1,4})\\]";var k="(?:\\b)www\\d{0,3}[.]";d="[^\\s"+d+f+"]";f="(?:(?:(?:[.:\\-_%@]|"+d+")*"+d+")|"+j+")";d="(?::\\d+){0,1}";var l="(?=[/?#])";b=b("URLMatcherConfig").tlds;var m="(?:(?:"+h+f+d+")|(?:"+g+d+")|(?:"+j+d+")|(?:"+k+f+b+d+")|(?:"+f+b+d+l+"))";l="(?:(?:"+h+f+d+")|(?:"+g+d+")|(?:"+j+d+")|(?:"+k+f+b+d+")|(?:"+f+b+d+"))";g="[/#?]";j="\\([^\\s()<>]+\\)";var n="[^\\s()<>?#]+",o=new RegExp(m,"im"),p="^\\[[0-9]{1,4}:[0-9]{1,4}:[A-Fa-f0-9]{1,4}\\]",q=new RegExp(p,"im"),r="(?:(?:"+g+")(?:(?:"+j+"|"+n+")*)*)*",s=new RegExp("((?:"+l+")(?:"+r+"))","im");function a(){s.compile()}var t=new RegExp("((?:"+h+f+d+")|(?:"+k+f+b+d+"))"),u=/[\s\'\";]/,v=new RegExp(g,"im"),w=new RegExp("[\\s!\"#%&'()*,./:;<>?@[\\]^`{|}\xab\xbb\u2000-\u206f\uff08\uff09]","im"),x=new RegExp("[\\s()<>?#]","im"),y=new RegExp("\\s()<>"),z=function(a){if(a!=null&&a.indexOf("@")!=-1)return t.exec(a)?a:null;else return a},A=function(a){return new RegExp("((?:"+m+")(?:"+r+"))",a)};function c(){return s.source}p=function(a){return B(a,A("im"))};j=function(a){return C(a,A("igm"))};n=function(a){return B(a,s)};var B=function(a,b){b=b.exec(a);return b==null||b.length===0?null:z(b[1]||null)},C=function(a,b){a=a.match(b);return a==null?[]:a.filter(Boolean)||[]};l=function(a){return o.exec(a)};h=function(a){return!u.test(a.charAt(a.length-1))};k=function(a){a=a;var b=!1;do{var c,d=o.exec(a);if(!d)return null;i&&((c=d[1])==null?void 0:c.trim())===""&&(d[0]=d[0].trim(),d.index+=d[1].length);b=!1;if(d[0][0]==="["&&d.index>0&&a[d.index-1]==="@"){c=q.exec(d[0]);c&&(b=!0,a=a.substr(d.index+c[0].length))}}while(b);if(!d)return null;c=a.substr(d.index+d[0].length);if(c.length===0||!v.test(c[0]))return z(d[0]);b=0;a=0;var e=1,f=["(","["],g=[")","]"],h=0,j=a;for(var k=1;k<c.length;k++){var l=c[k];if(j===a){if(f.includes(l))h+=1,j=e;else if(v.test(l)||!w.test(l))b=k;else if(x.test(l))break}else if(f.includes(l))h+=1;else if(g.includes(l))h-=1,h===0&&(j=a,b=k);else if(y.test(l))break}return z(d[0]+c.substring(0,b+1))};f={compilePermissiveHostPathMatcher:a,permissiveHostPathMatch:n,permissiveMatch:p,permissiveMultiMatch:j,matchToPattern:B,multiMatchToPattern:C,matchHost:l,trigger:h,match:k,getPermissiveHostPathMatcherSource:c};e.exports=f}),null);
__d("WALongInt",["WAHex","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is over 64 bits']);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid decimal string']);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose([""," is not a safe integer"]);j=function(){return a};return a}function k(a){if(typeof a!=="number"){d("WALogger").LOG(j(),a).color("red");throw new Error("numberOrThrowIfTooLarge is given a non-safe integer")}return a}f=function(a){return a==null?a:k(a)};function a(a){return a==null||typeof a!=="number"?null:a}function b(a,b){if(typeof a==="number"&&typeof b==="number")return a>b;a=typeof a==="number"?d("WAHex").hexLongFromNumber(a):a;b=typeof b==="number"?d("WAHex").hexLongFromNumber(b):b;return d("WAHex").isBiggerHexLong(a,b)}function c(a){if(typeof a==="number")return a.toString(10);var b=d("WAHex").hexLongToHex(a),c=[0],e=0;for(var f=0;f<b.length;f++){e=d("WAHex").hexAt(b,f);for(var g=0;g<c.length;g++)c[g]=c[g]*16+e,e=c[g]/10|0,c[g]%=10;while(e>0)c.push(e%10),e=e/10|0}g=c.reverse().join("");return d("WAHex").hexLongIsNegative(a)?"-"+g:g}function e(a){if(!/^-?\d+$/.test(a)){d("WALogger").LOG(i(),a).color("red");throw new Error("decimalStringToLongInt is given an invalid decimal string")}var b=a[0]==="-",c=a.replace(/^-?0*/,""),e=c.length;if(e<16||e===16&&c<="9007199254740991")return b?-Number(c):Number(c);if(e>20||e===20&&c>"18446744073709551615"||b&&(e>19||e===19&&c>"9223372036854775807")){d("WALogger").LOG(h(),a).color("red");throw new Error("decimalStringToHexLong is given value over 64 bits")}a=0;var f=0;for(var g=0;g<e;g++)a=a*10+Number(c[g]),f=f*10+Math.floor(a/4294967296),a=a%4294967296;return d("WAHex").createHexLongFrom32Bits(f,a,b)}g.numberOrThrowIfTooLarge=k;g.maybeNumberOrThrowIfTooLarge=f;g.maybeNumber=a;g.isBiggerLongInt=b;g.longIntToDecimalString=c;g.decimalStringToLongInt=e}),98);
__d("WATimeUtils",["Promise","WAHex"],(function(a,b,c,d,e,f,g){"use strict";var h,i=60,j=5*i,k=60*i,l=24*k,m=7*l,n=365*l,o=60*1e3,p=k*1e3,q=24*p,r=7*q,s=1<<31,t=~s,u=s+1,v={time:0,day:-4},w=0;function a(){return w}function c(a){w=a}function e(a){return W(a).toUTCString()}function x(a){a=a|0;return Math.max(u,Math.min(a,t))}function y(a){return x(a/1e3)}function f(a){if(typeof a!=="number")if(d("WAHex").hexLongIsNegative(a))return u;else return t;else return x(a)}function z(a){if(typeof a!=="number")if(d("WAHex").hexLongIsNegative(a))return u;else return t;else return C(a)}function A(a){return a==null?a:a>t?y(a):x(a)}function B(){return C(Z()-w*1e3)}function C(a){return a}function D(a){return a}function E(a){return C(a*1e3)}function F(a,b){var c=K();a=Math.max(a+b-c,0);return Math.min(1e3*a,~(1<<31))}function G(a,b){b=b!=null?b:K();return x(Math.ceil(b+Math.max(a,0)))}function H(a,b){b=b!=null?b:K();return x(Math.ceil(b-Math.max(a,0)))}function I(a){a=Math.max(a-K(),0);return Math.min(1e3*a,~(1<<31))}function J(a){var c=I(a);return new(h||(h=b("Promise")))(function(a){return void setTimeout(a,c)})}function K(){return x(Date.now()/1e3-w)}function L(){return x(Date.now()/1e3)}function M(){return x(new Date().setHours(0,0,0,0)/1e3-w)}function N(){return Date.now()-w*1e3}function O(a){return Math.max(a-K(),0)}function P(a){return O(a)>0}function Q(){return performance.now()}function R(a){return Math.floor(performance.now()-a)}function S(a,b){return a<b?a:b}var T=function(){function a(){var a=Q();this.$1=a;this.$2=a}var b=a.prototype;b.reset=function(){this.$2=Q()};b.elapsed=function(){return R(this.$2)};b.cumulative=function(){return R(this.$1)};return a}();function U(a,b,c){return Math.abs(a-b)<=c}function V(a,b){return U(K(),a,b)}function W(a){return new Date(a*1e3)}function X(a,b){if(Math.abs(a-b)>l)return!1;a=v.time===a?v.day:W(a+w).getDay();var c=v.time===b?v.day:W(b+w).getDay();v.time=b;v.day=c;return a===c}function Y(a){a=Number.parseInt(a,16);return Number.isFinite(a)?new Date(x(a)*1e3):null}function Z(){return Date.now()}function $(a){a=new Date(a);return isNaN(a)?null:y(a.getTime())}function aa(a,b){a=Math.abs(a-b);return Math.ceil(a/q)}g.MINUTE_SECONDS=i;g.FIVE_MINUTES=j;g.HOUR_SECONDS=k;g.DAY_SECONDS=l;g.WEEK_SECONDS=m;g.YEAR_SECONDS=n;g.MINUTE_MILLISECONDS=o;g.HOUR_MILLISECONDS=p;g.DAY_MILLISECONDS=q;g.WEEK_MILLISECONDS=r;g.DEFAULT_UNIXTIME=s;g.MAX_INT=t;g.getClockSkew=a;g.setClockSkew=c;g.toHttpHeaderDate=e;g.castToUnixTime=x;g.castMilliSecondsToUnixTime=y;g.castLongIntToUnixTime=f;g.castLongIntToMillisTime=z;g.castMillisTimeToUnixTime=A;g.millisTime=B;g.castToMillisTime=C;g.fromMillisTime=D;g.castUnixTimeToMillisTime=E;g.timeoutFor=F;g.futureUnixTime=G;g.pastUnixTime=H;g.cappedMillisecondsUntil=I;g.delayUntil=J;g.unixTime=K;g.unixTimeWithoutClockSkewCorrection=L;g.midnight=M;g.unixTimeMs=N;g.secondsUntil=O;g.isInFuture=P;g.monotonicTime=Q;g.monotonicTimeSince=R;g.oldest=S;g.MonotonicTimer=T;g.happenedWithinAt=U;g.happenedWithin=V;g.toDate=W;g.sameDay=X;g.convertHexToDate=Y;g.performanceAbsoluteNow=Z;g.convertISO8601DateFormatToUnixTime=$;g.daysDiff=aa}),98);/*FB_PKG_DELIM*/
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("core-util-is-1.0.2",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){function a(a){return Array.isArray?Array.isArray(a):p(a)==="[object Array]"}g.isArray=a;function b(a){return typeof a==="boolean"}g.isBoolean=b;function c(a){return a===null}g.isNull=c;function d(a){return a==null}g.isNullOrUndefined=d;function e(a){return typeof a==="number"}g.isNumber=e;function f(a){return typeof a==="string"}g.isString=f;function h(a){return typeof a==="symbol"}g.isSymbol=h;function i(a){return a===void 0}g.isUndefined=i;function j(a){return p(a)==="[object RegExp]"}g.isRegExp=j;function k(a){return typeof a==="object"&&a!==null}g.isObject=k;function l(a){return p(a)==="[object Date]"}g.isDate=l;function m(a){return p(a)==="[object Error]"||a instanceof Error}g.isError=m;function n(a){return typeof a==="function"}g.isFunction=n;function o(a){return a===null||typeof a==="boolean"||typeof a==="number"||typeof a==="string"||typeof a==="symbol"||typeof a==="undefined"}g.isPrimitive=o;g.isBuffer=Buffer.isBuffer;function p(a){return Object.prototype.toString.call(a)}}var j=!1;function k(){j||(j=!0,i());return h.exports}function a(a){switch(a){case void 0:return k()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("immediate-3.0.6",[],(function(a,b,c,d,e,f){"use strict";c={};var g={exports:c};function h(){var b=a.MutationObserver||a.WebKitMutationObserver,c;if(process.browser)if(b){var d=0;b=new b(j);var e=a.document.createTextNode("");b.observe(e,{characterData:!0});c=function(){e.data=d=++d%2}}else if(!a.setImmediate&&typeof a.MessageChannel!=="undefined"){var f=new a.MessageChannel();f.port1.onmessage=j;c=function(){f.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?c=function(){var b=a.document.createElement("script");b.onreadystatechange=function(){j(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null};a.document.documentElement.appendChild(b)}:c=function(){setTimeout(j,0)};else c=function(){process.nextTick(j)};var h,i=[];function j(){h=!0;var a,b,c=i.length;while(c){b=i;i=[];a=-1;while(++a<c)b[a]();c=i.length}h=!1}g.exports=k;function k(a){i.push(a)===1&&!h&&c()}}var i=!1;function j(){i||(i=!0,h());return g.exports}function b(a){switch(a){case void 0:return j()}}e.exports=b}),null);
/**
 * License: https://www.facebook.com/legal/license/Hnt8PzozZpk/
 */
__d("inherits-2.0.3",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){typeof Object.create==="function"?g.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:g.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype;a.prototype=new c();a.prototype.constructor=a}}var i=!1;function j(){i||(i=!0,h());return g.exports}c={};var k={exports:c};function l(){try{var a={};if(typeof a.inherits!=="function")throw"";k.exports=a.inherits}catch(a){k.exports=j()}}var m=!1;function n(){m||(m=!0,l());return k.exports}function a(a){switch(a){case void 0:return n()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("isarray-1.0.0",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a={}.toString;g.exports=Array.isArray||function(b){return a.call(b)=="[object Array]"}}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("lie-3.3.0",["immediate-3.0.6"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("immediate-3.0.6"));d={};var h={exports:d};function i(){var a=g();function b(){}var c={},d=["REJECTED"],e=["FULFILLED"],f=["PENDING"];if(!process.browser)var i=["UNHANDLED"];h.exports=j;function j(a){if(typeof a!=="function")throw new TypeError("resolver must be a function");this.state=f;this.queue=[];this.outcome=void 0;process.browser||(this.handled=i);a!==b&&n(this,a)}j.prototype["finally"]=function(c){if(typeof c!=="function")return this;var d=this.constructor;return this.then(a,b);function a(a){function b(){return a}return d.resolve(c()).then(b)}function b(a){function b(){throw a}return d.resolve(c()).then(b)}};j.prototype["catch"]=function(a){return this.then(null,a)};j.prototype.then=function(a,c){if(typeof a!=="function"&&this.state===e||typeof c!=="function"&&this.state===d)return this;var g=new this.constructor(b);process.browser||this.handled===i&&(this.handled=null);if(this.state!==f){var h=this.state===e?a:c;l(g,h,this.outcome)}else this.queue.push(new k(g,a,c));return g};function k(a,b,c){this.promise=a,typeof b==="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof c==="function"&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}k.prototype.callFulfilled=function(a){c.resolve(this.promise,a)};k.prototype.otherCallFulfilled=function(a){l(this.promise,this.onFulfilled,a)};k.prototype.callRejected=function(a){c.reject(this.promise,a)};k.prototype.otherCallRejected=function(a){l(this.promise,this.onRejected,a)};function l(b,d,e){a(function(){var a;try{a=d(e)}catch(a){return c.reject(b,a)}a===b?c.reject(b,new TypeError("Cannot resolve promise with itself")):c.resolve(b,a)})}c.resolve=function(a,b){var d=o(m,b);if(d.status==="error")return c.reject(a,d.value);d=d.value;if(d)n(a,d);else{a.state=e;a.outcome=b;d=-1;var f=a.queue.length;while(++d<f)a.queue[d].callFulfilled(b)}return a};c.reject=function(b,c){b.state=d;b.outcome=c;process.browser||b.handled===i&&a(function(){b.handled===i&&process.emit("unhandledRejection",c,b)});var e=-1,f=b.queue.length;while(++e<f)b.queue[e].callRejected(c);return b};function m(a){var b=a&&a.then;if(a&&(typeof a==="object"||typeof a==="function")&&typeof b==="function")return function(){b.apply(a,arguments)}}function n(a,b){var d=!1;function e(b){if(d)return;d=!0;c.reject(a,b)}function f(b){if(d)return;d=!0;c.resolve(a,b)}function g(){b(f,e)}g=o(g);g.status==="error"&&e(g.value)}function o(a,b){var c={};try{c.value=a(b),c.status="success"}catch(a){c.status="error",c.value=a}return c}j.resolve=p;function p(a){return a instanceof this?a:c.resolve(new this(b),a)}j.reject=q;function q(a){var d=new this(b);return c.reject(d,a)}j.all=r;function r(a){var d=this;if(Object.prototype.toString.call(a)!=="[object Array]")return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);var g=new Array(e),h=0,i=-1,j=new this(b);while(++i<e)k(a[i],i);return j;function k(b,a){d.resolve(b).then(i,function(a){f||(f=!0,c.reject(j,a))});function i(b){g[a]=b,++h===e&&!f&&(f=!0,c.resolve(j,g))}}}j.race=s;function s(a){var d=this;if(Object.prototype.toString.call(a)!=="[object Array]")return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);var g=-1,h=new this(b);while(++g<e)i(a[g]);return h;function i(a){d.resolve(a).then(function(a){f||(f=!0,c.resolve(h,a))},function(a){f||(f=!0,c.reject(h,a))})}}}var j=!1;function k(){j||(j=!0,i());return h.exports}function c(a){switch(a){case void 0:return k()}}e.exports=c}),null);
/**
 * License: https://www.facebook.com/legal/license/cr2jmG-CdKo/
 */
__d("pako-1.0.8",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){var a=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";function b(a,b){return Object.prototype.hasOwnProperty.call(a,b)}g.assign=function(a){var c=Array.prototype.slice.call(arguments,1);while(c.length){var d=c.shift();if(!d)continue;if(typeof d!=="object")throw new TypeError(d+"must be non-object");for(var e in d)b(d,e)&&(a[e]=d[e])}return a};g.shrinkBuf=function(a,b){if(a.length===b)return a;if(a.subarray)return a.subarray(0,b);a.length=b;return a};var c={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray){a.set(b.subarray(c,c+d),e);return}for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f;d=0;for(b=0,c=a.length;b<c;b++)d+=a[b].length;d=new Uint8Array(d);e=0;for(b=0,c=a.length;b<c;b++)f=a[b],d.set(f,e),e+=f.length;return d}},d={arraySet:function(a,b,c,d,e){for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};g.setTyped=function(a){a?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,c)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,d))};g.setTyped(a)}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){var a=k(),b=4,c=0,d=1,e=2;function f(a){var b=a.length;while(--b>=0)a[b]=0}var g=0,h=1,i=2,j=3,m=258,n=29,o=256,p=o+1+n,q=30,r=19,aa=2*p+1,s=15,t=16,u=7,v=256,w=16,x=17,y=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ba=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ca=512,C=new Array((p+2)*2);f(C);var da=new Array(q*2);f(da);var D=new Array(ca);f(D);var ea=new Array(m-j+1);f(ea);var fa=new Array(n);f(fa);var E=new Array(q);f(E);function ga(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length}var ha,F,G;function H(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b}function ia(a){return a<256?D[a]:D[256+(a>>>7)]}function ja(a,b){a.pending_buf[a.pending++]=b&255,a.pending_buf[a.pending++]=b>>>8&255}function I(a,b,c){a.bi_valid>t-c?(a.bi_buf|=b<<a.bi_valid&65535,ja(a,a.bi_buf),a.bi_buf=b>>t-a.bi_valid,a.bi_valid+=c-t):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function J(a,b,c){I(a,c[b*2],c[b*2+1])}function ka(a,b){var c=0;do c|=a&1,a>>>=1,c<<=1;while(--b>0);return c>>>1}function la(a){a.bi_valid===16?(ja(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=a.bi_buf&255,a.bi_buf>>=8,a.bi_valid-=8)}function ma(a,b){var c=b.dyn_tree,d=b.max_code,e=b.stat_desc.static_tree,f=b.stat_desc.has_stree,g=b.stat_desc.extra_bits,h=b.stat_desc.extra_base;b=b.stat_desc.max_length;var i,j,k,l,m,n=0;for(k=0;k<=s;k++)a.bl_count[k]=0;c[a.heap[a.heap_max]*2+1]=0;for(i=a.heap_max+1;i<aa;i++){j=a.heap[i];k=c[c[j*2+1]*2+1]+1;k>b&&(k=b,n++);c[j*2+1]=k;if(j>d)continue;a.bl_count[k]++;l=0;j>=h&&(l=g[j-h]);m=c[j*2];a.opt_len+=m*(k+l);f&&(a.static_len+=m*(e[j*2+1]+l))}if(n===0)return;do{k=b-1;while(a.bl_count[k]===0)k--;a.bl_count[k]--;a.bl_count[k+1]+=2;a.bl_count[b]--;n-=2}while(n>0);for(k=b;k!==0;k--){j=a.bl_count[k];while(j!==0){m=a.heap[--i];if(m>d)continue;c[m*2+1]!==k&&(a.opt_len+=(k-c[m*2+1])*c[m*2],c[m*2+1]=k);j--}}}function na(a,b,c){var d=new Array(s+1),e=0,f;for(f=1;f<=s;f++)d[f]=e=e+c[f-1]<<1;for(f=0;f<=b;f++){c=a[f*2+1];if(c===0)continue;a[f*2]=ka(d[c]++,c)}}function K(){var a,b,c,d=new Array(s+1);b=0;for(c=0;c<n-1;c++){fa[c]=b;for(a=0;a<1<<z[c];a++)ea[b++]=c}ea[b-1]=c;b=0;for(c=0;c<16;c++){E[c]=b;for(a=0;a<1<<A[c];a++)D[b++]=c}b>>=7;for(;c<q;c++){E[c]=b<<7;for(a=0;a<1<<A[c]-7;a++)D[256+b++]=c}for(c=0;c<=s;c++)d[c]=0;a=0;while(a<=143)C[a*2+1]=8,a++,d[8]++;while(a<=255)C[a*2+1]=9,a++,d[9]++;while(a<=279)C[a*2+1]=7,a++,d[7]++;while(a<=287)C[a*2+1]=8,a++,d[8]++;na(C,p+1,d);for(a=0;a<q;a++)da[a*2+1]=5,da[a*2]=ka(a,5);ha=new ga(C,z,o+1,p,s);F=new ga(da,A,0,q,s);G=new ga(new Array(0),B,0,r,u)}function oa(a){var b;for(b=0;b<p;b++)a.dyn_ltree[b*2]=0;for(b=0;b<q;b++)a.dyn_dtree[b*2]=0;for(b=0;b<r;b++)a.bl_tree[b*2]=0;a.dyn_ltree[v*2]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function L(a){a.bi_valid>8?ja(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function pa(b,c,d,e){L(b),e&&(ja(b,d),ja(b,~d)),a.arraySet(b.pending_buf,b.window,c,d,b.pending),b.pending+=d}function qa(a,b,c,d){var e=b*2,f=c*2;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function M(a,b,c){var d=a.heap[c],e=c<<1;while(e<=a.heap_len){e<a.heap_len&&qa(b,a.heap[e+1],a.heap[e],a.depth)&&e++;if(qa(b,d,a.heap[e],a.depth))break;a.heap[c]=a.heap[e];c=e;e<<=1}a.heap[c]=d}function ra(a,b,c){var d,e,f=0,g,h;if(a.last_lit!==0)do d=a.pending_buf[a.d_buf+f*2]<<8|a.pending_buf[a.d_buf+f*2+1],e=a.pending_buf[a.l_buf+f],f++,d===0?J(a,e,b):(g=ea[e],J(a,g+o+1,b),h=z[g],h!==0&&(e-=fa[g],I(a,e,h)),d--,g=ia(d),J(a,g,c),h=A[g],h!==0&&(d-=E[g],I(a,d,h)));while(f<a.last_lit);J(a,v,b)}function N(a,b){var c=b.dyn_tree,d=b.stat_desc.static_tree,e=b.stat_desc.has_stree,f=b.stat_desc.elems,g,h=-1,i;a.heap_len=0;a.heap_max=aa;for(g=0;g<f;g++)c[g*2]!==0?(a.heap[++a.heap_len]=h=g,a.depth[g]=0):c[g*2+1]=0;while(a.heap_len<2)i=a.heap[++a.heap_len]=h<2?++h:0,c[i*2]=1,a.depth[i]=0,a.opt_len--,e&&(a.static_len-=d[i*2+1]);b.max_code=h;for(g=a.heap_len>>1;g>=1;g--)M(a,c,g);i=f;do g=a.heap[1],a.heap[1]=a.heap[a.heap_len--],M(a,c,1),e=a.heap[1],a.heap[--a.heap_max]=g,a.heap[--a.heap_max]=e,c[i*2]=c[g*2]+c[e*2],a.depth[i]=(a.depth[g]>=a.depth[e]?a.depth[g]:a.depth[e])+1,c[g*2+1]=c[e*2+1]=i,a.heap[1]=i++,M(a,c,1);while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1];ma(a,b);na(c,h,a.bl_count)}function O(a,b,c){var d,e=-1,f,g=b[0*2+1],h=0,i=7,j=4;g===0&&(i=138,j=3);b[(c+1)*2+1]=65535;for(d=0;d<=c;d++){f=g;g=b[(d+1)*2+1];if(++h<i&&f===g)continue;else h<j?a.bl_tree[f*2]+=h:f!==0?(f!==e&&a.bl_tree[f*2]++,a.bl_tree[w*2]++):h<=10?a.bl_tree[x*2]++:a.bl_tree[y*2]++;h=0;e=f;g===0?(i=138,j=3):f===g?(i=6,j=3):(i=7,j=4)}}function P(a,b,c){var d,e=-1,f,g=b[0*2+1],h=0,i=7,j=4;g===0&&(i=138,j=3);for(d=0;d<=c;d++){f=g;g=b[(d+1)*2+1];if(++h<i&&f===g)continue;else if(h<j)do J(a,f,a.bl_tree);while(--h!==0);else f!==0?(f!==e&&(J(a,f,a.bl_tree),h--),J(a,w,a.bl_tree),I(a,h-3,2)):h<=10?(J(a,x,a.bl_tree),I(a,h-3,3)):(J(a,y,a.bl_tree),I(a,h-11,7));h=0;e=f;g===0?(i=138,j=3):f===g?(i=6,j=3):(i=7,j=4)}}function Q(a){var b;O(a,a.dyn_ltree,a.l_desc.max_code);O(a,a.dyn_dtree,a.d_desc.max_code);N(a,a.bl_desc);for(b=r-1;b>=3;b--)if(a.bl_tree[ba[b]*2+1]!==0)break;a.opt_len+=3*(b+1)+5+5+4;return b}function sa(a,b,c,d){var e;I(a,b-257,5);I(a,c-1,5);I(a,d-4,4);for(e=0;e<d;e++)I(a,a.bl_tree[ba[e]*2+1],3);P(a,a.dyn_ltree,b-1);P(a,a.dyn_dtree,c-1)}function R(a){var b=4093624447,e;for(e=0;e<=31;e++,b>>>=1)if(b&1&&a.dyn_ltree[e*2]!==0)return c;if(a.dyn_ltree[9*2]!==0||a.dyn_ltree[10*2]!==0||a.dyn_ltree[13*2]!==0)return d;for(e=32;e<o;e++)if(a.dyn_ltree[e*2]!==0)return d;return c}var ta=!1;function S(a){ta||(K(),ta=!0),a.l_desc=new H(a.dyn_ltree,ha),a.d_desc=new H(a.dyn_dtree,F),a.bl_desc=new H(a.bl_tree,G),a.bi_buf=0,a.bi_valid=0,oa(a)}function T(a,b,c,d){I(a,(g<<1)+(d?1:0),3),pa(a,b,c,!0)}function U(a){I(a,h<<1,3),J(a,v,C),la(a)}function V(a,c,d,f){var g,j,k=0;a.level>0?(a.strm.data_type===e&&(a.strm.data_type=R(a)),N(a,a.l_desc),N(a,a.d_desc),k=Q(a),g=a.opt_len+3+7>>>3,j=a.static_len+3+7>>>3,j<=g&&(g=j)):g=j=d+5;d+4<=g&&c!==-1?T(a,c,d,f):a.strategy===b||j===g?(I(a,(h<<1)+(f?1:0),3),ra(a,C,da)):(I(a,(i<<1)+(f?1:0),3),sa(a,a.l_desc.max_code+1,a.d_desc.max_code+1,k+1),ra(a,a.dyn_ltree,a.dyn_dtree));oa(a);f&&L(a)}function W(a,b,c){a.pending_buf[a.d_buf+a.last_lit*2]=b>>>8&255;a.pending_buf[a.d_buf+a.last_lit*2+1]=b&255;a.pending_buf[a.l_buf+a.last_lit]=c&255;a.last_lit++;b===0?a.dyn_ltree[c*2]++:(a.matches++,b--,a.dyn_ltree[(ea[c]+o+1)*2]++,a.dyn_dtree[ia(b)*2]++);return a.last_lit===a.lit_bufsize-1}l._tr_init=S;l._tr_stored_block=T;l._tr_flush_block=V;l._tr_tally=W;l._tr_align=U}var o=!1;function p(){o||(o=!0,n());return m.exports}b={};var q={exports:b};function r(){function a(a,b,c,d){var e=a&65535|0;a=a>>>16&65535|0;var f;while(c!==0){f=c>2e3?2e3:c;c-=f;do e=e+b[d++]|0,a=a+e|0;while(--f);e%=65521;a%=65521}return e|a<<16|0}q.exports=a}var aa=!1;function s(){aa||(aa=!0,r());return q.exports}c={};var t={exports:c};function u(){function a(){var a,b=[];for(var c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b}var b=a();function c(a,c,d,e){var f=b;d=e+d;a^=-1;for(e=e;e<d;e++)a=a>>>8^f[(a^c[e])&255];return a^-1}t.exports=c}var v=!1;function w(){v||(v=!0,u());return t.exports}d={};var x={exports:d};function y(){x.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}var z=!1;function A(){z||(z=!0,y());return x.exports}var B={},ba={exports:B};function ca(){var a=k(),b=p(),c=s(),d=w(),e=A(),f=0,g=1,h=3,i=4,j=5,l=0,m=1,n=-2,o=-3,q=-5,r=-1,aa=1,t=2,u=3,v=4,x=0,y=2,z=8,ba=9,ca=15,C=8,da=29,D=256,ea=D+1+da,fa=30,E=19,ga=2*ea+1,ha=15,F=3,G=258,H=G+F+1,ia=32,ja=42,I=69,J=73,ka=91,la=103,ma=113,na=666,K=1,oa=2,L=3,pa=4,qa=3;function M(a,b){a.msg=e[b];return b}function ra(a){return(a<<1)-(a>4?9:0)}function N(a){var b=a.length;while(--b>=0)a[b]=0}function O(b){var c=b.state,d=c.pending;d>b.avail_out&&(d=b.avail_out);if(d===0)return;a.arraySet(b.output,c.pending_buf,c.pending_out,d,b.next_out);b.next_out+=d;c.pending_out+=d;b.total_out+=d;b.avail_out-=d;c.pending-=d;c.pending===0&&(c.pending_out=0)}function P(a,c){b._tr_flush_block(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,c),a.block_start=a.strstart,O(a.strm)}function Q(a,b){a.pending_buf[a.pending++]=b}function sa(a,b){a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=b&255}function R(b,e,f,g){var h=b.avail_in;h>g&&(h=g);if(h===0)return 0;b.avail_in-=h;a.arraySet(e,b.input,b.next_in,h,f);b.state.wrap===1?b.adler=c(b.adler,e,h,f):b.state.wrap===2&&(b.adler=d(b.adler,e,h,f));b.next_in+=h;b.total_in+=h;return h}function ta(a,b){var c=a.max_chain_length,d=a.strstart,e,f=a.prev_length,g=a.nice_match,h=a.strstart>a.w_size-H?a.strstart-(a.w_size-H):0,i=a.window,j=a.w_mask,k=a.prev,l=a.strstart+G,m=i[d+f-1],n=i[d+f];a.prev_length>=a.good_match&&(c>>=2);g>a.lookahead&&(g=a.lookahead);do{e=b;if(i[e+f]!==n||i[e+f-1]!==m||i[e]!==i[d]||i[++e]!==i[d+1])continue;d+=2;e++;do;while(i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&d<l);e=G-(l-d);d=l-G;if(e>f){a.match_start=b;f=e;if(e>=g)break;m=i[d+f-1];n=i[d+f]}}while((b=k[b&j])>h&&--c!==0);return f<=a.lookahead?f:a.lookahead}function S(b){var c=b.w_size,d,e,f,g;do{g=b.window_size-b.lookahead-b.strstart;if(b.strstart>=c+(c-H)){a.arraySet(b.window,b.window,c,c,0);b.match_start-=c;b.strstart-=c;b.block_start-=c;e=b.hash_size;d=e;do f=b.head[--d],b.head[d]=f>=c?f-c:0;while(--e);e=c;d=e;do f=b.prev[--d],b.prev[d]=f>=c?f-c:0;while(--e);g+=c}if(b.strm.avail_in===0)break;e=R(b.strm,b.window,b.strstart+b.lookahead,g);b.lookahead+=e;if(b.lookahead+b.insert>=F){f=b.strstart-b.insert;b.ins_h=b.window[f];b.ins_h=(b.ins_h<<b.hash_shift^b.window[f+1])&b.hash_mask;while(b.insert){b.ins_h=(b.ins_h<<b.hash_shift^b.window[f+F-1])&b.hash_mask;b.prev[f&b.w_mask]=b.head[b.ins_h];b.head[b.ins_h]=f;f++;b.insert--;if(b.lookahead+b.insert<F)break}}}while(b.lookahead<H&&b.strm.avail_in!==0)}function T(a,b){var c=65535;c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);for(;;){if(a.lookahead<=1){S(a);if(a.lookahead===0&&b===f)return K;if(a.lookahead===0)break}a.strstart+=a.lookahead;a.lookahead=0;var d=a.block_start+c;if(a.strstart===0||a.strstart>=d){a.lookahead=a.strstart-d;a.strstart=d;P(a,!1);if(a.strm.avail_out===0)return K}if(a.strstart-a.block_start>=a.w_size-H){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=0;if(b===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.strstart>a.block_start){P(a,!1);if(a.strm.avail_out===0)return K}return K}function U(a,c){var d;for(;;){if(a.lookahead<H){S(a);if(a.lookahead<H&&c===f)return K;if(a.lookahead===0)break}d=0;a.lookahead>=F&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);d!==0&&a.strstart-d<=a.w_size-H&&(a.match_length=ta(a,d));if(a.match_length>=F){d=b._tr_tally(a,a.strstart-a.match_start,a.match_length-F);a.lookahead-=a.match_length;if(a.match_length<=a.max_lazy_match&&a.lookahead>=F){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(--a.match_length!==0);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask}else d=b._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=a.strstart<F-1?a.strstart:F-1;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function V(a,c){var d,e;for(;;){if(a.lookahead<H){S(a);if(a.lookahead<H&&c===f)return K;if(a.lookahead===0)break}d=0;a.lookahead>=F&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);a.prev_length=a.match_length;a.prev_match=a.match_start;a.match_length=F-1;d!==0&&a.prev_length<a.max_lazy_match&&a.strstart-d<=a.w_size-H&&(a.match_length=ta(a,d),a.match_length<=5&&(a.strategy===aa||a.match_length===F&&a.strstart-a.match_start>4096)&&(a.match_length=F-1));if(a.prev_length>=F&&a.match_length<=a.prev_length){d=a.strstart+a.lookahead-F;e=b._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-F);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=d&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(--a.prev_length!==0);a.match_available=0;a.match_length=F-1;a.strstart++;if(e){P(a,!1);if(a.strm.avail_out===0)return K}}else if(a.match_available){e=b._tr_tally(a,0,a.window[a.strstart-1]);e&&P(a,!1);a.strstart++;a.lookahead--;if(a.strm.avail_out===0)return K}else a.match_available=1,a.strstart++,a.lookahead--}a.match_available&&(b._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0);a.insert=a.strstart<F-1?a.strstart:F-1;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function W(a,c){var d,e,g,h=a.window;for(;;){if(a.lookahead<=G){S(a);if(a.lookahead<=G&&c===f)return K;if(a.lookahead===0)break}a.match_length=0;if(a.lookahead>=F&&a.strstart>0){e=a.strstart-1;d=h[e];if(d===h[++e]&&d===h[++e]&&d===h[++e]){g=a.strstart+G;do;while(d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&e<g);a.match_length=G-(g-e);a.match_length>a.lookahead&&(a.match_length=a.lookahead)}}a.match_length>=F?(d=b._tr_tally(a,1,a.match_length-F),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(d=b._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++);if(d){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=0;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function X(a,c){var d;for(;;){if(a.lookahead===0){S(a);if(a.lookahead===0){if(c===f)return K;break}}a.match_length=0;d=b._tr_tally(a,0,a.window[a.strstart]);a.lookahead--;a.strstart++;if(d){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=0;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function ua(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e}var va;va=[new ua(0,0,0,0,T),new ua(4,4,8,4,U),new ua(4,5,16,8,U),new ua(4,6,32,32,U),new ua(4,4,16,16,V),new ua(8,16,32,32,V),new ua(8,16,128,128,V),new ua(8,32,128,256,V),new ua(32,128,258,1024,V),new ua(32,258,258,4096,V)];function wa(a){a.window_size=2*a.w_size,N(a.head),a.max_lazy_match=va[a.level].max_lazy,a.good_match=va[a.level].good_length,a.nice_match=va[a.level].nice_length,a.max_chain_length=va[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=F-1,a.match_available=0,a.ins_h=0}function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=z,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(ga*2),this.dyn_dtree=new a.Buf16((2*fa+1)*2),this.bl_tree=new a.Buf16((2*E+1)*2),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(ha+1),this.heap=new a.Buf16(2*ea+1),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*ea+1),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function xa(a){var c;if(!a||!a.state)return M(a,n);a.total_in=a.total_out=0;a.data_type=y;c=a.state;c.pending=0;c.pending_out=0;c.wrap<0&&(c.wrap=-c.wrap);c.status=c.wrap?ja:ma;a.adler=c.wrap===2?0:1;c.last_flush=f;b._tr_init(c);return l}function Z(a){var b=xa(a);b===l&&wa(a.state);return b}function $(a,b){if(!a||!a.state)return n;if(a.state.wrap!==2)return n;a.state.gzhead=b;return l}function ya(b,c,d,e,f,g){if(!b)return n;var h=1;c===r&&(c=6);e<0?(h=0,e=-e):e>15&&(h=2,e-=16);if(f<1||f>ba||d!==z||e<8||e>15||c<0||c>9||g<0||g>v)return M(b,n);e===8&&(e=9);var i=new Y();b.state=i;i.strm=b;i.wrap=h;i.gzhead=null;i.w_bits=e;i.w_size=1<<i.w_bits;i.w_mask=i.w_size-1;i.hash_bits=f+7;i.hash_size=1<<i.hash_bits;i.hash_mask=i.hash_size-1;i.hash_shift=~~((i.hash_bits+F-1)/F);i.window=new a.Buf8(i.w_size*2);i.head=new a.Buf16(i.hash_size);i.prev=new a.Buf16(i.w_size);i.lit_bufsize=1<<f+6;i.pending_buf_size=i.lit_bufsize*4;i.pending_buf=new a.Buf8(i.pending_buf_size);i.d_buf=1*i.lit_bufsize;i.l_buf=(1+2)*i.lit_bufsize;i.level=c;i.strategy=g;i.method=d;return Z(b)}function za(a,b){return ya(a,b,z,ca,C,x)}function Aa(a,c){var e,k;if(!a||!a.state||c>j||c<0)return a?M(a,n):n;k=a.state;if(!a.output||!a.input&&a.avail_in!==0||k.status===na&&c!==i)return M(a,a.avail_out===0?q:n);k.strm=a;e=k.last_flush;k.last_flush=c;if(k.status===ja)if(k.wrap===2)a.adler=0,Q(k,31),Q(k,139),Q(k,8),!k.gzhead?(Q(k,0),Q(k,0),Q(k,0),Q(k,0),Q(k,0),Q(k,k.level===9?2:k.strategy>=t||k.level<2?4:0),Q(k,qa),k.status=ma):(Q(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),Q(k,k.gzhead.time&255),Q(k,k.gzhead.time>>8&255),Q(k,k.gzhead.time>>16&255),Q(k,k.gzhead.time>>24&255),Q(k,k.level===9?2:k.strategy>=t||k.level<2?4:0),Q(k,k.gzhead.os&255),k.gzhead.extra&&k.gzhead.extra.length&&(Q(k,k.gzhead.extra.length&255),Q(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(a.adler=d(a.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=I);else{var o=z+(k.w_bits-8<<4)<<8,p;k.strategy>=t||k.level<2?p=0:k.level<6?p=1:k.level===6?p=2:p=3;o|=p<<6;k.strstart!==0&&(o|=ia);o+=31-o%31;k.status=ma;sa(k,o);k.strstart!==0&&(sa(k,a.adler>>>16),sa(k,a.adler&65535));a.adler=1}if(k.status===I)if(k.gzhead.extra){p=k.pending;while(k.gzindex<(k.gzhead.extra.length&65535)){if(k.pending===k.pending_buf_size){k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));O(a);p=k.pending;if(k.pending===k.pending_buf_size)break}Q(k,k.gzhead.extra[k.gzindex]&255);k.gzindex++}k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=J)}else k.status=J;if(k.status===J)if(k.gzhead.name){p=k.pending;do{if(k.pending===k.pending_buf_size){k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));O(a);p=k.pending;if(k.pending===k.pending_buf_size){o=1;break}}k.gzindex<k.gzhead.name.length?o=k.gzhead.name.charCodeAt(k.gzindex++)&255:o=0;Q(k,o)}while(o!==0);k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));o===0&&(k.gzindex=0,k.status=ka)}else k.status=ka;if(k.status===ka)if(k.gzhead.comment){p=k.pending;do{if(k.pending===k.pending_buf_size){k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));O(a);p=k.pending;if(k.pending===k.pending_buf_size){o=1;break}}k.gzindex<k.gzhead.comment.length?o=k.gzhead.comment.charCodeAt(k.gzindex++)&255:o=0;Q(k,o)}while(o!==0);k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));o===0&&(k.status=la)}else k.status=la;k.status===la&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&O(a),k.pending+2<=k.pending_buf_size&&(Q(k,a.adler&255),Q(k,a.adler>>8&255),a.adler=0,k.status=ma)):k.status=ma);if(k.pending!==0){O(a);if(a.avail_out===0){k.last_flush=-1;return l}}else if(a.avail_in===0&&ra(c)<=ra(e)&&c!==i)return M(a,q);if(k.status===na&&a.avail_in!==0)return M(a,q);if(a.avail_in!==0||k.lookahead!==0||c!==f&&k.status!==na){p=k.strategy===t?X(k,c):k.strategy===u?W(k,c):va[k.level].func(k,c);(p===L||p===pa)&&(k.status=na);if(p===K||p===L){a.avail_out===0&&(k.last_flush=-1);return l}if(p===oa){c===g?b._tr_align(k):c!==j&&(b._tr_stored_block(k,0,0,!1),c===h&&(N(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0)));O(a);if(a.avail_out===0){k.last_flush=-1;return l}}}if(c!==i)return l;if(k.wrap<=0)return m;k.wrap===2?(Q(k,a.adler&255),Q(k,a.adler>>8&255),Q(k,a.adler>>16&255),Q(k,a.adler>>24&255),Q(k,a.total_in&255),Q(k,a.total_in>>8&255),Q(k,a.total_in>>16&255),Q(k,a.total_in>>24&255)):(sa(k,a.adler>>>16),sa(k,a.adler&65535));O(a);k.wrap>0&&(k.wrap=-k.wrap);return k.pending!==0?l:m}function Ba(a){var b;if(!a||!a.state)return n;b=a.state.status;if(b!==ja&&b!==I&&b!==J&&b!==ka&&b!==la&&b!==ma&&b!==na)return M(a,n);a.state=null;return b===ma?M(a,o):l}function Ca(b,d){var e=d.length,f,g,h,i,j;if(!b||!b.state)return n;f=b.state;g=f.wrap;if(g===2||g===1&&f.status!==ja||f.lookahead)return n;g===1&&(b.adler=c(b.adler,d,e,0));f.wrap=0;e>=f.w_size&&(g===0&&(N(f.head),f.strstart=0,f.block_start=0,f.insert=0),j=new a.Buf8(f.w_size),a.arraySet(j,d,e-f.w_size,f.w_size,0),d=j,e=f.w_size);j=b.avail_in;h=b.next_in;i=b.input;b.avail_in=e;b.next_in=0;b.input=d;S(f);while(f.lookahead>=F){e=f.strstart;d=f.lookahead-(F-1);do f.ins_h=(f.ins_h<<f.hash_shift^f.window[e+F-1])&f.hash_mask,f.prev[e&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=e,e++;while(--d);f.strstart=e;f.lookahead=F-1;S(f)}f.strstart+=f.lookahead;f.block_start=f.strstart;f.insert=f.lookahead;f.lookahead=0;f.match_length=f.prev_length=F-1;f.match_available=0;b.next_in=h;b.input=i;b.avail_in=j;f.wrap=g;return l}B.deflateInit=za;B.deflateInit2=ya;B.deflateReset=Z;B.deflateResetKeep=xa;B.deflateSetHeader=$;B.deflate=Aa;B.deflateEnd=Ba;B.deflateSetDictionary=Ca;B.deflateInfo="pako deflate (from Nodeca project)"}var C=!1;function da(){C||(C=!0,ca());return ba.exports}var D={},ea={exports:D};function fa(){var a=k(),b=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch(a){b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){c=!1}var d=new a.Buf8(256);for(var e=0;e<256;e++)d[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;d[254]=d[254]=1;D.string2buf=function(b){var c,d,e,f,g,h=b.length,i=0;for(f=0;f<h;f++)d=b.charCodeAt(f),(d&64512)===55296&&f+1<h&&(e=b.charCodeAt(f+1),(e&64512)===56320&&(d=65536+(d-55296<<10)+(e-56320),f++)),i+=d<128?1:d<2048?2:d<65536?3:4;c=new a.Buf8(i);for(g=0,f=0;g<i;f++)d=b.charCodeAt(f),(d&64512)===55296&&f+1<h&&(e=b.charCodeAt(f+1),(e&64512)===56320&&(d=65536+(d-55296<<10)+(e-56320),f++)),d<128?c[g++]=d:d<2048?(c[g++]=192|d>>>6,c[g++]=128|d&63):d<65536?(c[g++]=224|d>>>12,c[g++]=128|d>>>6&63,c[g++]=128|d&63):(c[g++]=240|d>>>18,c[g++]=128|d>>>12&63,c[g++]=128|d>>>6&63,c[g++]=128|d&63);return c};function f(d,e){if(e<65534&&(d.subarray&&c||!d.subarray&&b))return String.fromCharCode.apply(null,a.shrinkBuf(d,e));var f="";for(var g=0;g<e;g++)f+=String.fromCharCode(d[g]);return f}D.buf2binstring=function(a){return f(a,a.length)};D.binstring2buf=function(b){var c=new a.Buf8(b.length);for(var d=0,e=c.length;d<e;d++)c[d]=b.charCodeAt(d);return c};D.buf2string=function(a,b){var c,e,g,h;b=b||a.length;var i=new Array(b*2);for(e=0,c=0;c<b;){g=a[c++];if(g<128){i[e++]=g;continue}h=d[g];if(h>4){i[e++]=65533;c+=h-1;continue}g&=h===2?31:h===3?15:7;while(h>1&&c<b)g=g<<6|a[c++]&63,h--;if(h>1){i[e++]=65533;continue}g<65536?i[e++]=g:(g-=65536,i[e++]=55296|g>>10&1023,i[e++]=56320|g&1023)}return f(i,e)};D.utf8border=function(a,b){var c;b=b||a.length;b>a.length&&(b=a.length);c=b-1;while(c>=0&&(a[c]&192)===128)c--;if(c<0)return b;return c===0?b:c+d[a[c]]>b?c:b}}var E=!1;function ga(){E||(E=!0,fa());return ea.exports}f={};var ha={exports:f};function F(){function a(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}ha.exports=a}var G=!1;function H(){G||(G=!0,F());return ha.exports}var ia={},ja={exports:ia};function I(){var a=da(),b=k(),c=ga(),d=A(),e=H(),f=Object.prototype.toString,g=0,h=4,i=0,j=1,l=2,m=-1,n=0,o=8;function p(g){if(!(this instanceof p))return new p(g);this.options=b.assign({level:m,method:o,chunkSize:16384,windowBits:15,memLevel:8,strategy:n,to:""},g||{});g=this.options;g.raw&&g.windowBits>0?g.windowBits=-g.windowBits:g.gzip&&g.windowBits>0&&g.windowBits<16&&(g.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new e();this.strm.avail_out=0;var h=a.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(h!==i)throw new Error(d[h]);g.header&&a.deflateSetHeader(this.strm,g.header);if(g.dictionary){var j;typeof g.dictionary==="string"?j=c.string2buf(g.dictionary):f.call(g.dictionary)==="[object ArrayBuffer]"?j=new Uint8Array(g.dictionary):j=g.dictionary;h=a.deflateSetDictionary(this.strm,j);if(h!==i)throw new Error(d[h]);this._dict_set=!0}}p.prototype.push=function(d,e){var k=this.strm,m=this.options.chunkSize;if(this.ended)return!1;e=e===~~e?e:e===!0?h:g;typeof d==="string"?k.input=c.string2buf(d):f.call(d)==="[object ArrayBuffer]"?k.input=new Uint8Array(d):k.input=d;k.next_in=0;k.avail_in=k.input.length;do{k.avail_out===0&&(k.output=new b.Buf8(m),k.next_out=0,k.avail_out=m);d=a.deflate(k,e);if(d!==j&&d!==i){this.onEnd(d);this.ended=!0;return!1}(k.avail_out===0||k.avail_in===0&&(e===h||e===l))&&(this.options.to==="string"?this.onData(c.buf2binstring(b.shrinkBuf(k.output,k.next_out))):this.onData(b.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&d!==j);if(e===h){d=a.deflateEnd(this.strm);this.onEnd(d);this.ended=!0;return d===i}if(e===l){this.onEnd(i);k.avail_out=0;return!0}return!0};p.prototype.onData=function(a){this.chunks.push(a)};p.prototype.onEnd=function(a){a===i&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};function q(a,b){b=new p(b);b.push(a,!0);if(b.err)throw b.msg||d[b.err];return b.result}function r(a,b){b=b||{};b.raw=!0;return q(a,b)}function aa(a,b){b=b||{};b.gzip=!0;return q(a,b)}ia.Deflate=p;ia.deflate=q;ia.deflateRaw=r;ia.gzip=aa}var J=!1;function ka(){J||(J=!0,I());return ja.exports}b={};var la={exports:b};function ma(){var a=30,b=12;la.exports=function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,aa,s,t,u,v,w,x,y,z,A;e=c.state;f=c.next_in;z=c.input;g=f+(c.avail_in-5);h=c.next_out;A=c.output;d=h-(d-c.avail_out);i=h+(c.avail_out-257);j=e.dmax;k=e.wsize;l=e.whave;m=e.wnext;n=e.window;o=e.hold;p=e.bits;q=e.lencode;r=e.distcode;aa=(1<<e.lenbits)-1;s=(1<<e.distbits)-1;top:do{p<15&&(o+=z[f++]<<p,p+=8,o+=z[f++]<<p,p+=8);t=q[o&aa];dolen:for(;;){u=t>>>24;o>>>=u;p-=u;u=t>>>16&255;if(u===0)A[h++]=t&65535;else if(u&16){v=t&65535;u&=15;u&&(p<u&&(o+=z[f++]<<p,p+=8),v+=o&(1<<u)-1,o>>>=u,p-=u);p<15&&(o+=z[f++]<<p,p+=8,o+=z[f++]<<p,p+=8);t=r[o&s];dodist:for(;;){u=t>>>24;o>>>=u;p-=u;u=t>>>16&255;if(u&16){w=t&65535;u&=15;p<u&&(o+=z[f++]<<p,p+=8,p<u&&(o+=z[f++]<<p,p+=8));w+=o&(1<<u)-1;if(w>j){c.msg="invalid distance too far back";e.mode=a;break top}o>>>=u;p-=u;u=h-d;if(w>u){u=w-u;if(u>l&&e.sane){c.msg="invalid distance too far back";e.mode=a;break top}x=0;y=n;if(m===0){x+=k-u;if(u<v){v-=u;do A[h++]=n[x++];while(--u);x=h-w;y=A}}else if(m<u){x+=k+m-u;u-=m;if(u<v){v-=u;do A[h++]=n[x++];while(--u);x=0;if(m<v){u=m;v-=u;do A[h++]=n[x++];while(--u);x=h-w;y=A}}}else{x+=m-u;if(u<v){v-=u;do A[h++]=n[x++];while(--u);x=h-w;y=A}}while(v>2)A[h++]=y[x++],A[h++]=y[x++],A[h++]=y[x++],v-=3;v&&(A[h++]=y[x++],v>1&&(A[h++]=y[x++]))}else{x=h-w;do A[h++]=A[x++],A[h++]=A[x++],A[h++]=A[x++],v-=3;while(v>2);v&&(A[h++]=A[x++],v>1&&(A[h++]=A[x++]))}}else if((u&64)===0){t=r[(t&65535)+(o&(1<<u)-1)];continue dodist}else{c.msg="invalid distance code";e.mode=a;break top}break}}else if((u&64)===0){t=q[(t&65535)+(o&(1<<u)-1)];continue dolen}else if(u&32){e.mode=b;break top}else{c.msg="invalid literal/length code";e.mode=a;break top}break}}while(f<g&&h<i);v=p>>3;f-=v;p-=v<<3;o&=(1<<p)-1;c.next_in=f;c.next_out=h;c.avail_in=f<g?5+(g-f):5-(f-g);c.avail_out=h<i?257+(i-h):257-(h-i);e.hold=o;e.bits=p;return}}var na=!1;function K(){na||(na=!0,ma());return la.exports}c={};var oa={exports:c};function L(){var a=k(),b=15,c=852,d=592,e=0,f=1,g=2,h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],j=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];oa.exports=function(k,m,n,o,p,q,r,aa){var s=aa.bits,t,u,v,w,x,y,z,A,B,ba,ca,C,da,D,ea=0,fa,E=new a.Buf16(b+1),ga=new a.Buf16(b+1),ha=0,F,G,H;for(t=0;t<=b;t++)E[t]=0;for(u=0;u<o;u++)E[m[n+u]]++;s=s;for(w=b;w>=1;w--)if(E[w]!==0)break;s>w&&(s=w);if(w===0){p[q++]=1<<24|64<<16|0;p[q++]=1<<24|64<<16|0;aa.bits=1;return 0}for(v=1;v<w;v++)if(E[v]!==0)break;s<v&&(s=v);z=1;for(t=1;t<=b;t++){z<<=1;z-=E[t];if(z<0)return-1}if(z>0&&(k===e||w!==1))return-1;ga[1]=0;for(t=1;t<b;t++)ga[t+1]=ga[t]+E[t];for(u=0;u<o;u++)m[n+u]!==0&&(r[ga[m[n+u]]++]=u);k===e?(ga=o=r,fa=19):k===f?(ga=h,ea-=257,o=i,ha-=257,fa=256):(ga=j,o=l,fa=-1);B=0;u=0;t=v;D=q;x=s;y=0;C=-1;A=1<<s;da=A-1;if(k===f&&A>c||k===g&&A>d)return 1;for(;;){F=t-y;r[u]<fa?(G=0,H=r[u]):r[u]>fa?(G=o[ha+r[u]],H=ga[ea+r[u]]):(G=32+64,H=0);ba=1<<t-y;ca=1<<x;v=ca;do ca-=ba,p[D+(B>>y)+ca]=F<<24|G<<16|H|0;while(ca!==0);ba=1<<t-1;while(B&ba)ba>>=1;ba!==0?(B&=ba-1,B+=ba):B=0;u++;if(--E[t]===0){if(t===w)break;t=m[n+r[u]]}if(t>s&&(B&da)!==C){y===0&&(y=s);D+=v;x=t-y;z=1<<x;while(x+y<w){z-=E[x+y];if(z<=0)break;x++;z<<=1}A+=1<<x;if(k===f&&A>c||k===g&&A>d)return 1;C=B&da;p[C]=s<<24|x<<16|D-q|0}}B!==0&&(p[D+B]=t-y<<24|64<<16|0);aa.bits=s;return 0}}var pa=!1;function qa(){pa||(pa=!0,L());return oa.exports}var M={},ra={exports:M};function N(){var a=k(),b=s(),c=w(),d=K(),e=qa(),f=0,g=1,h=2,i=4,j=5,l=6,m=0,n=1,o=2,p=-2,q=-3,r=-4,aa=-5,t=8,u=1,v=2,x=3,y=4,z=5,A=6,B=7,ba=8,ca=9,C=10,da=11,D=12,ea=13,fa=14,E=15,ga=16,ha=17,F=18,G=19,H=20,ia=21,ja=22,I=23,J=24,ka=25,la=26,ma=27,na=28,oa=29,L=30,pa=31,ra=32,N=852,O=592,P=15,Q=P;function sa(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ta(b){var c;if(!b||!b.state)return p;c=b.state;b.total_in=b.total_out=c.total=0;b.msg="";c.wrap&&(b.adler=c.wrap&1);c.mode=u;c.last=0;c.havedict=0;c.dmax=32768;c.head=null;c.hold=0;c.bits=0;c.lencode=c.lendyn=new a.Buf32(N);c.distcode=c.distdyn=new a.Buf32(O);c.sane=1;c.back=-1;return m}function S(a){var b;if(!a||!a.state)return p;b=a.state;b.wsize=0;b.whave=0;b.wnext=0;return ta(a)}function T(a,b){var c,d;if(!a||!a.state)return p;d=a.state;b<0?(c=0,b=-b):(c=(b>>4)+1,b<48&&(b&=15));if(b&&(b<8||b>15))return p;d.window!==null&&d.wbits!==b&&(d.window=null);d.wrap=c;d.wbits=b;return S(a)}function U(a,b){var c;if(!a)return p;c=new R();a.state=c;c.window=null;c=T(a,b);c!==m&&(a.state=null);return c}function V(a){return U(a,Q)}var W=!0,X,ua;function va(b){if(W){var c;X=new a.Buf32(512);ua=new a.Buf32(32);c=0;while(c<144)b.lens[c++]=8;while(c<256)b.lens[c++]=9;while(c<280)b.lens[c++]=7;while(c<288)b.lens[c++]=8;e(g,b.lens,0,288,X,0,b.work,{bits:9});c=0;while(c<32)b.lens[c++]=5;e(h,b.lens,0,32,ua,0,b.work,{bits:5});W=!1}b.lencode=X;b.lenbits=9;b.distcode=ua;b.distbits=5}function wa(b,c,d,e){var f;b=b.state;b.window===null&&(b.wsize=1<<b.wbits,b.wnext=0,b.whave=0,b.window=new a.Buf8(b.wsize));e>=b.wsize?(a.arraySet(b.window,c,d-b.wsize,b.wsize,0),b.wnext=0,b.whave=b.wsize):(f=b.wsize-b.wnext,f>e&&(f=e),a.arraySet(b.window,c,d-e,f,b.wnext),e-=f,e?(a.arraySet(b.window,c,d-e,e,0),b.wnext=e,b.whave=b.wsize):(b.wnext+=f,b.wnext===b.wsize&&(b.wnext=0),b.whave<b.wsize&&(b.whave+=f)));return 0}function Y(k,s){var w,K,qa,M,N,O,P,Q,R,ta,S,T,U,V,W,X,ua,Y,xa,Z=new a.Buf8(4),$,ya,za=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return p;w=k.state;w.mode===D&&(w.mode=ea);N=k.next_out;qa=k.output;P=k.avail_out;M=k.next_in;K=k.input;O=k.avail_in;Q=w.hold;R=w.bits;ta=O;S=P;xa=m;inf_leave:for(;;)switch(w.mode){case u:if(w.wrap===0){w.mode=ea;break}while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(w.wrap&2&&Q===35615){w.check=0;Z[0]=Q&255;Z[1]=Q>>>8&255;w.check=c(w.check,Z,2,0);Q=0;R=0;w.mode=v;break}w.flags=0;w.head&&(w.head.done=!1);if(!(w.wrap&1)||(((Q&255)<<8)+(Q>>8))%31){k.msg="incorrect header check";w.mode=L;break}if((Q&15)!==t){k.msg="unknown compression method";w.mode=L;break}Q>>>=4;R-=4;Y=(Q&15)+8;if(w.wbits===0)w.wbits=Y;else if(Y>w.wbits){k.msg="invalid window size";w.mode=L;break}w.dmax=1<<Y;k.adler=w.check=1;w.mode=Q&512?C:D;Q=0;R=0;break;case v:while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.flags=Q;if((w.flags&255)!==t){k.msg="unknown compression method";w.mode=L;break}if(w.flags&57344){k.msg="unknown header flags set";w.mode=L;break}w.head&&(w.head.text=Q>>8&1);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,w.check=c(w.check,Z,2,0));Q=0;R=0;w.mode=x;case x:while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.head&&(w.head.time=Q);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,Z[2]=Q>>>16&255,Z[3]=Q>>>24&255,w.check=c(w.check,Z,4,0));Q=0;R=0;w.mode=y;case y:while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.head&&(w.head.xflags=Q&255,w.head.os=Q>>8);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,w.check=c(w.check,Z,2,0));Q=0;R=0;w.mode=z;case z:if(w.flags&1024){while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.length=Q;w.head&&(w.head.extra_len=Q);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,w.check=c(w.check,Z,2,0));Q=0;R=0}else w.head&&(w.head.extra=null);w.mode=A;case A:if(w.flags&1024){T=w.length;T>O&&(T=O);T&&(w.head&&(Y=w.head.extra_len-w.length,w.head.extra||(w.head.extra=new Array(w.head.extra_len)),a.arraySet(w.head.extra,K,M,T,Y)),w.flags&512&&(w.check=c(w.check,K,T,M)),O-=T,M+=T,w.length-=T);if(w.length)break inf_leave}w.length=0;w.mode=B;case B:if(w.flags&2048){if(O===0)break inf_leave;T=0;do Y=K[M+T++],w.head&&Y&&w.length<65536&&(w.head.name+=String.fromCharCode(Y));while(Y&&T<O);w.flags&512&&(w.check=c(w.check,K,T,M));O-=T;M+=T;if(Y)break inf_leave}else w.head&&(w.head.name=null);w.length=0;w.mode=ba;case ba:if(w.flags&4096){if(O===0)break inf_leave;T=0;do Y=K[M+T++],w.head&&Y&&w.length<65536&&(w.head.comment+=String.fromCharCode(Y));while(Y&&T<O);w.flags&512&&(w.check=c(w.check,K,T,M));O-=T;M+=T;if(Y)break inf_leave}else w.head&&(w.head.comment=null);w.mode=ca;case ca:if(w.flags&512){while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(Q!==(w.check&65535)){k.msg="header crc mismatch";w.mode=L;break}Q=0;R=0}w.head&&(w.head.hcrc=w.flags>>9&1,w.head.done=!0);k.adler=w.check=0;w.mode=D;break;case C:while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}k.adler=w.check=sa(Q);Q=0;R=0;w.mode=da;case da:if(w.havedict===0){k.next_out=N;k.avail_out=P;k.next_in=M;k.avail_in=O;w.hold=Q;w.bits=R;return o}k.adler=w.check=1;w.mode=D;case D:if(s===j||s===l)break inf_leave;case ea:if(w.last){Q>>>=R&7;R-=R&7;w.mode=ma;break}while(R<3){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.last=Q&1;Q>>>=1;R-=1;switch(Q&3){case 0:w.mode=fa;break;case 1:va(w);w.mode=H;if(s===l){Q>>>=2;R-=2;break inf_leave}break;case 2:w.mode=ha;break;case 3:k.msg="invalid block type",w.mode=L}Q>>>=2;R-=2;break;case fa:Q>>>=R&7;R-=R&7;while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if((Q&65535)!==(Q>>>16^65535)){k.msg="invalid stored block lengths";w.mode=L;break}w.length=Q&65535;Q=0;R=0;w.mode=E;if(s===l)break inf_leave;case E:w.mode=ga;case ga:T=w.length;if(T){T>O&&(T=O);T>P&&(T=P);if(T===0)break inf_leave;a.arraySet(qa,K,M,T,N);O-=T;M+=T;P-=T;N+=T;w.length-=T;break}w.mode=D;break;case ha:while(R<14){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.nlen=(Q&31)+257;Q>>>=5;R-=5;w.ndist=(Q&31)+1;Q>>>=5;R-=5;w.ncode=(Q&15)+4;Q>>>=4;R-=4;if(w.nlen>286||w.ndist>30){k.msg="too many length or distance symbols";w.mode=L;break}w.have=0;w.mode=F;case F:while(w.have<w.ncode){while(R<3){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.lens[za[w.have++]]=Q&7;Q>>>=3;R-=3}while(w.have<19)w.lens[za[w.have++]]=0;w.lencode=w.lendyn;w.lenbits=7;$={bits:w.lenbits};xa=e(f,w.lens,0,19,w.lencode,0,w.work,$);w.lenbits=$.bits;if(xa){k.msg="invalid code lengths set";w.mode=L;break}w.have=0;w.mode=G;case G:while(w.have<w.nlen+w.ndist){for(;;){U=w.lencode[Q&(1<<w.lenbits)-1];V=U>>>24;W=U>>>16&255;X=U&65535;if(V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(X<16)Q>>>=V,R-=V,w.lens[w.have++]=X;else{if(X===16){ya=V+2;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=V;R-=V;if(w.have===0){k.msg="invalid bit length repeat";w.mode=L;break}Y=w.lens[w.have-1];T=3+(Q&3);Q>>>=2;R-=2}else if(X===17){ya=V+3;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=V;R-=V;Y=0;T=3+(Q&7);Q>>>=3;R-=3}else{ya=V+7;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=V;R-=V;Y=0;T=11+(Q&127);Q>>>=7;R-=7}if(w.have+T>w.nlen+w.ndist){k.msg="invalid bit length repeat";w.mode=L;break}while(T--)w.lens[w.have++]=Y}}if(w.mode===L)break;if(w.lens[256]===0){k.msg="invalid code -- missing end-of-block";w.mode=L;break}w.lenbits=9;$={bits:w.lenbits};xa=e(g,w.lens,0,w.nlen,w.lencode,0,w.work,$);w.lenbits=$.bits;if(xa){k.msg="invalid literal/lengths set";w.mode=L;break}w.distbits=6;w.distcode=w.distdyn;$={bits:w.distbits};xa=e(h,w.lens,w.nlen,w.ndist,w.distcode,0,w.work,$);w.distbits=$.bits;if(xa){k.msg="invalid distances set";w.mode=L;break}w.mode=H;if(s===l)break inf_leave;case H:w.mode=ia;case ia:if(O>=6&&P>=258){k.next_out=N;k.avail_out=P;k.next_in=M;k.avail_in=O;w.hold=Q;w.bits=R;d(k,S);N=k.next_out;qa=k.output;P=k.avail_out;M=k.next_in;K=k.input;O=k.avail_in;Q=w.hold;R=w.bits;w.mode===D&&(w.back=-1);break}w.back=0;for(;;){U=w.lencode[Q&(1<<w.lenbits)-1];V=U>>>24;W=U>>>16&255;X=U&65535;if(V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(W&&(W&240)===0){Y=V;$=W;ua=X;for(;;){U=w.lencode[ua+((Q&(1<<Y+$)-1)>>Y)];V=U>>>24;W=U>>>16&255;X=U&65535;if(Y+V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=Y;R-=Y;w.back+=Y}Q>>>=V;R-=V;w.back+=V;w.length=X;if(W===0){w.mode=la;break}if(W&32){w.back=-1;w.mode=D;break}if(W&64){k.msg="invalid literal/length code";w.mode=L;break}w.extra=W&15;w.mode=ja;case ja:if(w.extra){ya=w.extra;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.length+=Q&(1<<w.extra)-1;Q>>>=w.extra;R-=w.extra;w.back+=w.extra}w.was=w.length;w.mode=I;case I:for(;;){U=w.distcode[Q&(1<<w.distbits)-1];V=U>>>24;W=U>>>16&255;X=U&65535;if(V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if((W&240)===0){Y=V;$=W;ua=X;for(;;){U=w.distcode[ua+((Q&(1<<Y+$)-1)>>Y)];V=U>>>24;W=U>>>16&255;X=U&65535;if(Y+V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=Y;R-=Y;w.back+=Y}Q>>>=V;R-=V;w.back+=V;if(W&64){k.msg="invalid distance code";w.mode=L;break}w.offset=X;w.extra=W&15;w.mode=J;case J:if(w.extra){ya=w.extra;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.offset+=Q&(1<<w.extra)-1;Q>>>=w.extra;R-=w.extra;w.back+=w.extra}if(w.offset>w.dmax){k.msg="invalid distance too far back";w.mode=L;break}w.mode=ka;case ka:if(P===0)break inf_leave;T=S-P;if(w.offset>T){T=w.offset-T;if(T>w.whave&&w.sane){k.msg="invalid distance too far back";w.mode=L;break}T>w.wnext?(T-=w.wnext,U=w.wsize-T):U=w.wnext-T;T>w.length&&(T=w.length);$=w.window}else $=qa,U=N-w.offset,T=w.length;T>P&&(T=P);P-=T;w.length-=T;do qa[N++]=$[U++];while(--T);w.length===0&&(w.mode=ia);break;case la:if(P===0)break inf_leave;qa[N++]=w.length;P--;w.mode=ia;break;case ma:if(w.wrap){while(R<32){if(O===0)break inf_leave;O--;Q|=K[M++]<<R;R+=8}S-=P;k.total_out+=S;w.total+=S;S&&(k.adler=w.check=w.flags?c(w.check,qa,S,N-S):b(w.check,qa,S,N-S));S=P;if((w.flags?Q:sa(Q))!==w.check){k.msg="incorrect data check";w.mode=L;break}Q=0;R=0}w.mode=na;case na:if(w.wrap&&w.flags){while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(Q!==(w.total&4294967295)){k.msg="incorrect length check";w.mode=L;break}Q=0;R=0}w.mode=oa;case oa:xa=n;break inf_leave;case L:xa=q;break inf_leave;case pa:return r;case ra:default:return p}k.next_out=N;k.avail_out=P;k.next_in=M;k.avail_in=O;w.hold=Q;w.bits=R;if((w.wsize||S!==k.avail_out&&w.mode<L&&(w.mode<ma||s!==i))&&wa(k,k.output,k.next_out,S-k.avail_out)){w.mode=pa;return r}ta-=k.avail_in;S-=k.avail_out;k.total_in+=ta;k.total_out+=S;w.total+=S;w.wrap&&S&&(k.adler=w.check=w.flags?c(w.check,qa,S,k.next_out-S):b(w.check,qa,S,k.next_out-S));k.data_type=w.bits+(w.last?64:0)+(w.mode===D?128:0)+(w.mode===H||w.mode===E?256:0);(ta===0&&S===0||s===i)&&xa===m&&(xa=aa);return xa}function xa(a){if(!a||!a.state)return p;var b=a.state;b.window&&(b.window=null);a.state=null;return m}function Z(a,b){if(!a||!a.state)return p;a=a.state;if((a.wrap&2)===0)return p;a.head=b;b.done=!1;return m}function $(a,c){var d=c.length,e,f;if(!a||!a.state)return p;e=a.state;if(e.wrap!==0&&e.mode!==da)return p;if(e.mode===da){f=1;f=b(f,c,d,0);if(f!==e.check)return q}f=wa(a,c,d,d);if(f){e.mode=pa;return r}e.havedict=1;return m}M.inflateReset=S;M.inflateReset2=T;M.inflateResetKeep=ta;M.inflateInit=V;M.inflateInit2=U;M.inflate=Y;M.inflateEnd=xa;M.inflateGetHeader=Z;M.inflateSetDictionary=$;M.inflateInfo="pako inflate (from Nodeca project)"}var O=!1;function P(){O||(O=!0,N());return ra.exports}d={};var Q={exports:d};function sa(){Q.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}var R=!1;function ta(){R||(R=!0,sa());return Q.exports}f={};var S={exports:f};function T(){function a(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}S.exports=a}var U=!1;function V(){U||(U=!0,T());return S.exports}var W={},X={exports:W};function ua(){var a=P(),b=k(),c=ga(),d=ta(),e=A(),f=H(),g=V(),h=Object.prototype.toString;function i(j){if(!(this instanceof i))return new i(j);this.options=b.assign({chunkSize:16384,windowBits:0,to:""},j||{});var k=this.options;k.raw&&k.windowBits>=0&&k.windowBits<16&&(k.windowBits=-k.windowBits,k.windowBits===0&&(k.windowBits=-15));k.windowBits>=0&&k.windowBits<16&&!(j&&j.windowBits)&&(k.windowBits+=32);k.windowBits>15&&k.windowBits<48&&((k.windowBits&15)===0&&(k.windowBits|=15));this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new f();this.strm.avail_out=0;j=a.inflateInit2(this.strm,k.windowBits);if(j!==d.Z_OK)throw new Error(e[j]);this.header=new g();a.inflateGetHeader(this.strm,this.header);if(k.dictionary){typeof k.dictionary==="string"?k.dictionary=c.string2buf(k.dictionary):h.call(k.dictionary)==="[object ArrayBuffer]"&&(k.dictionary=new Uint8Array(k.dictionary));if(k.raw){j=a.inflateSetDictionary(this.strm,k.dictionary);if(j!==d.Z_OK)throw new Error(e[j])}}}i.prototype.push=function(e,f){var g=this.strm,i=this.options.chunkSize,j=this.options.dictionary,k,l,m,n=!1;if(this.ended)return!1;f=f===~~f?f:f===!0?d.Z_FINISH:d.Z_NO_FLUSH;typeof e==="string"?g.input=c.binstring2buf(e):h.call(e)==="[object ArrayBuffer]"?g.input=new Uint8Array(e):g.input=e;g.next_in=0;g.avail_in=g.input.length;do{g.avail_out===0&&(g.output=new b.Buf8(i),g.next_out=0,g.avail_out=i);e=a.inflate(g,d.Z_NO_FLUSH);e===d.Z_NEED_DICT&&j&&(e=a.inflateSetDictionary(this.strm,j));e===d.Z_BUF_ERROR&&n===!0&&(e=d.Z_OK,n=!1);if(e!==d.Z_STREAM_END&&e!==d.Z_OK){this.onEnd(e);this.ended=!0;return!1}g.next_out&&((g.avail_out===0||e===d.Z_STREAM_END||g.avail_in===0&&(f===d.Z_FINISH||f===d.Z_SYNC_FLUSH))&&(this.options.to==="string"?(k=c.utf8border(g.output,g.next_out),l=g.next_out-k,m=c.buf2string(g.output,k),g.next_out=l,g.avail_out=i-l,l&&b.arraySet(g.output,g.output,k,l,0),this.onData(m)):this.onData(b.shrinkBuf(g.output,g.next_out))));g.avail_in===0&&g.avail_out===0&&(n=!0)}while((g.avail_in>0||g.avail_out===0)&&e!==d.Z_STREAM_END);e===d.Z_STREAM_END&&(f=d.Z_FINISH);if(f===d.Z_FINISH){e=a.inflateEnd(this.strm);this.onEnd(e);this.ended=!0;return e===d.Z_OK}if(f===d.Z_SYNC_FLUSH){this.onEnd(d.Z_OK);g.avail_out=0;return!0}return!0};i.prototype.onData=function(a){this.chunks.push(a)};i.prototype.onEnd=function(a){a===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};function j(a,b){b=new i(b);b.push(a,!0);if(b.err)throw b.msg||e[b.err];return b.result}function l(a,b){b=b||{};b.raw=!0;return j(a,b)}W.Inflate=i;W.inflate=j;W.inflateRaw=l;W.ungzip=j}var va=!1;function wa(){va||(va=!0,ua());return X.exports}b={};var Y={exports:b};function xa(){var a=k().assign,b=ka(),c=wa(),d=ta(),e={};a(e,b,c,d);Y.exports=e}var Z=!1;function $(){Z||(Z=!0,xa());return Y.exports}function a(a){switch(a){case void 0:return $()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("process-nextick-args-2.0.0",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?g.exports={nextTick:a}:g.exports=process;function a(a,b,c,d){if(typeof a!=="function")throw new TypeError('"callback" argument must be a function');var e=arguments.length,f,g;switch(e){case 0:case 1:return process.nextTick(a);case 2:return process.nextTick(function(){a.call(null,b)});case 3:return process.nextTick(function(){a.call(null,b,c)});case 4:return process.nextTick(function(){a.call(null,b,c,d)});default:f=new Array(e-1);g=0;while(g<f.length)f[g++]=arguments[g];return process.nextTick(function(){a.apply(null,f)})}}}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("safe-buffer-5.1.2",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){var a={},b=a.Buffer;function c(a,b){for(var c in a)b[c]=a[c]}b.from&&b.alloc&&b.allocUnsafe&&b.allocUnsafeSlow?h.exports=a:(c(a,g),g.Buffer=d);function d(a,c,d){return b(a,c,d)}c(b,d);d.from=function(a,c,d){if(typeof a==="number")throw new TypeError("Argument must not be a number");return b(a,c,d)};d.alloc=function(a,c,d){if(typeof a!=="number")throw new TypeError("Argument must be a number");a=b(a);c!==void 0?typeof d==="string"?a.fill(c,d):a.fill(c):a.fill(0);return a};d.allocUnsafe=function(a){if(typeof a!=="number")throw new TypeError("Argument must be a number");return b(a)};d.allocUnsafeSlow=function(b){if(typeof b!=="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(b)}}var j=!1;function k(){j||(j=!0,i());return h.exports}function a(a){switch(a){case void 0:return k()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("util-deprecate-1.0.2",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){g.exports={}.deprecate}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("readable-stream-2.3.6",["safe-buffer-5.1.2","process-nextick-args-2.0.0","core-util-is-1.0.2","inherits-2.0.3","util-deprecate-1.0.2","isarray-1.0.0"],(function(a,b,c,d,e,f){"use strict";function c(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=c(b("safe-buffer-5.1.2")),h=c(b("process-nextick-args-2.0.0")),i=c(b("core-util-is-1.0.2")),j=c(b("inherits-2.0.3")),k=c(b("util-deprecate-1.0.2")),l=c(b("isarray-1.0.0"));c={};var m={exports:c};function n(){m.exports={}}var o=!1;function p(){o||(o=!0,n());return m.exports}b={};var q={exports:b};function r(){function a(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var b=g().Buffer,c={};function d(a,b,c){a.copy(b,c)}q.exports=function(){function c(){a(this,c),this.head=null,this.tail=null,this.length=0}c.prototype.push=function(a){a={data:a,next:null};this.length>0?this.tail.next=a:this.head=a;this.tail=a;++this.length};c.prototype.unshift=function(a){a={data:a,next:this.head};this.length===0&&(this.tail=a);this.head=a;++this.length};c.prototype.shift=function(){if(this.length===0)return;var a=this.head.data;this.length===1?this.head=this.tail=null:this.head=this.head.next;--this.length;return a};c.prototype.clear=function(){this.head=this.tail=null,this.length=0};c.prototype.join=function(a){if(this.length===0)return"";var b=this.head,c=""+b.data;while(b=b.next)c+=a+b.data;return c};c.prototype.concat=function(a){if(this.length===0)return b.alloc(0);if(this.length===1)return this.head.data;a=b.allocUnsafe(a>>>0);var c=this.head,e=0;while(c)d(c.data,a,e),e+=c.data.length,c=c.next;return a};return c}();c&&c.inspect&&c.inspect.custom&&(q.exports.prototype[c.inspect.custom]=function(){var a=c.inspect({length:this.length});return this.constructor.name+" "+a})}var s=!1;function t(){s||(s=!0,r());return q.exports}c={};var u={exports:c};function v(){var a=h();function b(b,c){var e=this,f=this._readableState&&this._readableState.destroyed,g=this._writableState&&this._writableState.destroyed;if(f||g){c?c(b):b&&(!this._writableState||!this._writableState.errorEmitted)&&a.nextTick(d,this,b);return this}this._readableState&&(this._readableState.destroyed=!0);this._writableState&&(this._writableState.destroyed=!0);this._destroy(b||null,function(b){!c&&b?(a.nextTick(d,e,b),e._writableState&&(e._writableState.errorEmitted=!0)):c&&c(b)});return this}function c(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function d(a,b){a.emit("error",b)}u.exports={destroy:b,undestroy:c}}var w=!1;function x(){w||(w=!0,v());return u.exports}b={};var y={exports:b};function z(){var b=h();y.exports=w;function c(a){var b=this;this.next=null;this.entry=null;this.finish=function(){Q(b,a)}}var d=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:b.nextTick,e;w.WritableState=u;var f=i();f.inherits=j();var l={deprecate:k()},m=p(),n=g().Buffer,o=a.Uint8Array||function(){};function q(a){return n.from(a)}function r(a){return n.isBuffer(a)||a instanceof o}var s=x();f.inherits(w,m);function t(){}function u(a,b){e=e||F();a=a||{};var d=b instanceof e;this.objectMode=!!a.objectMode;d&&(this.objectMode=this.objectMode||!!a.writableObjectMode);var f=a.highWaterMark,g=a.writableHighWaterMark,h=this.objectMode?16:16*1024;f||f===0?this.highWaterMark=f:d&&(g||g===0)?this.highWaterMark=g:this.highWaterMark=h;this.highWaterMark=Math.floor(this.highWaterMark);this.finalCalled=!1;this.needDrain=!1;this.ending=!1;this.ended=!1;this.finished=!1;this.destroyed=!1;f=a.decodeStrings===!1;this.decodeStrings=!f;this.defaultEncoding=a.defaultEncoding||"utf8";this.length=0;this.writing=!1;this.corked=0;this.sync=!0;this.bufferProcessing=!1;this.onwrite=function(a){H(b,a)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=!1;this.errorEmitted=!1;this.bufferedRequestCount=0;this.corkedRequestsFree=new c(this)}u.prototype.getBuffer=function(){var a=this.bufferedRequest,b=[];while(a)b.push(a),a=a.next;return b};(function(){try{Object.defineProperty(u.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(a){}})();var v;typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(a){if(v.call(this,a))return!0;return this!==w?!1:a&&a._writableState instanceof u}})):v=function(a){return a instanceof this};function w(a){e=e||F();if(!v.call(w,this)&&!(this instanceof e))return new w(a);this._writableState=new u(a,this);this.writable=!0;a&&(typeof a.write==="function"&&(this._write=a.write),typeof a.writev==="function"&&(this._writev=a.writev),typeof a.destroy==="function"&&(this._destroy=a.destroy),typeof a["final"]==="function"&&(this._final=a["final"]));m.call(this)}w.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function z(a,c){var d=new Error("write after end");a.emit("error",d);b.nextTick(c,d)}function A(a,c,d,e){var f=!0,g=!1;d===null?g=new TypeError("May not write null values to stream"):typeof d!=="string"&&d!==void 0&&!c.objectMode&&(g=new TypeError("Invalid non-string/buffer chunk"));g&&(a.emit("error",g),b.nextTick(e,g),f=!1);return f}w.prototype.write=function(a,b,c){var d=this._writableState,e=!1,f=!d.objectMode&&r(a);f&&!n.isBuffer(a)&&(a=q(a));typeof b==="function"&&(c=b,b=null);f?b="buffer":b||(b=d.defaultEncoding);typeof c!=="function"&&(c=t);d.ended?z(this,c):(f||A(this,d,a,c))&&(d.pendingcb++,e=C(this,d,f,a,b,c));return e};w.prototype.cork=function(){var a=this._writableState;a.corked++};w.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,!a.writing&&!a.corked&&!a.finished&&!a.bufferProcessing&&a.bufferedRequest&&K(this,a))};w.prototype.setDefaultEncoding=function(a){typeof a==="string"&&(a=a.toLowerCase());if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);this._writableState.defaultEncoding=a;return this};function B(a,b,c){!a.objectMode&&a.decodeStrings!==!1&&typeof b==="string"&&(b=n.from(b,c));return b}Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function C(a,b,c,d,e,f){if(!c){var g=B(b,d,e);d!==g&&(c=!0,e="buffer",d=g)}g=b.objectMode?1:d.length;b.length+=g;var h=b.length<b.highWaterMark;h||(b.needDrain=!0);if(b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest={chunk:d,encoding:e,isBuf:c,callback:f,next:null};i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest;b.bufferedRequestCount+=1}else D(a,b,!1,g,d,e,f);return h}function D(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function E(a,c,d,e,f){--c.pendingcb,d?(b.nextTick(f,e),b.nextTick(O,a,c),a._writableState.errorEmitted=!0,a.emit("error",e)):(f(e),a._writableState.errorEmitted=!0,a.emit("error",e),O(a,c))}function G(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function H(a,b){var c=a._writableState,e=c.sync,f=c.writecb;G(c);if(b)E(a,c,e,b,f);else{b=L(c);!b&&!c.corked&&!c.bufferProcessing&&c.bufferedRequest&&K(a,c);e?d(I,a,c,b,f):I(a,c,b,f)}}function I(a,b,c,d){c||J(a,b),b.pendingcb--,d(),O(a,b)}function J(a,b){b.length===0&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function K(a,b){b.bufferProcessing=!0;var d=b.bufferedRequest;if(a._writev&&d&&d.next){var e=b.bufferedRequestCount;e=new Array(e);var f=b.corkedRequestsFree;f.entry=d;var g=0,h=!0;while(d)e[g]=d,d.isBuf||(h=!1),d=d.next,g+=1;e.allBuffers=h;D(a,b,!0,b.length,e,"",f.finish);b.pendingcb++;b.lastBufferedRequest=null;f.next?(b.corkedRequestsFree=f.next,f.next=null):b.corkedRequestsFree=new c(b);b.bufferedRequestCount=0}else{while(d){g=d.chunk;h=d.encoding;e=d.callback;f=b.objectMode?1:g.length;D(a,b,!1,f,g,h,e);d=d.next;b.bufferedRequestCount--;if(b.writing)break}d===null&&(b.lastBufferedRequest=null)}b.bufferedRequest=d;b.bufferProcessing=!1}w.prototype._write=function(a,b,c){c(new Error("_write() is not implemented"))};w.prototype._writev=null;w.prototype.end=function(a,b,c){var d=this._writableState;typeof a==="function"?(c=a,a=null,b=null):typeof b==="function"&&(c=b,b=null);a!==null&&a!==void 0&&this.write(a,b);d.corked&&(d.corked=1,this.uncork());!d.ending&&!d.finished&&P(this,d,c)};function L(a){return a.ending&&a.length===0&&a.bufferedRequest===null&&!a.finished&&!a.writing}function M(a,b){a._final(function(c){b.pendingcb--,c&&a.emit("error",c),b.prefinished=!0,a.emit("prefinish"),O(a,b)})}function N(a,c){!c.prefinished&&!c.finalCalled&&(typeof a._final==="function"?(c.pendingcb++,c.finalCalled=!0,b.nextTick(M,a,c)):(c.prefinished=!0,a.emit("prefinish")))}function O(a,b){var c=L(b);c&&(N(a,b),b.pendingcb===0&&(b.finished=!0,a.emit("finish")));return c}function P(a,c,d){c.ending=!0,O(a,c),d&&(c.finished?b.nextTick(d):a.once("finish",d)),c.ended=!0,a.writable=!1}function Q(a,b,c){var d=a.entry;a.entry=null;while(d){var e=d.callback;b.pendingcb--;e(c);d=d.next}b.corkedRequestsFree?b.corkedRequestsFree.next=a:b.corkedRequestsFree=a}Object.defineProperty(w.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(a){if(!this._writableState)return;this._writableState.destroyed=a}});w.prototype.destroy=s.destroy;w.prototype._undestroy=s.undestroy;w.prototype._destroy=function(a,b){this.end(),b(a)}}var A=!1;function B(){A||(A=!0,z());return y.exports}c={};var C={exports:c};function D(){var a=h(),b=Object.keys||function(a){var b=[];for(a in a)b.push(a);return b};C.exports=g;var c=i();c.inherits=j();var d=O(),e=B();c.inherits(g,d);c=b(e.prototype);for(b=0;b<c.length;b++){var f=c[b];g.prototype[f]||(g.prototype[f]=e.prototype[f])}function g(a){if(!(this instanceof g))return new g(a);d.call(this,a);e.call(this,a);a&&a.readable===!1&&(this.readable=!1);a&&a.writable===!1&&(this.writable=!1);this.allowHalfOpen=!0;a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1);this.once("end",k)}Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function k(){if(this.allowHalfOpen||this._writableState.ended)return;a.nextTick(l,this)}function l(a){a.end()}Object.defineProperty(g.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(a){if(this._readableState===void 0||this._writableState===void 0)return;this._readableState.destroyed=a;this._writableState.destroyed=a}});g.prototype._destroy=function(b,c){this.push(null),this.end(),a.nextTick(c,b)}}var E=!1;function F(){E||(E=!0,D());return C.exports}var G={},H={exports:G};function I(){var a=g().Buffer,b=a.isEncoding||function(a){a=""+a;switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function c(a){if(!a)return"utf8";var b;while(!0)switch(a){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return a;default:if(b)return;a=(""+a).toLowerCase();b=!0}}function d(d){var e=c(d);if(typeof e!=="string"&&(a.isEncoding===b||!b(d)))throw new Error("Unknown encoding: "+d);return e||d}G.StringDecoder=e;function e(b){this.encoding=d(b);var c;switch(this.encoding){case"utf16le":this.text=m;this.end=n;c=4;break;case"utf8":this.fillLast=j;c=4;break;case"base64":this.text=o;this.end=p;c=3;break;default:this.write=q;this.end=r;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=a.allocUnsafe(c)}e.prototype.write=function(a){if(a.length===0)return"";var b,c;if(this.lastNeed){b=this.fillLast(a);if(b===void 0)return"";c=this.lastNeed;this.lastNeed=0}else c=0;return c<a.length?b?b+this.text(a,c):this.text(a,c):b||""};e.prototype.end=l;e.prototype.text=k;e.prototype.fillLast=function(a){if(this.lastNeed<=a.length){a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,a.length);this.lastNeed-=a.length};function f(a){if(a<=127)return 0;else if(a>>5===6)return 2;else if(a>>4===14)return 3;else if(a>>3===30)return 4;return a>>6===2?-1:-2}function h(a,b,c){var d=b.length-1;if(d<c)return 0;var e=f(b[d]);if(e>=0){e>0&&(a.lastNeed=e-1);return e}if(--d<c||e===-2)return 0;e=f(b[d]);if(e>=0){e>0&&(a.lastNeed=e-2);return e}if(--d<c||e===-2)return 0;e=f(b[d]);if(e>=0){e>0&&(e===2?e=0:a.lastNeed=e-3);return e}return 0}function i(a,b,c){if((b[0]&192)!==128){a.lastNeed=0;return"\ufffd"}if(a.lastNeed>1&&b.length>1){if((b[1]&192)!==128){a.lastNeed=1;return"\ufffd"}if(a.lastNeed>2&&b.length>2&&(b[2]&192)!==128){a.lastNeed=2;return"\ufffd"}}}function j(a){var b=this.lastTotal-this.lastNeed,c=i(this,a,b);if(c!==void 0)return c;if(this.lastNeed<=a.length){a.copy(this.lastChar,b,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}a.copy(this.lastChar,b,0,a.length);this.lastNeed-=a.length}function k(a,b){var c=h(this,a,b);if(!this.lastNeed)return a.toString("utf8",b);this.lastTotal=c;c=a.length-(c-this.lastNeed);a.copy(this.lastChar,0,c);return a.toString("utf8",b,c)}function l(a){a=a&&a.length?this.write(a):"";return this.lastNeed?a+"\ufffd":a}function m(a,b){if((a.length-b)%2===0){var c=a.toString("utf16le",b);if(c){var d=c.charCodeAt(c.length-1);if(d>=55296&&d<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=a[a.length-2];this.lastChar[1]=a[a.length-1];return c.slice(0,-1)}}return c}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=a[a.length-1];return a.toString("utf16le",b,a.length-1)}function n(a){a=a&&a.length?this.write(a):"";if(this.lastNeed){var b=this.lastTotal-this.lastNeed;return a+this.lastChar.toString("utf16le",0,b)}return a}function o(a,b){var c=(a.length-b)%3;if(c===0)return a.toString("base64",b);this.lastNeed=3-c;this.lastTotal=3;c===1?this.lastChar[0]=a[a.length-1]:(this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1]);return a.toString("base64",b,a.length-c)}function p(a){a=a&&a.length?this.write(a):"";return this.lastNeed?a+this.lastChar.toString("base64",0,3-this.lastNeed):a}function q(a){return a.toString(this.encoding)}function r(a){return a&&a.length?this.write(a):""}}var J=!1;function K(){J||(J=!0,I());return H.exports}b={};var L={exports:b};function M(){var b=h();L.exports=A;var c=l(),d;A.ReadableState=z;var e=function(a,b){return a.listeners(b).length},f=p(),k=g().Buffer,m=a.Uint8Array||function(){};function n(a){return k.from(a)}function o(a){return k.isBuffer(a)||a instanceof m}var q=i();q.inherits=j();var r={},s=void 0;r&&r.debuglog?s=r.debuglog("stream"):s=function(){};var u=t();r=x();var v;q.inherits(A,f);var w=["error","close","destroy","pause","resume"];function y(a,b,d){if(typeof a.prependListener==="function")return a.prependListener(b,d);!a._events||!a._events[b]?a.on(b,d):c(a._events[b])?a._events[b].unshift(d):a._events[b]=[d,a._events[b]]}function z(a,b){d=d||F();a=a||{};b=b instanceof d;this.objectMode=!!a.objectMode;b&&(this.objectMode=this.objectMode||!!a.readableObjectMode);var c=a.highWaterMark,e=a.readableHighWaterMark,f=this.objectMode?16:16*1024;c||c===0?this.highWaterMark=c:b&&(e||e===0)?this.highWaterMark=e:this.highWaterMark=f;this.highWaterMark=Math.floor(this.highWaterMark);this.buffer=new u();this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=!1;this.endEmitted=!1;this.reading=!1;this.sync=!0;this.needReadable=!1;this.emittedReadable=!1;this.readableListening=!1;this.resumeScheduled=!1;this.destroyed=!1;this.defaultEncoding=a.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=!1;this.decoder=null;this.encoding=null;a.encoding&&(v||(v=K("/").StringDecoder),this.decoder=new v(a.encoding),this.encoding=a.encoding)}function A(a){d=d||F();if(!(this instanceof A))return new A(a);this._readableState=new z(a,this);this.readable=!0;a&&(typeof a.read==="function"&&(this._read=a.read),typeof a.destroy==="function"&&(this._destroy=a.destroy));f.call(this)}Object.defineProperty(A.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(a){if(!this._readableState)return;this._readableState.destroyed=a}});A.prototype.destroy=r.destroy;A.prototype._undestroy=r.undestroy;A.prototype._destroy=function(a,b){this.push(null),b(a)};A.prototype.push=function(a,b){var c=this._readableState,d;!c.objectMode?typeof a==="string"&&(b=b||c.defaultEncoding,b!==c.encoding&&(a=k.from(a,b),b=""),d=!0):d=!0;return B(this,a,b,!1,d)};A.prototype.unshift=function(a){return B(this,a,null,!0,!1)};function B(a,b,c,d,e){var f=a._readableState;if(b===null)f.reading=!1,J(a,f);else{var g;e||(g=D(f,b));g?a.emit("error",g):f.objectMode||b&&b.length>0?(typeof b!=="string"&&!f.objectMode&&Object.getPrototypeOf(b)!==k.prototype&&(b=n(b)),d?f.endEmitted?a.emit("error",new Error("stream.unshift() after end event")):C(a,f,b,!0):f.ended?a.emit("error",new Error("stream.push() after EOF")):(f.reading=!1,f.decoder&&!c?(b=f.decoder.write(b),f.objectMode||b.length!==0?C(a,f,b,!1):O(a,f)):C(a,f,b,!1))):d||(f.reading=!1)}return E(f)}function C(a,b,c,d){b.flowing&&b.length===0&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,d?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&M(a)),O(a,b)}function D(a,b){var c;!o(b)&&typeof b!=="string"&&b!==void 0&&!a.objectMode&&(c=new TypeError("Invalid non-string/buffer chunk"));return c}function E(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||a.length===0)}A.prototype.isPaused=function(){return this._readableState.flowing===!1};A.prototype.setEncoding=function(a){v||(v=K("/").StringDecoder);this._readableState.decoder=new v(a);this._readableState.encoding=a;return this};var G=8388608;function H(a){a>=G?a=G:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++);return a}function I(a,b){if(a<=0||b.length===0&&b.ended)return 0;if(b.objectMode)return 1;if(a!==a)if(b.flowing&&b.length)return b.buffer.head.data.length;else return b.length;a>b.highWaterMark&&(b.highWaterMark=H(a));if(a<=b.length)return a;if(!b.ended){b.needReadable=!0;return 0}return b.length}A.prototype.read=function(a){s("read",a);a=parseInt(a,10);var b=this._readableState,c=a;a!==0&&(b.emittedReadable=!1);if(a===0&&b.needReadable&&(b.length>=b.highWaterMark||b.ended)){s("read: emitReadable",b.length,b.ended);b.length===0&&b.ended?Z(this):M(this);return null}a=I(a,b);if(a===0&&b.ended){b.length===0&&Z(this);return null}var d=b.needReadable;s("need readable",d);(b.length===0||b.length-a<b.highWaterMark)&&(d=!0,s("length less than watermark",d));b.ended||b.reading?(d=!1,s("reading or ended",d)):d&&(s("do read"),b.reading=!0,b.sync=!0,b.length===0&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(a=I(c,b)));a>0?d=V(a,b):d=null;d===null?(b.needReadable=!0,a=0):b.length-=a;b.length===0&&(b.ended||(b.needReadable=!0),c!==a&&b.ended&&Z(this));d!==null&&this.emit("data",d);return d};function J(a,b){if(b.ended)return;if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0;M(a)}function M(a){var c=a._readableState;c.needReadable=!1;c.emittedReadable||(s("emitReadable",c.flowing),c.emittedReadable=!0,c.sync?b.nextTick(N,a):N(a))}function N(a){s("emit readable"),a.emit("readable"),U(a)}function O(a,c){c.readingMore||(c.readingMore=!0,b.nextTick(P,a,c))}function P(a,b){var c=b.length;while(!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark){s("maybeReadMore read 0");a.read(0);if(c===b.length)break;else c=b.length}b.readingMore=!1}A.prototype._read=function(a){this.emit("error",new Error("_read() is not implemented"))};A.prototype.pipe=function(a,c){var d=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=a;break;case 1:f.pipes=[f.pipes,a];break;default:f.pipes.push(a);break}f.pipesCount+=1;s("pipe count=%d opts=%j",f.pipesCount,c);c=(!c||c.end!==!1)&&a!==process.stdout&&a!==process.stderr;c=c?h:q;f.endEmitted?b.nextTick(c):d.once("end",c);a.on("unpipe",g);function g(a,b){s("onunpipe"),a===d&&(b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,k()))}function h(){s("onend"),a.end()}var i=Q(d);a.on("drain",i);var j=!1;function k(){s("cleanup"),a.removeListener("close",o),a.removeListener("finish",p),a.removeListener("drain",i),a.removeListener("error",n),a.removeListener("unpipe",g),d.removeListener("end",h),d.removeListener("end",q),d.removeListener("data",m),j=!0,f.awaitDrain&&(!a._writableState||a._writableState.needDrain)&&i()}var l=!1;d.on("data",m);function m(b){s("ondata");l=!1;b=a.write(b);!1===b&&!l&&((f.pipesCount===1&&f.pipes===a||f.pipesCount>1&&aa(f.pipes,a)!==-1)&&!j&&(s("false write response, pause",d._readableState.awaitDrain),d._readableState.awaitDrain++,l=!0),d.pause())}function n(b){s("onerror",b),q(),a.removeListener("error",n),e(a,"error")===0&&a.emit("error",b)}y(a,"error",n);function o(){a.removeListener("finish",p),q()}a.once("close",o);function p(){s("onfinish"),a.removeListener("close",o),q()}a.once("finish",p);function q(){s("unpipe"),d.unpipe(a)}a.emit("pipe",d);f.flowing||(s("pipe resume"),d.resume());return a};function Q(a){return function(){var b=a._readableState;s("pipeOnDrain",b.awaitDrain);b.awaitDrain&&b.awaitDrain--;b.awaitDrain===0&&e(a,"data")&&(b.flowing=!0,U(a))}}A.prototype.unpipe=function(a){var b=this._readableState,c={hasUnpiped:!1};if(b.pipesCount===0)return this;if(b.pipesCount===1){if(a&&a!==b.pipes)return this;a||(a=b.pipes);b.pipes=null;b.pipesCount=0;b.flowing=!1;a&&a.emit("unpipe",this,c);return this}if(!a){var d=b.pipes,e=b.pipesCount;b.pipes=null;b.pipesCount=0;b.flowing=!1;for(var f=0;f<e;f++)d[f].emit("unpipe",this,c);return this}d=aa(b.pipes,a);if(d===-1)return this;b.pipes.splice(d,1);b.pipesCount-=1;b.pipesCount===1&&(b.pipes=b.pipes[0]);a.emit("unpipe",this,c);return this};A.prototype.on=function(a,c){c=f.prototype.on.call(this,a,c);if(a==="data")this._readableState.flowing!==!1&&this.resume();else if(a==="readable"){a=this._readableState;!a.endEmitted&&!a.readableListening&&(a.readableListening=a.needReadable=!0,a.emittedReadable=!1,!a.reading?b.nextTick(R,this):a.length&&M(this))}return c};A.prototype.addListener=A.prototype.on;function R(a){s("readable nexttick read 0"),a.read(0)}A.prototype.resume=function(){var a=this._readableState;a.flowing||(s("resume"),a.flowing=!0,S(this,a));return this};function S(a,c){c.resumeScheduled||(c.resumeScheduled=!0,b.nextTick(T,a,c))}function T(a,b){b.reading||(s("resume read 0"),a.read(0)),b.resumeScheduled=!1,b.awaitDrain=0,a.emit("resume"),U(a),b.flowing&&!b.reading&&a.read(0)}A.prototype.pause=function(){s("call pause flowing=%j",this._readableState.flowing);!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause"));return this};function U(a){var b=a._readableState;s("flow",b.flowing);while(b.flowing&&a.read()!==null);}A.prototype.wrap=function(a){var b=this,c=this._readableState,d=!1;a.on("end",function(){s("wrapped end");if(c.decoder&&!c.ended){var a=c.decoder.end();a&&a.length&&b.push(a)}b.push(null)});a.on("data",function(e){s("wrapped data");c.decoder&&(e=c.decoder.write(e));if(c.objectMode&&(e===null||e===void 0))return;else if(!c.objectMode&&(!e||!e.length))return;e=b.push(e);e||(d=!0,a.pause())});for(var e in a)this[e]===void 0&&typeof a[e]==="function"&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));for(e=0;e<w.length;e++)a.on(w[e],this.emit.bind(this,w[e]));this._read=function(b){s("wrapped _read",b),d&&(d=!1,a.resume())};return this};Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});A._fromList=V;function V(a,b){if(b.length===0)return null;var c;b.objectMode?c=b.buffer.shift():!a||a>=b.length?(b.decoder?c=b.buffer.join(""):b.buffer.length===1?c=b.buffer.head.data:c=b.buffer.concat(b.length),b.buffer.clear()):c=W(a,b.buffer,b.decoder);return c}function W(a,b,c){var d;a<b.head.data.length?(d=b.head.data.slice(0,a),b.head.data=b.head.data.slice(a)):a===b.head.data.length?d=b.shift():d=c?X(a,b):Y(a,b);return d}function X(a,b){var c=b.head,d=1,e=c.data;a-=e.length;while(c=c.next){var f=c.data,g=a>f.length?f.length:a;g===f.length?e+=f:e+=f.slice(0,a);a-=g;if(a===0){g===f.length?(++d,c.next?b.head=c.next:b.head=b.tail=null):(b.head=c,c.data=f.slice(g));break}++d}b.length-=d;return e}function Y(a,b){var c=k.allocUnsafe(a),d=b.head,e=1;d.data.copy(c);a-=d.data.length;while(d=d.next){var f=d.data,g=a>f.length?f.length:a;f.copy(c,c.length-a,0,g);a-=g;if(a===0){g===f.length?(++e,d.next?b.head=d.next:b.head=b.tail=null):(b.head=d,d.data=f.slice(g));break}++e}b.length-=e;return c}function Z(a){var c=a._readableState;if(c.length>0)throw new Error('"endReadable()" called on non-empty stream');c.endEmitted||(c.ended=!0,b.nextTick($,c,a))}function $(a,b){!a.endEmitted&&a.length===0&&(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function aa(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}}var N=!1;function O(){N||(N=!0,M());return L.exports}c={};var P={exports:c};function Q(){P.exports=d;var a=F(),b=i();b.inherits=j();b.inherits(d,a);function c(a,b){var c=this._transformState;c.transforming=!1;var d=c.writecb;if(!d)return this.emit("error",new Error("write callback called multiple times"));c.writechunk=null;c.writecb=null;b!=null&&this.push(b);d(a);c=this._readableState;c.reading=!1;(c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}function d(b){if(!(this instanceof d))return new d(b);a.call(this,b);this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=!0;this._readableState.sync=!1;b&&(typeof b.transform==="function"&&(this._transform=b.transform),typeof b.flush==="function"&&(this._flush=b.flush));this.on("prefinish",e)}function e(){var a=this;typeof this._flush==="function"?this._flush(function(b,c){f(a,b,c)}):f(this,null,null)}d.prototype.push=function(b,c){this._transformState.needTransform=!1;return a.prototype.push.call(this,b,c)};d.prototype._transform=function(a,b,c){throw new Error("_transform() is not implemented")};d.prototype._write=function(a,b,c){var d=this._transformState;d.writecb=c;d.writechunk=a;d.writeencoding=b;if(!d.transforming){c=this._readableState;(d.needTransform||c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}};d.prototype._read=function(a){a=this._transformState;a.writechunk!==null&&a.writecb&&!a.transforming?(a.transforming=!0,this._transform(a.writechunk,a.writeencoding,a.afterTransform)):a.needTransform=!0};d.prototype._destroy=function(b,c){var d=this;a.prototype._destroy.call(this,b,function(a){c(a),d.emit("close")})};function f(a,b,c){if(b)return a.emit("error",b);c!=null&&a.push(c);if(a._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(a._transformState.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}}var R=!1;function S(){R||(R=!0,Q());return P.exports}b={};var T={exports:b};function U(){T.exports=c;var a=S(),b=i();b.inherits=j();b.inherits(c,a);function c(b){if(!(this instanceof c))return new c(b);a.call(this,b)}c.prototype._transform=function(a,b,c){c(null,a)}}var V=!1;function W(){V||(V=!0,U());return T.exports}d={};var X={exports:d};function Y(){var a={};process.env.READABLE_STREAM==="disable"&&a?(X.exports=a,d=X.exports=a.Readable,d.Readable=a.Readable,d.Writable=a.Writable,d.Duplex=a.Duplex,d.Transform=a.Transform,d.PassThrough=a.PassThrough,d.Stream=a):(d=X.exports=O(),d.Stream=a||d,d.Readable=d,d.Writable=B(),d.Duplex=F(),d.Transform=S(),d.PassThrough=W())}var Z=!1;function $(){Z||(Z=!0,Y());return X.exports}function f(a){switch(a){case void 0:return $()}}e.exports=f}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("set-immediate-shim-1.0.1",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){g.exports=typeof setImmediate==="function"?setImmediate:function(){var a=[].slice.apply(arguments);a.splice(1,0,0);setTimeout.apply(null,a)}}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/cr2jmG-CdKo/
 */
__d("jszip-3.2.0",["readable-stream-2.3.6","set-immediate-shim-1.0.1","lie-3.3.0","pako-1.0.8"],(function(a,b,c,d,e,f){"use strict";var g=b("readable-stream-2.3.6"),h=b("set-immediate-shim-1.0.1"),i=b("lie-3.3.0"),j=b("pako-1.0.8"),k={},l={exports:k};function m(){k.base64=!0;k.array=!0;k.string=!0;k.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";k.nodebuffer=typeof Buffer!=="undefined";k.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined")k.blob=!1;else{var a=new ArrayBuffer(0);try{k.blob=new Blob([a],{type:"application/zip"}).size===0}catch(c){try{var b=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder;b=new b();b.append(a);k.blob=b.getBlob("application/zip").size===0}catch(a){k.blob=!1}}}try{k.nodestream=!!g().Readable}catch(a){k.nodestream=!1}}var n=!1;function o(){n||(n=!0,m());return l.exports}var p={},q={exports:p};function r(){var a=E(),b=o(),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";p.encode=function(b){var d=[],e,f,g,h,i=0,j=b.length,k=j,l=a.getTypeOf(b)!=="string";while(i<b.length)k=j-i,!l?(e=b.charCodeAt(i++),f=i<j?b.charCodeAt(i++):0,g=i<j?b.charCodeAt(i++):0):(e=b[i++],f=i<j?b[i++]:0,g=i<j?b[i++]:0),h=e>>2,e=(e&3)<<4|f>>4,f=k>1?(f&15)<<2|g>>6:64,g=k>2?g&63:64,d.push(c.charAt(h)+c.charAt(e)+c.charAt(f)+c.charAt(g));return d.join("")};p.decode=function(a){var d,e,f,g,h=0,i=0,j="data:";if(a.substr(0,j.length)===j)throw new Error("Invalid base64 input, it looks like a data url.");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j=a.length*3/4;a.charAt(a.length-1)===c.charAt(64)&&j--;a.charAt(a.length-2)===c.charAt(64)&&j--;if(j%1!==0)throw new Error("Invalid base64 input, bad content length.");var k;b.uint8array?k=new Uint8Array(j|0):k=new Array(j|0);while(h<a.length)j=c.indexOf(a.charAt(h++)),e=c.indexOf(a.charAt(h++)),f=c.indexOf(a.charAt(h++)),g=c.indexOf(a.charAt(h++)),j=j<<2|e>>4,e=(e&15)<<4|f>>2,d=(f&3)<<6|g,k[i++]=j,f!==64&&(k[i++]=e),g!==64&&(k[i++]=d);return k}}var s=!1;function t(){s||(s=!0,r());return q.exports}c={};var u={exports:c};function v(){u.exports={isNode:typeof Buffer!=="undefined",newBufferFrom:function(a,b){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,b);else{if(typeof a==="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,b)}},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);else{a=new Buffer(a);a.fill(0);return a}},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on==="function"&&typeof a.pause==="function"&&typeof a.resume==="function"}}}var w=!1;function x(){w||(w=!0,v());return u.exports}d={};var y={exports:d};function z(){var a;typeof Promise!=="undefined"?a=Promise:a=i();y.exports={Promise:a}}var A=!1;function B(){A||(A=!0,z());return y.exports}var C={},aa={exports:C};function ba(){var a=o(),b=t(),c=x(),d=h(),e=B();function f(b){var c;a.uint8array?c=new Uint8Array(b.length):c=new Array(b.length);return i(b,c)}C.newBlob=function(a,b){C.checkSupport("blob");try{return new Blob([a],{type:b})}catch(d){try{var c=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder;c=new c();c.append(a);return c.getBlob(b)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};function g(a){return a}function i(a,b){for(var c=0;c<a.length;++c)b[c]=a.charCodeAt(c)&255;return b}var j={stringifyByChunk:function(a,b,c){var d=[],e=0,f=a.length;if(f<=c)return String.fromCharCode.apply(null,a);while(e<f)b==="array"||b==="nodebuffer"?d.push(String.fromCharCode.apply(null,a.slice(e,Math.min(e+c,f)))):d.push(String.fromCharCode.apply(null,a.subarray(e,Math.min(e+c,f)))),e+=c;return d.join("")},stringifyByChar:function(a){var b="";for(var c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(a){return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch(a){return!1}}()}};function k(a){var b=65536,c=C.getTypeOf(a),d=!0;c==="uint8array"?d=j.applyCanBeUsed.uint8array:c==="nodebuffer"&&(d=j.applyCanBeUsed.nodebuffer);if(d)while(b>1)try{return j.stringifyByChunk(a,c,b)}catch(a){b=Math.floor(b/2)}return j.stringifyByChar(a)}C.applyFromCharCode=k;function l(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b}var m={};m.string={string:g,array:function(a){return i(a,new Array(a.length))},arraybuffer:function(a){return m.string.uint8array(a).buffer},uint8array:function(a){return i(a,new Uint8Array(a.length))},nodebuffer:function(a){return i(a,c.allocBuffer(a.length))}};m.array={string:k,array:g,arraybuffer:function(a){return new Uint8Array(a).buffer},uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return c.newBufferFrom(a)}};m.arraybuffer={string:function(a){return k(new Uint8Array(a))},array:function(a){return l(new Uint8Array(a),new Array(a.byteLength))},arraybuffer:g,uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return c.newBufferFrom(new Uint8Array(a))}};m.uint8array={string:k,array:function(a){return l(a,new Array(a.length))},arraybuffer:function(a){return a.buffer},uint8array:g,nodebuffer:function(a){return c.newBufferFrom(a)}};m.nodebuffer={string:k,array:function(a){return l(a,new Array(a.length))},arraybuffer:function(a){return m.nodebuffer.uint8array(a).buffer},uint8array:function(a){return l(a,new Uint8Array(a.length))},nodebuffer:g};C.transformTo=function(a,b){b||(b="");if(!a)return b;C.checkSupport(a);var c=C.getTypeOf(b);c=m[c][a](b);return c};C.getTypeOf=function(b){if(typeof b==="string")return"string";if(Object.prototype.toString.call(b)==="[object Array]")return"array";if(a.nodebuffer&&c.isBuffer(b))return"nodebuffer";if(a.uint8array&&b instanceof Uint8Array)return"uint8array";if(a.arraybuffer&&b instanceof ArrayBuffer)return"arraybuffer"};C.checkSupport=function(b){var c=a[b.toLowerCase()];if(!c)throw new Error(b+" is not supported by this platform")};C.MAX_VALUE_16BITS=65535;C.MAX_VALUE_32BITS=-1;C.pretty=function(a){var b="",c,d;for(d=0;d<(a||"").length;d++)c=a.charCodeAt(d),b+="\\x"+(c<16?"0":"")+c.toString(16).toUpperCase();return b};C.delay=function(a,b,c){d(function(){a.apply(c||null,b||[])})};C.inherits=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c()};C.extend=function(){var a={},b,c;for(b=0;b<arguments.length;b++)for(c in arguments[b])arguments[b].hasOwnProperty(c)&&typeof a[c]==="undefined"&&(a[c]=arguments[b][c]);return a};C.prepareContent=function(c,d,g,h,i){d=e.Promise.resolve(d).then(function(b){var c=a.blob&&(b instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(b))!==-1);if(c&&typeof FileReader!=="undefined")return new e.Promise(function(a,c){var d=new FileReader();d.onload=function(b){a(b.target.result)};d.onerror=function(a){c(a.target.error)};d.readAsArrayBuffer(b)});else return b});return d.then(function(a){var d=C.getTypeOf(a);if(!d)return e.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"));d==="arraybuffer"?a=C.transformTo("uint8array",a):d==="string"&&(i?a=b.decode(a):g&&(h!==!0&&(a=f(a))));return a})}}var D=!1;function E(){D||(D=!0,ba());return aa.exports}f={};var F={exports:f};function ca(){function a(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){if(this.isFinished)return!1;this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp());return!0},on:function(a,b){this._listeners[a].push(b);return this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,b){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,b)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo;this.mergeStreamInfo();this.previous=a;var b=this;a.on("data",function(a){b.processChunk(a)});a.on("end",function(){b.end()});a.on("error",function(a){b.error(a)});return this},pause:function(){if(this.isPaused||this.isFinished)return!1;this.isPaused=!0;this.previous&&this.previous.pause();return!0},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;this.generatedError&&(this.error(this.generatedError),a=!0);this.previous&&this.previous.resume();return!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,b){this.extraStreamInfo[a]=b;this.mergeStreamInfo();return this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo){if(!this.extraStreamInfo.hasOwnProperty(a))continue;this.streamInfo[a]=this.extraStreamInfo[a]}},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0;this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;if(this.previous)return this.previous+" -> "+a;else return a}};F.exports=a}var G=!1;function H(){G||(G=!0,ca());return F.exports}var I={},da={exports:I};function ea(){var a=E(),b=o(),c=x(),d=H(),e=new Array(256);for(var f=0;f<256;f++)e[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;e[254]=e[254]=1;var g=function(c){var d,e,f,g,a,h=c.length,i=0;for(g=0;g<h;g++)e=c.charCodeAt(g),(e&64512)===55296&&g+1<h&&(f=c.charCodeAt(g+1),(f&64512)===56320&&(e=65536+(e-55296<<10)+(f-56320),g++)),i+=e<128?1:e<2048?2:e<65536?3:4;b.uint8array?d=new Uint8Array(i):d=new Array(i);for(a=0,g=0;a<i;g++)e=c.charCodeAt(g),(e&64512)===55296&&g+1<h&&(f=c.charCodeAt(g+1),(f&64512)===56320&&(e=65536+(e-55296<<10)+(f-56320),g++)),e<128?d[a++]=e:e<2048?(d[a++]=192|e>>>6,d[a++]=128|e&63):e<65536?(d[a++]=224|e>>>12,d[a++]=128|e>>>6&63,d[a++]=128|e&63):(d[a++]=240|e>>>18,d[a++]=128|e>>>12&63,d[a++]=128|e>>>6&63,d[a++]=128|e&63);return d},h=function(a,b){var c;b=b||a.length;b>a.length&&(b=a.length);c=b-1;while(c>=0&&(a[c]&192)===128)c--;if(c<0)return b;return c===0?b:c+e[a[c]]>b?c:b},i=function(c){var b,d,f,g,h=c.length,i=new Array(h*2);for(d=0,b=0;b<h;){f=c[b++];if(f<128){i[d++]=f;continue}g=e[f];if(g>4){i[d++]=65533;b+=g-1;continue}f&=g===2?31:g===3?15:7;while(g>1&&b<h)f=f<<6|c[b++]&63,g--;if(g>1){i[d++]=65533;continue}f<65536?i[d++]=f:(f-=65536,i[d++]=55296|f>>10&1023,i[d++]=56320|f&1023)}i.length!==d&&(i.subarray?i=i.subarray(0,d):i.length=d);return a.applyFromCharCode(i)};I.utf8encode=function(a){return b.nodebuffer?c.newBufferFrom(a,"utf-8"):g(a)};I.utf8decode=function(c){if(b.nodebuffer)return a.transformTo("nodebuffer",c).toString("utf-8");c=a.transformTo(b.uint8array?"uint8array":"array",c);return i(c)};function j(){d.call(this,"utf-8 decode"),this.leftOver=null}a.inherits(j,d);j.prototype.processChunk=function(c){var d=a.transformTo(b.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(b.uint8array){var e=d;d=new Uint8Array(e.length+this.leftOver.length);d.set(this.leftOver,0);d.set(e,this.leftOver.length)}else d=this.leftOver.concat(d);this.leftOver=null}e=h(d);var f=d;e!==d.length&&(b.uint8array?(f=d.subarray(0,e),this.leftOver=d.subarray(e,d.length)):(f=d.slice(0,e),this.leftOver=d.slice(e,d.length)));this.push({data:I.utf8decode(f),meta:c.meta})};j.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:I.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};I.Utf8DecodeWorker=j;function k(){d.call(this,"utf-8 encode")}a.inherits(k,d);k.prototype.processChunk=function(a){this.push({data:I.utf8encode(a.data),meta:a.meta})};I.Utf8EncodeWorker=k}var J=!1;function K(){J||(J=!0,ea());return da.exports}b={};var L={exports:b};function fa(){var a=H(),b=E();function c(b){a.call(this,"ConvertWorker to "+b),this.destType=b}b.inherits(c,a);c.prototype.processChunk=function(a){this.push({data:b.transformTo(this.destType,a.data),meta:a.meta})};L.exports=c}var M=!1;function ga(){M||(M=!0,fa());return L.exports}c={};var N={exports:c};function ha(){var a=g().Readable,b=E();b.inherits(c,a);function c(b,c,d){a.call(this,c);this._helper=b;var e=this;b.on("data",function(a,b){e.push(a)||e._helper.pause(),d&&d(b)}).on("error",function(a){e.emit("error",a)}).on("end",function(){e.push(null)})}c.prototype._read=function(){this._helper.resume()};N.exports=c}var O=!1;function ia(){O||(O=!0,ha());return N.exports}d={};var P={exports:d};function ja(){var a=E(),b=ga(),c=H(),d=t(),e=o(),f=B(),g=null;if(e.nodestream)try{g=ia()}catch(a){}function h(b,c,e){switch(b){case"blob":return a.newBlob(a.transformTo("arraybuffer",c),e);case"base64":return d.encode(c);default:return a.transformTo(b,c)}}function i(a,b){var c,d=0,e=null,f=0;for(c=0;c<b.length;c++)f+=b[c].length;switch(a){case"string":return b.join("");case"array":return Array.prototype.concat.apply([],b);case"uint8array":e=new Uint8Array(f);for(c=0;c<b.length;c++)e.set(b[c],d),d+=b[c].length;return e;case"nodebuffer":return Buffer.concat(b);default:throw new Error("concat : unsupported type '"+a+"'")}}function j(a,b){return new f.Promise(function(c,d){var e=[],f=a._internalType,g=a._outputType,j=a._mimeType;a.on("data",function(a,c){e.push(a),b&&b(c)}).on("error",function(a){e=[],d(a)}).on("end",function(){try{var a=h(g,i(f,e),j);c(a)}catch(a){d(a)}e=[]}).resume()})}function k(d,e,f){var g=e;switch(e){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string";break}try{this._internalType=g,this._outputType=e,this._mimeType=f,a.checkSupport(g),this._worker=d.pipe(new b(g)),d.lock()}catch(a){this._worker=new c("error"),this._worker.error(a)}}k.prototype={accumulate:function(a){return j(this,a)},on:function(b,c){var d=this;b==="data"?this._worker.on(b,function(a){c.call(d,a.data,a.meta)}):this._worker.on(b,function(){a.delay(c,arguments,d)});return this},resume:function(){a.delay(this._worker.resume,[],this._worker);return this},pause:function(){this._worker.pause();return this},toNodejsStream:function(b){a.checkSupport("nodestream");if(this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},b)}};P.exports=k}var Q=!1;function R(){Q||(Q=!0,ja());return P.exports}var S={},ka={exports:S};function la(){S.base64=!1,S.binary=!1,S.dir=!1,S.createFolders=!0,S.date=null,S.compression=null,S.compressionOptions=null,S.comment=null,S.unixPermissions=null,S.dosPermissions=null}var T=!1;function U(){T||(T=!0,la());return ka.exports}f={};var V={exports:f};function ma(){var a=E(),b=H(),c=16*1024;function d(c){b.call(this,"DataWorker");var d=this;this.dataIsReady=!1;this.index=0;this.max=0;this.data=null;this.type="";this._tickScheduled=!1;c.then(function(b){d.dataIsReady=!0,d.data=b,d.max=b&&b.length||0,d.type=a.getTypeOf(b),d.isPaused||d._tickAndRepeat()},function(a){d.error(a)})}a.inherits(d,b);d.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this.data=null};d.prototype.resume=function(){if(!b.prototype.resume.call(this))return!1;!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this));return!0};d.prototype._tickAndRepeat=function(){this._tickScheduled=!1;if(this.isPaused||this.isFinished)return;this._tick();this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0)};d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=c,b=null;a=Math.min(this.max,this.index+a);if(this.index>=this.max)return this.end();else{switch(this.type){case"string":b=this.data.substring(this.index,a);break;case"uint8array":b=this.data.subarray(this.index,a);break;case"array":case"nodebuffer":b=this.data.slice(this.index,a);break}this.index=a;return this.push({data:b,meta:{percent:this.max?this.index/this.max*100:0}})}};V.exports=d}var na=!1;function oa(){na||(na=!0,ma());return V.exports}b={};var pa={exports:b};function qa(){var a=E(),b=H();function c(a){b.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}a.inherits(c,b);c.prototype.processChunk=function(a){if(a){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+a.data.length}b.prototype.processChunk.call(this,a)};pa.exports=c}var ra=!1;function sa(){ra||(ra=!0,qa());return pa.exports}c={};var ta={exports:c};function ua(){var a=E();function b(){var a,b=[];for(var c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b}var c=b();function d(a,b,d,e){var f=c;d=e+d;a=a^-1;for(e=e;e<d;e++)a=a>>>8^f[(a^b[e])&255];return a^-1}function e(a,b,d,e){var f=c;d=e+d;a=a^-1;for(e=e;e<d;e++)a=a>>>8^f[(a^b.charCodeAt(e))&255];return a^-1}ta.exports=function(b,c){if(typeof b==="undefined"||!b.length)return 0;var f=a.getTypeOf(b)!=="string";if(f)return d(c|0,b,b.length,0);else return e(c|0,b,b.length,0)}}var va=!1;function W(){va||(va=!0,ua());return ta.exports}d={};var wa={exports:d};function xa(){var a=H(),b=W(),c=E();function d(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}c.inherits(d,a);d.prototype.processChunk=function(a){this.streamInfo.crc32=b(a.data,this.streamInfo.crc32||0),this.push(a)};wa.exports=d}var ya=!1;function za(){ya||(ya=!0,xa());return wa.exports}f={};var Aa={exports:f};function Ba(){var a=B(),b=oa(),c=sa(),d=za(),c=sa();function e(a,b,c,d,e){this.compressedSize=a,this.uncompressedSize=b,this.crc32=c,this.compression=d,this.compressedContent=e}e.prototype={getContentWorker:function(){var d=new b(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),e=this;d.on("end",function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")});return d},getCompressedWorker:function(){return new b(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};e.createWorkerFrom=function(a,b,e){return a.pipe(new d()).pipe(new c("uncompressedSize")).pipe(b.compressWorker(e)).pipe(new c("compressedSize")).withStreamInfo("compression",b)};Aa.exports=e}var Ca=!1;function X(){Ca||(Ca=!0,Ba());return Aa.exports}b={};var Da={exports:b};function Ea(){var a=R(),b=oa(),c=K(),d=X(),e=H(),f=function(a,b,c){this.name=a,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=b,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}};f.prototype={internalStream:function(b){var d=null,f="string";try{if(!b)throw new Error("No output type specified.");f=b.toLowerCase();b=f==="string"||f==="text";(f==="binarystring"||f==="text")&&(f="string");d=this._decompressWorker();var g=!this._dataBinary;g&&!b&&(d=d.pipe(new c.Utf8EncodeWorker()));!g&&b&&(d=d.pipe(new c.Utf8DecodeWorker()))}catch(a){d=new e("error"),d.error(a)}return new a(d,f,"")},async:function(a,b){return this.internalStream(a).accumulate(b)},nodeStream:function(a,b){return this.internalStream(a||"nodebuffer").toNodejsStream(b)},_compressWorker:function(a,b){if(this._data instanceof d&&this._data.compression.magic===a.magic)return this._data.getCompressedWorker();else{var e=this._decompressWorker();this._dataBinary||(e=e.pipe(new c.Utf8EncodeWorker()));return d.createWorkerFrom(e,a,b)}},_decompressWorker:function(){if(this._data instanceof d)return this._data.getContentWorker();else if(this._data instanceof e)return this._data;else return new b(this._data)}};var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(var i=0;i<g.length;i++)f.prototype[g[i]]=h;Da.exports=f}var Fa=!1;function Ga(){Fa||(Fa=!0,Ea());return Da.exports}var Y={},Ha={exports:Y};function Ia(){var a=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined",b=j(),c=E(),d=H(),e=a?"uint8array":"array";Y.magic="\b\0";function f(a,b){d.call(this,"FlateWorker/"+a),this._pako=null,this._pakoAction=a,this._pakoOptions=b,this.meta={}}c.inherits(f,d);f.prototype.processChunk=function(a){this.meta=a.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(e,a.data),!1)};f.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)};f.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null};f.prototype._createPako=function(){this._pako=new b[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var a=this;this._pako.onData=function(b){a.push({data:b,meta:a.meta})}};Y.compressWorker=function(a){return new f("Deflate",a)};Y.uncompressWorker=function(){return new f("Inflate",{})}}var Ja=!1;function Ka(){Ja||(Ja=!0,Ia());return Ha.exports}var Z={},La={exports:Z};function Ma(){var a=H();Z.STORE={magic:"\0\0",compressWorker:function(b){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}};Z.DEFLATE=Ka()}var Na=!1;function Oa(){Na||(Na=!0,Ma());return La.exports}var $={},Pa={exports:$};function Qa(){$.LOCAL_FILE_HEADER="PK\x03\x04",$.CENTRAL_FILE_HEADER="PK\x01\x02",$.CENTRAL_DIRECTORY_END="PK\x05\x06",$.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",$.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",$.DATA_DESCRIPTOR="PK\x07\b"}var Ra=!1;function Sa(){Ra||(Ra=!0,Qa());return Pa.exports}c={};var Ta={exports:c};function Ua(){var a=E(),b=H(),c=K(),d=W(),e=Sa(),f=function(a,b){var c="",d;for(d=0;d<b;d++)c+=String.fromCharCode(a&255),a=a>>>8;return c},g=function(a,b){var c=a;a||(c=b?16893:33204);return(c&65535)<<16},h=function(a,b){return(a||0)&63},i=function(b,i,j,k,l,m){var n=b.file,o=b.compression,p=m!==c.utf8encode,q=a.transformTo("string",m(n.name)),r=a.transformTo("string",c.utf8encode(n.name)),s=n.comment;m=a.transformTo("string",m(s));var t=a.transformTo("string",c.utf8encode(s)),u=r.length!==n.name.length;s=t.length!==s.length;var v="",w="",x="",y=n.dir,z=n.date,A={crc32:0,compressedSize:0,uncompressedSize:0};(!i||j)&&(A.crc32=b.crc32,A.compressedSize=b.compressedSize,A.uncompressedSize=b.uncompressedSize);j=0;i&&(j|=8);!p&&(u||s)&&(j|=2048);b=0;i=0;y&&(b|=16);l==="UNIX"?(i=798,b|=g(n.unixPermissions,y)):(i=20,b|=h(n.dosPermissions));p=z.getUTCHours();p=p<<6;p=p|z.getUTCMinutes();p=p<<5;p=p|z.getUTCSeconds()/2;l=z.getUTCFullYear()-1980;l=l<<4;l=l|z.getUTCMonth()+1;l=l<<5;l=l|z.getUTCDate();u&&(w=f(1,1)+f(d(q),4)+r,v+="up"+f(w.length,2)+w);s&&(x=f(1,1)+f(d(m),4)+t,v+="uc"+f(x.length,2)+x);y="";y+="\n\0";y+=f(j,2);y+=o.magic;y+=f(p,2);y+=f(l,2);y+=f(A.crc32,4);y+=f(A.compressedSize,4);y+=f(A.uncompressedSize,4);y+=f(q.length,2);y+=f(v.length,2);n=e.LOCAL_FILE_HEADER+y+q+v;z=e.CENTRAL_FILE_HEADER+f(i,2)+y+f(m.length,2)+"\0\0\0\0"+f(b,4)+f(k,4)+q+v+m;return{fileRecord:n,dirRecord:z}},j=function(b,c,d,g,h){h=a.transformTo("string",h(g));g=e.CENTRAL_DIRECTORY_END+"\0\0\0\0"+f(b,2)+f(b,2)+f(c,4)+f(d,4)+f(h.length,2)+h;return g},k=function(a){a=e.DATA_DESCRIPTOR+f(a.crc32,4)+f(a.compressedSize,4)+f(a.uncompressedSize,4);return a};function l(a,c,d,e){b.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=c,this.zipPlatform=d,this.encodeFileName=e,this.streamFiles=a,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(l,b);l.prototype.push=function(a){var c=a.meta.percent||0,d=this.entriesCount,e=this._sources.length;this.accumulate?this.contentBuffer.push(a):(this.bytesWritten+=a.data.length,b.prototype.push.call(this,{data:a.data,meta:{currentFile:this.currentFile,percent:d?(c+100*(d-e-1))/d:100}}))};l.prototype.openedSource=function(a){this.currentSourceOffset=this.bytesWritten;this.currentFile=a.file.name;var b=this.streamFiles&&!a.file.dir;if(b){a=i(a,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:a.fileRecord,meta:{percent:0}})}else this.accumulate=!0};l.prototype.closedSource=function(a){this.accumulate=!1;var b=this.streamFiles&&!a.file.dir,c=i(a,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.dirRecords.push(c.dirRecord);if(b)this.push({data:k(a),meta:{percent:100}});else{this.push({data:c.fileRecord,meta:{percent:0}});while(this.contentBuffer.length)this.push(this.contentBuffer.shift())}this.currentFile=null};l.prototype.flush=function(){var a=this.bytesWritten;for(var b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});b=this.bytesWritten-a;b=j(this.dirRecords.length,b,a,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})};l.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()};l.prototype.registerPrevious=function(a){this._sources.push(a);var b=this;a.on("data",function(a){b.processChunk(a)});a.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()});a.on("error",function(a){b.error(a)});return this};l.prototype.resume=function(){if(!b.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length){this.prepareNextSource();return!0}if(!this.previous&&!this._sources.length&&!this.generatedError){this.end();return!0}};l.prototype.error=function(a){var c=this._sources;if(!b.prototype.error.call(this,a))return!1;for(var d=0;d<c.length;d++)try{c[d].error(a)}catch(a){}return!0};l.prototype.lock=function(){b.prototype.lock.call(this);var a=this._sources;for(var c=0;c<a.length;c++)a[c].lock()};Ta.exports=l}var Va=!1;function Wa(){Va||(Va=!0,Ua());return Ta.exports}var Xa={},Ya={exports:Xa};function Za(){var a=Oa(),b=Wa(),c=function(b,c){b=b||c;c=a[b];if(!c)throw new Error(b+" is not a valid compression method !");return c};Xa.generateWorker=function(a,d,e){var f=new b(d.streamFiles,e,d.platform,d.encodeFileName),g=0;try{a.forEach(function(a,b){g++;var e=c(b.options.compression,d.compression),h=b.options.compressionOptions||d.compressionOptions||{},i=b.dir,j=b.date;b._compressWorker(e,h).withStreamInfo("file",{name:a,dir:i,date:j,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(f)}),f.entriesCount=g}catch(a){f.error(a)}return f}}var $a=!1;function ab(){$a||($a=!0,Za());return Ya.exports}d={};var bb={exports:d};function cb(){var a=E(),b=H();function c(a,c){b.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(c)}a.inherits(c,b);c.prototype._bindStream=function(a){var b=this;this._stream=a;a.pause();a.on("data",function(a){b.push({data:a,meta:{percent:0}})}).on("error",function(a){b.isPaused?this.generatedError=a:b.error(a)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})};c.prototype.pause=function(){if(!b.prototype.pause.call(this))return!1;this._stream.pause();return!0};c.prototype.resume=function(){if(!b.prototype.resume.call(this))return!1;this._upstreamEnded?this.end():this._stream.resume();return!0};bb.exports=c}var db=!1;function eb(){db||(db=!0,cb());return bb.exports}f={};var fb={exports:f};function gb(){var a=K(),b=E(),c=H(),d=R(),e=U(),f=X(),g=Ga(),h=ab(),i=x(),j=eb(),k=function(a,d,h){var k=b.getTypeOf(d),o,p=b.extend(h||{},e);p.date=p.date||new Date();p.compression!==null&&(p.compression=p.compression.toUpperCase());typeof p.unixPermissions==="string"&&(p.unixPermissions=parseInt(p.unixPermissions,8));p.unixPermissions&&p.unixPermissions&16384&&(p.dir=!0);p.dosPermissions&&p.dosPermissions&16&&(p.dir=!0);p.dir&&(a=m(a));p.createFolders&&(o=l(a))&&n.call(this,o,!0);var q=k==="string"&&p.binary===!1&&p.base64===!1;(!h||typeof h.binary==="undefined")&&(p.binary=!q);h=d instanceof f&&d.uncompressedSize===0;(h||p.dir||!d||d.length===0)&&(p.base64=!1,p.binary=!0,d="",p.compression="STORE",k="string");d instanceof f||d instanceof c?q=d:i.isNode&&i.isStream(d)?q=new j(a,d):q=b.prepareContent(a,d,p.binary,p.optimizedBinaryString,p.base64);h=new g(a,q,p);this.files[a]=h},l=function(a){a.slice(-1)==="/"&&(a=a.substring(0,a.length-1));var b=a.lastIndexOf("/");return b>0?a.substring(0,b):""},m=function(a){a.slice(-1)!=="/"&&(a+="/");return a},n=function(a,b){b=typeof b!=="undefined"?b:e.createFolders;a=m(a);this.files[a]||k.call(this,a,null,{dir:!0,createFolders:b});return this.files[a]};function o(a){return Object.prototype.toString.call(a)==="[object RegExp]"}var p={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(a){var b,c,d;for(b in this.files){if(!this.files.hasOwnProperty(b))continue;d=this.files[b];c=b.slice(this.root.length,b.length);c&&b.slice(0,this.root.length)===this.root&&a(c,d)}},filter:function(a){var b=[];this.forEach(function(c,d){a(c,d)&&b.push(d)});return b},file:function(a,b,c){if(arguments.length===1)if(o(a)){var d=a;return this.filter(function(a,b){return!b.dir&&d.test(a)})}else{var e=this.files[this.root+a];if(e&&!e.dir)return e;else return null}else a=this.root+a,k.call(this,a,b,c);return this},folder:function(a){if(!a)return this;if(o(a))return this.filter(function(b,c){return c.dir&&a.test(b)});var b=this.root+a;b=n.call(this,b);var c=this.clone();c.root=b.name;return c},remove:function(a){a=this.root+a;var b=this.files[a];b||(a.slice(-1)!=="/"&&(a+="/"),b=this.files[a]);if(b&&!b.dir)delete this.files[a];else{b=this.filter(function(c,b){return b.name.slice(0,a.length)===a});for(var c=0;c<b.length;c++)delete this.files[b[c].name]}return this},generate:function(a){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var f,g={};try{g=b.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode});g.type=g.type.toLowerCase();g.compression=g.compression.toUpperCase();g.type==="binarystring"&&(g.type="string");if(!g.type)throw new Error("No output type specified.");b.checkSupport(g.type);(g.platform==="darwin"||g.platform==="freebsd"||g.platform==="linux"||g.platform==="sunos")&&(g.platform="UNIX");g.platform==="win32"&&(g.platform="DOS");e=g.comment||this.comment||"";f=h.generateWorker(this,g,e)}catch(a){f=new c("error"),f.error(a)}return new d(f,g.type||"string",g.mimeType)},generateAsync:function(a,b){return this.generateInternalStream(a).accumulate(b)},generateNodeStream:function(a,b){a=a||{};a.type||(a.type="nodebuffer");return this.generateInternalStream(a).toNodejsStream(b)}};fb.exports=p}var hb=!1;function ib(){hb||(hb=!0,gb());return fb.exports}b={};var jb={exports:b};function kb(){var a=E();function b(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}b.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},readInt:function(a){var b=0,c;this.checkOffset(a);for(c=this.index+a-1;c>=this.index;c--)b=(b<<8)+this.byteAt(c);this.index+=a;return b},readString:function(b){return a.transformTo("string",this.readData(b))},readData:function(a){},lastIndexOfSignature:function(a){},readAndCheckSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1))}};jb.exports=b}var lb=!1;function mb(){lb||(lb=!0,kb());return jb.exports}c={};var nb={exports:c};function ob(){var a=mb(),b=E();function c(b){a.call(this,b);for(var c=0;c<this.data.length;c++)b[c]=b[c]&255}b.inherits(c,a);c.prototype.byteAt=function(a){return this.data[this.zero+a]};c.prototype.lastIndexOfSignature=function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2);a=a.charCodeAt(3);for(var e=this.length-4;e>=0;--e)if(this.data[e]===b&&this.data[e+1]===c&&this.data[e+2]===d&&this.data[e+3]===a)return e-this.zero;return-1};c.prototype.readAndCheckSignature=function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2);a=a.charCodeAt(3);var e=this.readData(4);return b===e[0]&&c===e[1]&&d===e[2]&&a===e[3]};c.prototype.readData=function(a){this.checkOffset(a);if(a===0)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};nb.exports=c}var pb=!1;function qb(){pb||(pb=!0,ob());return nb.exports}d={};var rb={exports:d};function sb(){var a=mb(),b=E();function c(b){a.call(this,b)}b.inherits(c,a);c.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)};c.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero};c.prototype.readAndCheckSignature=function(a){var b=this.readData(4);return a===b};c.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};rb.exports=c}var tb=!1;function ub(){tb||(tb=!0,sb());return rb.exports}f={};var vb={exports:f};function wb(){var a=qb(),b=E();function c(b){a.call(this,b)}b.inherits(c,a);c.prototype.readData=function(a){this.checkOffset(a);if(a===0)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};vb.exports=c}var xb=!1;function yb(){xb||(xb=!0,wb());return vb.exports}b={};var zb={exports:b};function Ab(){var a=yb(),b=E();function c(b){a.call(this,b)}b.inherits(c,a);c.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};zb.exports=c}var Bb=!1;function Cb(){Bb||(Bb=!0,Ab());return zb.exports}c={};var Db={exports:c};function Eb(){var a=E(),b=o(),c=qb(),d=ub(),e=Cb(),f=yb();Db.exports=function(g){var h=a.getTypeOf(g);a.checkSupport(h);if(h==="string"&&!b.uint8array)return new d(g);if(h==="nodebuffer")return new e(g);return b.uint8array?new f(a.transformTo("uint8array",g)):new c(a.transformTo("array",g))}}var Fb=!1;function Gb(){Fb||(Fb=!0,Eb());return Db.exports}d={};var Hb={exports:d};function Ib(){var a=Gb(),b=E(),c=X(),d=W(),e=K(),f=Oa(),g=o(),h=0,i=3,j=function(a){for(var b in f){if(!f.hasOwnProperty(b))continue;if(f[b].magic===a)return f[b]}return null};function k(a,b){this.options=a,this.loadOptions=b}k.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(a){var d;a.skip(22);this.fileNameLength=a.readInt(2);d=a.readInt(2);this.fileName=a.readData(this.fileNameLength);a.skip(d);if(this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");d=j(this.compressionMethod);if(d===null)throw new Error("Corrupted zip : compression "+b.pretty(this.compressionMethod)+" unknown (inner file : "+b.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,d,a.readData(this.compressedSize))},readCentralPart:function(a){this.versionMadeBy=a.readInt(2);a.skip(2);this.bitFlag=a.readInt(2);this.compressionMethod=a.readString(2);this.date=a.readDate();this.crc32=a.readInt(4);this.compressedSize=a.readInt(4);this.uncompressedSize=a.readInt(4);var b=a.readInt(2);this.extraFieldsLength=a.readInt(2);this.fileCommentLength=a.readInt(2);this.diskNumberStart=a.readInt(2);this.internalFileAttributes=a.readInt(2);this.externalFileAttributes=a.readInt(4);this.localHeaderOffset=a.readInt(4);if(this.isEncrypted())throw new Error("Encrypted zip are not supported");a.skip(b);this.readExtraFields(a);this.parseZIP64ExtraField(a);this.fileComment=a.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null;this.dosPermissions=null;var a=this.versionMadeBy>>8;this.dir=this.externalFileAttributes&16?!0:!1;a===h&&(this.dosPermissions=this.externalFileAttributes&63);a===i&&(this.unixPermissions=this.externalFileAttributes>>16&65535);!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(c){if(!this.extraFields[1])return;c=a(this.extraFields[1].value);this.uncompressedSize===b.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8));this.compressedSize===b.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8));this.localHeaderOffset===b.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8));this.diskNumberStart===b.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))},readExtraFields:function(a){var b=a.index+this.extraFieldsLength,c,d,e;this.extraFields||(this.extraFields={});while(a.index<b)c=a.readInt(2),d=a.readInt(2),e=a.readData(d),this.extraFields[c]={id:c,length:d,value:e}},handleUTF8:function(){var a=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=e.utf8decode(this.fileName),this.fileCommentStr=e.utf8decode(this.fileComment);else{var c=this.findExtraFieldUnicodePath();if(c!==null)this.fileNameStr=c;else{c=b.transformTo(a,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}c=this.findExtraFieldUnicodeComment();if(c!==null)this.fileCommentStr=c;else{c=b.transformTo(a,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var c=a(b.value);if(c.readInt(1)!==1)return null;return d(this.fileName)!==c.readInt(4)?null:e.utf8decode(c.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var c=a(b.value);if(c.readInt(1)!==1)return null;return d(this.fileComment)!==c.readInt(4)?null:e.utf8decode(c.readData(b.length-5))}return null}};Hb.exports=k}var Jb=!1;function Kb(){Jb||(Jb=!0,Ib());return Hb.exports}f={};var Lb={exports:f};function Mb(){var a=Gb(),b=E(),c=Sa(),d=Kb();K();var e=o();function f(a){this.files=[],this.loadOptions=a}f.prototype={checkSignature:function(a){if(!this.reader.readAndCheckSignature(a)){this.reader.index-=4;var c=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+b.pretty(c)+", expected "+b.pretty(a)+")")}},isSignature:function(a,b){var c=this.reader.index;this.reader.setIndex(a);a=this.reader.readString(4);a=a===b;this.reader.setIndex(c);return a},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var a=this.reader.readData(this.zipCommentLength),c=e.uint8array?"uint8array":"array";c=b.transformTo(c,a);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.reader.skip(4);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var a=this.zip64EndOfCentralSize-44,b=0,c,d,e;while(b<a)c=this.reader.readInt(2),d=this.reader.readInt(4),e=this.reader.readData(d),this.zip64ExtensibleData[c]={id:c,length:d,value:e}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var a,b;for(a=0;a<this.files.length;a++)b=this.files[a],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var a;this.reader.setIndex(this.centralDirOffset);while(this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER))a=new d({zip64:this.zip64},this.loadOptions),a.readCentralPart(this.reader),this.files.push(a);if(this.centralDirRecords!==this.files.length&&(this.centralDirRecords!==0&&this.files.length===0))throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var a=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(a<0){var d=!this.isSignature(0,c.LOCAL_FILE_HEADER);if(d)throw new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");else throw new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(a);d=a;this.checkSignature(c.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===b.MAX_VALUE_16BITS||this.diskWithCentralDirStart===b.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===b.MAX_VALUE_16BITS||this.centralDirRecords===b.MAX_VALUE_16BITS||this.centralDirSize===b.MAX_VALUE_32BITS||this.centralDirOffset===b.MAX_VALUE_32BITS){this.zip64=!0;a=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(a<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");this.reader.setIndex(a);this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();if(!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)){this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END);if(this.relativeOffsetEndOfZip64CentralDir<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory")}this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}a=this.centralDirOffset+this.centralDirSize;this.zip64&&(a+=20,a+=12+this.zip64EndOfCentralSize);a=d-a;if(a>0)this.isSignature(d,c.CENTRAL_FILE_HEADER)||(this.reader.zero=a);else if(a<0)throw new Error("Corrupted zip: missing "+Math.abs(a)+" bytes.")},prepareReader:function(b){this.reader=a(b)},load:function(a){this.prepareReader(a),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};Lb.exports=f}var Nb=!1;function Ob(){Nb||(Nb=!0,Mb());return Lb.exports}b={};var Pb={exports:b};function Qb(){var a=E(),b=B(),c=K(),a=E(),d=Ob(),e=za(),f=x();function g(a){return new b.Promise(function(b,c){var d=a.decompressed.getContentWorker().pipe(new e());d.on("error",function(a){c(a)}).on("end",function(){d.streamInfo.crc32!==a.decompressed.crc32?c(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}Pb.exports=function(e,h){var i=this;h=a.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode});return f.isNode&&f.isStream(e)?b.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",e,!0,h.optimizedBinaryString,h.base64).then(function(a){var b=new d(h);b.load(a);return b}).then(function(a){var c=[b.Promise.resolve(a)];a=a.files;if(h.checkCRC32)for(var d=0;d<a.length;d++)c.push(g(a[d]));return b.Promise.all(c)}).then(function(a){a=a.shift();var b=a.files;for(var c=0;c<b.length;c++){var d=b[c];i.file(d.fileNameStr,d.decompressed,{binary:!0,optimizedBinaryString:!0,date:d.date,dir:d.dir,comment:d.fileCommentStr.length?d.fileCommentStr:null,unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions,createFolders:h.createFolders})}a.zipComment.length&&(i.comment=a.zipComment);return i})}}var Rb=!1;function Sb(){Rb||(Rb=!0,Qb());return Pb.exports}c={};var Tb={exports:c};function Ub(){function a(){if(!(this instanceof a))return new a();if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={};this.comment=null;this.root="";this.clone=function(){var b=new a();for(var c in this)typeof this[c]!=="function"&&(b[c]=this[c]);return b}}a.prototype=ib();a.prototype.loadAsync=Sb();a.support=o();a.defaults=U();a.version="3.2.0";a.loadAsync=function(b,c){return new a().loadAsync(b,c)};a.external=B();Tb.exports=a}var Vb=!1;function Wb(){Vb||(Vb=!0,Ub());return Tb.exports}function a(a){switch(a){case void 0:return Wb()}}e.exports=a}),null);
__d("jszip",["jszip-3.2.0"],(function(a,b,c,d,e,f){e.exports=b("jszip-3.2.0")()}),null);
/**
 * License: https://www.facebook.com/legal/license/PAEKTkKqR_S/
 */
__d("msgpack-msgpack-2.8.0",["regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){Object.defineProperty(g,"__esModule",{value:!0});g.getUint64=g.getInt64=g.setInt64=g.setUint64=g.UINT32_MAX=void 0;g.UINT32_MAX=4294967295;function a(a,b,c){var d=c/4294967296;c=c;a.setUint32(b,d);a.setUint32(b+4,c)}g.setUint64=a;function b(a,b,c){var d=Math.floor(c/4294967296);c=c;a.setUint32(b,d);a.setUint32(b+4,c)}g.setInt64=b;function c(a,b){var c=a.getInt32(b);a=a.getUint32(b+4);return c*4294967296+a}g.getInt64=c;function d(a,b){var c=a.getUint32(b);a=a.getUint32(b+4);return c*4294967296+a}g.getUint64=d}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){var a;Object.defineProperty(l,"__esModule",{value:!0});l.utf8DecodeTD=l.TEXT_DECODER_THRESHOLD=l.utf8DecodeJs=l.utf8EncodeTE=l.TEXT_ENCODER_THRESHOLD=l.utf8EncodeJs=l.utf8Count=void 0;var b=k();a=(typeof process==="undefined"||((a=process===null||process===void 0?void 0:process.env)===null||a===void 0?void 0:a.TEXT_ENCODING)!=="never")&&typeof TextEncoder!=="undefined"&&typeof TextDecoder!=="undefined";function c(a){var b=a.length,c=0,d=0;while(d<b){var e=a.charCodeAt(d++);if((e&4294967168)===0){c++;continue}else if((e&4294965248)===0)c+=2;else{if(e>=55296&&e<=56319&&d<b){var f=a.charCodeAt(d);(f&64512)===56320&&(++d,e=((e&1023)<<10)+(f&1023)+65536)}(e&4294901760)===0?c+=3:c+=4}}return c}l.utf8Count=c;function d(a,b,c){var d=a.length;c=c;var e=0;while(e<d){var f=a.charCodeAt(e++);if((f&4294967168)===0){b[c++]=f;continue}else if((f&4294965248)===0)b[c++]=f>>6&31|192;else{if(f>=55296&&f<=56319&&e<d){var g=a.charCodeAt(e);(g&64512)===56320&&(++e,f=((f&1023)<<10)+(g&1023)+65536)}(f&4294901760)===0?(b[c++]=f>>12&15|224,b[c++]=f>>6&63|128):(b[c++]=f>>18&7|240,b[c++]=f>>12&63|128,b[c++]=f>>6&63|128)}b[c++]=f&63|128}}l.utf8EncodeJs=d;var e=a?new TextEncoder():void 0;l.TEXT_ENCODER_THRESHOLD=a?typeof process!=="undefined"&&((c=process===null||process===void 0?void 0:process.env)===null||c===void 0?void 0:c.TEXT_ENCODING)!=="force"?200:0:b.UINT32_MAX;function f(a,b,c){b.set(e.encode(a),c)}function g(a,b,c){e.encodeInto(a,b.subarray(c))}l.utf8EncodeTE=(e===null||e===void 0?void 0:e.encodeInto)?g:f;var h=4096;function i(a,b,c){b=b;c=b+c;var d=[],e="";while(b<c){var f=a[b++];if((f&128)===0)d.push(f);else if((f&224)===192){var g=a[b++]&63;d.push((f&31)<<6|g)}else if((f&240)===224){g=a[b++]&63;var i=a[b++]&63;d.push((f&31)<<12|g<<6|i)}else if((f&248)===240){g=a[b++]&63;i=a[b++]&63;var j=a[b++]&63;g=(f&7)<<18|g<<12|i<<6|j;g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|g&1023);d.push(g)}else d.push(f);d.length>=h&&(e+=String.fromCharCode.apply(String,d),d.length=0)}d.length>0&&(e+=String.fromCharCode.apply(String,d));return e}l.utf8DecodeJs=i;var j=a?new TextDecoder():null;l.TEXT_DECODER_THRESHOLD=a?typeof process!=="undefined"&&((d=process===null||process===void 0?void 0:process.env)===null||d===void 0?void 0:d.TEXT_DECODER)!=="force"?200:0:b.UINT32_MAX;function m(a,b,c){a=a.subarray(b,b+c);return j.decode(a)}l.utf8DecodeTD=m}var o=!1;function p(){o||(o=!0,n());return m.exports}var q={},r={exports:q};function aa(){Object.defineProperty(q,"__esModule",{value:!0});q.ExtData=void 0;var a=function(a,b){this.type=a,this.data=b};q.ExtData=a}var s=!1;function t(){s||(s=!0,aa());return r.exports}var u={},ba={exports:u};function ca(){Object.defineProperty(u,"__esModule",{value:!0});u.DecodeError=void 0;var a=function(b){babelHelpers.inheritsLoose(a,b);function a(c){c=b.call(this,c)||this;var d=Object.create(a.prototype);Object.setPrototypeOf(babelHelpers.assertThisInitialized(c),d);Object.defineProperty(babelHelpers.assertThisInitialized(c),"name",{configurable:!0,enumerable:!1,value:a.name});return c}return a}(babelHelpers.wrapNativeSuper(Error));u.DecodeError=a}var v=!1;function w(){v||(v=!0,ca());return ba.exports}var x={},da={exports:x};function ea(){Object.defineProperty(x,"__esModule",{value:!0});x.timestampExtension=x.decodeTimestampExtension=x.decodeTimestampToTimeSpec=x.encodeTimestampExtension=x.encodeDateToTimeSpec=x.encodeTimeSpecToTimestamp=x.EXT_TIMESTAMP=void 0;var a=w(),b=k();x.EXT_TIMESTAMP=-1;var c=4294967296-1,d=17179869184-1;function e(a){var e=a.sec;a=a.nsec;if(e>=0&&a>=0&&e<=d)if(a===0&&e<=c){var f=new Uint8Array(4),g=new DataView(f.buffer);g.setUint32(0,e);return f}else{g=e/4294967296;f=e&4294967295;var h=new Uint8Array(8),i=new DataView(h.buffer);i.setUint32(0,a<<2|g&3);i.setUint32(4,f);return h}else{g=new Uint8Array(12);i=new DataView(g.buffer);i.setUint32(0,a);b.setInt64(i,4,e);return g}}x.encodeTimeSpecToTimestamp=e;function f(a){a=a.getTime();var b=Math.floor(a/1e3);a=(a-b*1e3)*1e6;var c=Math.floor(a/1e9);return{sec:b+c,nsec:a-c*1e9}}x.encodeDateToTimeSpec=f;function g(a){if(a instanceof Date){a=f(a);return e(a)}else return null}x.encodeTimestampExtension=g;function h(c){var d=new DataView(c.buffer,c.byteOffset,c.byteLength);switch(c.byteLength){case 4:var e=d.getUint32(0),f=0;return{sec:e,nsec:f};case 8:e=d.getUint32(0);f=d.getUint32(4);f=(e&3)*4294967296+f;e=e>>>2;return{sec:f,nsec:e};case 12:f=b.getInt64(d,4);e=d.getUint32(0);return{sec:f,nsec:e};default:throw new a.DecodeError("Unrecognized data size for timestamp (expected 4, 8, or 12): "+c.length)}}x.decodeTimestampToTimeSpec=h;function i(a){a=h(a);return new Date(a.sec*1e3+a.nsec/1e6)}x.decodeTimestampExtension=i;x.timestampExtension={type:x.EXT_TIMESTAMP,encode:g,decode:i}}var y=!1;function z(){y||(y=!0,ea());return da.exports}var A={},fa={exports:A};function ga(){Object.defineProperty(A,"__esModule",{value:!0});A.ExtensionCodec=void 0;var a=t(),b=z(),c=function(){function c(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(b.timestampExtension)}var d=c.prototype;d.register=function(a){var b=a.type,c=a.encode;a=a.decode;if(b>=0)this.encoders[b]=c,this.decoders[b]=a;else{b=1+b;this.builtInEncoders[b]=c;this.builtInDecoders[b]=a}};d.tryToEncode=function(b,c){for(var d=0;d<this.builtInEncoders.length;d++){var e=this.builtInEncoders[d];if(e!=null){e=e(b,c);if(e!=null){var f=-1-d;return new a.ExtData(f,e)}}}for(f=0;f<this.encoders.length;f++){e=this.encoders[f];if(e!=null){d=e(b,c);if(d!=null){e=f;return new a.ExtData(e,d)}}}return b instanceof a.ExtData?b:null};d.decode=function(b,c,d){var e=c<0?this.builtInDecoders[-1-c]:this.decoders[c];if(e)return e(b,c,d);else return new a.ExtData(c,b)};return c}();A.ExtensionCodec=c;c.defaultCodec=new c()}var B=!1;function C(){B||(B=!0,ga());return fa.exports}var D={},ha={exports:D};function ia(){Object.defineProperty(D,"__esModule",{value:!0});D.createDataView=D.ensureUint8Array=void 0;function a(a){if(a instanceof Uint8Array)return a;else if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);else if(a instanceof ArrayBuffer)return new Uint8Array(a);else return Uint8Array.from(a)}D.ensureUint8Array=a;function b(b){if(b instanceof ArrayBuffer)return new DataView(b);b=a(b);return new DataView(b.buffer,b.byteOffset,b.byteLength)}D.createDataView=b}var E=!1;function F(){E||(E=!0,ia());return ha.exports}var G={},ja={exports:G};function ka(){Object.defineProperty(G,"__esModule",{value:!0});G.Encoder=G.DEFAULT_INITIAL_BUFFER_SIZE=G.DEFAULT_MAX_DEPTH=void 0;var a=p(),b=C(),c=k(),d=F();G.DEFAULT_MAX_DEPTH=100;G.DEFAULT_INITIAL_BUFFER_SIZE=2048;var e=function(){function e(a,c,d,e,f,g,h,i){a===void 0&&(a=b.ExtensionCodec.defaultCodec),c===void 0&&(c=void 0),d===void 0&&(d=G.DEFAULT_MAX_DEPTH),e===void 0&&(e=G.DEFAULT_INITIAL_BUFFER_SIZE),f===void 0&&(f=!1),g===void 0&&(g=!1),h===void 0&&(h=!1),i===void 0&&(i=!1),this.extensionCodec=a,this.context=c,this.maxDepth=d,this.initialBufferSize=e,this.sortKeys=f,this.forceFloat32=g,this.ignoreUndefined=h,this.forceIntegerToFloat=i,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}var f=e.prototype;f.reinitializeState=function(){this.pos=0};f.encodeSharedRef=function(a){this.reinitializeState();this.doEncode(a,1);return this.bytes.subarray(0,this.pos)};f.encode=function(a){this.reinitializeState();this.doEncode(a,1);return this.bytes.slice(0,this.pos)};f.doEncode=function(a,b){if(b>this.maxDepth)throw new Error("Too deep objects in depth "+b);a==null?this.encodeNil():typeof a==="boolean"?this.encodeBoolean(a):typeof a==="number"?this.encodeNumber(a):typeof a==="string"?this.encodeString(a):this.encodeObject(a,b)};f.ensureBufferSizeToWrite=function(a){a=this.pos+a;this.view.byteLength<a&&this.resizeBuffer(a*2)};f.resizeBuffer=function(a){a=new ArrayBuffer(a);var b=new Uint8Array(a);a=new DataView(a);b.set(this.bytes);this.view=a;this.bytes=b};f.encodeNil=function(){this.writeU8(192)};f.encodeBoolean=function(a){a===!1?this.writeU8(194):this.writeU8(195)};f.encodeNumber=function(a){Number.isSafeInteger(a)&&!this.forceIntegerToFloat?a>=0?a<128?this.writeU8(a):a<256?(this.writeU8(204),this.writeU8(a)):a<65536?(this.writeU8(205),this.writeU16(a)):a<4294967296?(this.writeU8(206),this.writeU32(a)):(this.writeU8(207),this.writeU64(a)):a>=-32?this.writeU8(224|a+32):a>=-128?(this.writeU8(208),this.writeI8(a)):a>=-32768?(this.writeU8(209),this.writeI16(a)):a>=-2147483648?(this.writeU8(210),this.writeI32(a)):(this.writeU8(211),this.writeI64(a)):this.forceFloat32?(this.writeU8(202),this.writeF32(a)):(this.writeU8(203),this.writeF64(a))};f.writeStringHeader=function(a){if(a<32)this.writeU8(160+a);else if(a<256)this.writeU8(217),this.writeU8(a);else if(a<65536)this.writeU8(218),this.writeU16(a);else if(a<4294967296)this.writeU8(219),this.writeU32(a);else throw new Error("Too long string: "+a+" bytes in UTF-8")};f.encodeString=function(b){var c=1+4,d=b.length;if(d>a.TEXT_ENCODER_THRESHOLD){d=a.utf8Count(b);this.ensureBufferSizeToWrite(c+d);this.writeStringHeader(d);a.utf8EncodeTE(b,this.bytes,this.pos);this.pos+=d}else{d=a.utf8Count(b);this.ensureBufferSizeToWrite(c+d);this.writeStringHeader(d);a.utf8EncodeJs(b,this.bytes,this.pos);this.pos+=d}};f.encodeObject=function(a,b){var c=this.extensionCodec.tryToEncode(a,this.context);if(c!=null)this.encodeExtension(c);else if(Array.isArray(a))this.encodeArray(a,b);else if(ArrayBuffer.isView(a))this.encodeBinary(a);else if(typeof a==="object")this.encodeMap(a,b);else throw new Error("Unrecognized object: "+Object.prototype.toString.apply(a))};f.encodeBinary=function(a){var b=a.byteLength;if(b<256)this.writeU8(196),this.writeU8(b);else if(b<65536)this.writeU8(197),this.writeU16(b);else if(b<4294967296)this.writeU8(198),this.writeU32(b);else throw new Error("Too large binary: "+b);b=d.ensureUint8Array(a);this.writeU8a(b)};f.encodeArray=function(a,b){var c=a.length;if(c<16)this.writeU8(144+c);else if(c<65536)this.writeU8(220),this.writeU16(c);else if(c<4294967296)this.writeU8(221),this.writeU32(c);else throw new Error("Too large array: "+c);for(var c=a,a=Array.isArray(c),d=0,c=a?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(a){if(d>=c.length)break;e=c[d++]}else{d=c.next();if(d.done)break;e=d.value}e=e;this.doEncode(e,b+1)}};f.countWithoutUndefined=function(a,b){var c=0;for(var b=b,d=Array.isArray(b),e=0,b=d?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=b.length)break;f=b[e++]}else{e=b.next();if(e.done)break;f=e.value}f=f;a[f]!==void 0&&c++}return c};f.encodeMap=function(a,b){var c=Object.keys(a);this.sortKeys&&c.sort();var d=this.ignoreUndefined?this.countWithoutUndefined(a,c):c.length;if(d<16)this.writeU8(128+d);else if(d<65536)this.writeU8(222),this.writeU16(d);else if(d<4294967296)this.writeU8(223),this.writeU32(d);else throw new Error("Too large map object: "+d);for(d=0;d<c.length;d++){var e=c[d],f=a[e];this.ignoreUndefined&&f===void 0||(this.encodeString(e),this.doEncode(f,b+1))}};f.encodeExtension=function(a){var b=a.data.length;if(b===1)this.writeU8(212);else if(b===2)this.writeU8(213);else if(b===4)this.writeU8(214);else if(b===8)this.writeU8(215);else if(b===16)this.writeU8(216);else if(b<256)this.writeU8(199),this.writeU8(b);else if(b<65536)this.writeU8(200),this.writeU16(b);else if(b<4294967296)this.writeU8(201),this.writeU32(b);else throw new Error("Too large extension object: "+b);this.writeI8(a.type);this.writeU8a(a.data)};f.writeU8=function(a){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,a),this.pos++};f.writeU8a=function(a){var b=a.length;this.ensureBufferSizeToWrite(b);this.bytes.set(a,this.pos);this.pos+=b};f.writeI8=function(a){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,a),this.pos++};f.writeU16=function(a){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,a),this.pos+=2};f.writeI16=function(a){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,a),this.pos+=2};f.writeU32=function(a){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,a),this.pos+=4};f.writeI32=function(a){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,a),this.pos+=4};f.writeF32=function(a){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,a),this.pos+=4};f.writeF64=function(a){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,a),this.pos+=8};f.writeU64=function(a){this.ensureBufferSizeToWrite(8),c.setUint64(this.view,this.pos,a),this.pos+=8};f.writeI64=function(a){this.ensureBufferSizeToWrite(8),c.setInt64(this.view,this.pos,a),this.pos+=8};return e}();G.Encoder=e}var H=!1;function I(){H||(H=!0,ka());return ja.exports}var J={},la={exports:J};function ma(){Object.defineProperty(J,"__esModule",{value:!0});J.encode=void 0;var a=I(),b={};function c(c,d){d===void 0&&(d=b);d=new a.Encoder(d.extensionCodec,d.context,d.maxDepth,d.initialBufferSize,d.sortKeys,d.forceFloat32,d.ignoreUndefined,d.forceIntegerToFloat);return d.encodeSharedRef(c)}J.encode=c}var K=!1;function na(){K||(K=!0,ma());return la.exports}var L={},oa={exports:L};function pa(){Object.defineProperty(L,"__esModule",{value:!0});L.prettyByte=void 0;function a(a){return(a<0?"-":"")+"0x"+Math.abs(a).toString(16).padStart(2,"0")}L.prettyByte=a}var M=!1;function qa(){M||(M=!0,pa());return oa.exports}var N={},ra={exports:N};function sa(){Object.defineProperty(N,"__esModule",{value:!0});N.CachedKeyDecoder=void 0;var a=p(),b=16,c=16,d=function(){function d(a,d){a===void 0&&(a=b);d===void 0&&(d=c);this.maxKeyLength=a;this.maxLengthPerKey=d;this.hit=0;this.miss=0;this.caches=[];for(a=0;a<this.maxKeyLength;a++)this.caches.push([])}var e=d.prototype;e.canBeCached=function(a){return a>0&&a<=this.maxKeyLength};e.find=function(a,b,c){var d=this.caches[c-1];FIND_CHUNK:for(var d=d,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;var h=g.bytes;for(var i=0;i<c;i++)if(h[i]!==a[b+i])continue FIND_CHUNK;return g.str}return null};e.store=function(a,b){var c=this.caches[a.length-1];a={bytes:a,str:b};c.length>=this.maxLengthPerKey?c[Math.random()*c.length|0]=a:c.push(a)};e.decode=function(b,c,d){var e=this.find(b,c,d);if(e!=null){this.hit++;return e}this.miss++;e=a.utf8DecodeJs(b,c,d);b=Uint8Array.prototype.slice.call(b,c,c+d);this.store(b,e);return e};return d}();N.CachedKeyDecoder=d}var O=!1;function ta(){O||(O=!0,sa());return ra.exports}var P={},ua={exports:P};function va(){Object.defineProperty(P,"__esModule",{value:!0});P.Decoder=P.DataViewIndexOutOfBoundsError=void 0;var a=qa(),c=C(),d=k(),e=p(),f=F(),g=ta(),h=w(),i=function(a){a=typeof a;return a==="string"||a==="number"},j=-1,l=new DataView(new ArrayBuffer(0)),m=new Uint8Array(l.buffer);P.DataViewIndexOutOfBoundsError=function(){try{l.getInt8(0)}catch(a){return a.constructor}throw new Error("never reached")}();var n=new P.DataViewIndexOutOfBoundsError("Insufficient data"),o=new g.CachedKeyDecoder();g=function(){function g(a,b,e,f,g,h,i,k){a===void 0&&(a=c.ExtensionCodec.defaultCodec),b===void 0&&(b=void 0),e===void 0&&(e=d.UINT32_MAX),f===void 0&&(f=d.UINT32_MAX),g===void 0&&(g=d.UINT32_MAX),h===void 0&&(h=d.UINT32_MAX),i===void 0&&(i=d.UINT32_MAX),k===void 0&&(k=o),this.extensionCodec=a,this.context=b,this.maxStrLength=e,this.maxBinLength=f,this.maxArrayLength=g,this.maxMapLength=h,this.maxExtLength=i,this.keyDecoder=k,this.totalPos=0,this.pos=0,this.view=l,this.bytes=m,this.headByte=j,this.stack=[]}var k=g.prototype;k.reinitializeState=function(){this.totalPos=0,this.headByte=j,this.stack.length=0};k.setBuffer=function(a){this.bytes=f.ensureUint8Array(a),this.view=f.createDataView(this.bytes),this.pos=0};k.appendBuffer=function(a){if(this.headByte===j&&!this.hasRemaining(1))this.setBuffer(a);else{var b=this.bytes.subarray(this.pos);a=f.ensureUint8Array(a);var c=new Uint8Array(b.length+a.length);c.set(b);c.set(a,b.length);this.setBuffer(c)}};k.hasRemaining=function(a){return this.view.byteLength-this.pos>=a};k.createExtraByteError=function(a){var b=this.view,c=this.pos;return new RangeError("Extra "+(b.byteLength-c)+" of "+b.byteLength+" byte(s) found at buffer["+a+"]")};k.decode=function(a){this.reinitializeState();this.setBuffer(a);a=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return a};k.decodeMulti=b("regeneratorRuntime").mark(function a(c){return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:this.reinitializeState(),this.setBuffer(c);case 2:if(!this.hasRemaining(1)){a.next=7;break}a.next=5;return this.doDecodeSync();case 5:a.next=2;break;case 7:case"end":return a.stop()}},a,this)});k.decodeAsync=function(c){var d,e,f,g,h,i,j,k,l,m,n,o;return b("regeneratorRuntime").async(function(p){while(1)switch(p.prev=p.next){case 0:d=!1,f=!0,g=!1,p.prev=3,i=babelHelpers.asyncIterator(c);case 5:p.next=7;return b("regeneratorRuntime").awrap(i.next());case 7:j=p.sent;f=j.done;p.next=11;return b("regeneratorRuntime").awrap(j.value);case 11:k=p.sent;if(f){p.next=30;break}l=k;if(!d){p.next=16;break}throw this.createExtraByteError(this.totalPos);case 16:this.appendBuffer(l);p.prev=17;e=this.doDecodeSync();d=!0;p.next=26;break;case 22:p.prev=22;p.t0=p["catch"](17);if(p.t0 instanceof P.DataViewIndexOutOfBoundsError){p.next=26;break}throw p.t0;case 26:this.totalPos+=this.pos;case 27:f=!0;p.next=5;break;case 30:p.next=36;break;case 32:p.prev=32,p.t1=p["catch"](3),g=!0,h=p.t1;case 36:p.prev=36;p.prev=37;if(!(!f&&i["return"]!=null)){p.next=41;break}p.next=41;return b("regeneratorRuntime").awrap(i["return"]());case 41:p.prev=41;if(!g){p.next=44;break}throw h;case 44:return p.finish(41);case 45:return p.finish(36);case 46:if(!d){p.next=50;break}if(!this.hasRemaining(1)){p.next=49;break}throw this.createExtraByteError(this.totalPos);case 49:return p.abrupt("return",e);case 50:m=this.headByte,n=this.pos,o=this.totalPos;throw new RangeError("Insufficient data in parsing "+a.prettyByte(m)+" at "+o+" ("+n+" in the current buffer)");case 52:case"end":return p.stop()}},null,this,[[3,32,36,46],[17,22],[37,,41,45]])};k.decodeArrayStream=function(a){return this.decodeMultiAsync(a,!0)};k.decodeStream=function(a){return this.decodeMultiAsync(a,!1)};k.decodeMultiAsync=function(){var a=babelHelpers.wrapAsyncGenerator(b("regeneratorRuntime").mark(function a(c,d){var e,f,g,h,i,j,k,l,m;return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:e=d,f=-1,g=!0,h=!1,a.prev=4,j=babelHelpers.asyncIterator(c);case 6:a.next=8;return babelHelpers.awaitAsyncGenerator(j.next());case 8:k=a.sent;g=k.done;a.next=12;return babelHelpers.awaitAsyncGenerator(k.value);case 12:l=a.sent;if(g){a.next=37;break}m=l;if(!(d&&f===0)){a.next=17;break}throw this.createExtraByteError(this.totalPos);case 17:this.appendBuffer(m),e&&(f=this.readArraySize(),e=!1,this.complete()),a.prev=19;case 20:a.next=23;return this.doDecodeSync();case 23:if(!(--f===0)){a.next=25;break}return a.abrupt("break",27);case 25:a.next=20;break;case 27:a.next=33;break;case 29:a.prev=29;a.t0=a["catch"](19);if(a.t0 instanceof P.DataViewIndexOutOfBoundsError){a.next=33;break}throw a.t0;case 33:this.totalPos+=this.pos;case 34:g=!0;a.next=6;break;case 37:a.next=43;break;case 39:a.prev=39,a.t1=a["catch"](4),h=!0,i=a.t1;case 43:a.prev=43;a.prev=44;if(!(!g&&j["return"]!=null)){a.next=48;break}a.next=48;return babelHelpers.awaitAsyncGenerator(j["return"]());case 48:a.prev=48;if(!h){a.next=51;break}throw i;case 51:return a.finish(48);case 52:return a.finish(43);case 53:case"end":return a.stop()}},a,this,[[4,39,43,53],[19,29],[44,,48,52]])}));function c(b,c){return a.apply(this,arguments)}return c}();k.doDecodeSync=function(){DECODE:while(!0){var b=this.readHeadByte(),c=void 0;if(b>=224)c=b-256;else if(b<192)if(b<128)c=b;else if(b<144){var d=b-128;if(d!==0){this.pushMapState(d);this.complete();continue DECODE}else c={}}else if(b<160){d=b-144;if(d!==0){this.pushArrayState(d);this.complete();continue DECODE}else c=[]}else{d=b-160;c=this.decodeUtf8String(d,0)}else if(b===192)c=null;else if(b===194)c=!1;else if(b===195)c=!0;else if(b===202)c=this.readF32();else if(b===203)c=this.readF64();else if(b===204)c=this.readU8();else if(b===205)c=this.readU16();else if(b===206)c=this.readU32();else if(b===207)c=this.readU64();else if(b===208)c=this.readI8();else if(b===209)c=this.readI16();else if(b===210)c=this.readI32();else if(b===211)c=this.readI64();else if(b===217){d=this.lookU8();c=this.decodeUtf8String(d,1)}else if(b===218){d=this.lookU16();c=this.decodeUtf8String(d,2)}else if(b===219){d=this.lookU32();c=this.decodeUtf8String(d,4)}else if(b===220){d=this.readU16();if(d!==0){this.pushArrayState(d);this.complete();continue DECODE}else c=[]}else if(b===221){d=this.readU32();if(d!==0){this.pushArrayState(d);this.complete();continue DECODE}else c=[]}else if(b===222){d=this.readU16();if(d!==0){this.pushMapState(d);this.complete();continue DECODE}else c={}}else if(b===223){d=this.readU32();if(d!==0){this.pushMapState(d);this.complete();continue DECODE}else c={}}else if(b===196){d=this.lookU8();c=this.decodeBinary(d,1)}else if(b===197){d=this.lookU16();c=this.decodeBinary(d,2)}else if(b===198){d=this.lookU32();c=this.decodeBinary(d,4)}else if(b===212)c=this.decodeExtension(1,0);else if(b===213)c=this.decodeExtension(2,0);else if(b===214)c=this.decodeExtension(4,0);else if(b===215)c=this.decodeExtension(8,0);else if(b===216)c=this.decodeExtension(16,0);else if(b===199){d=this.lookU8();c=this.decodeExtension(d,1)}else if(b===200){d=this.lookU16();c=this.decodeExtension(d,2)}else if(b===201){d=this.lookU32();c=this.decodeExtension(d,4)}else throw new h.DecodeError("Unrecognized type byte: "+a.prettyByte(b));this.complete();d=this.stack;while(d.length>0){b=d[d.length-1];if(b.type===0){b.array[b.position]=c;b.position++;if(b.position===b.size)d.pop(),c=b.array;else continue DECODE}else if(b.type===1){if(!i(c))throw new h.DecodeError("The type of key must be string or number but "+typeof c);if(c==="__proto__")throw new h.DecodeError("The key __proto__ is not allowed");b.key=c;b.type=2;continue DECODE}else{b.map[b.key]=c;b.readCount++;if(b.readCount===b.size)d.pop(),c=b.map;else{b.key=null;b.type=1;continue DECODE}}}return c}};k.readHeadByte=function(){this.headByte===j&&(this.headByte=this.readU8());return this.headByte};k.complete=function(){this.headByte=j};k.readArraySize=function(){var b=this.readHeadByte();switch(b){case 220:return this.readU16();case 221:return this.readU32();default:if(b<160)return b-144;else throw new h.DecodeError("Unrecognized array type byte: "+a.prettyByte(b))}};k.pushMapState=function(a){if(a>this.maxMapLength)throw new h.DecodeError("Max length exceeded: map length ("+a+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:a,key:null,readCount:0,map:{}})};k.pushArrayState=function(a){if(a>this.maxArrayLength)throw new h.DecodeError("Max length exceeded: array length ("+a+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:a,array:new Array(a),position:0})};k.decodeUtf8String=function(a,b){var c;if(a>this.maxStrLength)throw new h.DecodeError("Max length exceeded: UTF-8 byte length ("+a+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+b+a)throw n;var d=this.pos+b;this.stateIsMapKey()&&((c=this.keyDecoder)===null||c===void 0?void 0:c.canBeCached(a))?c=this.keyDecoder.decode(this.bytes,d,a):a>e.TEXT_DECODER_THRESHOLD?c=e.utf8DecodeTD(this.bytes,d,a):c=e.utf8DecodeJs(this.bytes,d,a);this.pos+=b+a;return c};k.stateIsMapKey=function(){if(this.stack.length>0){var a=this.stack[this.stack.length-1];return a.type===1}return!1};k.decodeBinary=function(a,b){if(a>this.maxBinLength)throw new h.DecodeError("Max length exceeded: bin length ("+a+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(a+b))throw n;var c=this.pos+b;c=this.bytes.subarray(c,c+a);this.pos+=b+a;return c};k.decodeExtension=function(a,b){if(a>this.maxExtLength)throw new h.DecodeError("Max length exceeded: ext length ("+a+") > maxExtLength ("+this.maxExtLength+")");var c=this.view.getInt8(this.pos+b);a=this.decodeBinary(a,b+1);return this.extensionCodec.decode(a,c,this.context)};k.lookU8=function(){return this.view.getUint8(this.pos)};k.lookU16=function(){return this.view.getUint16(this.pos)};k.lookU32=function(){return this.view.getUint32(this.pos)};k.readU8=function(){var a=this.view.getUint8(this.pos);this.pos++;return a};k.readI8=function(){var a=this.view.getInt8(this.pos);this.pos++;return a};k.readU16=function(){var a=this.view.getUint16(this.pos);this.pos+=2;return a};k.readI16=function(){var a=this.view.getInt16(this.pos);this.pos+=2;return a};k.readU32=function(){var a=this.view.getUint32(this.pos);this.pos+=4;return a};k.readI32=function(){var a=this.view.getInt32(this.pos);this.pos+=4;return a};k.readU64=function(){var a=d.getUint64(this.view,this.pos);this.pos+=8;return a};k.readI64=function(){var a=d.getInt64(this.view,this.pos);this.pos+=8;return a};k.readF32=function(){var a=this.view.getFloat32(this.pos);this.pos+=4;return a};k.readF64=function(){var a=this.view.getFloat64(this.pos);this.pos+=8;return a};return g}();P.Decoder=g}var Q=!1;function R(){Q||(Q=!0,va());return ua.exports}var S={},wa={exports:S};function xa(){Object.defineProperty(S,"__esModule",{value:!0});S.decodeMulti=S.decode=S.defaultDecodeOptions=void 0;var a=R();S.defaultDecodeOptions={};function b(b,c){c===void 0&&(c=S.defaultDecodeOptions);c=new a.Decoder(c.extensionCodec,c.context,c.maxStrLength,c.maxBinLength,c.maxArrayLength,c.maxMapLength,c.maxExtLength);return c.decode(b)}S.decode=b;function c(b,c){c===void 0&&(c=S.defaultDecodeOptions);c=new a.Decoder(c.extensionCodec,c.context,c.maxStrLength,c.maxBinLength,c.maxArrayLength,c.maxMapLength,c.maxExtLength);return c.decodeMulti(b)}S.decodeMulti=c}var T=!1;function U(){T||(T=!0,xa());return wa.exports}var V={},ya={exports:V};function za(){Object.defineProperty(V,"__esModule",{value:!0});V.ensureAsyncIterable=V.asyncIterableFromStream=V.isAsyncIterable=void 0;function a(a){return a[typeof Symbol==="function"?Symbol.asyncIterator:"@@asyncIterator"]!=null}V.isAsyncIterable=a;function c(a){if(a==null)throw new Error("Assertion Failure: value must not be null nor undefined")}function d(a){return e.apply(this,arguments)}function e(){e=babelHelpers.wrapAsyncGenerator(b("regeneratorRuntime").mark(function a(d){var e,f,g,h;return b("regeneratorRuntime").wrap(function(a){while(1)switch(a.prev=a.next){case 0:e=d.getReader(),a.prev=1;case 2:a.next=5;return babelHelpers.awaitAsyncGenerator(e.read());case 5:f=a.sent;g=f.done;h=f.value;if(!g){a.next=10;break}return a.abrupt("return");case 10:c(h);a.next=13;return h;case 13:a.next=2;break;case 15:a.prev=15;e.releaseLock();return a.finish(15);case 18:case"end":return a.stop()}},a,this,[[1,,15,18]])}));return e.apply(this,arguments)}V.asyncIterableFromStream=d;function f(b){if(a(b))return b;else return d(b)}V.ensureAsyncIterable=f}var W=!1;function Aa(){W||(W=!0,za());return ya.exports}var X={},Ba={exports:X};function Ca(){Object.defineProperty(X,"__esModule",{value:!0});X.decodeStream=X.decodeMultiStream=X.decodeArrayStream=X.decodeAsync=void 0;var a=R(),c=Aa(),d=U();function e(e,f){var g,h;return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:f===void 0&&(f=d.defaultDecodeOptions);g=c.ensureAsyncIterable(e);h=new a.Decoder(f.extensionCodec,f.context,f.maxStrLength,f.maxBinLength,f.maxArrayLength,f.maxMapLength,f.maxExtLength);return b.abrupt("return",h.decodeAsync(g));case 4:case"end":return b.stop()}},null,this)}X.decodeAsync=e;function f(b,e){e===void 0&&(e=d.defaultDecodeOptions);b=c.ensureAsyncIterable(b);e=new a.Decoder(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength);return e.decodeArrayStream(b)}X.decodeArrayStream=f;function g(b,e){e===void 0&&(e=d.defaultDecodeOptions);b=c.ensureAsyncIterable(b);e=new a.Decoder(e.extensionCodec,e.context,e.maxStrLength,e.maxBinLength,e.maxArrayLength,e.maxMapLength,e.maxExtLength);return e.decodeStream(b)}X.decodeMultiStream=g;function h(a,b){b===void 0&&(b=d.defaultDecodeOptions);return g(a,b)}X.decodeStream=h}var Y=!1;function Da(){Y||(Y=!0,Ca());return Ba.exports}var Z={},Ea={exports:Z};function Fa(){Object.defineProperty(Z,"__esModule",{value:!0});Z.decodeTimestampExtension=Z.encodeTimestampExtension=Z.decodeTimestampToTimeSpec=Z.encodeTimeSpecToTimestamp=Z.encodeDateToTimeSpec=Z.EXT_TIMESTAMP=Z.ExtData=Z.ExtensionCodec=Z.Encoder=Z.DataViewIndexOutOfBoundsError=Z.DecodeError=Z.Decoder=Z.decodeStream=Z.decodeMultiStream=Z.decodeArrayStream=Z.decodeAsync=Z.decodeMulti=Z.decode=Z.encode=void 0;var a=na();Object.defineProperty(Z,"encode",{enumerable:!0,get:function(){return a.encode}});var b=U();Object.defineProperty(Z,"decode",{enumerable:!0,get:function(){return b.decode}});Object.defineProperty(Z,"decodeMulti",{enumerable:!0,get:function(){return b.decodeMulti}});var c=Da();Object.defineProperty(Z,"decodeAsync",{enumerable:!0,get:function(){return c.decodeAsync}});Object.defineProperty(Z,"decodeArrayStream",{enumerable:!0,get:function(){return c.decodeArrayStream}});Object.defineProperty(Z,"decodeMultiStream",{enumerable:!0,get:function(){return c.decodeMultiStream}});Object.defineProperty(Z,"decodeStream",{enumerable:!0,get:function(){return c.decodeStream}});var d=R();Object.defineProperty(Z,"Decoder",{enumerable:!0,get:function(){return d.Decoder}});Object.defineProperty(Z,"DataViewIndexOutOfBoundsError",{enumerable:!0,get:function(){return d.DataViewIndexOutOfBoundsError}});var e=w();Object.defineProperty(Z,"DecodeError",{enumerable:!0,get:function(){return e.DecodeError}});var f=I();Object.defineProperty(Z,"Encoder",{enumerable:!0,get:function(){return f.Encoder}});var g=C();Object.defineProperty(Z,"ExtensionCodec",{enumerable:!0,get:function(){return g.ExtensionCodec}});var h=t();Object.defineProperty(Z,"ExtData",{enumerable:!0,get:function(){return h.ExtData}});var i=z();Object.defineProperty(Z,"EXT_TIMESTAMP",{enumerable:!0,get:function(){return i.EXT_TIMESTAMP}});Object.defineProperty(Z,"encodeDateToTimeSpec",{enumerable:!0,get:function(){return i.encodeDateToTimeSpec}});Object.defineProperty(Z,"encodeTimeSpecToTimestamp",{enumerable:!0,get:function(){return i.encodeTimeSpecToTimestamp}});Object.defineProperty(Z,"decodeTimestampToTimeSpec",{enumerable:!0,get:function(){return i.decodeTimestampToTimeSpec}});Object.defineProperty(Z,"encodeTimestampExtension",{enumerable:!0,get:function(){return i.encodeTimestampExtension}});Object.defineProperty(Z,"decodeTimestampExtension",{enumerable:!0,get:function(){return i.decodeTimestampExtension}})}var $=!1;function Ga(){$||($=!0,Fa());return Ea.exports}function a(a){switch(a){case void 0:return Ga()}}e.exports=a}),null);
__d("msgpack-msgpack",["msgpack-msgpack-2.8.0"],(function(a,b,c,d,e,f){e.exports=b("msgpack-msgpack-2.8.0")()}),null);
/**
 * License: https://www.facebook.com/legal/license/CCT5pM3qiNk/
 */
__d("tweetnacl-auth-1.0.1",["tweetnacl-1.0.3"],(function(a,b,c,d,e,f){"use strict";var g=b("tweetnacl-1.0.3");c={};var h={exports:c};function i(){(function(a,b){typeof h!=="undefined"&&h.exports?h.exports=b(g()):a.nacl.auth=b(a.nacl)})(this,function(a){if(!a)throw new Error("tweetnacl not loaded");var b=128,c=64;function d(d,e){var f=new Uint8Array(b+Math.max(c,d.length)),g;e.length>b&&(e=a.hash(e));for(g=0;g<b;g++)f[g]=54;for(g=0;g<e.length;g++)f[g]^=e[g];f.set(d,b);d=a.hash(f.subarray(0,b+d.length));for(g=0;g<b;g++)f[g]=92;for(g=0;g<e.length;g++)f[g]^=e[g];f.set(d,b);return a.hash(f.subarray(0,b+d.length))}function e(a,b){var c=new Uint8Array(32);c.set(d(a,b).subarray(0,32));return c}e.full=function(a,b){return d(a,b)};e.authLength=32;e.authFullLength=64;e.keyLength=32;return e})}var j=!1;function k(){j||(j=!0,i());return h.exports}function a(a){switch(a){case void 0:return k()}}e.exports=a}),null);
__d("tweetnacl-auth",["tweetnacl-auth-1.0.1"],(function(a,b,c,d,e,f){e.exports=b("tweetnacl-auth-1.0.1")()}),null);/*FB_PKG_DELIM*/
__d("EBAPIQPLPoints",[],(function(a,b,c,d,e,f){"use strict";a={GRAPHQL_QUERY_END:"graphql_query_end",GRAPHQL_QUERY_START:"graphql_query_start"};b={EBLS_NOT_INITIALIZED:"ebls_not_initialized",EMPTY_DECRYPTION_RESPONSE:"empty_decryption_response",INVALID_CLIENT_STATE:"invalid_client_state",INVALID_GRAPHQL_RESPONSE:"invalid_graphql_response",NO_CLIENT_STATE:"no_client_state",RUNTIME_ERROR:"runtime_error"};c=babelHelpers["extends"]({},a);d=babelHelpers["extends"]({},a,b,{DECRYPT_MESSAGES_ECHO_END:"decrypt_messages_echo_end",DECRYPT_MESSAGES_ECHO_START:"decrypt_messages_echo_start",DECRYPT_MESSAGES_PROTOBUF_END:"decrypt_messages_protobuf_end",DECRYPT_MESSAGES_PROTOBUF_START:"decrypt_messages_protobuf_start",DELETE_MAILBOX:"delete_mailbox",DERIVE_AND_STORE_EPOCHS_END:"derive_and_store_epochs_end",DERIVE_AND_STORE_EPOCHS_START:"derive_and_store_epochs_start",ECHO_DECODE_END:"echo_decode_end",ECHO_DECODE_START:"echo_decode_start",MISSING_RANGE_INFO:"missing_range_info",PROCESS_AND_DECRYPT_MESSAGES_END:"process_and_decrypt_messages_end",PROCESS_AND_DECRYPT_MESSAGES_START:"process_and_decrypt_messages_start",PROTOBUF_DECRYPTION_FAILURE:"protobuf_decryption_failure"});f.EBAPIQPLCommonPoints=a;f.EBAPIQPLCommonErrorPoints=b;f.EBMessageMetadataQPLPoints=c;f.EBMessageRangeQueryQPLPoints=d}),66);
__d("EBFormatUtils",["I64","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){if(a!=null)return(h||(h=d("I64"))).min(a,h.of_float(d("WATimeUtils").millisTime()));switch(b){case"before":return(h||(h=d("I64"))).of_float(d("WATimeUtils").millisTime());case"after":return(h||(h=d("I64"))).zero;default:b;return(h||(h=d("I64"))).max_int}}function b(a,b){switch(b){case"before":return[a,0];case"after":return[0,a];default:b;return[Math.ceil(a/2),Math.ceil(a/2)]}}g.adjustTs=a;g.adjustCount=b}),98);
__d("EBMessageMetadataQueryQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8744995708862431"}),null);
__d("EBMessageMetadataQueryQuery.graphql",["EBMessageMetadataQueryQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"data"}],c={alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"data",variableName:"data"}],concreteType:"XFBTDeanonMessagesResponse",kind:"LinkedField",name:"deanon_messages_metadata",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"offline_threading_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sort_order_ms",storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"EBMessageMetadataQueryQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[c],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"EBMessageMetadataQueryQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("EBMessageMetadataQueryQuery_facebookRelayOperation"),metadata:{},name:"EBMessageMetadataQueryQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("EBMessageMetadataQuery",["CometRelay","EBAPIQPLPoints","EBMessageMetadataQueryQuery.graphql","FBLogger","QPLUserFlow","WAHashStringToNumber","WAResultOrError","XPlatRelayEnvironment","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("EBMessageMetadataQueryQuery.graphql");function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.direction,e=a.includeAnonymizedMessages;e=e===void 0?!1:e;var f=a.instanceKey,g=a.numberOfMessages,h=a.referenceTimestamp;h=h===void 0?null:h;a=a.threadId;var j=f!=null?d("WAHashStringToNumber").hashStringToNumber(f):void 0;try{c("QPLUserFlow").start(c("qpl")._(521476771,"2454"),{instanceKey:j});var k=d("XPlatRelayEnvironment").getRelayEnvironment();b=b==="after"?"AFTER":"BEFORE";c("QPLUserFlow").addPoint(c("qpl")._(521476771,"2454"),d("EBAPIQPLPoints").EBMessageMetadataQPLPoints.GRAPHQL_QUERY_START,{instanceKey:j});k=(yield d("CometRelay").fetchQuery(k,i,{data:{act_thread_id:a,direction:b,include_anonymized_messages:e,reference_timestamp:h,requested_messages:g}}).toPromise());c("QPLUserFlow").addPoint(c("qpl")._(521476771,"2454"),d("EBAPIQPLPoints").EBMessageMetadataQPLPoints.GRAPHQL_QUERY_END,{instanceKey:j});g=(h=k==null?void 0:(a=k.viewer)==null?void 0:(b=a.encrypted_backup)==null?void 0:(e=b.mailbox)==null?void 0:e.deanon_messages_metadata)!=null?h:[];k=g.map(function(a){var b=a.offline_threading_id;a=a.sort_order_ms;return{offlineThreadingId:b,sortOrderMs:a}});c("QPLUserFlow").endSuccess(c("qpl")._(521476771,"2454"),{instanceKey:j});return d("WAResultOrError").makeResult({instanceKey:f,messages:k})}catch(a){c("FBLogger")("labyrinth_web").catching(a).mustfix("Error querying messaging metadata from EBMessageMetadataQuery");c("QPLUserFlow").endFailure(c("qpl")._(521476771,"2454"),"error",{error:a,instanceKey:j});return d("WAResultOrError").makeError("error",a)}});return j.apply(this,arguments)}g.messageMetadataQuery=a}),98);
__d("LSDeleteAndReenrollDeviceState",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] Beginning execution."),function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] No reenrollment trigger table. Doing nothing."),d[1]=c.createArray(),void 0!==void 0?d[8]=(d[1].push(void 0),d[1]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure","No reenrollment trigger table. Doing nothing.",d[1],c.i64.cast([0,3]))},function(a){return d[2]=c.i64.of_float(Date.now()),d[3]=c.i64.random(),d[5]="Finishing execution. Execution time: ",d[6]=c.i64.to_string(c.i64.sub(d[2],d[0])),d[7]=" ms",d[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure] ",d[4],d[5],d[4],d[6],d[4],d[7]].join("")),c.i64.eq(c.i64.mod_(d[3],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[8]=",",d[9]=c.createArray(),void 0!==void 0?d[10]=(d[9].push(void 0),d[9]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure",[d[5],d[8],d[6],d[8],d[7]].join(""),d[9],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeleteAndReenrollDeviceStateStoredProcedure";e.exports=a}),null);
__d("LSDeleteAndReenrollDeviceStateStoredProcedure",["LSDeleteAndReenrollDeviceState","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSDeleteAndReenrollDeviceState")(b.targetDeviceId,b.reenrollmentReason,a)}g["default"]=a}),98);
__d("LSMEBDeviceReenrollmentReason",[],(function(a,b,c,d,e,f){a=Object.freeze({UNIT_TEST:1,UPLOAD_FAILED_WITH_NO_DEVICE_FOUND:2,LOCAL_DEVICE_ID_NOT_IN_FETCH_BACKUPS_RESULT:3,RESTORE_FAILED_WITH_NO_DEVICE_FOUND:4,EPOCH_DOWNLOAD_UNRECOVERABLE_ERROR:5,OPT_OUT_DELTA_FROM_DEVICE_PRUNING:6,UPLOAD_FAILED_WITH_INCORRECT_FINGERPRINT_FROM_CORRUPT_EPOCH:7,INIT_SEV_REMEDIATION:8});f["default"]=a}),66);
__d("LSDecryptSupplementalKey",["LSArrayGetObjectAt","LSBase64Decode.nop","LSCreateDerivedKeys.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedData.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptSupplementalKey] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.nativeOperation(b("LSBase64Decode.nop"),a[0]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[1],c.i64.cast([0,0])).then(function(a){return a=a,d[3]=a[0],d[4]=a[1],a})},function(a){return c.blobs.neq(d[2],void 0)?c.sequence([function(a){return d[13]=d[3].get("epoch_root_key"),d[3],d[14]=c.createArray(),d[21]=(d[14].push(c.i64.cast([0,32])),d[14]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,d[13],d[14]).then(function(a){return a=a,d[15]=a[0],a})},function(a){return d[15]!==void 0?c.sequence([function(a){return d[21]=c.i64.of_int32(d[15].length),c.i64.ge(d[21],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[15],c.i64.cast([0,0])).then(function(a){return a=a,d[23]=a[0],d[24]=a[1],a})},function(a){return d[22]=d[23]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[23],c.i64.cast([0,3]))},function(a){return d[22]=void 0}])},function(a){return d[16]=d[22]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[21]=c.createArray(),void 0!==void 0?d[22]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[21],c.i64.cast([0,3]))},function(a){return d[16]=void 0}])},function(a){return c.blobs.neq(d[16],void 0)?d[17]=!0:d[17]=!1,d[17]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedData.nop"),d[16],c.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),d[2]).then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.blobs.neq(d[18],void 0)?(a=[c.blobs.to_string(d[18]),void 0],d[19]=a[0],d[20]=a[1],a):(d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,109])),d[21].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),d[21].set("error_message",""),a=[void 0,d[21]],d[19]=a[0],d[20]=a[1],a),a=[d[19],d[20]],d[5]=a[0],d[6]=a[1],a}]):c.resolve((d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,109])),d[13].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),d[13].set("error_message",""),a=[void 0,d[13]],d[5]=a[0],d[6]=a[1],a))},function(a){return d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptSupplementalKey] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptSupplementalKey",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure";e.exports=a}),null);
__d("LSDecryptMessageProtobufs",["LSArrayGetObjectAt","LSDecryptProtobuf","LSDecryptSupplementalKey","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptMessageProtobufs] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[11]=new c.Map(),d[11].set("error_code",c.i64.cast([0,1])),d[11].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure"),d[11].set("error_message",""),g=[void 0,d[11]],d[2]=g[0],d[3]=g[1],g):(f=e.item,c.sequence([function(a){return d[19]=f.backupId,d[18]=f.backupTenancy,d[17]=f.encryptionVersion,d[11]=void 0,c.i64.neq(d[11],void 0)?c.resolve(d[12]=d[11]):c.sequence([function(a){return d[20]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[30]=(d[20].push(c.i64.cast([0,0])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[30]=(d[20].push(c.i64.cast([0,2])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[30]=(d[20].push(c.i64.cast([0,3])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[30]=(d[20].push(c.i64.cast([0,4])),d[20]):0,d[25]=c.createArray(),d[26]=c.i64.of_int32(d[20].length),c.i64.gt(d[26],c.i64.cast([0,0]))?c.loopAsync(d[26],function(a){return d[30]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[20],d[30]).then(function(a){return a=a,d[31]=a[0],d[32]=a[1],a})},function(a){return d[33]=(d[25].push(d[31]),d[25])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[30]=c.createArray(),d[31]=c.i64.of_int32(d[25].length),c.i64.gt(d[31],c.i64.cast([0,0]))?c.loopAsync(d[31],function(a){return d[33]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[25],d[33]).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[36]=(d[30].push(c.i64.to_string(d[34])),d[30])}])}):c.resolve()},function(a){return d[32]=d[30].join(","),d[27]=d[32]}])},function(a){return d[25].some(function(a){return c.i64.eq(d[17],a)})?d[28]=d[17]:d[28]=void 0,c.i64.neq(d[28],void 0)?d[29]=d[28]:d[29]=void 0,d[12]=d[29]}])},function(e){return c.i64.neq(d[12],void 0)?d[13]=d[12]:d[13]=c.i64.cast([0,0]),c.i64.neq(d[18],void 0)?d[14]=d[18]:d[14]=c.i64.cast([0,1]),c.i64.neq(f.deviceId,void 0)?c.sequence([function(e){return d[20]=c.createArray(),d[21]=c.createArray(),d[22]=new c.Map(),d[23]=c.i64.of_int32(a[0].length),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(e){return d[27]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[27]).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],a})},function(a){return d[30]=d[28].get("encrypted_protobufs"),d[28],d[31]=d[30].get("toplevel_protobuf"),d[30],d[32]=d[31].get("epoch_id"),d[31],d[33]=d[31].get("epoch_anon_id"),d[31],d[34]=d[22].get(c.blobs.to_string(d[33])),d[22],d[34]!==void 0?c.resolve(d[35]=d[34]):c.sequence([function(a){return c.i64.neq(d[32],void 0)?c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[32]]]]),function(a){return c.i64.eq(a.backupId,d[19])&&c.i64.eq(a.epochId,d[32])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[41]=d[42]}]):c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[19]]],"fk_secure_encrypted_backups_client_state"]),function(a){return c.i64.eq(a.backupId,d[19])&&c.blobs.eq(a.epochAnonIdBlob,d[33])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[41]=d[42]}])},function(a){return d[35]=d[41]}])},function(e){return d[36]=d[31].get("epoch_anon_id"),d[31],d[22].set(c.blobs.to_string(d[36]),d[35]),d[37]=d[31].get("encrypted_protobuf"),d[31],d[38]=d[31].get("encryption_version"),d[31],c.storedProcedure(b("LSDecryptProtobuf"),d[37],d[38],a[1],d[35]).then(function(a){return a=a,d[39]=a[0],d[40]=a[1],a})},function(e){return c.blobs.neq(d[39],void 0)?c.sequence([function(e){return d[41]=d[28].get("encrypted_protobufs"),d[28],d[42]=d[41].get("supplemental_protobufs"),d[41],d[43]=new c.Map(),d[44]=d[42].keys(),d[45]=c.i64.of_int32(d[44].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[50]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[44],d[50]).then(function(a){return a=a,d[51]=a[0],d[52]=a[1],a})},function(e){return d[53]=d[42].get(d[51]),d[42],d[53]!==void 0?c.sequence([function(a){return d[54]=d[53].get("epoch_id"),d[53],d[55]=d[53].get("epoch_anon_id"),d[53],d[56]=d[22].get(c.blobs.to_string(d[55])),d[22],d[56]!==void 0?c.resolve(d[57]=d[56]):c.sequence([function(a){return c.i64.neq(d[54],void 0)?c.sequence([function(a){return d[63]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[54]]]]),function(a){return c.i64.eq(a.backupId,d[19])&&c.i64.eq(a.epochId,d[54])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[64]=new c.Map(),d[64].set("epoch_root_key",a.epochRootKeyBlob),d[64].set("epoch_anon_id",a.epochAnonIdBlob),d[65]=(d[63].push(d[64]),d[63])})},function(a){return d[62]=d[63]}]):c.sequence([function(a){return d[63]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[19]]],"fk_secure_encrypted_backups_client_state"]),function(a){return c.i64.eq(a.backupId,d[19])&&c.blobs.eq(a.epochAnonIdBlob,d[55])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[64]=new c.Map(),d[64].set("epoch_root_key",a.epochRootKeyBlob),d[64].set("epoch_anon_id",a.epochAnonIdBlob),d[65]=(d[63].push(d[64]),d[63])})},function(a){return d[62]=d[63]}])},function(a){return d[57]=d[62]}])},function(a){return d[58]=d[53].get("epoch_anon_id"),d[53],d[22].set(c.blobs.to_string(d[58]),d[57]),d[59]=d[53].get("sk_ciphertext"),d[53],c.storedProcedure(b("LSDecryptSupplementalKey"),d[59]==null?"":d[59],d[57]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],a})},function(e){return d[60]!==void 0?c.sequence([function(e){return d[62]=d[53].get("encrypted_protobuf"),d[53],d[63]=d[53].get("encryption_version"),d[53],c.storedProcedure(b("LSDecryptProtobuf"),d[62],d[63],a[1],d[57]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],a})},function(a){return c.blobs.neq(d[64],void 0)?(d[66]=d[53].get("protobuf_timestamp_ms"),d[53],d[67]=new c.Map(),d[67].set("decrypted_protobuf",d[64]),d[67].set("protobuf_timestamp_ms",d[66]),d[43].set(d[60],d[67])):d[66]=(d[21].push(d[65]),d[21])}]):c.resolve((d[62]=new c.Map(),d[62].set("error_code",c.i64.cast([0,109])),d[62].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure"),d[62].set("error_message",""),d[63]=(d[21].push(d[62]),d[21])))}]):c.resolve()}])}):c.resolve()},function(a){return d[46]=d[28].get("otid"),d[28],d[47]=d[31].get("protobuf_timestamp_ms"),d[31],d[48]=new c.Map(),d[48].set("decrypted_protobuf",d[39]),d[48].set("protobuf_timestamp_ms",d[47]),d[49]=new c.Map(),d[49].set("otid",d[46]),d[49].set("toplevel_protobuf",d[48]),d[49].set("supplemental_protobufs",d[43]),d[50]=(d[20].push(d[49]),d[20])}]):c.resolve(d[41]=(d[21].push(d[40]),d[21]))}])}):c.resolve()},function(a){return d[24]=c.i64.of_int32(d[21].length),c.i64.gt(d[24],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[21],c.i64.cast([0,0])).then(function(a){return a=a,d[27]=a[0],d[28]=a[1],a})},function(a){return a=[void 0,d[27]],d[25]=a[0],d[26]=a[1],a}]):c.resolve((a=[d[20],void 0],d[25]=a[0],d[26]=a[1],a))},function(a){return a=[d[25],d[26]],d[15]=a[0],d[16]=a[1],a}]):c.resolve((d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,24])),d[20].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[15]=e[0],d[16]=e[1],e))},function(a){return a=[d[15],d[16]],d[2]=a[0],d[3]=a[1],a}]))})},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[8]="Finishing execution. Execution time: ",d[9]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[10]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptMessageProtobufs] ",d[7],d[8],d[7],d[9],d[7],d[10]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[11]=",",d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessageProtobufs",[d[8],d[11],d[9],d[11],d[10]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptMessageProtobufsStoredProcedure";e.exports=a}),null);
__d("LSDecryptMessageProtobufsStoredProcedure",["LSDecryptMessageProtobufs","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSDecryptMessageProtobufs")(b.encryptedMessagesWithProtobufs,b.actThreadId,a)}g["default"]=a}),98);
__d("LSSymmetricEncryptionCreateDecryptedString.nop",["Base64Utils","CryptoLogger","LSResult","LSSymmetricEncryptionCreateDecryptedData.nop","XPlatReactTextDecoder"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return c("LSResult")(a)}a=function(a,b,e,f,g){var i=d("CryptoLogger").CryptoLogger("symmetric_encryption_create_decrypted_string");g=d("Base64Utils").toArrayBuffer(g);return c("LSSymmetricEncryptionCreateDecryptedData.nop")(a,b,e,f,g).then(function(a){a=a[0];return a}).then(function(a){return a==null?h():h(new(d("XPlatReactTextDecoder").TextDecoder)().decode(a))})["catch"](function(a){d("CryptoLogger").captureError(i,a).mustfix("symmetric string decryption failed");return h()})};g["default"]=a}),98);
__d("LSDecryptMessageV2",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSIsMobileClient","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptMessageV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[8]=a[2]==null?c.i64.cast([0,0]):a[2],d[2]=c.i64.of_int32(a[3].length),c.i64.eq(d[2],c.i64.cast([0,1]))?c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[3],c.i64.cast([0,0])).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(e){return d[14]=d[12].get("epoch_anon_id"),d[12],d[15]=d[12].get("epoch_root_key"),d[12],d[16]=c.createArray(),d[26]=(d[16].push(c.i64.cast([0,32])),d[16]),c.i64.ge(d[8],c.i64.cast([0,3]))?c.resolve(d[17]=void 0):c.sequence([function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[1]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[17]=d[26]}])},function(e){return c.i64.ge(d[8],c.i64.cast([0,4]))?(d[26]="_",d[18]=["message_key_in_epoch",d[26],c.blobs.to_string(d[14]),d[26],"cipher_version",d[26],c.i64.to_string(d[8]),d[26],"thread",d[26],a[1]==null?"":a[1]].join("")):(c.i64.ge(d[8],c.i64.cast([0,3]))?(d[27]="_",d[26]=["message_key_in_epoch",d[27],c.blobs.to_string(d[14]),d[27],"cipher_version",d[27],c.i64.to_string(d[8]),d[27],"thread",d[27],a[1]==null?"":a[1]].join("")):(c.i64.ge(d[8],c.i64.cast([0,2]))?(d[28]="_",d[27]=["message_key_in_epoch",d[28],c.blobs.to_string(d[14]),d[28],"cipher_version",d[28],c.i64.to_string(d[8])].join("")):d[27]=["message_key_in_epoch","_",c.blobs.to_string(d[14])].join(""),d[26]=d[27]),d[18]=d[26]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[18]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[19],d[17],d[15],d[16]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!1:d[21]=!0,d[21]?c.resolve(d[22]=void 0):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[20],c.i64.cast([0,0])).then(function(a){return a=a,d[26]=a[0],d[27]=a[1],a})},function(a){return d[22]=d[26]}])},function(e){return c.blobs.neq(d[22],void 0)?c.sequence([function(e){return c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedString.nop"),d[22],c.blobs.of_string(["message_thread","_",a[1]].join("")),a[0]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]!==void 0?c.resolve(d[27]=d[26]):c.sequence([function(a){return d[28]=["Failed to decrypt message. Epoch Anon ID: ",c.blobs.to_string(d[14]),", Encryption Version: ",c.i64.to_string(d[8])].join(""),function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsDecryptMessageV2StoredProcedure] ","",d[28]].join("")),d[29]=c.createArray(),void 0!==void 0?d[30]=(d[29].push(void 0),d[29]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptMessageV2StoredProcedure",[d[28]].join(""),d[29],c.i64.cast([0,3]))},function(a){return d[27]=void 0}])},function(a){return d[23]=d[27]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDecryptMessageV2StoredProcedure] Decryption message key is null"),void 0!==void 0?c.sequence([function(a){return void 0!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),void 0,c.i64.cast([0,85]),c.i64.cast([0,2]),"[EncryptedBackups][LSEncryptedBackupsDecryptMessageV2StoredProcedure] Decryption message key is null",void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[27]=a[0],a})},function(a){return d[27]?d[28]=!0:d[28]=!1,d[28]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[29]=c.createArray(),void 0!==void 0?d[30]=(d[29].push(void 0),d[29]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[29],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptMessageV2StoredProcedure","Decryption message key is null",d[26],c.i64.cast([0,3]))},function(a){return d[23]=void 0}])},function(a){return d[23]!==void 0?(a=[d[23],void 0],d[24]=a[0],d[25]=a[1],a):(d[26]=new c.Map(),d[26].set("error_code",c.i64.cast([0,101])),d[26].set("stored_procedure","LSEncryptedBackupsDecryptMessageV2StoredProcedure"),d[26].set("error_message",""),a=[void 0,d[26]],d[24]=a[0],d[25]=a[1],a),a=[d[24],d[25]],d[3]=a[0],d[4]=a[1],a}]):c.resolve((d[12]=c.i64.of_int32(a[3].length),c.i64.eq(d[12],c.i64.cast([0,0]))?(d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,102])),d[15].set("stored_procedure","LSEncryptedBackupsDecryptMessageV2StoredProcedure"),d[15].set("error_message",""),e=[void 0,d[15]],d[13]=e[0],d[14]=e[1],e):(d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,103])),d[15].set("stored_procedure","LSEncryptedBackupsDecryptMessageV2StoredProcedure"),d[15].set("error_message",""),e=[void 0,d[15]],d[13]=e[0],d[14]=e[1],e),e=[d[13],d[14]],d[3]=e[0],d[4]=e[1],e))},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[9]="Finishing execution. Execution time: ",d[10]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[11]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptMessageV2] ",d[7],d[9],d[7],d[10],d[7],d[11]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[12]=",",d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessageV2",[d[9],d[12],d[10],d[12],d[11]].join(""),d[13],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[3],d[4]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptMessageV2StoredProcedure";e.exports=a}),null);
__d("LSDecryptMessages",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSDecryptMessageV2","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptMessages] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[11]=new c.Map(),d[11].set("error_code",c.i64.cast([0,1])),d[11].set("stored_procedure","LSEncryptedBackupsDecryptMessagesStoredProcedure"),d[11].set("error_message",""),g=[void 0,d[11]],d[2]=g[0],d[3]=g[1],g):(f=e.item,c.sequence([function(a){return d[19]=f.backupId,d[20]=f.deviceId,d[18]=f.backupTenancy,d[17]=f.encryptionVersion,d[11]=void 0,c.i64.neq(d[11],void 0)?c.resolve(d[12]=d[11]):c.sequence([function(a){return d[21]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[31]=(d[21].push(c.i64.cast([0,0])),d[21]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[31]=(d[21].push(c.i64.cast([0,2])),d[21]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[31]=(d[21].push(c.i64.cast([0,3])),d[21]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[25]=a[0],a})},function(a){return d[25]?d[31]=(d[21].push(c.i64.cast([0,4])),d[21]):0,d[26]=c.createArray(),d[27]=c.i64.of_int32(d[21].length),c.i64.gt(d[27],c.i64.cast([0,0]))?c.loopAsync(d[27],function(a){return d[31]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[21],d[31]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],a})},function(a){return d[34]=(d[26].push(d[32]),d[26])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[31]=c.createArray(),d[32]=c.i64.of_int32(d[26].length),c.i64.gt(d[32],c.i64.cast([0,0]))?c.loopAsync(d[32],function(a){return d[34]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[26],d[34]).then(function(a){return a=a,d[35]=a[0],d[36]=a[1],a})},function(a){return d[37]=(d[31].push(c.i64.to_string(d[35])),d[31])}])}):c.resolve()},function(a){return d[33]=d[31].join(","),d[28]=d[33]}])},function(a){return d[26].some(function(a){return c.i64.eq(d[17],a)})?d[29]=d[17]:d[29]=void 0,c.i64.neq(d[29],void 0)?d[30]=d[29]:d[30]=void 0,d[12]=d[30]}])},function(e){return c.i64.neq(d[12],void 0)?d[13]=d[12]:d[13]=c.i64.cast([0,0]),c.i64.neq(d[18],void 0)?d[14]=d[18]:d[14]=c.i64.cast([0,1]),c.i64.neq(d[20],void 0)?c.sequence([function(e){return d[21]=c.createArray(),d[22]=c.createArray(),d[23]=new c.Map(),d[24]=c.i64.of_int32(a[0].length),c.i64.gt(d[24],c.i64.cast([0,0]))?c.loopAsync(d[24],function(e){return d[28]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[28]).then(function(a){return a=a,d[29]=a[0],d[30]=a[1],a})},function(a){return d[31]=d[29].get("epoch_anon_id"),d[29],d[32]=d[23].get(c.blobs.to_string(d[31])),d[23],d[32]!==void 0?c.resolve(d[33]=d[32]):c.sequence([function(a){return d[38]=d[29].get("epoch_anon_id"),d[29],d[39]=d[29].get("epoch_id"),d[29],c.i64.neq(d[39],void 0)?c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[39]]]]),function(a){return c.i64.eq(a.backupId,d[19])&&c.i64.eq(a.epochId,d[39])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[40]=d[42]}]):c.sequence([function(a){return d[42]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch([[[d[19]]],"fk_secure_encrypted_backups_client_state"]),function(a){return c.i64.eq(a.backupId,d[19])&&c.blobs.eq(a.epochAnonIdBlob,d[38])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[43]=new c.Map(),d[43].set("epoch_root_key",a.epochRootKeyBlob),d[43].set("epoch_anon_id",a.epochAnonIdBlob),d[44]=(d[42].push(d[43]),d[42])})},function(a){return d[40]=d[42]}])},function(a){return d[41]=c.i64.of_int32(d[40].length),c.i64.gt(d[41],c.i64.cast([0,0]))?(d[42]=d[29].get("epoch_anon_id"),d[29],d[23].set(c.blobs.to_string(d[42]),d[40])):0,d[33]=d[40]}])},function(e){return d[34]=d[29].get("value"),d[29],d[35]=d[29].get("encryption_version"),d[29],c.storedProcedure(b("LSDecryptMessageV2"),d[34],a[1],d[35],d[33]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(a){return d[36]!==void 0?c.resolve((d[38]=d[29].get("otid"),d[29],d[39]=new c.Map(),d[39].set("value",d[36]),d[39].set("otid",d[38]),d[40]=(d[21].push(d[39]),d[21]))):c.sequence([function(a){return d[37]!==void 0?c.sequence([function(a){return d[38]=c.i64.of_int32(d[33].length),c.i64.gt(d[38],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[33],c.i64.cast([0,0])).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[51]=d[49].get("epoch_root_key"),d[49],d[52]=c.createArray(),d[57]=(d[52].push(c.i64.cast([0,18])),d[52]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[51],d[52]).then(function(a){return a=a,d[53]=a[0],a})},function(a){return d[53]!==void 0?c.sequence([function(a){return d[57]=c.i64.of_int32(d[53].length),c.i64.ge(d[57],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[53],c.i64.cast([0,0])).then(function(a){return a=a,d[59]=a[0],d[60]=a[1],a})},function(a){return d[58]=d[59]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[59]=c.createArray(),void 0!==void 0?d[60]=(d[59].push(void 0),d[59]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[59],c.i64.cast([0,3]))},function(a){return d[58]=void 0}])},function(a){return d[54]=d[58]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[57]=c.createArray(),void 0!==void 0?d[58]=(d[57].push(void 0),d[57]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[57],c.i64.cast([0,3]))},function(a){return d[54]=void 0}])},function(a){return c.blobs.neq(d[54],void 0)?d[55]=!0:d[55]=!1,d[55]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.neq(d[54],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[54]).then(function(a){return a=a,d[57]=a[0],a})},function(a){return d[56]=d[57]==null?"[encodingFailed]":d[57]}]):c.resolve(d[56]="[null]")},function(a){return d[39]=d[56]}]):c.resolve(d[39]="[noEpochs]")},function(a){return d[40]=d[29].get("otid"),d[29],d[41]=d[29].get("epoch_anon_id"),d[29],d[42]=d[29].get("encryption_version"),d[29],c.i64.neq(d[42],void 0)?d[43]=c.i64.to_string(d[42]):d[43]="null",d[44]=c.i64.of_int32(d[33].length),d[45]=d[29].get("epoch_fingerprint"),d[29],c.blobs.neq(d[45],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[46]=d[49]==null?"[encodingFailed]":d[49]}]):c.resolve(d[46]="[null]")},function(a){return d[47]=d[29].get("backup_id"),d[29],d[48]="",d[37].set("error_message",["Decryption failed for message with otid:",d[48],d[40],d[48]," epoch:",d[48],c.blobs.to_string(d[41]),d[48]," version:",d[48],d[43],d[48]," epoch_key_count:",d[48],c.i64.to_string(d[44]),d[48]," vsr_fingerprint:",d[48],d[46],d[48]," local_fingerprint:",d[48],d[39],d[48]," vsr_backup_id:",d[48],c.i64.to_string(d[47])==null?"[null]":c.i64.to_string(d[47]),d[48]," local_backup_id:",d[48],c.i64.to_string(d[19]),d[48]," local_device_id:",d[48],c.i64.to_string(d[20])].join(""))}]):c.resolve()},function(a){return d[38]=(d[22].push(d[37]),d[22])}])}])}):c.resolve()},function(a){return d[25]=c.i64.of_int32(d[22].length),c.i64.gt(d[25],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[22],c.i64.cast([0,0])).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],a})},function(a){return a=[void 0,d[28]],d[26]=a[0],d[27]=a[1],a}]):c.resolve((a=[d[21],void 0],d[26]=a[0],d[27]=a[1],a))},function(a){return a=[d[26],d[27]],d[15]=a[0],d[16]=a[1],a}]):c.resolve((d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,24])),d[21].set("stored_procedure","LSEncryptedBackupsDecryptMessagesStoredProcedure"),d[21].set("error_message",""),e=[void 0,d[21]],d[15]=e[0],d[16]=e[1],e))},function(a){return a=[d[15],d[16]],d[2]=a[0],d[3]=a[1],a}]))})},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[8]="Finishing execution. Execution time: ",d[9]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[10]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptMessages] ",d[7],d[8],d[7],d[9],d[7],d[10]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[11]=",",d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessages",[d[8],d[11],d[9],d[11],d[10]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptMessagesStoredProcedure";e.exports=a}),null);
__d("LSDecryptMessagesStoredProcedure",["LSDecryptMessages","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSDecryptMessages")(b.encryptedMessages,b.actThreadId,a)}g["default"]=a}),98);
__d("LSGetNextEpochAnonId.nop",["CryptoLogger","LSCryptoUtils","LSResult","Promise","XPlatReactTextDecoder"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e,f){a=d("LSCryptoUtils").strToBuf("0");if(f!=null){e=f;if(e.byteLength===0)f=a;else{var g=new(d("XPlatReactTextDecoder").TextDecoder)();g=g.decode(e);e=Number.parseInt(g,10);g=e+1;f=d("LSCryptoUtils").strToBuf(String(g))}}else f=a;return(h||(h=b("Promise"))).resolve(c("LSResult")(f))["catch"](function(a){d("CryptoLogger").captureError(d("CryptoLogger").CryptoLogger("get_next_epoch_anonid"),a).mustfix("Getting next epoch anon id failed");throw a})};g["default"]=a}),98);
__d("PublicKeyEncryptionUtils",["Promise","UInt8Array","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){}function c(a){if(a!=null)return a;else return new Uint8Array(0).buffer}function e(a,b,c,e,f){return d("UInt8Array").concatBytes([a,b,c,e,f]).buffer}function f(a,b,c,e){return d("XPlatReactCrypto").subtleImportKey("raw",a.buffer,"HKDF",!1,["deriveKey"]).then(function(a){return d("XPlatReactCrypto").subtleDeriveKey({hash:"SHA-256",info:c,name:"HKDF",salt:b},a,{length:256,name:"AES-GCM"},!1,[e])})}var i="key length is not "+32;function j(a,b){if(a.length!==32)return b(i)}function k(a){return new(h||(h=b("Promise")))(function(b,c){j(a,c);return b()})}var l=32;g.assertValidCurvePoint=a;g.getSalt=c;g.concatAad=e;g.getAesKey=f;g.testKeyLength=j;g.assertKeyLength=k;g.keyLength=l}),98);
__d("LSPublicEncryptionCreateDecryptedData.nop",["CryptoLogger","Promise","PublicKeyEncryptionUtils","RetUtil","XPlatReactCrypto","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("PublicKeyCrypto").__setRef("LSPublicEncryptionCreateDecryptedData.nop"),j=c("requireDeferred")("X25519").__setRef("LSPublicEncryptionCreateDecryptedData.nop");function k(a,b){var c=1+d("PublicKeyEncryptionUtils").keyLength+16;a=a.length;a<1+d("PublicKeyEncryptionUtils").keyLength+16&&b("CipherText length is "+a+", < "+c)}function l(a,b,c){b=b[0];if(b!==a)return c("Unexpected version "+b)}function m(a){return new(h||(h=b("Promise")))(function(b,c){l(1,a,c);k(a,c);return b()})}function n(a,c){return new(h||(h=b("Promise")))(function(b,e){d("PublicKeyEncryptionUtils").assertValidCurvePoint(a,e);d("PublicKeyEncryptionUtils").assertValidCurvePoint(c,e);return b()})}a=function(a,c,e,f,g,k,l,o){var p=new Uint8Array(l),q=new Uint8Array([1]),r=d("PublicKeyEncryptionUtils").getSalt(k),s=new Uint8Array(e),t=new Uint8Array(g),u=new Uint8Array(f),v=new Uint8Array(o);return(h||(h=b("Promise"))).all([d("PublicKeyEncryptionUtils").assertKeyLength(s),d("PublicKeyEncryptionUtils").assertKeyLength(u),d("PublicKeyEncryptionUtils").assertKeyLength(t)]).then(function(){return m(v)}).then(function(){return j.load()}).then(function(a){var c=v.slice(1,d("PublicKeyEncryptionUtils").keyLength+1),e=a.publicKeyFromBytes(c,a.KeyPurpose.Encryption);return n(e,t).then(function(){var f=d("PublicKeyEncryptionUtils").concatAad(q,t,s,c,p),g=function(c,d,f){c=a.publicKeyFromBytes(c,a.KeyPurpose.Encryption);d=a.publicKeyFromBytes(d,a.KeyPurpose.Encryption);f=a.secretKeyFromBytes(f,a.KeyPurpose.Encryption);return c==null||d==null||f==null||e==null?(h||(h=b("Promise"))).resolve():(h||(h=b("Promise"))).resolve([c,d,f,e])};return g(s,t,u).then(function(a){if(a==null)return;return{ephemeralPub:a[3],innerAad:f,receiverPriv:a[2],receiverPub:a[0],senderPub:a[1]}})})}).then(function(a){if(a==null)return;var b=a.ephemeralPub,c=a.receiverPriv,e=a.senderPub,f=a.innerAad;return i.load().then(function(a){return a.receiverDeriveSharedSecret(c,b,e)}).then(function(a){if(a==null)return null;else return d("PublicKeyEncryptionUtils").getAesKey(a,r,f,"decrypt")}).then(function(a){if(a==null)return;var b=new Uint8Array(12).buffer,c=v.slice(d("PublicKeyEncryptionUtils").keyLength+1).buffer;return d("XPlatReactCrypto").subtleDecrypt({additionalData:f,iv:new Uint8Array(b),name:"AES-GCM",tagLength:128},a,c)})}).then(function(a){return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(a))})["catch"](function(a){var c=d("CryptoLogger").CryptoLogger("public_encryption_create_decrypted_data");d("CryptoLogger").captureError(c,a).mustfix("Creation of decrypted data for public encryption failed");return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(void 0))})};g["default"]=a}),98);
__d("LSDeriveAndStoreEpochs",["LSArrayGetObjectAt","LSBase64Decode.nop","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSGetNextEpochAnonId.nop","LSIsEncryptionVersionSecure","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSPublicEncryptionCreateDecryptedData.nop","LSSymmetricEncryptionCreateDecryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] Beginning execution."),d[1]=c.i64.of_int32(a[0].length),c.i64.gt(d[1],c.i64.cast([0,0]))?c.sequence([function(e){return d[8]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] Unable to load client state: 1"),d[21]=c.createArray(),void 0!==void 0?d[24]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure","Unable to load client state: 1",d[21],c.i64.cast([0,3]))},function(e){return d[22]=c.createArray(),d[23]=c.i64.of_int32(a[0].length),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(e){return d[24]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[24]).then(function(a){return a=a,d[25]=a[0],d[26]=a[1],a})},function(a){return d[27]=d[25].get("from_epoch"),d[25],d[28]=d[27].get("epoch_anon_id"),d[27],c.nativeOperation(b("LSBase64Encode.nop"),d[28]).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[29]!==void 0?d[30]=d[29]:d[30]="",d[31]=d[25].get("from_epoch"),d[25],d[32]=d[31].get("epoch_id"),d[31],d[33]=new c.Map(),d[33].set("anon_id",d[30]),d[33].set("epoch_id",d[32]),d[34]=d[25].get("to_epoch"),d[25],d[35]=d[34].get("epoch_anon_id"),d[34],c.nativeOperation(b("LSBase64Encode.nop"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]!==void 0?d[37]=d[36]:d[37]="",d[38]=d[25].get("to_epoch"),d[25],d[39]=d[38].get("epoch_id"),d[38],d[40]=new c.Map(),d[40].set("anon_id",d[37]),d[40].set("epoch_id",d[39]),d[41]=d[25].get("forward_edge"),d[25],d[41]?d[42]=!1:d[42]=!0,d[42]?d[43]=!1:d[43]=!0,d[44]=d[25].get("backward_edge"),d[25],c.blobs.neq(d[44],void 0)?d[45]=!0:d[45]=!1,d[46]=new c.Map(),d[46].set("from",d[33]),d[46].set("to",d[40]),d[46].set("has_forward_edge",d[43]),d[46].set("has_backward_edge",d[45]),d[46].set("result_code",c.i64.cast([0,7])),d[46].set("error_message",void 0),d[47]=(d[22].push(d[46]),d[22])}])}):c.resolve()},function(b){return b=[void 0,void 0,void 0,a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[22]],d[9]=b[0],d[10]=b[1],d[11]=b[2],d[12]=b[3],d[13]=b[4],d[14]=b[5],d[15]=b[6],b}]):(f=e.item,c.sequence([function(a){return d[35]=f.epochStoragePublicKeyBlob,d[34]=f.deviceId,d[33]=f.backupTenancy,d[32]=f.encryptionVersion,d[21]=void 0,c.i64.neq(d[21],void 0)?c.resolve(d[22]=d[21]):c.sequence([function(a){return d[36]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[46]=(d[36].push(c.i64.cast([0,0])),d[36]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[38]?d[46]=(d[36].push(c.i64.cast([0,2])),d[36]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[39]=a[0],a})},function(a){return d[39]?d[46]=(d[36].push(c.i64.cast([0,3])),d[36]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[40]=a[0],a})},function(a){return d[40]?d[46]=(d[36].push(c.i64.cast([0,4])),d[36]):0,d[41]=c.createArray(),d[42]=c.i64.of_int32(d[36].length),c.i64.gt(d[42],c.i64.cast([0,0]))?c.loopAsync(d[42],function(a){return d[46]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[36],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=(d[41].push(d[47]),d[41])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[46]=c.createArray(),d[47]=c.i64.of_int32(d[41].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[49]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[41],d[49]).then(function(a){return a=a,d[50]=a[0],d[51]=a[1],a})},function(a){return d[52]=(d[46].push(c.i64.to_string(d[50])),d[46])}])}):c.resolve()},function(a){return d[48]=d[46].join(","),d[43]=d[48]}])},function(a){return d[41].some(function(a){return c.i64.eq(d[32],a)})?d[44]=d[32]:d[44]=void 0,c.i64.neq(d[44],void 0)?d[45]=d[44]:d[45]=void 0,d[22]=d[45]}])},function(e){return c.i64.neq(d[22],void 0)?d[23]=d[22]:d[23]=c.i64.cast([0,0]),c.i64.neq(d[33],void 0)?d[24]=d[33]:d[24]=c.i64.cast([0,1]),c.i64.neq(d[34],void 0)?c.sequence([function(b){return c.i64.neq(a[1],void 0)?c.sequence([function(b){return c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}).next().then(function(e,f){var b=e.done;e=e.value;return b?d[44]=!1:(f=e.item,d[47]=f.deviceId,c.i64.neq(d[47],void 0)?d[46]=c.i64.neq(d[47],a[1]):d[46]=!1,d[44]=d[46])})},function(a){return d[36]=d[44]}]):c.resolve(d[36]=!1)},function(e){return d[36]?c.sequence([function(e){return d[44]=c.createArray(),d[45]=c.i64.of_int32(a[0].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[46]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=d[47].get("from_epoch"),d[47],d[50]=d[49].get("epoch_anon_id"),d[49],c.nativeOperation(b("LSBase64Encode.nop"),d[50]).then(function(a){return a=a,d[51]=a[0],a})},function(a){return d[51]!==void 0?d[52]=d[51]:d[52]="",d[53]=d[47].get("from_epoch"),d[47],d[54]=d[53].get("epoch_id"),d[53],d[55]=new c.Map(),d[55].set("anon_id",d[52]),d[55].set("epoch_id",d[54]),d[56]=d[47].get("to_epoch"),d[47],d[57]=d[56].get("epoch_anon_id"),d[56],c.nativeOperation(b("LSBase64Encode.nop"),d[57]).then(function(a){return a=a,d[58]=a[0],a})},function(a){return d[58]!==void 0?d[59]=d[58]:d[59]="",d[60]=d[47].get("to_epoch"),d[47],d[61]=d[60].get("epoch_id"),d[60],d[62]=new c.Map(),d[62].set("anon_id",d[59]),d[62].set("epoch_id",d[61]),d[63]=d[47].get("forward_edge"),d[47],d[63]?d[64]=!1:d[64]=!0,d[64]?d[65]=!1:d[65]=!0,d[66]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[66],void 0)?d[67]=!0:d[67]=!1,d[68]=new c.Map(),d[68].set("from",d[55]),d[68].set("to",d[62]),d[68].set("has_forward_edge",d[65]),d[68].set("has_backward_edge",d[67]),d[68].set("result_code",c.i64.cast([0,8])),d[68].set("error_message",void 0),d[69]=(d[44].push(d[68]),d[44])}])}):c.resolve()},function(b){return b=[d[34],d[34],a[1],a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[44]],d[37]=b[0],d[38]=b[1],d[39]=b[2],d[40]=b[3],d[41]=b[4],d[42]=b[5],d[43]=b[6],b}]):c.sequence([function(e){return d[44]=c.createArray(),d[45]=c.i64.of_int32(a[0].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[46]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=d[47].get("from_epoch"),d[47],d[50]=d[49].get("epoch_id"),d[49],c.count(c.db.table(169).fetch([[[d[50]]]])).then(function(a){return d[51]=a})},function(a){return c.i64.le(d[51],c.i64.cast([0,1]))?c.sequence([function(a){return c.db.table(169).fetch([[[d[50]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[77]=new c.Map(),d[77].set("error_msg","Expected a nonempty query result"),d[77].set("code",c.i64.cast([0,3])),d[77].set("src_line","MEBEpochClientUtils.php:69 MEBEpochClientUtils::maybeEpoch()"),d[78]=c.createArray(),d[79]=(d[78].push(d[77]),d[78]),a=[void 0,d[78]],d[73]=a[0],d[74]=a[1],a):(e=b.item,d[77]=new c.Map(),d[77].set("epoch_id",e.epochId),d[77].set("backup_id",e.backupId),d[77].set("epoch_anon_id_blob",e.epochAnonIdBlob),d[77].set("epoch_root_key_blob",e.epochRootKeyBlob),d[77].set("epoch_status",e.epochStatus),d[77].set("authority_level",e.authorityLevel),a=[d[77],void 0],d[73]=a[0],d[74]=a[1],a)})},function(a){return d[76]=new c.Map(),d[76].set("value",d[73]),d[76].set("errors",d[74]),d[52]=d[76]}]):c.resolve((d[73]=new c.Map(),d[73].set("error_msg","Expected at most one result"),d[73].set("code",c.i64.cast([0,4])),d[73].set("src_line","MEBEpochClientUtils.php:69 MEBEpochClientUtils::maybeEpoch()"),d[74]=c.createArray(),d[76]=(d[74].push(d[73]),d[74]),d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[74]),d[52]=d[75]))},function(a){return d[53]=d[52].get("value"),d[52],d[53]!==void 0?(d[73]=d[53].get("epoch_id"),d[53],d[74]=d[53].get("backup_id"),d[53],d[75]=d[53].get("epoch_anon_id_blob"),d[53],d[76]=d[53].get("epoch_root_key_blob"),d[53],d[77]=d[53].get("epoch_status"),d[53],d[78]=d[53].get("authority_level"),d[53],d[54]=d[52]):(d[73]=d[52].get("errors"),d[52],d[74]=d[52].get("errors"),d[52],d[75]=new c.Map(),d[75].set("error_msg","EB_EPOCH_SRC_EPOCH_MISSING"),d[75].set("code",c.i64.cast([0,10003])),d[75].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:372 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge()"),d[77]=(d[73].push(d[75]),d[73]),d[76]=new c.Map(),d[76].set("value",void 0),d[76].set("errors",d[73]),d[54]=d[76]),d[55]=d[54].get("value"),d[54],d[55]!==void 0?(d[73]=d[55].get("epoch_id"),d[55],d[74]=d[55].get("backup_id"),d[55],d[75]=d[55].get("epoch_anon_id_blob"),d[55],d[76]=d[55].get("epoch_root_key_blob"),d[55],d[77]=d[55].get("epoch_status"),d[55],d[78]=d[55].get("authority_level"),d[55],d[79]=d[47].get("from_epoch"),d[47],d[80]=d[79].get("epoch_anon_id"),d[79],c.blobs.eq(d[80],d[75])?d[81]=d[54]:(d[82]=new c.Map(),d[82].set("error_msg","EB_EPOCH_DERIVATION_SRC_ANON_ID_MISMATCH"),d[82].set("code",c.i64.cast([0,10007])),d[82].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:377 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#2()"),d[83]=c.createArray(),d[85]=(d[83].push(d[82]),d[83]),d[84]=new c.Map(),d[84].set("value",void 0),d[84].set("errors",d[83]),d[81]=d[84]),d[56]=d[81]):(d[73]=d[54].get("errors"),d[54],d[74]=d[54].get("errors"),d[54],d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[73]),d[56]=d[75]),d[57]=d[56].get("value"),d[56],d[57]!==void 0?c.sequence([function(a){return d[73]=d[57].get("epoch_id"),d[57],d[74]=d[57].get("backup_id"),d[57],d[75]=d[57].get("epoch_anon_id_blob"),d[57],d[76]=d[57].get("epoch_root_key_blob"),d[57],d[77]=d[57].get("epoch_status"),d[57],d[78]=d[57].get("authority_level"),d[57],d[79]=d[47].get("from_epoch_fingerprint"),d[47],d[80]=c.createArray(),d[85]=(d[80].push(c.i64.cast([0,18])),d[80]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[76],d[80]).then(function(a){return a=a,d[81]=a[0],a})},function(a){return d[81]!==void 0?c.sequence([function(a){return d[85]=c.i64.of_int32(d[81].length),c.i64.ge(d[85],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[81],c.i64.cast([0,0])).then(function(a){return a=a,d[87]=a[0],d[88]=a[1],a})},function(a){return d[86]=d[87]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[87]=c.createArray(),void 0!==void 0?d[88]=(d[87].push(void 0),d[87]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[87],c.i64.cast([0,3]))},function(a){return d[86]=void 0}])},function(a){return d[82]=d[86]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[85]=c.createArray(),void 0!==void 0?d[86]=(d[85].push(void 0),d[85]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[85],c.i64.cast([0,3]))},function(a){return d[82]=void 0}])},function(a){return c.blobs.neq(d[82],void 0)?d[83]=!0:d[83]=!1,d[83]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.eq(d[79],void 0)||c.blobs.eq(d[79],d[82])?d[84]=d[56]:(d[85]=new c.Map(),d[85].set("error_msg","EB_EPOCH_DERIVATION_SRC_FINGERPRINT_MISMATCH"),d[85].set("code",c.i64.cast([0,10002])),d[85].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:386 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#4()"),d[86]=c.createArray(),d[88]=(d[86].push(d[85]),d[86]),d[87]=new c.Map(),d[87].set("value",void 0),d[87].set("errors",d[86]),d[84]=d[87]),d[58]=d[84]}]):c.resolve((d[73]=d[56].get("errors"),d[56],d[74]=d[56].get("errors"),d[56],d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[73]),d[58]=d[75]))},function(a){return d[59]=d[47].get("forward_edge"),d[47],d[59]!==void 0?c.sequence([function(a){return d[73]=d[58].get("value"),d[58],d[73]!==void 0?c.sequence([function(a){return d[87]=d[73].get("epoch_id"),d[73],d[88]=d[73].get("backup_id"),d[73],d[89]=d[73].get("epoch_anon_id_blob"),d[73],d[90]=d[73].get("epoch_root_key_blob"),d[73],d[91]=d[73].get("epoch_status"),d[73],d[92]=d[73].get("authority_level"),d[73],c.nativeOperation(b("LSGetNextEpochAnonId.nop"),d[89]).then(function(a){return a=a,d[93]=a[0],a})},function(a){return d[94]=d[47].get("to_epoch"),d[47],d[95]=d[94].get("epoch_anon_id"),d[94],c.blobs.eq(d[93],d[95])?d[96]=d[58]:(d[97]=new c.Map(),d[97].set("error_msg","EB_EPOCH_FORWARD_EDGE_NOT_CONSECUTIVE"),d[97].set("code",c.i64.cast([0,10009])),d[97].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:104 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge()"),d[98]=c.createArray(),d[100]=(d[98].push(d[97]),d[98]),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[98]),d[96]=d[99]),d[74]=d[96]}]):c.resolve((d[87]=d[58].get("errors"),d[58],d[88]=d[58].get("errors"),d[58],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[74]=d[89]))},function(a){return d[75]=d[74].get("value"),d[74],d[75]!==void 0?c.sequence([function(a){return d[87]=d[75].get("epoch_id"),d[75],d[88]=d[75].get("backup_id"),d[75],d[89]=d[75].get("epoch_anon_id_blob"),d[75],d[90]=d[75].get("epoch_root_key_blob"),d[75],d[91]=d[75].get("epoch_status"),d[75],d[92]=d[75].get("authority_level"),d[75],d[93]=d[47].get("from_epoch"),d[47],d[94]=d[93].get("epoch_anon_id"),d[93],d[95]=d[47].get("from_epoch"),d[47],d[96]=d[95].get("epoch_id"),d[95],d[97]=c.createArray(),d[106]=(d[97].push(c.i64.cast([0,32])),d[97]),d[106]=(d[97].push(c.i64.cast([0,32])),d[97]),d[98]="_",c.nativeOperation(b("LSGetBlobFromString.nop"),["epoch_chaining",d[98],c.blobs.to_string(d[94]),d[98],c.i64.to_string(d[96])].join("")).then(function(a){return a=a,d[99]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[99],void 0,d[90],d[97]).then(function(a){return a=a,d[100]=a[0],a})},function(a){return d[100]?d[101]=!1:d[101]=!0,d[101]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Failed to generate epoch_chaining_key and epoch_distribution_pre_shared_key."),d[106]=c.createArray(),void 0!==void 0?d[109]=(d[106].push(void 0),d[106]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Failed to generate epoch_chaining_key and epoch_distribution_pre_shared_key.",d[106],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[107]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[108]=a[0],a})},function(a){return a=[d[107],d[108]],d[102]=a[0],d[103]=a[1],a}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[100],c.i64.cast([0,0])).then(function(a){return a=a,d[106]=a[0],d[107]=a[1],a})},function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[100],c.i64.cast([0,1])).then(function(a){return a=a,d[108]=a[0],d[109]=a[1],a})},function(a){return a=[d[106],d[108]],d[102]=a[0],d[103]=a[1],a}])},function(a){return d[104]=new c.Map(),d[104].set("epoch_chaining_key",d[102]),d[104].set("epoch_distribution_pre_shared_key",d[103]),d[105]=new c.Map(),d[105].set("value",d[104]),d[105].set("errors",void 0),d[76]=d[105]}]):c.resolve((d[87]=d[74].get("errors"),d[74],d[88]=d[74].get("errors"),d[74],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[76]=d[89]))},function(a){return d[77]=d[76].get("value"),d[76],d[77]!==void 0?c.sequence([function(a){return d[87]=d[77].get("epoch_chaining_key"),d[77],d[88]=d[77].get("epoch_distribution_pre_shared_key"),d[77],d[89]=d[59].get("psk_fingerprint"),d[59],d[90]=c.createArray(),d[95]=(d[90].push(c.i64.cast([0,18])),d[90]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkNyeXB0b1ByZVNoYXJlZEtleQ=="),void 0,d[88],d[90]).then(function(a){return a=a,d[91]=a[0],a})},function(a){return d[91]!==void 0?c.sequence([function(a){return d[95]=c.i64.of_int32(d[91].length),c.i64.ge(d[95],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[91],c.i64.cast([0,0])).then(function(a){return a=a,d[97]=a[0],d[98]=a[1],a})},function(a){return d[96]=d[97]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[97]=c.createArray(),void 0!==void 0?d[98]=(d[97].push(void 0),d[97]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[97],c.i64.cast([0,3]))},function(a){return d[96]=void 0}])},function(a){return d[92]=d[96]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[95]=c.createArray(),void 0!==void 0?d[96]=(d[95].push(void 0),d[95]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[95],c.i64.cast([0,3]))},function(a){return d[92]=void 0}])},function(a){return c.blobs.neq(d[92],void 0)?d[93]=!0:d[93]=!1,d[93]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.eq(d[89],void 0)||c.blobs.eq(d[89],d[92])?d[94]=d[76]:(d[95]=new c.Map(),d[95].set("error_msg","EB_EPOCH_DERIVATION_PSK_FINGERPRINT_MISMATCH"),d[95].set("code",c.i64.cast([0,10005])),d[95].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:130 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#4()"),d[96]=c.createArray(),d[98]=(d[96].push(d[95]),d[96]),d[97]=new c.Map(),d[97].set("value",void 0),d[97].set("errors",d[96]),d[94]=d[97]),d[78]=d[94]}]):c.resolve((d[87]=d[76].get("errors"),d[76],d[88]=d[76].get("errors"),d[76],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[78]=d[89]))},function(a){return d[79]=d[78].get("value"),d[78],d[79]!==void 0?(d[87]=d[79].get("epoch_chaining_key"),d[79],d[88]=d[79].get("epoch_distribution_pre_shared_key"),d[79],d[89]=d[59].get("epoch_storage_public_key"),d[59],c.blobs.eq(d[89],void 0)||c.blobs.eq(d[89],d[35])?d[90]=d[78]:(d[91]=new c.Map(),d[91].set("error_msg","EB_EPOCH_DERIVATION_STORAGE_KEY_MISMATCH"),d[91].set("code",c.i64.cast([0,10006])),d[91].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:144 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#7()"),d[92]=c.createArray(),d[94]=(d[92].push(d[91]),d[92]),d[93]=new c.Map(),d[93].set("value",void 0),d[93].set("errors",d[92]),d[90]=d[93]),d[80]=d[90]):(d[87]=d[78].get("errors"),d[78],d[88]=d[78].get("errors"),d[78],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[80]=d[89]),d[81]=d[80].get("value"),d[80],d[81]!==void 0?c.sequence([function(a){return d[87]=d[81].get("epoch_chaining_key"),d[81],d[88]=d[81].get("epoch_distribution_pre_shared_key"),d[81],d[89]=d[59].get("auth_public_key"),d[59],d[90]=d[47].get("to_epoch"),d[47],d[91]=d[90].get("epoch_anon_id"),d[90],d[92]=d[59].get("encrypted_entropy"),d[59],c.nativeOperation(b("LSPublicEncryptionCreateDecryptedData.nop"),d[35],f.epochStoragePrivateKeyBlob,d[89],d[88],c.blobs.of_string(["epoch_","_",c.blobs.to_string(d[91])].join("")),d[92]).then(function(a){return a=a,d[93]=a[0],a})},function(a){return c.blobs.neq(d[93],void 0)?c.resolve(d[94]=d[93]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Couldn't decrypt epoch key. Returning null entropy"),d[100]=c.createArray(),void 0!==void 0?d[101]=(d[100].push(void 0),d[100]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Couldn't decrypt epoch key. Returning null entropy",d[100],c.i64.cast([0,3]))},function(a){return d[94]=void 0}])},function(a){return c.blobs.neq(d[94],void 0)?(d[100]=new c.Map(),d[100].set("entropy",d[94]),d[101]=new c.Map(),d[101].set("value",d[100]),d[101].set("errors",void 0),d[102]=d[101].get("value"),d[101],d[103]=d[101].get("errors"),d[101],a=[d[102],d[103]],d[95]=a[0],d[96]=a[1],a):(d[100]=c.createArray(),c.blobs.eq(d[94],void 0)?d[107]=(d[100].push("entropy"),d[100]):0,d[101]=d[100].join(", "),d[102]=new c.Map(),d[102].set("error_msg",["The following required nullables are null: ","",d[101]].join("")),d[102].set("code",c.i64.cast([0,2])),d[102].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:169 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#11()"),d[103]=c.createArray(),d[107]=(d[103].push(d[102]),d[103]),d[104]=new c.Map(),d[104].set("value",void 0),d[104].set("errors",d[103]),d[105]=d[104].get("value"),d[104],d[106]=d[104].get("errors"),d[104],a=[d[105],d[106]],d[95]=a[0],d[96]=a[1],a),d[97]=new c.Map(),d[97].set("value",d[95]),d[97].set("errors",d[96]),d[98]=d[97].get("value"),d[97],d[98]!==void 0?(d[100]=d[98].get("entropy"),d[98],d[99]=d[97]):(d[100]=d[97].get("errors"),d[97],d[101]=d[97].get("errors"),d[97],d[102]=new c.Map(),d[102].set("error_msg","EB_EPOCH_FORWARD_DECRYPTION_FAILED"),d[102].set("code",c.i64.cast([0,10004])),d[102].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:171 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processForwardEdge#10()"),d[104]=(d[100].push(d[102]),d[100]),d[103]=new c.Map(),d[103].set("value",void 0),d[103].set("errors",d[100]),d[99]=d[103]),d[82]=d[99]}]):c.resolve((d[87]=d[80].get("errors"),d[80],d[88]=d[80].get("errors"),d[80],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[82]=d[89]))},function(a){return d[83]=d[80].get("value"),d[80],d[83]!==void 0?c.sequence([function(a){return d[87]=d[83].get("epoch_chaining_key"),d[83],d[88]=d[83].get("epoch_distribution_pre_shared_key"),d[83],d[89]=d[82].get("value"),d[82],d[89]!==void 0?c.sequence([function(a){return d[91]=d[89].get("entropy"),d[89],d[92]=c.createArray(),d[99]=(d[92].push(c.i64.cast([0,32])),d[92]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key").then(function(a){return a=a,d[93]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[93],d[87],d[91],d[92]).then(function(a){return a=a,d[94]=a[0],a})},function(a){return d[94]?d[95]=!1:d[95]=!0,d[95]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Unable to generate epoch root key."),d[99]=c.createArray(),void 0!==void 0?d[101]=(d[99].push(void 0),d[99]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Unable to generate epoch root key.",d[99],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[100]=a[0],a})},function(a){return d[96]=d[100]}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[94],c.i64.cast([0,0])).then(function(a){return a=a,d[99]=a[0],d[100]=a[1],a})},function(a){return d[96]=d[99]}])},function(a){return d[97]=new c.Map(),d[97].set("root_key",d[96]),d[98]=new c.Map(),d[98].set("value",d[97]),d[98].set("errors",void 0),d[90]=d[98]}]):c.resolve((d[91]=d[82].get("errors"),d[82],d[92]=d[82].get("errors"),d[82],d[93]=new c.Map(),d[93].set("value",void 0),d[93].set("errors",d[91]),d[90]=d[93]))},function(a){return d[84]=d[90]}]):c.resolve((d[87]=d[80].get("errors"),d[80],d[88]=d[80].get("errors"),d[80],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[84]=d[89]))},function(a){return d[85]=d[84].get("value"),d[84],d[86]=d[84].get("errors"),d[84],a=[d[85],d[86]],d[60]=a[0],d[61]=a[1],a}]):c.sequence([function(a){return d[73]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[73],void 0)?c.sequence([function(a){return d[79]=d[58].get("value"),d[58],d[79]!==void 0?c.sequence([function(a){return d[87]=d[79].get("epoch_id"),d[79],d[88]=d[79].get("backup_id"),d[79],d[89]=d[79].get("epoch_anon_id_blob"),d[79],d[90]=d[79].get("epoch_root_key_blob"),d[79],d[91]=d[79].get("epoch_status"),d[79],d[92]=d[79].get("authority_level"),d[79],d[93]=d[47].get("to_epoch"),d[47],d[94]=d[93].get("epoch_anon_id"),d[93],c.nativeOperation(b("LSGetNextEpochAnonId.nop"),d[94]).then(function(a){return a=a,d[95]=a[0],a})},function(a){return c.blobs.eq(d[95],d[89])?d[96]=d[58]:(d[97]=new c.Map(),d[97].set("error_msg","EB_EPOCH_BACKWARD_EDGE_NOT_CONSECUTIVE"),d[97].set("code",c.i64.cast([0,10010])),d[97].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:198 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processBackwardEdge()"),d[98]=c.createArray(),d[100]=(d[98].push(d[97]),d[98]),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[98]),d[96]=d[99]),d[80]=d[96]}]):c.resolve((d[87]=d[58].get("errors"),d[58],d[88]=d[58].get("errors"),d[58],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[80]=d[89]))},function(a){return d[81]=d[80].get("value"),d[80],d[81]!==void 0?c.sequence([function(a){return d[87]=d[81].get("epoch_id"),d[81],d[88]=d[81].get("backup_id"),d[81],d[89]=d[81].get("epoch_anon_id_blob"),d[81],d[90]=d[81].get("epoch_root_key_blob"),d[81],d[91]=d[81].get("epoch_status"),d[81],d[92]=d[81].get("authority_level"),d[81],d[93]=c.createArray(),d[98]=(d[93].push(c.i64.cast([0,32])),d[93]),c.nativeOperation(b("LSBase64Encode.nop"),d[89]).then(function(a){return a=a,d[94]=a[0],a})},function(a){return d[94]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blobs.of_string(["epoch_data_storage","_",d[94]].join("")),void 0,d[90],d[93]).then(function(a){return a=a,d[98]=a[0],a})},function(a){return d[98]?d[99]=!1:d[99]=!0,d[99]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),d[101]=c.createArray(),void 0!==void 0?d[103]=(d[101].push(void 0),d[101]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",d[101],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[102]=a[0],a})},function(a){return d[100]=d[102]}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[98],c.i64.cast([0,0])).then(function(a){return a=a,d[101]=a[0],d[102]=a[1],a})},function(a){return d[100]=d[101]}])},function(a){return d[95]=d[100]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),d[98]=c.createArray(),void 0!==void 0?d[100]=(d[98].push(void 0),d[98]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",d[98],c.i64.cast([0,3]))},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,d[99]=a[0],a})},function(a){return d[95]=d[99]}])},function(a){return d[96]=new c.Map(),d[96].set("epoch_data_storage_key",d[95]),d[97]=new c.Map(),d[97].set("value",d[96]),d[97].set("errors",void 0),d[82]=d[97]}]):c.resolve((d[87]=d[80].get("errors"),d[80],d[88]=d[80].get("errors"),d[80],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[82]=d[89]))},function(a){return d[83]=d[82].get("value"),d[82],d[83]!==void 0?c.sequence([function(a){return d[87]=d[83].get("epoch_data_storage_key"),d[83],c.nativeOperation(b("LSBase64Encode.nop"),d[73]).then(function(a){return a=a,d[88]=a[0],a})},function(a){return d[95]=d[88],d[95]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedString.nop"),d[87],c.blob("ZXBvY2hfZGF0YV9tZXRhZGF0YQ=="),d[95]).then(function(a){return a=a,d[96]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Decode.nop"),d[96]).then(function(a){return a=a,d[97]=a[0],a})},function(a){return d[89]=d[97]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] Unable to base64 encode backward edge."),d[96]=c.createArray(),void 0!==void 0?d[97]=(d[96].push(void 0),d[96]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","Unable to base64 encode backward edge.",d[96],c.i64.cast([0,3]))},function(a){return d[89]=void 0}])},function(a){return c.blobs.neq(d[89],void 0)?(d[96]=new c.Map(),d[96].set("root_key",d[89]),d[97]=new c.Map(),d[97].set("value",d[96]),d[97].set("errors",void 0),d[98]=d[97].get("value"),d[97],d[99]=d[97].get("errors"),d[97],a=[d[98],d[99]],d[90]=a[0],d[91]=a[1],a):(d[96]=c.createArray(),c.blobs.eq(d[89],void 0)?d[103]=(d[96].push("root_key"),d[96]):0,d[97]=d[96].join(", "),d[98]=new c.Map(),d[98].set("error_msg",["The following required nullables are null: ","",d[97]].join("")),d[98].set("code",c.i64.cast([0,2])),d[98].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:227 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processBackwardEdge#5()"),d[99]=c.createArray(),d[103]=(d[99].push(d[98]),d[99]),d[100]=new c.Map(),d[100].set("value",void 0),d[100].set("errors",d[99]),d[101]=d[100].get("value"),d[100],d[102]=d[100].get("errors"),d[100],a=[d[101],d[102]],d[90]=a[0],d[91]=a[1],a),d[92]=new c.Map(),d[92].set("value",d[90]),d[92].set("errors",d[91]),d[93]=d[92].get("value"),d[92],d[93]!==void 0?(d[96]=d[93].get("root_key"),d[93],d[94]=d[92]):(d[96]=d[92].get("errors"),d[92],d[97]=d[92].get("errors"),d[92],d[98]=new c.Map(),d[98].set("error_msg","EB_EPOCH_BACKWARD_DECRYPTION_FAILED"),d[98].set("code",c.i64.cast([0,10013])),d[98].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:229 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processBackwardEdge#4()"),d[100]=(d[96].push(d[98]),d[96]),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[96]),d[94]=d[99]),d[84]=d[94]}]):c.resolve((d[87]=d[82].get("errors"),d[82],d[88]=d[82].get("errors"),d[82],d[89]=new c.Map(),d[89].set("value",void 0),d[89].set("errors",d[87]),d[84]=d[89]))},function(a){return d[85]=d[84].get("value"),d[84],d[86]=d[84].get("errors"),d[84],a=[d[85],d[86]],d[74]=a[0],d[75]=a[1],a}]):c.resolve((d[79]=new c.Map(),d[79].set("error_msg","EB_EPOCH_EDGE_NEITHER_FORWARD_NOR_BACKWARD"),d[79].set("code",c.i64.cast([0,10008])),d[79].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:411 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#9()"),d[80]=c.createArray(),d[84]=(d[80].push(d[79]),d[80]),d[81]=new c.Map(),d[81].set("value",void 0),d[81].set("errors",d[80]),d[82]=d[81].get("value"),d[81],d[83]=d[81].get("errors"),d[81],a=[d[82],d[83]],d[74]=a[0],d[75]=a[1],a))},function(a){return d[76]=new c.Map(),d[76].set("value",d[74]),d[76].set("errors",d[75]),d[77]=d[76].get("value"),d[76],d[78]=d[76].get("errors"),d[76],a=[d[77],d[78]],d[60]=a[0],d[61]=a[1],a}])},function(a){return d[62]=new c.Map(),d[62].set("value",d[60]),d[62].set("errors",d[61]),d[63]=d[62].get("value"),d[62],d[63]!==void 0?c.sequence([function(a){return d[73]=d[63].get("root_key"),d[63],d[74]=d[47].get("to_epoch_fingerprint"),d[47],d[75]=c.createArray(),d[80]=(d[75].push(c.i64.cast([0,18])),d[75]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[73],d[75]).then(function(a){return a=a,d[76]=a[0],a})},function(a){return d[76]!==void 0?c.sequence([function(a){return d[80]=c.i64.of_int32(d[76].length),c.i64.ge(d[80],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[76],c.i64.cast([0,0])).then(function(a){return a=a,d[82]=a[0],d[83]=a[1],a})},function(a){return d[81]=d[82]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[82]=c.createArray(),void 0!==void 0?d[83]=(d[82].push(void 0),d[82]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",d[82],c.i64.cast([0,3]))},function(a){return d[81]=void 0}])},function(a){return d[77]=d[81]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[80]=c.createArray(),void 0!==void 0?d[81]=(d[80].push(void 0),d[80]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",d[80],c.i64.cast([0,3]))},function(a){return d[77]=void 0}])},function(a){return c.blobs.neq(d[77],void 0)?d[78]=!0:d[78]=!1,d[78]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.blobs.eq(d[74],void 0)||c.blobs.eq(d[74],d[77])?d[79]=d[62]:(d[80]=new c.Map(),d[80].set("error_msg","EB_EPOCH_DERIVATION_DEST_FINGERPRINT_MISMATCH"),d[80].set("code",c.i64.cast([0,10001])),d[80].set("src_line","LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure.php:415 Closure$LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure::processEdge#11()"),d[81]=c.createArray(),d[83]=(d[81].push(d[80]),d[81]),d[82]=new c.Map(),d[82].set("value",void 0),d[82].set("errors",d[81]),d[79]=d[82]),d[64]=d[79]}]):c.resolve((d[73]=d[62].get("errors"),d[62],d[74]=d[62].get("errors"),d[62],d[75]=new c.Map(),d[75].set("value",void 0),d[75].set("errors",d[73]),d[64]=d[75]))},function(a){return d[65]=d[64].get("value"),d[64],d[65]!==void 0?c.sequence([function(a){return d[73]=d[65].get("root_key"),d[65],d[74]=d[47].get("to_epoch"),d[47],d[75]=d[74].get("epoch_id"),d[74],d[76]=d[47].get("to_epoch"),d[47],d[77]=d[76].get("epoch_anon_id"),d[76],d[98]="Storing newly derived epoch ",d[99]=c.blobs.to_string(d[77]),d[100]=" authority_level:",d[101]="AUTHORITATIVE",d[102]=" status:",d[103]=c.i64.to_string(c.i64.cast([0,2])),d[78]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[78],d[98],d[78],d[99],d[78],d[100],d[78],d[101],d[78],d[102],d[78],d[103]].join("")),c.resolve()},function(a){return c.filter(c.db.table(169).fetch([[[d[75]]]]),function(a){return c.i64.eq(a.epochId,d[75])&&c.i64.gt(a.authorityLevel,c.i64.cast([0,80]))}).next().then(function(b){var a=b.done;b.value;return a?c.db.table(169).put({epochId:d[75],backupId:f.backupId,epochAnonIdBlob:d[77],epochRootKeyBlob:d[73],epochStatus:c.i64.cast([0,2]),authorityLevel:c.i64.cast([0,80])}):0})},function(a){return d[79]=d[47].get("from_epoch"),d[47],d[80]=d[79].get("epoch_anon_id"),d[79],c.nativeOperation(b("LSBase64Encode.nop"),d[80]).then(function(a){return a=a,d[81]=a[0],a})},function(a){return d[81]!==void 0?d[82]=d[81]:d[82]="",d[83]=d[47].get("from_epoch"),d[47],d[84]=d[83].get("epoch_id"),d[83],d[85]=new c.Map(),d[85].set("anon_id",d[82]),d[85].set("epoch_id",d[84]),d[86]=d[47].get("to_epoch"),d[47],d[87]=d[86].get("epoch_anon_id"),d[86],c.nativeOperation(b("LSBase64Encode.nop"),d[87]).then(function(a){return a=a,d[88]=a[0],a})},function(a){return d[88]!==void 0?d[89]=d[88]:d[89]="",d[90]=d[47].get("to_epoch"),d[47],d[91]=d[90].get("epoch_id"),d[90],d[92]=new c.Map(),d[92].set("anon_id",d[89]),d[92].set("epoch_id",d[91]),d[93]=d[47].get("forward_edge"),d[47],d[93]?d[94]=!1:d[94]=!0,d[94]?d[95]=!1:d[95]=!0,d[96]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[96],void 0)?d[97]=!0:d[97]=!1,a=[d[85],d[92],d[95],d[97],void 0,c.i64.cast([0,0])],d[66]=a[0],d[67]=a[1],d[68]=a[2],d[69]=a[3],d[70]=a[4],d[71]=a[5],a}]):c.sequence([function(a){return d[73]=d[64].get("errors"),d[64],d[74]=d[64].get("errors"),d[64],d[75]=c.i64.of_int32(d[73].length),c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[73],c.i64.sub(d[75],c.i64.cast([0,1]))).then(function(a){return a=a,d[76]=a[0],d[77]=a[1],a})},function(a){return d[78]=d[76].get("code"),d[76],d[79]=d[76].get("src_line"),d[76],d[80]=d[76].get("error_msg"),d[76],c.i64.eq(d[78],c.i64.cast([0,10004]))?d[81]=c.i64.cast([0,3]):(c.i64.eq(d[78],c.i64.cast([0,10003]))?d[103]=c.i64.cast([0,13]):(c.i64.eq(d[78],c.i64.cast([0,10002]))?d[104]=c.i64.cast([0,9]):(c.i64.eq(d[78],c.i64.cast([0,10001]))?d[105]=c.i64.cast([0,10]):(c.i64.eq(d[78],c.i64.cast([0,10005]))?d[106]=c.i64.cast([0,12]):(c.i64.eq(d[78],c.i64.cast([0,10006]))?d[107]=c.i64.cast([0,11]):(c.i64.eq(d[78],c.i64.cast([0,10008]))?d[108]=c.i64.cast([0,2]):(c.i64.eq(d[78],c.i64.cast([0,10009]))?d[109]=c.i64.cast([0,14]):(c.i64.eq(d[78],c.i64.cast([0,10010]))?d[110]=c.i64.cast([0,15]):(c.i64.eq(d[78],c.i64.cast([0,10011]))?d[111]=c.i64.cast([0,16]):(c.i64.eq(d[78],c.i64.cast([0,10012]))?d[112]=c.i64.cast([0,17]):(c.i64.eq(d[78],c.i64.cast([0,10013]))?d[113]=c.i64.cast([0,6]):d[113]=c.i64.cast([0,1]),d[112]=d[113]),d[111]=d[112]),d[110]=d[111]),d[109]=d[110]),d[108]=d[109]),d[107]=d[108]),d[106]=d[107]),d[105]=d[106]),d[104]=d[105]),d[103]=d[104]),d[81]=d[103]),d[82]=d[47].get("from_epoch"),d[47],d[83]=d[82].get("epoch_anon_id"),d[82],c.nativeOperation(b("LSBase64Encode.nop"),d[83]).then(function(a){return a=a,d[84]=a[0],a})},function(a){return d[84]!==void 0?d[85]=d[84]:d[85]="",d[86]=d[47].get("from_epoch"),d[47],d[87]=d[86].get("epoch_id"),d[86],d[88]=new c.Map(),d[88].set("anon_id",d[85]),d[88].set("epoch_id",d[87]),d[89]=d[47].get("to_epoch"),d[47],d[90]=d[89].get("epoch_anon_id"),d[89],c.nativeOperation(b("LSBase64Encode.nop"),d[90]).then(function(a){return a=a,d[91]=a[0],a})},function(a){return d[91]!==void 0?d[92]=d[91]:d[92]="",d[93]=d[47].get("to_epoch"),d[47],d[94]=d[93].get("epoch_id"),d[93],d[95]=new c.Map(),d[95].set("anon_id",d[92]),d[95].set("epoch_id",d[94]),d[96]=d[47].get("forward_edge"),d[47],d[96]?d[97]=!1:d[97]=!0,d[97]?d[98]=!1:d[98]=!0,d[99]=d[47].get("backward_edge"),d[47],c.blobs.neq(d[99],void 0)?d[100]=!0:d[100]=!1,d[101]="",d[102]=c.i64.of_int32(d[73].length),c.i64.gt(d[102],c.i64.cast([0,0]))?c.loopAsync(d[102],function(a){return d[103]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[73],d[103]).then(function(a){return a=a,d[104]=a[0],d[105]=a[1],a})},function(a){return d[106]=d[104].get("code"),d[104],d[107]=d[104].get("src_line"),d[104],d[108]=d[104].get("error_msg"),d[104],d[109]=d[104].get("code"),d[104],d[110]=d[104].get("src_line"),d[104],d[111]=d[104].get("error_msg"),d[104],d[112]=d[104].get("code"),d[104],d[113]=d[104].get("src_line"),d[104],d[114]=d[104].get("error_msg"),d[104],d[101]=[d[101],["at ",d[107],": ","error code ",c.i64.to_string(d[109]),": ",d[114]].join(""),"\n"].join("")}])}):c.resolve()},function(a){return a=[d[88],d[95],d[98],d[100],d[101],d[81]],d[66]=a[0],d[67]=a[1],d[68]=a[2],d[69]=a[3],d[70]=a[4],d[71]=a[5],a}])},function(a){return d[72]=new c.Map(),d[72].set("from",d[66]),d[72].set("to",d[67]),d[72].set("has_forward_edge",d[68]),d[72].set("has_backward_edge",d[69]),d[72].set("error_message",d[70]),d[72].set("result_code",d[71]),d[73]=(d[44].push(d[72]),d[44])}])}):c.resolve()},function(b){return b=[d[34],d[34],a[1],a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[44]],d[37]=b[0],d[38]=b[1],d[39]=b[2],d[40]=b[3],d[41]=b[4],d[42]=b[5],d[43]=b[6],b}])},function(a){return a=[d[37],d[38],d[39],d[40],d[41],d[42],d[43]],d[25]=a[0],d[26]=a[1],d[27]=a[2],d[28]=a[3],d[29]=a[4],d[30]=a[5],d[31]=a[6],a}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] Unable to load client state: 24"),d[36]=c.createArray(),void 0!==void 0?d[39]=(d[36].push(void 0),d[36]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure","Unable to load client state: 24",d[36],c.i64.cast([0,3]))},function(e){return d[37]=c.createArray(),d[38]=c.i64.of_int32(a[0].length),c.i64.gt(d[38],c.i64.cast([0,0]))?c.loopAsync(d[38],function(e){return d[39]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[39]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],a})},function(a){return d[42]=d[40].get("from_epoch"),d[40],d[43]=d[42].get("epoch_anon_id"),d[42],c.nativeOperation(b("LSBase64Encode.nop"),d[43]).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[44]!==void 0?d[45]=d[44]:d[45]="",d[46]=d[40].get("from_epoch"),d[40],d[47]=d[46].get("epoch_id"),d[46],d[48]=new c.Map(),d[48].set("anon_id",d[45]),d[48].set("epoch_id",d[47]),d[49]=d[40].get("to_epoch"),d[40],d[50]=d[49].get("epoch_anon_id"),d[49],c.nativeOperation(b("LSBase64Encode.nop"),d[50]).then(function(a){return a=a,d[51]=a[0],a})},function(a){return d[51]!==void 0?d[52]=d[51]:d[52]="",d[53]=d[40].get("to_epoch"),d[40],d[54]=d[53].get("epoch_id"),d[53],d[55]=new c.Map(),d[55].set("anon_id",d[52]),d[55].set("epoch_id",d[54]),d[56]=d[40].get("forward_edge"),d[40],d[56]?d[57]=!1:d[57]=!0,d[57]?d[58]=!1:d[58]=!0,d[59]=d[40].get("backward_edge"),d[40],c.blobs.neq(d[59],void 0)?d[60]=!0:d[60]=!1,d[61]=new c.Map(),d[61].set("from",d[48]),d[61].set("to",d[55]),d[61].set("has_forward_edge",d[58]),d[61].set("has_backward_edge",d[60]),d[61].set("result_code",c.i64.cast([0,7])),d[61].set("error_message",void 0),d[62]=(d[37].push(d[61]),d[37])}])}):c.resolve()},function(b){return b=[void 0,void 0,void 0,a[2],c.i64.cast([0,0]),c.i64.cast([0,0]),d[37]],d[25]=b[0],d[26]=b[1],d[27]=b[2],d[28]=b[3],d[29]=b[4],d[30]=b[5],d[31]=b[6],b}])},function(a){return a=[d[25],d[26],d[27],d[28],d[29],d[30],d[31]],d[9]=a[0],d[10]=a[1],d[11]=a[2],d[12]=a[3],d[13]=a[4],d[14]=a[5],d[15]=a[6],a}]))})},function(a){return d[17]=c.i64.of_float(Date.now()),d[18]=new c.Map(),d[18].set("local_device_id",d[9]),d[18].set("decryption_device_id",d[10]),d[18].set("target_device_id",d[11]),d[18].set("epoch_sync_reason",d[12]),d[18].set("start_ms",d[8]),d[18].set("end_ms",d[17]),d[18].set("results",d[15]),d[19]=c.toJSON(d[18]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_record_epoch_sync",c.i64.cast([0,50039]),d[19],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[20]=a[0],a})}]):c.resolve()},function(a){return d[2]=c.i64.of_float(Date.now()),d[3]=c.i64.random(),d[5]="Finishing execution. Execution time: ",d[6]=c.i64.to_string(c.i64.sub(d[2],d[0])),d[7]=" ms",d[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure] ",d[4],d[5],d[4],d[6],d[4],d[7]].join("")),c.i64.eq(c.i64.mod_(d[3],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[8]=",",d[9]=c.createArray(),void 0!==void 0?d[10]=(d[9].push(void 0),d[9]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure",[d[5],d[8],d[6],d[8],d[7]].join(""),d[9],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeriveAndStoreEpochsStoredProcedure";e.exports=a}),null);
__d("LSDeriveAndStoreEpochsStoredProcedure",["LSDeriveAndStoreEpochs","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSDeriveAndStoreEpochs")(b.epochEdges,b.targetDeviceId,b.epochSyncReason,b.traceId,a)}g["default"]=a}),98);
__d("MEBEncryptionVersion",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,ENCRYPTION_KDF_WITH_VERSION:2,ENCRYPTION_KDF_WITH_NULL_SALT:3,ENCRYPTION_KDF_WITH_NULL_SALT_DF_CANARY:4,TEST_VERSION:99});f["default"]=a}),66);
__d("MEBEpochSyncReason",[],(function(a,b,c,d,e,f){a=Object.freeze({EMPTY_RESTORE_PAYLOAD:-3,NONE_PROVIDED_BY_CLIENT:-2,NONE_PROVIDED_BY_SERVER:-1,SNAPSHOT_RESTORE:0,POINT_QUERY_RESTORE:1,RANGE_QUERY_RESTORE:2,MESSAGE_QUERY_RESTORE:3,SURROUNDING_RESTORE:4,DOWNLOAD_EPOCHS_V2:5,PREPARE_OPEN_EPOCH:6,HANDLE_OPEN_EPOCH_SUCCESS:7,HANDLE_INIT_GET_SECRETS:8,DERIVE_ONBOARDING_MATERIAL:9,DECRYPT_AND_WRITE_MESSAGES:10,RESTORE_WITH_SERIALIZER:11,FINISH_ADD_PEER_DEVICE:12});f["default"]=a}),66);
__d("WorkerRelayEnvironment",["ActorURIConfig","MAWCurrentUser","RelayAPIConfig","WAResolvable","createRelayFBNetwork","createRelayFBNetworkFetch","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=i(d("MAWCurrentUser").getID());a={execute:a.execute};h.resolve(a);return a}var h=new(d("WAResolvable").Resolvable)();function b(){return h.promise}function i(a,b){b={actorID:a,batchResponseChunks:!0,getAdditionalData:function(){var b={};a!=null&&(b[c("ActorURIConfig").PARAMETER_ACTOR]=a);c("RelayAPIConfig").useXController===!1&&c("RelayAPIConfig").accessToken!==""&&(b.access_token=c("RelayAPIConfig").accessToken);return b},graphURI:b};b=c("createRelayFBNetworkFetch")(b);var e=function(a,b,c){return d("relay-runtime").Observable.create(function(a){return a.complete()})};return c("createRelayFBNetwork")(b,e,null,null)}g.createWorkerRelayEnvironment=a;g.getWorkerRelayEnvironment=b}),98);
__d("executeGraphQLQuery",["DTSG","MAWBridge","asyncToGeneratorRuntime","err","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){b=d("relay-runtime").getRequest(b);if(b.params.operationKind==="subscription")throw c("err")("executeGraphQLQuery: Expected query or mutation operation");var f={force:!0},g=(yield d("MAWBridge").getBridge().sendAndReceive("event","getDTSGToken")["catch"](function(a){throw c("err")("executeGraphQLQuery: Failed to get DTSG token from the main thread",a)}));if(g==null||g===""||typeof g!=="string")throw c("err")("executeGraphQLQuery: Received an empty DTSG token from the main thread");d("DTSG").setToken(g);g=d("relay-runtime").createOperationDescriptor(b,e,f);return a.execute(g.request.node.params,g.request.variables,f)});return h.apply(this,arguments)}g.executeGraphQLQuery=a}),98);
__d("createWorkerMutation",["WorkerRelayEnvironment","asyncToGeneratorRuntime","err","executeGraphQLQuery","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var e=d("relay-runtime").getRequest(a);if(e.params.operationKind!=="mutation")throw c("err")("createWorkerMutation: Expected mutation operation");var f=d("WorkerRelayEnvironment").getWorkerRelayEnvironment();e=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=(yield f);return d("executeGraphQLQuery").executeGraphQLQuery(c,a,b).then(function(a){return a.toPromise()}).then(function(a){if(Array.isArray(a)){return(a=a[0])==null?void 0:a.data}else return null})});return function(a){return c.apply(this,arguments)}}();return[e]}g["default"]=a}),98);
__d("createWorkerQuery",["WorkerRelayEnvironment","asyncToGeneratorRuntime","err","executeGraphQLQuery","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=d("relay-runtime").getRequest(a);if(e.params.operationKind!=="query")throw c("err")("createWorkerQuery: Expected query operation");e=(yield d("WorkerRelayEnvironment").getWorkerRelayEnvironment());e=(yield d("executeGraphQLQuery").executeGraphQLQuery(e,a,b).then(function(a){return a.toPromise()}).then(function(a){return Array.isArray(a)?a[0].data:(a=a.data)!=null?a:null}));return e});return h.apply(this,arguments)}g["default"]=a}),98);
__d("WorkerRelay",["WorkerRelayEnvironment","createWorkerMutation","createWorkerQuery","executeGraphQLQuery","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";f.exports={createWorkerMutation:c("createWorkerMutation"),createWorkerQuery:c("createWorkerQuery"),executeGraphQLQuery:d("executeGraphQLQuery").executeGraphQLQuery,getWorkerRelayEnvironment:d("WorkerRelayEnvironment").getWorkerRelayEnvironment,graphql:d("relay-runtime").graphql}}),34);
__d("handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"encryption_version",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"epoch_anon_id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"epoch_id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"encrypted_protobuf_stanza",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"protobuf_timestamp_ms",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"sk_ciphertext",storageKey:null},g=[b,c];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMessage",kind:"LinkedField",name:"encrypted_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEchoDocument",kind:"LinkedField",name:"echo_document",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"echo_document_string",storageKey:null},a,b,c,{alias:null,args:null,kind:"ScalarField",name:"epoch_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"otid",storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanzas",kind:"LinkedField",name:"protobuf_stanzas",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"top_level_protobuf",plural:!1,selections:[d,a,b,c,e,f],storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"supplemental_protobufs",plural:!0,selections:[d,a,b,c,e,f,{alias:null,args:null,kind:"ScalarField",name:"supplemental_key",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_id",storageKey:null},{alias:null,args:null,concreteType:"XFBMessageRangeInfo",kind:"LinkedField",name:"message_range_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_more_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_more_after",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_after",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_delete_mailbox",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochDerivationSet",kind:"LinkedField",name:"epoch_derivation_set",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupsEpochEdge",kind:"LinkedField",name:"epoch_edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"backward_edge",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochForwardEdge",kind:"LinkedField",name:"forward_edge",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"auth_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_entropy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entropy_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_storage_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"psk_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"from_epoch",plural:!1,selections:g,storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"to_epoch",plural:!1,selections:g,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"from_epoch_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"to_epoch_fingerprint",storageKey:null}],storageKey:null}],storageKey:null}],type:"XFBEncryptedBackupMessages",abstractKey:null}}();e.exports=a}),null);
__d("handleRestoreMessagesGraphQLResponse",["EBAPIQPLPoints","I64","LSAuthorityLevel","LSDecryptMessageProtobufsStoredProcedure","LSDecryptMessagesStoredProcedure","LSDeleteAndReenrollDeviceStateStoredProcedure","LSDeriveAndStoreEpochsStoredProcedure","LSDict","LSFactory","LSIntEnum","LSMEBDeviceReenrollmentReason","LSMEBTaskCreationSource","LSShape","LSVec","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWJobDefinitions","MEBEncryptionVersion","MEBEpochSyncReason","QPLUserFlow","ReQL","WAHashStringToNumber","WALogger","asyncToGeneratorRuntime","handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages.graphql","promiseDone","qpl","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Protobuf decryption failed in search range restore response"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is not complete - cannot proceed with graphQL restore"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] backup_id is null - cannot proceed with graphQL restore"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is null - cannot proceed with graphQL restore"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web Client state is null - unable to proceed with GQL restore"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message with no echo document and no protobuf data"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] echo_document_string or echo_epoch_anon_id is null for a message in the GraphQL range restore response"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] otid is null for a message in the GraphQL range restore response"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message is null in the GraphQL range restore response"]);s=function(){return a};return a}var t=c("requireDeferred")("LSRestoreEchoBlobs.nop").__setRef("handleRestoreMessagesGraphQLResponse"),u=c("requireDeferred")("LSRestoreProtobufs.nop").__setRef("handleRestoreMessagesGraphQLResponse");function v(a){if(a==null)return c("MEBEncryptionVersion").UNKNOWN;switch(a){case"ENCRYPTION_KDF_WITH_NULL_SALT":return c("MEBEncryptionVersion").ENCRYPTION_KDF_WITH_NULL_SALT;case"ENCRYPTION_KDF_WITH_VERSION":return c("MEBEncryptionVersion").ENCRYPTION_KDF_WITH_VERSION;case"ENCRYPTION_KDF_WITH_NULL_SALT_DF_CANARY":return c("MEBEncryptionVersion").ENCRYPTION_KDF_WITH_NULL_SALT_DF_CANARY;case"TEST_VERSION":return c("MEBEncryptionVersion").TEST_VERSION;default:return c("MEBEncryptionVersion").UNKNOWN}}function w(a,b){var e=[];a=(a=a==null?void 0:a.map(function(a){var f,g,h,k,l,m,n;if(a==null){d("WALogger").ERROR(s());return}var o=a.otid;if(o==null){d("WALogger").ERROR(r());return}f=(f=a.echo_document)==null?void 0:f.echo_document_string;g=(g=a.echo_document)==null?void 0:g.epoch_anon_id;h=(h=a.echo_document)==null?void 0:h.epoch_fingerprint;var t=a.protobuf_stanzas;k=t==null?void 0:(k=t.top_level_protobuf)==null?void 0:k.encrypted_protobuf_stanza;l=t==null?void 0:(l=t.top_level_protobuf)==null?void 0:l.epoch_anon_id;m=t==null?void 0:(m=t.top_level_protobuf)==null?void 0:m.epoch_id;n=t==null?void 0:(n=t.top_level_protobuf)==null?void 0:n.protobuf_timestamp_ms;var u=t==null?void 0:t.supplemental_protobufs;if(f==null||g==null){d("WALogger").ERROR(q());return}if(k==null||l==null||m==null||n==null)if(f.length===0){d("WALogger").ERROR(p());return}else{var w;e.push(d("LSShape").ofRecord({backup_id:Number(b),encryption_version:(i||(i=d("LSIntEnum"))).ofNumber(v((w=a.echo_document)==null?void 0:w.encryption_version)),epoch_anon_id:new TextEncoder().encode(g).buffer,epoch_fingerprint:h!=null?new TextEncoder().encode(h).buffer:void 0,epoch_id:((w=a.echo_document)==null?void 0:w.epoch_id)!=null?(j||(j=d("I64"))).of_string(a.echo_document.epoch_id):void 0,otid:o,value:f}));return}if(t!=null){a=d("LSShape").ofRecord({backup_id:Number(b),encryption_version:(i||(i=d("LSIntEnum"))).ofNumber(v((w=a.echo_document)==null?void 0:w.encryption_version)),epoch_anon_id:new TextEncoder().encode(g).buffer,epoch_fingerprint:h!=null?new TextEncoder().encode(h).buffer:void 0,value:f});g=d("LSShape").ofRecord({encrypted_protobuf:k,encryption_version:i.ofNumber(v(t==null?void 0:(w=t.top_level_protobuf)==null?void 0:w.encryption_version)),epoch_anon_id:new TextEncoder().encode(l).buffer,epoch_id:(j||(j=d("I64"))).of_string(m),protobuf_timestamp_ms:j.of_string(n)});var x=new(c("LSDict"))();u==null?void 0:u.forEach(function(a){var b=a==null?void 0:a.supplemental_key,c=a==null?void 0:a.encrypted_protobuf_stanza,e=a.epoch_anon_id,f=a==null?void 0:a.epoch_id,g=a==null?void 0:a.protobuf_timestamp_ms;if(c==null||e==null||f==null||g==null||b==null)return;x.set(b,d("LSShape").ofRecord({encrypted_protobuf:c,encryption_version:(i||(i=d("LSIntEnum"))).ofNumber(v(a==null?void 0:a.encryption_version)),epoch_anon_id:new TextEncoder().encode(e).buffer,epoch_id:(j||(j=d("I64"))).of_string(f),protobuf_timestamp_ms:j.of_string(g),sk_ciphertext:a==null?void 0:a.sk_ciphertext}))});return d("LSShape").ofRecord({encrypted_echo_message:a,encrypted_protobufs:d("LSShape").ofRecord({supplemental_protobufs:x,toplevel_protobuf:g}),otid:o})}}).filter(Boolean))!=null?a:[];return{encryptedEchoMessages:e,encryptedMessagesWithProtobufs:a}}function x(a){return y.apply(this,arguments)}function y(){y=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.backupId,e=a.encryptedMessages,g=a.isPointQuery,h=a.messageRangeInfo,k=a.sortOrderMs,l=a.source,m=a.storage,n=a.threadId,o=a.traceId;a=w(e,b);var p=a.encryptedEchoMessages,q=a.encryptedMessagesWithProtobufs;b=(e=h)!=null?e:{};var r=b.has_more_after,s=b.has_more_before,v=b.next_message_timestamp_ms_after,x=b.next_message_timestamp_ms_before;if(s==null||r==null||v==null||x==null)return;if(q.length===0){a=(yield m.runInTransaction(function(a){return c("LSDecryptMessagesStoredProcedure")(c("LSFactory")(a),{actThreadId:n,encryptedMessages:c("LSVec").ofArray(p)})},"readwrite",void 0,void 0,f.id+":323"));h=a[0];if(h!=null){var y=c("LSVec").toArray(h).map(function(a){return d("LSShape").toRecord(a).value});c("promiseDone")(t.load().then(function(a){return m.runInTransaction(function(b){return a(b,0,(j||(j=d("I64"))).zero,c("LSVec").ofArray(y),s,j.of_string(x),r,j.of_string(v),g,n,o,k!=null?k:void 0,(i||(i=d("LSIntEnum"))).ofNumber((b=l)!=null?b:c("LSMEBTaskCreationSource").UNKNOWN))},"readwrite",void 0,void 0,f.id+":339")}))}}else{var z=(yield m.runInTransaction(function(a){return c("LSDecryptMessageProtobufsStoredProcedure")(c("LSFactory")(a),{actThreadId:n,encryptedMessagesWithProtobufs:c("LSVec").ofArray(q)})},"readwrite",void 0,void 0,f.id+":361"));c("promiseDone")(u.load().then(function(a){return m.runInTransaction(function(b){return a(b,0,n,(b=z[0])!=null?b:c("LSVec").ofArray([]),s,(j||(j=d("I64"))).of_string(x),r,j.of_string(v),g,o,k!=null?k:void 0,void 0,c("LSVec").ofArray([]),(i||(i=d("LSIntEnum"))).ofNumber((b=l)!=null?b:c("LSMEBTaskCreationSource").UNKNOWN))},"readwrite",void 0,void 0,f.id+":371")}))}});return y.apply(this,arguments)}function a(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=(yield (b=d("ReQL")).firstAsync(b.fromTableAscending(a.tables.secure_encrypted_backups_client_state)));b=(yield b.toArrayAsync(b.fromTableAscending(a.tables.secure_encrypted_backups_epochs)));a=b.filter(function(a){return a.authorityLevel!==c("LSAuthorityLevel").AUTHORITATIVE}).map(function(a){return(j||(j=d("I64"))).to_float(a.epochId)});if(e==null){d("WALogger").ERROR(o());return}b=e.deviceId;var f=e.mailboxRootKeyBlob;e=e.ocmfClientStateBlob;return{device_id:b,locally_available_epochs:a,mailboxRootKey:f,ocmfClientStateBlob:e}});return z.apply(this,arguments)}function A(a,b,c,d){return B.apply(this,arguments)}function B(){B=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,g){g!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"derive_and_store_epochs",traceId:g,type:"none"});if(a!=null){a=a.epoch_edges;var h=[],k=new TextEncoder();a!=null&&a.forEach(function(a){var b=a.from_epoch,c=a.to_epoch,e=a.forward_edge,f=e==null?void 0:e.auth_public_key,g=e==null?void 0:e.encrypted_entropy,i=e==null?void 0:e.entropy_fingerprint,l=e==null?void 0:e.epoch_storage_public_key;e=e==null?void 0:e.psk_fingerprint;var m;f!=null&&g!=null&&(m=d("LSShape").ofRecord({auth_public_key:k.encode(f).buffer,encrypted_entropy:k.encode(g).buffer,entropy_fingerprint:i!=null?k.encode(i).buffer:void 0,epoch_storage_public_key:l!=null?k.encode(l).buffer:void 0,psk_fingerprint:e!=null?k.encode(e).buffer:void 0}));f=b==null?void 0:b.epoch_anon_id;g=b==null?void 0:b.epoch_id;i=c==null?void 0:c.epoch_anon_id;l=c==null?void 0:c.epoch_id;f!=null&&g!=null&&i!=null&&l!=null&&h.push(d("LSShape").ofRecord({backward_edge:a.backward_edge!=null?k.encode(a.backward_edge).buffer:void 0,forward_edge:m,from_epoch:d("LSShape").ofRecord({epoch_anon_id:k.encode(f).buffer,epoch_id:(j||(j=d("I64"))).of_string(g)}),from_epoch_fingerprint:a.from_epoch_fingerprint!=null?k.encode(a.from_epoch_fingerprint).buffer:void 0,to_epoch:d("LSShape").ofRecord({epoch_anon_id:k.encode(i).buffer,epoch_id:j.of_string(l)}),to_epoch_fingerprint:a.to_epoch_fingerprint!=null?k.encode(a.to_epoch_fingerprint).buffer:void 0}))});yield b.runInTransaction(function(a){return c("LSDeriveAndStoreEpochsStoredProcedure")(c("LSFactory")(a),{epochEdges:c("LSVec").ofArray(h),epochSyncReason:(i||(i=d("LSIntEnum"))).ofNumber(c("MEBEpochSyncReason").DECRYPT_AND_WRITE_MESSAGES),targetDeviceId:e,traceId:g})},"readwrite",void 0,void 0,f.id+":517")}});return B.apply(this,arguments)}function e(a,b,c,d,e,f,g,h){return C.apply(this,arguments)}function C(){C=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,g,h,j,k,o){var p=a;if(p==null){j!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"null_messages",traceId:j,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(j));return}var q=p.backup_id,r=p.encrypted_messages,s=p.epoch_derivation_set,t=p.message_range_info;p=p.should_delete_mailbox;p===!0&&(j!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"delete_mailbox",traceId:j,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(j)),yield b.runInTransaction(function(a){return c("LSDeleteAndReenrollDeviceStateStoredProcedure")(c("LSFactory")(a),{reenrollmentReason:(i||(i=d("LSIntEnum"))).ofNumber(c("LSMEBDeviceReenrollmentReason").RESTORE_FAILED_WITH_NO_DEVICE_FOUND),targetDeviceId:g})},"readwrite",void 0,void 0,f.id+":579"));yield A(s,b,g,j);if(r.length===0){j!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"no_messages",traceId:j,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(j));return}if(t==null){j!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"message_range_info_null",traceId:j,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(j));d("WALogger").ERROR(n());return}if(q==null){j!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"backup_id_null",traceId:j,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(j));d("WALogger").ERROR(m());return}p=t.has_more_after;s=t.has_more_before;var u=t.next_message_timestamp_ms_after,v=t.next_message_timestamp_ms_before;if(s==null||p==null||u==null||v==null){j!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:" message_range_info_incomplete",traceId:j,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(j));d("WALogger").ERROR(l());return}yield x({backupId:q,encryptedMessages:r,isPointQuery:o,messageRangeInfo:t,sortOrderMs:h,source:k,storage:b,threadId:e,traceId:j});return a});return C.apply(this,arguments)}h!==void 0?h:h=b("handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages.graphql");function D(a){return E.apply(this,arguments)}function E(){E=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.backupId,e=a.encryptedMessages,g=a.messageRangeInfo,h=a.sortOrderMs,i=a.source,l=a.storage,m=a.threadId;a=a.traceId;var n=a!=null?d("WAHashStringToNumber").hashStringToNumber(a):void 0;e=w(e,b);var o=e.encryptedEchoMessages,p=e.encryptedMessagesWithProtobufs;e=(b=g)!=null?b:{};g=e.has_more_after;b=e.has_more_before;var q=e.next_message_timestamp_ms_after;e=e.next_message_timestamp_ms_before;if(b==null||g==null||q==null||e==null){c("QPLUserFlow").addPoint(c("qpl")._(521471755,"2586"),d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.MISSING_RANGE_INFO,{instanceKey:n});return}if(p.length===0){c("QPLUserFlow").addPoint(c("qpl")._(521471755,"2586"),d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.DECRYPT_MESSAGES_ECHO_START,{instanceKey:n});var r=(yield l.runInTransaction(function(a){return c("LSDecryptMessagesStoredProcedure")(c("LSFactory")(a),{actThreadId:m,encryptedMessages:c("LSVec").ofArray(o)})},"readwrite",void 0,void 0,f.id+":783"));c("QPLUserFlow").addPoint(c("qpl")._(521471755,"2586"),d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.DECRYPT_MESSAGES_ECHO_END,{instanceKey:n});r=r[0];if(r!=null){c("QPLUserFlow").addPoint(c("qpl")._(521471755,"2586"),d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.ECHO_DECODE_START,{instanceKey:n});r=c("LSVec").toArray(r).map(function(a){return d("LSShape").toRecord(a).value}).map(function(a){return d("MAWJobDefinitions").toEncodedEchoMessage(a)});r={echoMessages:r,hasMoreAfter:g,hasMoreBefore:b,isPointQuery:!1,mpsMessageQuery:void 0,nextMessageTimestampMsAfter:(j||(j=d("I64"))).of_string(q),nextMessageTimestampMsBefore:j.of_string(e),referenceTimestamp:h!=null?h:void 0,requestId:a,taskSource:i!=null?i:void 0};return r}}else{c("QPLUserFlow").addPoint(c("qpl")._(521471755,"2586"),d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.DECRYPT_MESSAGES_PROTOBUF_START,{instanceKey:n});r=(yield l.runInTransaction(function(a){return c("LSDecryptMessageProtobufsStoredProcedure")(c("LSFactory")(a),{actThreadId:m,encryptedMessagesWithProtobufs:c("LSVec").ofArray(p)})},"readwrite",void 0,void 0,f.id+":846"));c("QPLUserFlow").addPoint(c("qpl")._(521471755,"2586"),d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.DECRYPT_MESSAGES_PROTOBUF_END,{instanceKey:n});if(r[0]==null){d("WALogger").ERROR(k());c("QPLUserFlow").addPoint(c("qpl")._(521471755,"2586"),d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.PROTOBUF_DECRYPTION_FAILURE,{instanceKey:n});return}l=d("MAWEncryptedBackupUtils").convertLSTypesToJSTypesForRestoreJob(r[0]);n={hasMoreAfter:g,hasMoreBefore:b,isPointQuery:!1,mpsMessageQuery:void 0,nextMessageTimestampMsAfter:(j||(j=d("I64"))).of_string(q),nextMessageTimestampMsBefore:j.of_string(e),protobufMessages:l,referenceTimestamp:h!=null?h:void 0,requestId:a,taskSource:i!=null?i:void 0};return n}});return E.apply(this,arguments)}g.getClientState=a;g.deriveAndStoreEpochs=A;g.handleGraphQLRestoreResponse=e;g.processEncryptedMessagesForSearch=D}),98);
__d("LSEncryptedBackupsMessagesRangeQueryDirection",[],(function(a,b,c,d,e,f){a=Object.freeze({BEFORE:1,AFTER:2});f["default"]=a}),66);
__d("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="8422073107849682"}),null);
__d("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery.graphql",["MAWEncryptedBackupsRestoreMessageOverGraphQLQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"app_id"},c={defaultValue:null,kind:"LocalArgument",name:"restore_payload_string"},d={defaultValue:null,kind:"LocalArgument",name:"restore_type"},e=[{kind:"Variable",name:"app_id",variableName:"app_id"},{kind:"Variable",name:"restore_payload_string",variableName:"restore_payload_string"},{kind:"Variable",name:"restore_type",variableName:"restore_type"}],f={alias:null,args:null,kind:"ScalarField",name:"encryption_version",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"epoch_anon_id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"epoch_id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"encrypted_protobuf_stanza",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"protobuf_timestamp_ms",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"sk_ciphertext",storageKey:null},l=[g,h];return{fragment:{argumentDefinitions:[a,c,d],kind:"Fragment",metadata:null,name:"MAWEncryptedBackupsRestoreMessageOverGraphQLQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:e,concreteType:"XFBEncryptedBackupMessages",kind:"LinkedField",name:"messages",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[c,d,a],kind:"Operation",name:"MAWEncryptedBackupsRestoreMessageOverGraphQLQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:e,concreteType:"XFBEncryptedBackupMessages",kind:"LinkedField",name:"messages",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMessage",kind:"LinkedField",name:"encrypted_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEchoDocument",kind:"LinkedField",name:"echo_document",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"echo_document_string",storageKey:null},f,g,h,{alias:null,args:null,kind:"ScalarField",name:"epoch_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"otid",storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanzas",kind:"LinkedField",name:"protobuf_stanzas",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"top_level_protobuf",plural:!1,selections:[i,f,g,h,j,k],storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"supplemental_protobufs",plural:!0,selections:[i,f,g,h,j,k,{alias:null,args:null,kind:"ScalarField",name:"supplemental_key",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_id",storageKey:null},{alias:null,args:null,concreteType:"XFBMessageRangeInfo",kind:"LinkedField",name:"message_range_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_more_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_more_after",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_after",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_delete_mailbox",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochDerivationSet",kind:"LinkedField",name:"epoch_derivation_set",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupsEpochEdge",kind:"LinkedField",name:"epoch_edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"backward_edge",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochForwardEdge",kind:"LinkedField",name:"forward_edge",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"auth_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_entropy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entropy_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_storage_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"psk_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"from_epoch",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"to_epoch",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"from_epoch_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"to_epoch_fingerprint",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery_facebookRelayOperation"),metadata:{},name:"MAWEncryptedBackupsRestoreMessageOverGraphQLQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("XFBLSRestoreOperationType.facebook",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["INITIAL_RESTORE","MESSAGE_QUERY_RESTORE","POINT_QUERY_RESTORE","RANGE_QUERY_RESTORE","SNAPSHOT_RESTORE","SURROUNDING_RESTORE","UNKNOWN"]);c=a;f["default"]=c}),66);
__d("MAWEncryptedBackupsRestoreMessageOverGraphQL",["EBAPIWorkerCheck","I64","LSDatabaseSingleton","MAWCurrentUser","MAWEBRestoreTrackingUtils","MAWEncryptedBackupsRestoreMessageOverGraphQLQuery.graphql","MAWJobDefinitions","WABase64","WAJids","WALogger","WAResultOrError","WorkerRelay","WorkerRelayEnvironment","asyncToGeneratorRuntime","gkx","handleRestoreMessagesGraphQLResponse"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] getMessagesFromBackup error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth][web] mandatory params of client state are null"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mandatory params of client state are null"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] GQL point query incorrectly called from worker context"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] GQL point query called from non-worker context"]);o=function(){return a};return a}var p=h!==void 0?h:h=b("MAWEncryptedBackupsRestoreMessageOverGraphQLQuery.graphql");function a(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(b==="GQL_WORKER"&&!d("EBAPIWorkerCheck").runningInWorker()){d("WALogger").ERROR(o());return d("WAResultOrError").makeError(null)}if(b==="GQL_MAIN_THREAD"&&d("EBAPIWorkerCheck").runningInWorker()){d("WALogger").ERROR(n());return d("WAResultOrError").makeError(null)}b=a.messageId;var c=a.sortOrderMs,e=a.source,f=a.threadId;a=a.traceId;var g=(yield (i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton),h=(yield d("handleRestoreMessagesGraphQLResponse").getClientState(g));if(h==null){a!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"client_state_null",traceId:a,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(a));return d("WAResultOrError").makeError(null)}var k=h.device_id,l=h.locally_available_epochs,q=h.mailboxRootKey;h=h.ocmfClientStateBlob;if(k==null||q==null||h==null){a!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"mandatory_params_client_state_null",traceId:a,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(a));d("WALogger").ERROR(m());return d("WAResultOrError").makeError(null)}var r=d("MAWCurrentUser").getAppID();yield d("WorkerRelayEnvironment").createWorkerRelayEnvironment();l={restore_context:{act_thread_id:d("MAWJobDefinitions").toThreadJidPrimaryId(f),site:"www",tam_thread_subtype:0},success:{device_context:{device_id:(j||(j=d("I64"))).to_float(k),locally_available_epochs:l,raw_tokens:{mailbox_root_key:d("WABase64").encodeB64(q),ocmf_client_state_blob:d("WABase64").encodeB64(h)}},message_id:b}};c!=null&&(l=babelHelpers["extends"]({},l,{reference_timestamp:(j||(j=d("I64"))).to_float(c)}));h=(yield d("WorkerRelay").createWorkerQuery(p,{app_id:String((q=r)!=null?q:"0"),restore_payload_string:JSON.stringify(l),restore_type:"POINT_QUERY_RESTORE"}));if(h!=null&&(h==null?void 0:(b=h.viewer)==null?void 0:(r=b.encrypted_backup)==null?void 0:r.mailbox)!=null){a!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"gql_point_restore_response_nonnull",traceId:a,type:"none"});r=(yield d("handleRestoreMessagesGraphQLResponse").handleGraphQLRestoreResponse(h==null?void 0:(q=h.viewer)==null?void 0:(l=q.encrypted_backup)==null?void 0:(b=l.mailbox)==null?void 0:b.messages,g,f,k,c!=null?(j||(j=d("I64"))).to_string(c):void 0,a,e,!0));return r==null?d("WAResultOrError").makeError(null):d("WAResultOrError").makeResult(r)}return d("WAResultOrError").makeError(null)});return q.apply(this,arguments)}function e(a,b,c,d,e,f){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h){d("MAWEBRestoreTrackingUtils").markEBRestorePaginated(h,g,"GQL_MAIN_THREAD");try{var i=(yield d("handleRestoreMessagesGraphQLResponse").getClientState(b));if(i==null){g!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"client_state_null",traceId:g,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(g));return}var m=i.device_id,n=i.locally_available_epochs,o=i.mailboxRootKey;i=i.ocmfClientStateBlob;if(m==null||o==null||i==null){g!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"client_state_null",traceId:g,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(g));d("WALogger").ERROR(l());return}var q=d("MAWCurrentUser").getAppID();a=d("WAJids").threadIdForChatJid(a);yield d("WorkerRelayEnvironment").createWorkerRelayEnvironment();q=(yield d("WorkerRelay").createWorkerQuery(p,{app_id:String((q=q)!=null?q:"0"),restore_payload_string:JSON.stringify({restore_context:{act_thread_id:d("MAWJobDefinitions").toThreadJidPrimaryId(a),site:"www",tam_thread_subtype:0},success:{device_context:{device_id:(j||(j=d("I64"))).to_float(m),locally_available_epochs:n,raw_tokens:{mailbox_root_key:d("WABase64").encodeB64(o),ocmf_client_state_blob:d("WABase64").encodeB64(i)}},direction:f,include_offset:c("gkx")("5340"),reference_timestamp:j.to_float(e),server_thread_key:a}}),restore_type:"RANGE_QUERY_RESTORE"}));if(q!=null&&(q==null?void 0:(n=q.viewer)==null?void 0:(o=n.encrypted_backup)==null?void 0:o.mailbox)!=null){g!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"gql_range_restore_response_nonnull",traceId:g,type:"none"});yield d("handleRestoreMessagesGraphQLResponse").handleGraphQLRestoreResponse(q==null?void 0:(i=q.viewer)==null?void 0:(f=i.encrypted_backup)==null?void 0:(n=f.mailbox)==null?void 0:n.messages,b,a,m,(j||(j=d("I64"))).to_string(e),g,h,!1)}return q}catch(a){d("WALogger").ERROR(k(),a),g!=null&&(d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"gql_range_restore_exception",traceId:g,type:"none"}),d("MAWEBRestoreTrackingUtils").markEBRestoreFail(g))}});return r.apply(this,arguments)}g.query=p;g.getPointRestoreResponseFromGQL=a;g.getMessagesFromBackup=e}),98);
__d("EBMessageRangeQueryForIndexing",["EBAPIQPLPoints","EBAPISharedUtils","I64","LSEncryptedBackupsBackupTenancy","LSEncryptedBackupsMessagesRangeQueryDirection","LSIntEnum","MAWCurrentUser","MAWEncryptedBackupUtils","MAWEncryptedBackupsRestoreMessageOverGraphQL","MAWJobDefinitions","QPLUserFlow","WABase64","WAHashStringToNumber","WAJids","WALogger","WAPushSafeTypes","WAResultOrError","WorkerRelay","asyncToGeneratorRuntime","cr:7713","gkx","handleRestoreMessagesGraphQLResponse","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] graphQL range restore error ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mandatory params of client state are null"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No client state found - unable to restore"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Calling EBLS without EBLS being available for message range query"]);m=function(){return a};return a}function a(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WAPushSafeTypes").unsafeNotNullable(a);var e=a.chatJid,f=a.direction,g=a.sortOrderMs,n=a.source;a=a.traceId;var o=a!=null?d("WAHashStringToNumber").hashStringToNumber(a):void 0,p=c("qpl")._(521471755,"2586");try{c("QPLUserFlow").start(p,{annotations:{bool:{mainThreadRestore:!1,workerThreadRestore:!0}},instanceKey:o});if(b("cr:7713")==null){d("WALogger").ERROR(m());c("QPLUserFlow").endFailure(p,d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.EBLS_NOT_INITIALIZED,{instanceKey:o});return d("WAResultOrError").makeError("ebls-not-intialized")}yield b("cr:7713").init();var q=(yield b("cr:7713").getLSStorage()),r=(yield d("MAWEncryptedBackupUtils").getBackupTenancy(q.tables));if(r!=null&&!(h||(h=d("I64"))).equal(r,(i||(i=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION)))return d("WAResultOrError").makeError("eb-not-enabled");r=(yield d("handleRestoreMessagesGraphQLResponse").getClientState(q));if(r==null){d("WALogger").ERROR(l());c("QPLUserFlow").endFailure(p,d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.NO_CLIENT_STATE,{instanceKey:o});return d("WAResultOrError").makeError("no-client-state")}var s=r.device_id,t=r.locally_available_epochs,u=r.mailboxRootKey;r=r.ocmfClientStateBlob;if(s==null||u==null||r==null){d("WALogger").ERROR(k());c("QPLUserFlow").endFailure(p,d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.INVALID_CLIENT_STATE,{instanceKey:o});return d("WAResultOrError").makeError("invalid-client-state")}var v=d("MAWCurrentUser").getAppID();e=d("WAJids").threadIdForChatJid(e);f=f==="before"?c("LSEncryptedBackupsMessagesRangeQueryDirection").BEFORE:c("LSEncryptedBackupsMessagesRangeQueryDirection").AFTER;t={restore_context:{act_thread_id:d("MAWJobDefinitions").toThreadJidPrimaryId(e),site:"www",tam_thread_subtype:0},success:{device_context:{device_id:(h||(h=d("I64"))).to_float(s),locally_available_epochs:t,raw_tokens:{mailbox_root_key:d("WABase64").encodeB64(u),ocmf_client_state_blob:d("WABase64").encodeB64(r)}},direction:f,include_offset:c("gkx")("5340"),server_thread_key:e}};g!=null&&(t=babelHelpers["extends"]({},t,{reference_timestamp:g}));c("QPLUserFlow").addPoint(p,d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.GRAPHQL_QUERY_START,{instanceKey:o});r=(yield d("WorkerRelay").createWorkerQuery(d("MAWEncryptedBackupsRestoreMessageOverGraphQL").query,{app_id:String((u=v)!=null?u:"0"),restore_payload_string:JSON.stringify(t),restore_type:"RANGE_QUERY_RESTORE"}));f=(yield d("EBAPISharedUtils").constructEBRestoreResponse(r,p,q,o,s,e,n,a,g));if(f.success)return d("WAResultOrError").makeResult(f.response);else return d("WAResultOrError").makeError(f.response)}catch(a){d("WALogger").ERROR(j(),a);c("QPLUserFlow").endFailure(p,d("EBAPIQPLPoints").EBMessageRangeQueryQPLPoints.RUNTIME_ERROR,{error:a,instanceKey:o});return d("WAResultOrError").makeError("runtime-error",a)}});return n.apply(this,arguments)}g.messageRangeQueryForIndexing=a}),98);
__d("EncryptedBackupsConvertToLegacyAttachmentContext",["MAWCastToMsgrServerMediaType","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid "," media type for legacy attachment upload"]);h=function(){return a};return a}function a(a){var b=[];for(var c=0;c<a.length;c++){var e=a[c],f=d("MAWCastToMsgrServerMediaType").castMediaAttachmentTypeToServerMediaType(e.mediaType);f==null?d("WALogger").ERROR(h(),e.mediaType):b.push({mediaObjectId:e.mediaObjectId,mediaType:f})}return b}g["default"]=a}),98);
__d("EncryptedBackupsCastToAttachmentContextMediaType",["EncryptedBackupsUploadEntity","MAWDbMedia","WALogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid AttachmentContextMediaType: ",""]);h=function(){return a};return a}function a(a){switch(a){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.IMAGE;case d("MAWDbMedia").MEDIA_TYPE.VIDEO:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.VIDEO;case d("MAWDbMedia").MEDIA_TYPE.PTT:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.PTT;case d("MAWDbMedia").MEDIA_TYPE.GIF:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.GIF;case d("MAWDbMedia").MEDIA_TYPE.STICKER:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.STICKER;case d("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE:return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.DOCUMENT;default:a;d("WALogger").ERROR(h(),a);return d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.INVALID}}g["default"]=a}),98);
__d("EncryptedBackupsGetAttachmentContextForReceivedMsg",["EncryptedBackupsCastToAttachmentContextMediaType","EncryptedBackupsUploadEntity","WAMediaUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,e=new Map(),f=[];if(((b=a.decodedMsg)==null?void 0:b.unstoredDbMedia)!=null){b=(b=a.decodedMsg)==null?void 0:b.unstoredDbMedia;var g=b.mediaType;b=d("WAMediaUtils").decodeMediaEntryData(b.mediaEntry);var h=b.downloadableThumbnail;b=b.objectId;h=h==null?void 0:h.objectId;g=c("EncryptedBackupsCastToAttachmentContextMediaType")(g);b!=null&&g!=null&&e.set(d("WAMediaUtils").stringToDeliveryObjectId(b),g);h!=null&&c("gkx")("6038")&&e.set(d("WAMediaUtils").stringToDeliveryObjectId(h),d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.MESSENGER_PREVIEW)}if(((b=a.decodedMsg)==null?void 0:b.unstoredXMA)!=null){h=(g=a.decodedMsg)==null?void 0:g.unstoredXMA;if(h.unstoredFavicon!=null){b=d("WAMediaUtils").decodeMediaEntryData(h.unstoredFavicon.mediaEntry);a=b.objectId;a!=null&&e.set(d("WAMediaUtils").stringToDeliveryObjectId(a),d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}if(h.unstoredHeaderMedia!=null){g=d("WAMediaUtils").decodeMediaEntryData(h.unstoredHeaderMedia.mediaEntry);b=g.objectId;b!=null&&e.set(d("WAMediaUtils").stringToDeliveryObjectId(b),d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}if(h.unstoredAssociatedMedia!=null){a=d("WAMediaUtils").decodeMediaEntryData(h.unstoredAssociatedMedia.mediaEntry);g=a.objectId;g!=null&&e.set(d("WAMediaUtils").stringToDeliveryObjectId(g),d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}h.unstoredPreviews!=null&&h.unstoredPreviews.length>0&&h.unstoredPreviews.forEach(function(a){a=a.mediaEntry;a=d("WAMediaUtils").decodeMediaEntryData(a);a=a.objectId;a!=null&&e.set(d("WAMediaUtils").stringToDeliveryObjectId(a),d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)})}e.forEach(function(a,b){f.push({mediaObjectId:b,mediaType:a})});return f}g["default"]=a}),98);
__d("MessageBackupDirectiveGenerator",["FBLogger","I64","MAWMsgType","MessageBackupSupplementalKeyGenerator","WAGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){return{actionType:2,originalMsgProtocolId:a,supplementalKey:d("MessageBackupSupplementalKeyGenerator").createMessageSupplementalKey(d("MessageBackupSupplementalKeyGenerator").SupplementalKeyPrefix.REACTION,(h||(h=d("I64"))).to_string(b))}}function j(a,b){return{actionType:2,originalMsgProtocolId:a,supplementalKey:d("MessageBackupSupplementalKeyGenerator").createMessageSupplementalKey(d("MessageBackupSupplementalKeyGenerator").SupplementalKeyPrefix.EDIT,(h||(h=d("I64"))).to_string(b))}}function k(a){if(d("WAJids").isAuthorSystem(a.author))return null;if(a.reactToExternalId!=null)return{author:a.reactToAuthor===d("WAGlobals").getMyUserJid()?"@me":a.reactToAuthor,chat:a.threadJid,externalId:a.reactToExternalId};else if(a.originalMsgExternalId!=null)return{author:a.author,chat:a.threadJid,externalId:a.originalMsgExternalId};else if(a.revokedExternalId!=null)return{author:a.author,chat:a.threadJid,externalId:a.revokedExternalId};return a.externalId==null?null:{author:a.author,chat:a.threadJid,externalId:a.externalId}}function a(a){var b=(h||(h=d("I64"))).of_string(d("WAJids").authorToUserId(a.author,d("WAJids").extractUserId(d("WAGlobals").getMyUserJid()))),c=k(a);if(c==null)return null;if(a.originalMsgExternalId!=null)return j(c,b);return a.reactToExternalId!=null?i(c,b):l(c,b,a.type)}function l(a,b,e){switch(e){case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.XMA:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:return{actionType:1,originalMsgProtocolId:a};case d("MAWMsgType").MSG_TYPE.REACTION:return i(a,b);case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return j(a,b);case d("MAWMsgType").MSG_TYPE.REVOKED:return{actionType:4,originalMsgProtocolId:a};case d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME:return{actionType:3,originalMsgProtocolId:a};default:c("FBLogger")("labyrinth_web").mustfix("Unsupported message type %s",e);return{actionType:0,originalMsgProtocolId:a}}}g.createMessageBackupDirectiveFromDbMsg=a;g.createMessageBackupDirective=l}),98);
__d("EBUploadReceivedMessages",["EncryptedBackupsConvertToLegacyAttachmentContext","EncryptedBackupsGetAttachmentContextForReceivedMsg","EncryptedBackupsUploadQueue","I64","LSRequestId","MAWEBUploadMessageUtils","MAWEBUploadTrackingUtils","MAWMsgType","MessageBackupDirectiveGenerator","WAAsMessageApplication","WAGlobals","WAJids","WALogger","WAMsgApplication.pb","WAResultOrError","WATimeUtils","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] error generating backup directive for received message, ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] no result or failed for incoming stanza ",""]);j=function(){return a};return a}function k(a){if(a==null)return null;var b;if(a.unstoredDbReaction!=null)return d("MAWMsgType").MSG_TYPE.REACTION;else if(a.unstoredDbEditActionMsg!=null)return d("MAWMsgType").MSG_TYPE.EDIT_ACTION;else if(a.unstoredDbMedia!=null)b=a.unstoredDbMedia.mediaType;else if(a.unstoredXMA!=null)b=d("MAWMsgType").MSG_TYPE.XMA;else if(a.unstoredDbMsg!=null)b=a.unstoredDbMsg.type;else return null;return d("MAWMsgType").isEBSupportedMsgType(b)?b:null}function l(a){var b,c=a.stanza.message.decrypted.id;if(((b=a.decodedMsg)==null?void 0:b.unstoredDbReaction)!=null)return{author:a.decodedMsg.unstoredDbReaction.reactToAuthor,chat:c.chat,externalId:a.decodedMsg.unstoredDbReaction.reactToExternalId};else if(((b=a.decodedMsg)==null?void 0:b.unstoredDbEditActionMsg)!=null)return{author:c.author,chat:c.chat,externalId:a.decodedMsg.unstoredDbEditActionMsg.originalMsgExternalId};return c}function a(a){var b=a.incomingMessages;a.instanceKey;var e=a.msgResults;try{if(b.length===0)return d("WAResultOrError").makeResult();a=b.map(function(a){try{var b,f=a.stanza.message.decrypted.id,g=e.get(f),m=k(a.decodedMsg);if(g==null||!g.success||m==null){d("WALogger").EXPECTED_ERROR(j(),a.stanza.message.decrypted.id);return null}g=f.author;var n=f.externalId,o=l(a),p=a.stanza.message.decrypted.msg;if((p==null?void 0:p.version)!=="v3"||p.type!=="subprotocol")return null;p={metadata:p.metadata,payload:{subProtocol:(b={},b[p.subprotocolType]={payload:p.subprotocol.buffer,version:1},b)}};b={bytes:d("WAAsMessageApplication").castToMessageApplicationBytes(d("encodeProtobuf").encodeProtobuf(d("WAMsgApplication.pb").MessageApplicationSpec,p).readByteArray()),version:"v3"};p=a.stanza.message.details.reportingMeta;var q=a.stanza.message.details.ts;a=c("EncryptedBackupsGetAttachmentContextForReceivedMsg")(a);a=c("EncryptedBackupsConvertToLegacyAttachmentContext")(a);var r=[];a.length>0&&a.forEach(function(a){var b=a.mediaObjectId;a=a.mediaType;r.push({deliveryObjectId:b,mediaType:a,messageId:f.externalId,productType:"msgr",threadId:d("WAJids").threadIdForChatJid(f.chat),threadJid:f.chat,traceId:c("LSRequestId").generate(),ts:q})});d("MAWEBUploadTrackingUtils").addExternalIdToCache(f,m);return{backupDirective:d("MessageBackupDirectiveGenerator").createMessageBackupDirective(o,(h||(h=d("I64"))).of_string(d("WAJids").authorToUserId(g,d("WAJids").extractUserId(d("WAGlobals").getMyUserJid()))),m),legacyAttachmentContext:r,messageApplication:b.bytes,msgId:f,originalMsgProtocolId:o,reportingMeta:p,senderId:h.of_string(d("WAJids").authorToUserId(g,d("WAJids").extractUserId(d("WAGlobals").getMyUserJid()))),serverTs:q,sortOrderMs:d("WATimeUtils").castToMillisTime(d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder({externalId:n,serverTs:q,ts:q}))}}catch(a){d("WALogger").ERROR(i(),a);return null}}).filter(Boolean);if(a.length===0)return d("WAResultOrError").makeResult();d("EncryptedBackupsUploadQueue").putMsgsToEbUpload(a);return d("WAResultOrError").makeResult()}catch(a){return d("WAResultOrError").makeError("runtime-exception",a)}}g.uploadReceivedMessages=a}),98);
__d("MAWGetAllMediaIdsForXMAMsgApi",["MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({xma:d("MAWTransactionMode").READONLY},"getAllMediaIdsForXMAMsg",function(a){return function(b){var c=new Map();b=b.map(function(b){return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,b).then(function(a){var d,e=(d=c.get(b))!=null?d:new Set();a!=null&&(a.faviconMediaId!=null&&e.add(a.faviconMediaId),a.headerMediaId!=null&&e.add(a.headerMediaId),a.previewMediaIds!=null&&a.previewMediaIds.forEach(function(a){return e.add(a)}));c.set(b,e)})});return d("MAWDexieTable").dexieAll(b).then(function(a){return c})}});g.getAllMediaIdsForXMAMsg=a}),98);
__d("EncryptedBackupsGetAttachmentContextForSentMsgXMA",["EncryptedBackupsUploadEntity","MAWDbMediaTxns","MAWGetAllMediaIdsForXMAMsgApi","MAWIndexedDb","MAWTransactionMode","WAMediaUtils","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READONLY},"bulkGetRetroactiveMedia",function(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWDbMediaTxns").bulkGetMedias.apply(void 0,[a].concat(c))}});function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=(yield d("MAWGetAllMediaIdsForXMAMsgApi").getAllMediaIdsForXMAMsg([a]).then(function(b){b=b.get(a);return b!=null?h(Array.from(b)):[]}));return e.filter(Boolean).flatMap(function(a){var e=b.msgId!=null?a==null?void 0:a.mediaEntries.get(b.msgId):null;e=e!=null?d("WAMediaUtils").decodeMediaEntryData(e):null;var f=[];(e==null?void 0:e.objectId)!=null&&a.mediaType!=null&&f.push({mediaObjectId:e.objectId,mediaType:d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA});e=e==null?void 0:(a=e.downloadableThumbnail)==null?void 0:a.objectId;e!=null&&c("gkx")("6038")&&f.push({isPreview:!0,mediaObjectId:d("WAMediaUtils").stringToDeliveryObjectId(e),mediaType:d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.MESSENGER_PREVIEW});return f})});return i.apply(this,arguments)}g["default"]=a}),98);
__d("EncryptedBackupsGetAttachmentContextForSentMsg",["EncryptedBackupsCastToAttachmentContextMediaType","EncryptedBackupsGetAttachmentContextForSentMsgXMA","EncryptedBackupsUploadEntity","WAMediaUtils","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.dbMsg,e=a.isXMAMsg,f=a.media;a=a.protocolMsgIdFromArgs;if(e===!0){e=(yield c("EncryptedBackupsGetAttachmentContextForSentMsgXMA")(a,b));return e.filter(Boolean)}a=[];e=b.msgId!=null?f==null?void 0:f.mediaEntries.get(b.msgId):null;b=e!=null?d("WAMediaUtils").decodeMediaEntryData(e):null;if(f==null||b==null)return[];if(b.objectId!=null&&f.mediaType!=null){a.push({mediaObjectId:b.objectId,mediaType:c("EncryptedBackupsCastToAttachmentContextMediaType")(f.mediaType)});f=(e=b.downloadableThumbnail)==null?void 0:e.objectId;f!=null&&c("gkx")("6038")&&a.push({mediaObjectId:d("WAMediaUtils").stringToDeliveryObjectId(f),mediaType:d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.MESSENGER_PREVIEW})}return a});return h.apply(this,arguments)}g["default"]=a}),98);
__d("EncryptedBackupsGetAttachmentContextForSentMsgV2",["EncryptedBackupsCastToAttachmentContextMediaType","EncryptedBackupsUploadEntity","WAMediaUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var f=new Map(),g=[],h=a.msgId;if(b!=null){a=h!=null?b.mediaEntries.get(h):null;a=a!=null?d("WAMediaUtils").decodeMediaEntryData(a):null;b=c("EncryptedBackupsCastToAttachmentContextMediaType")(b.mediaType);if((a==null?void 0:a.objectId)!=null&&b!=null){var i=a.objectId;f.set(i,b)}b=a==null?void 0:(i=a.downloadableThumbnail)==null?void 0:i.objectId;b!=null&&c("gkx")("6038")&&f.set(b,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.MESSENGER_PREVIEW)}if(e!=null){if(e.favicon!=null){a=e.favicon.objectId;a!=null&&f.set(a,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}if(e.header!=null){i=e.header.objectId;i!=null&&f.set(i,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}e.previews!=null&&e.previews.length>0&&e.previews.forEach(function(a){a=a.mediaEntries;a=h!=null?a.get(h):null;a=a!=null?d("WAMediaUtils").decodeMediaEntryData(a):null;if((a==null?void 0:a.objectId)!=null){a=a.objectId;f.set(a,d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.XMA)}})}f.forEach(function(a,b){g.push({mediaObjectId:b,mediaType:a})});return g}g["default"]=a}),98);
__d("EBUploadSentMessage",["EncryptedBackupsConvertToLegacyAttachmentContext","EncryptedBackupsGetAttachmentContextForSentMsg","EncryptedBackupsGetAttachmentContextForSentMsgV2","EncryptedBackupsUploadQueue","I64","LSRequestId","MAWEBUploadMessageUtils","MAWEBUploadTrackingUtils","MAWMsgType","MessageBackupDirectiveGenerator","WAFrankingTypes","WAGenReportingMeta","WAGlobals","WAJids","WALogger","WAResultOrError","WATimeUtils","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg adding message "," attachments to EB upload queue"]);i=function(){return a};return a}function j(a){if(a.reactToExternalId!=null)return d("MAWMsgType").MSG_TYPE.REACTION;else if(a.editMsgHistoryId!=null)return d("MAWMsgType").MSG_TYPE.EDIT_ACTION;else if(a.type==null)return null;else return d("MAWMsgType").isEBSupportedMsgType(a.type)?a.type:null}function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.dbMsg;a.instanceKey;var e=a.isXMAMsg;e=e===void 0?!1:e;var f=a.media,g=a.messageApplication,k=a.messageApplicationBytes,l=a.protocolMsgId,m=a.serverTs;a=a.xmaPayload;try{if(d("WAJids").isAuthorSystem(b.author))return d("WAResultOrError").makeResult();var n=j(b);if(n==null)return d("WAResultOrError").makeError("Unsupported EB upload message type");var o=d("MessageBackupDirectiveGenerator").createMessageBackupDirectiveFromDbMsg(b);if(o==null)return d("WAResultOrError").makeError("Unable to create backup directive");g=g==null?void 0:g.metadata;var p=[];c("gkx")("2453")?p=c("EncryptedBackupsGetAttachmentContextForSentMsgV2")(b,f,a):p=(yield c("EncryptedBackupsGetAttachmentContextForSentMsg")({dbMsg:b,isXMAMsg:e,media:f,protocolMsgIdFromArgs:l}));d("WALogger").LOG(i(),(a=p)==null?void 0:a.length);d("MAWEBUploadTrackingUtils").addExternalIdToCache(l,n);e=(yield d("WAGenReportingMeta").genReportingMeta(k,(g==null?void 0:g.frankingKey)?d("WAFrankingTypes").castToFrankingKey(new Uint8Array(g==null?void 0:g.frankingKey)):null,g==null?void 0:g.frankingVersion));f=c("EncryptedBackupsConvertToLegacyAttachmentContext")(p);var q=[];f.length>0&&f.forEach(function(a){var e=a.mediaObjectId;a=a.mediaType;q.push({deliveryObjectId:e,mediaType:a,messageId:l.externalId,productType:"msgr",threadId:d("WAJids").threadIdForChatJid(l.chat),threadJid:b.threadJid,traceId:c("LSRequestId").generate(),ts:m})});d("EncryptedBackupsUploadQueue").putMsgsToEbUpload([{attachmentContext:p,backupDirective:o,legacyAttachmentContext:q,messageApplication:k,msgId:l,originalMsgProtocolId:o.originalMsgProtocolId.externalId!==l.externalId?o.originalMsgProtocolId:l,reportingMeta:e,senderId:(h||(h=d("I64"))).of_string(d("WAJids").authorToUserId(l.author,d("WAJids").extractUserId(d("WAGlobals").getMyUserJid()))),serverTs:m,sortOrderMs:d("WATimeUtils").castToMillisTime(d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder({externalId:l.externalId,serverTs:m,ts:m}))}]);return d("WAResultOrError").makeResult()}catch(a){return d("WAResultOrError").makeError("runtime-error",a)}});return k.apply(this,arguments)}g.uploadSentMessage=a}),98);
__d("EchoSerializationFailureFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5722");b=d("FalcoLoggerInternal").create("echo_serialization_failure",a);e=b;g["default"]=e}),98);
__d("EchoSerializationSuccessFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5723");b=d("FalcoLoggerInternal").create("echo_serialization_success",a);e=b;g["default"]=e}),98);
__d("EncryptedBackupsDYIHandleMessageRestore",["EncryptedBackupsDYISingleton","I64"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Issuing next range query for thread with thread key ",", server generated next reference timestamp: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["nextTimestampMs was not supplied for thread with thread key ","."]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["handling message range query for thread with thread key ",", hasMoreBefore: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot find thread key for thread id: ",""]);l=function(){return a};return a}function a(a,b,c,e,f,g,n){var o=d("EncryptedBackupsDYISingleton").getSingleton(),p=o.getLogger();o=o.getThreadKeyForThreadId(b);if(o==null){p.WARN(l(),b);return}void p.LOG(k(),b,e);c.length>0&&g(o,b,c);if(!e||f==null){e&&f==null&&void p.ERROR(j(),b);m(o);return}g=(h||(h=d("I64"))).to_string(f);void p.LOG(i(),b,g);void n(a,g,b)}function m(a){var b=d("EncryptedBackupsDYISingleton").getSingleton();b.deleteThreadKeyFromThreadsRestoreInProgress(a)}g.handleMessageRangeQueryRestore=a}),98);
__d("EncryptedBackupsDYIMediaDownloadHandlers",["EncryptedBackupsDYIFileUtils","EncryptedBackupsDYISingleton","FBLogger","Promise","WAResultOrError","asyncToGeneratorRuntime","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f){f=(yield d("EncryptedBackupsDYIFileUtils").getMediaFolderHandle());b=b.split("/")[1];b=c("uuidv4")()+"."+b;yield d("EncryptedBackupsDYIFileUtils").writeFile(f,b,e);f=d("EncryptedBackupsDYISingleton").getSingleton();f.setMediaUrlByPlainTextHash(a,d("EncryptedBackupsDYIFileUtils").DyiMediaFolder+"/"+b);f.deletePlaintextHashFromAttachmentDownloadsInProgress(a);return d("WAResultOrError").makeResult()});return function(b,c,d,e){return a.apply(this,arguments)}}();e=function(){c("FBLogger")("labyrinth_web").debug("[DYIMediaPreviewHandler] Skipping previews for DYI");return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult())};g.DYIMediaDownloadHandler=a;g.DYIMediaPreviewHandler=e}),98);
__d("LSIssueAttachmentRestoreTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSBinaryToHex.nop","LSCreateDataTrace","LSCreateDataTraceID.nop","LSCreateDerivedKeys.nop","LSFindBackup","LSFlushDataTrace.nop","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] Beginning execution."),a[7]!==void 0?c.resolve(d[1]=a[7]):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))&&c.i64.eq(a.backupTenancy,c.i64.cast([0,2]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){b=a.done;a=a.value;return b?d[27]=!1:(a.item,d[27]=!0)})},function(a){return d[27]?d[29]=c.i64.or_(c.i64.cast([0,82]),c.i64.cast([0,128])):d[29]=c.i64.cast([0,82]),c.sequence([function(a){return c.nativeOperation(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,d[31]=a[0],a})},function(a){return c.sequence([function(a){return d[35]="EncryptedBackups MCD Trace ID",d[36]=c.i64.to_string(d[29]),d[34]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils] ",d[34],d[35],d[34],d[36]].join("")),c.resolve()},function(a){return c.storedProcedure(b("LSCreateDataTrace"),d[31],void 0,void 0,"media_restore",d[29])}])},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()},function(a){return d[30]=d[31]}])},function(a){return d[1]=d[30]}])},function(a){return c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,1829]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[27]=a[0],a})},function(a){return d[27]?d[28]=!0:d[28]=!1,d[28]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[29]=c.createArray(),void 0!==void 0?d[30]=(d[29].push(void 0),d[29]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[29],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,e){var f=a.done;a=a.value;return f?(f=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,20]),void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],d[9]=f[7],d[10]=f[8],d[11]=f[9],d[12]=f[10],d[13]=f[11],d[14]=f[12],d[15]=f[13],d[16]=f[14],d[17]=f[15],d[18]=f[16],f):(e=a.item,c.sequence([function(a){return d[32]=e.backupTenancy,d[31]=e.encryptionVersion,d[27]=void 0,c.i64.neq(d[27],void 0)?c.resolve(d[28]=d[27]):c.sequence([function(a){return d[33]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[34]=a[0],a})},function(a){return d[34]?d[43]=(d[33].push(c.i64.cast([0,0])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[35]?d[43]=(d[33].push(c.i64.cast([0,2])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[43]=(d[33].push(c.i64.cast([0,3])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[43]=(d[33].push(c.i64.cast([0,4])),d[33]):0,d[38]=c.createArray(),d[39]=c.i64.of_int32(d[33].length),c.i64.gt(d[39],c.i64.cast([0,0]))?c.loopAsync(d[39],function(a){return d[43]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[33],d[43]).then(function(a){return a=a,d[44]=a[0],d[45]=a[1],a})},function(a){return d[46]=(d[38].push(d[44]),d[38])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[43]=c.createArray(),d[44]=c.i64.of_int32(d[38].length),c.i64.gt(d[44],c.i64.cast([0,0]))?c.loopAsync(d[44],function(a){return d[46]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[38],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=(d[43].push(c.i64.to_string(d[47])),d[43])}])}):c.resolve()},function(a){return d[45]=d[43].join(","),d[40]=d[45]}])},function(a){return d[38].some(function(a){return c.i64.eq(d[31],a)})?d[41]=d[31]:d[41]=void 0,c.i64.neq(d[41],void 0)?d[42]=d[41]:d[42]=void 0,d[28]=d[42]}])},function(a){return c.i64.neq(d[28],void 0)?d[29]=d[28]:d[29]=c.i64.cast([0,0]),c.i64.neq(d[32],void 0)?d[30]=d[32]:d[30]=c.i64.cast([0,1]),a=[e.backupId,e.deviceId,e.mailboxRootKeyBlob,e.ocmfClientStateBlob,void 0,void 0,d[29],d[30],e.epochAuthPublicKeyBlob,e.epochAuthPrivateKeyBlob,e.devicePublicKeyBlob,e.devicePrivateKeyBlob,e.epochStoragePublicKeyBlob,e.epochStoragePrivateKeyBlob,e.obliviousValidationTokenBlob,e.authorityLevel,void 0],d[2]=a[0],d[3]=a[1],d[4]=a[2],d[5]=a[3],d[6]=a[4],d[7]=a[5],d[8]=a[6],d[9]=a[7],d[10]=a[8],d[11]=a[9],d[12]=a[10],d[13]=a[11],d[14]=a[12],d[15]=a[13],d[16]=a[14],d[17]=a[15],d[18]=a[16],a}]))})},function(a){return c.storedProcedure(b("LSFindBackup")).then(function(a){return a=a,d[20]=a[0],a})},function(e){return c.blobs.neq(d[5],void 0)?c.i64.neq(d[3],void 0)?d[20]!==void 0?c.blobs.neq(d[4],void 0)?c.sequence([function(e){return d[27]=c.createArray(),d[34]=(d[27].push(d[20]),d[27]),d[34]=(d[27].push(a[1]),d[27]),d[28]=c.toJSON(d[27]),d[29]=c.createArray(),d[34]=(d[29].push(c.i64.cast([0,32])),d[29]),c.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",a[5]].join("")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[30],void 0,d[4],d[29]).then(function(a){return a=a,d[31]=a[0],a})},function(a){return d[31]?d[32]=!1:d[32]=!0,d[32]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils","Got null keys while deriving message list OPE key. Returning null blobish",d[34],c.i64.cast([0,3]))},function(a){return d[33]=void 0}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[31],c.i64.cast([0,0])).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[33]=d[34]}])},function(e){return c.blobs.neq(d[33],void 0)?c.sequence([function(e){return c.i64.neq(a[9],void 0)?d[34]=a[9]:d[34]=c.i64.cast([-1,4294967295]),c.nativeOperation(b("LSGetBlobFromInt64BE.nop"),a[6]).then(function(a){return a=a,d[35]=a[0],a})},function(a){return c.nativeOperation(b("LSTruncateSortKey.nop"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return c.nativeOperation(b("LSOpeEncrypt.nop"),d[33],d[36],c.i64.cast([0,16])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return c.nativeOperation(b("LSBinaryToHex.nop"),d[37]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[28]).then(function(a){return a=a,d[39]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2NvcGU="),d[39]).then(function(a){return a=a,d[40]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[40]).then(function(a){return a=a,d[41]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[42]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[20]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWFpbGJveF9pZF9zY29wZQ=="),d[43]).then(function(a){return a=a,d[44]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[44]).then(function(a){return a=a,d[45]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[46]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[4]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWVzc2FnZV9pZF9zY29wZQ=="),d[47]).then(function(a){return a=a,d[48]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[48]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[49]).then(function(a){return a=a,d[50]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[4]).then(function(a){return a=a,d[51]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[51]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[52]).then(function(a){return a=a,d[53]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[53]).then(function(a){return a=a,d[54]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[5]).then(function(a){return a=a,d[55]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("dGhyZWFkX2lkX3Njb3Bl"),d[55]).then(function(a){return a=a,d[56]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[56]).then(function(a){return a=a,d[57]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[57]).then(function(a){return a=a,d[58]=a[0],a})},function(e){return d[59]=new c.Map(),d[59].set("attachment_index_key",d[42]==null?"":d[42]),d[59].set("backup_ent_fbid",a[0]),d[59].set("delivery_object_id",a[1]),d[59].set("device_id",d[3]),d[59].set("mailbox_partial_id",d[46]==null?"":d[46]),d[59].set("media_type",a[3]),d[59].set("message_partial_id",d[50]==null?"":d[50]),d[59].set("product_type",a[2]),d[59].set("salt_partial_id",d[54]==null?"":d[54]),d[59].set("sort_key",d[38]==null?"":d[38]),d[59].set("thread_partial_id",d[58]==null?"":d[58]),d[59].set("trace_id",d[1]),d[59].set("source",d[34]),d[60]=new c.Map(),d[60].set("otid",a[4]),d[60].set("server_thread_key",a[8]),d[60].set("timestamp",c.i64.to_string(a[6])),c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[61]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[4]).then(function(a){return a=a,d[62]=a[0],a})},function(e){return d[63]=new c.Map(),d[63].set("ocmf_client_state_blob",d[61]==null?"":d[61]),d[63].set("mailbox_root_key",d[62]==null?"":d[62]),d[64]=c.createArray(),d[76]=(d[64].push(a[4]),d[64]),d[76]=(d[64].push(a[1]),d[64]),d[65]=c.toJSON(d[64]),d[59].set("raw_identifiers",d[60]),d[59].set("backup_id",d[20]),d[59].set("thread_id",a[5]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[65]).then(function(a){return a=a,d[66]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[66]).then(function(a){return a=a,d[67]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[67]).then(function(a){return a=a,d[68]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[68]).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[59].set("salt_partial_access_token",d[69]==null?"":d[69]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[28]).then(function(a){return a=a,d[70]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2FsdF9zY29wZQ=="),d[70]).then(function(a){return a=a,d[71]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[71]).then(function(a){return a=a,d[72]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[72]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return d[59].set("salt_partial_attachment_index_key",d[73]==null?"":d[73]),d[59].set("raw_tokens",d[63]),d[74]=c.toJSON(d[59]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_attachment_restore",c.i64.cast([0,50020]),d[74],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),d[1],c.i64.cast([0,0])).then(function(a){return a=a,d[75]=a[0],a})}]):(d[34]="OPE key is null for IssueAttachmentRestoreTask",d[34]!==void 0?c.sequence([function(a){return d[36]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[34]].join(""),function(a){c.logger(a).mustfix(a)}(d[36]),d[35]=c.createArray(),d[1]!==void 0?d[37]=(d[35].push(d[1]),d[35]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[34],d[35],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[36],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[39]=a[0],a})},function(a){return d[39]?d[40]=!0:d[40]=!1,d[40]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[41]=c.createArray(),void 0!==void 0?d[42]=(d[41].push(void 0),d[41]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[41],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[38]=!0:d[38]=!1,d[38]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[39]=c.createArray(),void 0!==void 0?d[40]=(d[39].push(void 0),d[39]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[39],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[38]=!0:d[38]=!1,d[38]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[39]=c.createArray(),void 0!==void 0?d[40]=(d[39].push(void 0),d[39]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[39],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[35]?d[36]=!0:d[36]=!1,d[36]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[37]=c.createArray(),void 0!==void 0?d[38]=(d[37].push(void 0),d[37]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[37],c.i64.cast([0,3]))):c.resolve()}]))}]):(d[27]="Missing mailbox_root_key for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}])):(d[27]="Missing backup_id for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}])):(d[27]="Missing device_id for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}])):(d[27]="Missing ocmf_client_state_blob for IssueAttachmentRestoreTask",d[27]!==void 0?c.sequence([function(a){return d[29]=["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[27]].join(""),function(a){c.logger(a).mustfix(a)}(d[29]),d[28]=c.createArray(),d[1]!==void 0?d[30]=(d[28].push(d[1]),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[27],d[28],c.i64.cast([0,3]))},function(a){return c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),d[29],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!0:d[33]=!1,d[33]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[34]=c.createArray(),void 0!==void 0?d[35]=(d[34].push(void 0),d[34]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[34],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(a){return d[1]!==void 0?c.sequence([function(a){return d[1]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),d[1],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[31]=!0:d[31]=!1,d[31]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[32]=c.createArray(),void 0!==void 0?d[33]=(d[32].push(void 0),d[32]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[32],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(a){return d[1]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),d[1]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}]))},function(a){return d[21]=c.i64.of_float(Date.now()),d[22]=c.i64.random(),d[24]="Finishing execution. Execution time: ",d[25]=c.i64.to_string(c.i64.sub(d[21],d[0])),d[26]=" ms",d[23]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ",d[23],d[24],d[23],d[25],d[23],d[26]].join("")),c.i64.eq(c.i64.mod_(d[22],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[27]=",",d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",[d[24],d[27],d[25],d[27],d[26]].join(""),d[28],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure";e.exports=a}),null);
__d("LSIssueAttachmentRestoreTaskStoredProcedure",["LSIssueAttachmentRestoreTask","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSIssueAttachmentRestoreTask")(b.backupEntFbid,b.deliveryObjectId,b.productType,b.mediaType,b.messageId,b.threadId,b.sortOrder,b.traceId,b.serverThreadKey,b.source,a)}g["default"]=a}),98);
__d("MAWMIMediaDownloader",["FBLogger","I64","LSDatabaseSingleton","LSFactory","LSIntEnum","LSIssueAttachmentRestoreTaskStoredProcedure","LSMEBTaskCreationSource","MAWCastToMsgrServerMediaType","MAWLoggerUtils","MAWThreadKeyUtils","MebMIMediaDownloader","MediaDownloadMediator","Promise","WALogger","WAMediaUtils","asyncToGeneratorRuntime","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);l=function(){return a};return a}a=function(a){babelHelpers.inheritsLoose(e,a);function e(){return a.apply(this,arguments)||this}var g=e.prototype;g.handle=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=this,e=(yield (k||(k=d("LSDatabaseSingleton"))).LSDatabaseSingleton);d("MediaDownloadMediator").mapDeliveryObjectIdToMediaDownloader(d("WAMediaUtils").stringToDeliveryObjectId(this.mediaDownloadMetadata.deliveryObjectId),this);var g=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(this.mediaDownloadMetadata.mediaType);if(g==null)throw c("FBLogger")("labyrinth_web").mustfixThrow("Unsupported media type");var m=d("MAWThreadKeyUtils").stringThreadKeyToString(this.mediaDownloadMetadata.threadKey),n=new(h||(h=b("Promise")))(function(a,b){window.setTimeout(function(){b(c("err")("[labyrinth_web][MIMediaDownloader] MI Media download timed out"))},2*60*1e3)}),o=d("MAWLoggerUtils").getInstanceKey();return h.race([e.runInTransaction(function(b){return c("LSIssueAttachmentRestoreTaskStoredProcedure")(c("LSFactory")(b),{backupEntFbid:(i||(i=d("I64"))).of_string(a.mediaDownloadMetadata.backupEntFbid),deliveryObjectId:a.mediaDownloadMetadata.deliveryObjectId,mediaType:g,messageId:a.mediaDownloadMetadata.messageId,productType:a.mediaDownloadMetadata.productType,serverThreadKey:m,sortOrder:i.of_float(a.mediaDownloadMetadata.sortOrder),source:(j||(j=d("LSIntEnum"))).ofNumber(c("LSMEBTaskCreationSource").MSGR_DYI),threadId:a.mediaDownloadMetadata.threadId,traceId:o.toString()})},"readwrite",void 0,void 0,f.id+":68"),n])["catch"](function(b){d("WALogger").ERROR(l(),b.message);return a.handleError(b)})});function e(){return a.apply(this,arguments)}return e}();return e}(c("MebMIMediaDownloader"));g.MAWMIMediaDownloader=a}),98);
__d("EncryptedBackupsDYIMessageProcessingUtils",["EncryptedBackupsDYIMediaDownloadHandlers","EncryptedBackupsDYISingleton","IGDMIMediaDownloader","MAWMIMediaDownloader","MebWAMediaDownloader","Promise","WAJids","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Failed to resign CDN URL: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Media CDN URL has expired and should be renewed"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Successfully downloaded media"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[","] Failed to download media"]);l=function(){return a};return a}function a(a,b){return{isUnsent:!1,media:new Set(),reactions:[],senderName:m(a),text:"",timestamp:(a=b)!=null?a:0,type:""}}function m(a){var b=d("EncryptedBackupsDYISingleton").getSingleton(),c="Unknown User";if(a!=null){b=b.getContactNameForContactId(a);b!=null&&(c=b)}return c}function c(a,c,e,f,g,m,n,o,p,q){var r=d("EncryptedBackupsDYISingleton").getSingleton(),s=r.getLogger(),t={author:d("WAJids").toMsgrUserJid(n),chat:d("WAJids").toMsgrUserJid(g),externalId:o},u={hash:p,isUrlRenewed:!1,mediaEntry:f,protocolMsgId:t,sortOrderMs:q};n={onDownloadError:function(){void s.ERROR(l(),u.hash);r.deletePlaintextHashFromAttachmentDownloadsInProgress(u.hash);return(h||(h=b("Promise"))).resolve()},onDownloadSuccess:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){void s.LOG(k(),u.hash);var b=a.mimeType;a=a.plaintext;yield d("EncryptedBackupsDYIMediaDownloadHandlers").DYIMediaDownloadHandler(u.hash,b,a,t)});function c(b){return a.apply(this,arguments)}return c}(),onUrlExpired:function(){void s.LOG(j(),u.hash);return(h||(h=b("Promise"))).resolve()}};var v=new(d("MebWAMediaDownloader").MebWAMediaDownloader)(u,n,a),w=f.serverMediaType;f=f.objectId;if(w!=null&&f!=null&&typeof q==="number"){c={backupEntFbid:c,deliveryObjectId:f,hash:p,mediaType:w,messageId:o,productType:e,sortOrder:q,threadId:g,threadKey:m};f={onResignCdnUrlFailure:function(a){void s.ERROR(i(),u.hash,a.message);r.deletePlaintextHashFromAttachmentDownloadsInProgress(u.hash);return(h||(h=b("Promise"))).resolve()},onResignCdnUrlSuccess:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){});function c(){return a.apply(this,arguments)}return c}()};p=e==="msgr"?new(d("MAWMIMediaDownloader").MAWMIMediaDownloader)(c,f):new(d("IGDMIMediaDownloader").IGDMIMediaDownloader)(c,f);v.setNextHandler(p);p.setNextHandler(new(d("MebWAMediaDownloader").MebWAMediaDownloader)(u,n,a))}void v.handle()}g.buildBaseDyiMessage=a;g.getSenderName=m;g.startMediaDownloadChain=c}),98);
__d("LSLoadThreadPkFromThreadId",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadThreadPkFromThreadId] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.filter(c.db.table(173).fetch(),function(b){return c.i64.to_string(b.jid)===a[0]}).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,100])),d[13].set("stored_procedure","LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure"),d[13].set("error_message",""),e=[void 0,d[13]],d[2]=e[0],d[3]=e[1],e):(b=a.item,e=[b.clientThreadPk,void 0],d[2]=e[0],d[3]=e[1],e)})},function(a){return c.i64.neq(d[2],void 0)?(a=[d[2],d[3]],d[5]=a[0],d[6]=a[1],a):(d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,7])),d[13].set("stored_procedure","LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure"),d[13].set("error_message",""),c.i64.neq(void 0,void 0)?(a=[void 0,d[13]],d[14]=a[0],d[15]=a[1],a):(d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,100])),d[16].set("stored_procedure","LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure"),d[16].set("error_message",""),a=[void 0,d[16]],d[14]=a[0],d[15]=a[1],a),a=[d[14],d[15]],d[5]=a[0],d[6]=a[1],a),d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadThreadPkFromThreadId] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadThreadPkFromThreadId",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadThreadPkFromThreadIdStoredProcedure";e.exports=a}),null);
__d("LSIssueMessageRangeQueryTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSFlushDataTrace.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLoadThreadPkFromThreadId","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] Beginning execution."),d[6]=c.i64.gt(a[1],c.i64.cast([0,0]))&&c.i64.gt(a[5],c.i64.cast([0,0])),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(e){return d[6]?(d[12]=new c.Map(),d[12].set("error_code",c.i64.cast([0,1])),d[12].set("error_message",""),d[12].set("stored_procedure","issueMessageRangeQueryTask"),d[13]=new c.Map(),d[13].set("act_thread_id",a[0]),d[14]=new c.Map(),d[14].set("restore_context",d[13]),d[14].set("failure",d[12]),d[15]=d[14].get("restore_context"),d[14],d[16]=d[15].get("act_thread_id"),d[15],d[17]=c.toJSON(d[14]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[16]].join(""),c.i64.cast([0,50031]),d[17],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[18]=a[0],a})):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?d[12]=void 0:(f=e.item,c.sequence([function(a){return d[28]=f.deviceId,d[27]=f.backupTenancy,d[26]=f.encryptionVersion,d[21]=void 0,c.i64.neq(d[21],void 0)?c.resolve(d[22]=d[21]):c.sequence([function(a){return d[29]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[30]=a[0],a})},function(a){return d[30]?d[39]=(d[29].push(c.i64.cast([0,0])),d[29]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[31]=a[0],a})},function(a){return d[31]?d[39]=(d[29].push(c.i64.cast([0,2])),d[29]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[39]=(d[29].push(c.i64.cast([0,3])),d[29]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[33]?d[39]=(d[29].push(c.i64.cast([0,4])),d[29]):0,d[34]=c.createArray(),d[35]=c.i64.of_int32(d[29].length),c.i64.gt(d[35],c.i64.cast([0,0]))?c.loopAsync(d[35],function(a){return d[39]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],d[39]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],a})},function(a){return d[42]=(d[34].push(d[40]),d[34])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[39]=c.createArray(),d[40]=c.i64.of_int32(d[34].length),c.i64.gt(d[40],c.i64.cast([0,0]))?c.loopAsync(d[40],function(a){return d[42]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[34],d[42]).then(function(a){return a=a,d[43]=a[0],d[44]=a[1],a})},function(a){return d[45]=(d[39].push(c.i64.to_string(d[43])),d[39])}])}):c.resolve()},function(a){return d[41]=d[39].join(","),d[36]=d[41]}])},function(a){return d[34].some(function(a){return c.i64.eq(d[26],a)})?d[37]=d[26]:d[37]=void 0,c.i64.neq(d[37],void 0)?d[38]=d[37]:d[38]=void 0,d[22]=d[38]}])},function(a){return c.i64.neq(d[22],void 0)?d[23]=d[22]:d[23]=c.i64.cast([0,0]),c.i64.neq(d[27],void 0)?d[24]=d[27]:d[24]=c.i64.cast([0,1]),c.i64.neq(d[28],void 0)?d[25]=d[28]:d[25]=void 0,d[12]=d[25]}]))})},function(e){return d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([0,1])),d[14].set("error_message",void 0==null?"":void 0),d[14].set("stored_procedure","issueMessageRangeQueryTask"),d[15]=new c.Map(),d[15].set("act_thread_id",a[0]),d[15].set("source",a[6]),d[15].set("restore_operation_type",c.i64.cast([0,2])),d[15].set("request_id",a[4]),d[15].set("device_id",d[12]),d[16]=new c.Map(),d[16].set("restore_context",d[15]),d[16].set("failure",d[14]),d[17]=d[16].get("queue_name"),d[16],d[17]!==void 0?d[18]=d[17]:(d[21]=d[16].get("restore_context"),d[16],d[22]=d[21].get("act_thread_id"),d[21],d[18]=["encrypted_backups_restore",":",d[22]].join("")),d[19]=c.toJSON(d[16]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[18],c.i64.cast([0,50030]),d[19],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[20]=a[0],a})}])},function(e){return d[11]="backup not found",d[11]!==void 0?c.sequence([function(e){return d[13]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",d[11]].join(""),function(a){c.logger(a).mustfix(a)}(d[13]),d[12]=c.createArray(),a[4]!==void 0?d[14]=(d[12].push(a[4]),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",d[11],d[12],c.i64.cast([0,3]))},function(e){return c.sequence([function(e){return a[4]!==void 0?c.sequence([function(e){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),d[13],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[16]=a[0],a})},function(a){return d[16]?d[17]=!0:d[17]=!1,d[17]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[18]=c.createArray(),void 0!==void 0?d[19]=(d[18].push(void 0),d[18]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[18],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!0:d[15]=!1,d[15]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[16],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(e){return a[4]!==void 0?c.sequence([function(d){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!0:d[15]=!1,d[15]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[16],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[12]=a[0],a})},function(a){return d[12]?d[13]=!0:d[13]=!1,d[13]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[14],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[6]?d[10]=c.i64.cast([0,5]):d[10]=c.i64.cast([0,2]),d[1]=!1}]):(f=e.item,c.sequence([function(a){return d[19]=f.mailboxRootKeyBlob,d[18]=f.ocmfClientStateBlob,d[17]=f.deviceId,d[16]=f.backupTenancy,d[15]=f.encryptionVersion,d[10]=void 0,c.i64.neq(d[10],void 0)?c.resolve(d[11]=d[10]):c.sequence([function(a){return d[20]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[21]=a[0],a})},function(a){return d[21]?d[30]=(d[20].push(c.i64.cast([0,0])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[30]=(d[20].push(c.i64.cast([0,2])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[23]?d[30]=(d[20].push(c.i64.cast([0,3])),d[20]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[30]=(d[20].push(c.i64.cast([0,4])),d[20]):0,d[25]=c.createArray(),d[26]=c.i64.of_int32(d[20].length),c.i64.gt(d[26],c.i64.cast([0,0]))?c.loopAsync(d[26],function(a){return d[30]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[20],d[30]).then(function(a){return a=a,d[31]=a[0],d[32]=a[1],a})},function(a){return d[33]=(d[25].push(d[31]),d[25])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[30]=c.createArray(),d[31]=c.i64.of_int32(d[25].length),c.i64.gt(d[31],c.i64.cast([0,0]))?c.loopAsync(d[31],function(a){return d[33]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[25],d[33]).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[36]=(d[30].push(c.i64.to_string(d[34])),d[30])}])}):c.resolve()},function(a){return d[32]=d[30].join(","),d[27]=d[32]}])},function(a){return d[25].some(function(a){return c.i64.eq(d[15],a)})?d[28]=d[15]:d[28]=void 0,c.i64.neq(d[28],void 0)?d[29]=d[28]:d[29]=void 0,d[11]=d[29]}])},function(e){return c.i64.neq(d[11],void 0)?d[12]=d[11]:d[12]=c.i64.cast([0,0]),c.i64.neq(d[16],void 0)?d[13]=d[16]:d[13]=c.i64.cast([0,1]),c.i64.neq(d[17],void 0)?c.sequence([function(e){return c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[0]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(e){return c.i64.neq(d[20],void 0)?d[6]?c.sequence([function(e){return c.i64.eq(d[13],c.i64.cast([0,3]))?d[22]=c.i64.cast([0,4]):d[22]=c.i64.cast([0,0]),d[23]=new c.Map(),d[23].set("act_thread_id",a[0]),d[23].set("tam_thread_subtype",d[22]),d[23].set("source",a[6]),c.nativeOperation(b("LSBase64Encode.nop"),d[18]).then(function(a){return a=a,d[24]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[19]).then(function(a){return a=a,d[25]=a[0],a})},function(a){return d[26]=new c.Map(),d[26].set("ocmf_client_state_blob",d[24]==null?"":d[24]),d[26].set("mailbox_root_key",d[25]==null?"":d[25]),d[27]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[39]=(d[27].push(a.epochId),d[27])})},function(a){return d[37]="Queried locally available epochs. Count: ",d[28]=c.i64.of_int32(d[27].length),d[38]=c.i64.to_string(d[28]),d[29]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[29],d[37],d[29],d[38]].join("")),c.resolve()},function(e){return d[30]=new c.Map(),d[30].set("device_id",d[17]),d[30].set("raw_tokens",d[26]),d[30].set("locally_available_epochs",d[27]),d[31]=new c.Map(),d[31].set("reference_timestamp",a[2]),d[31].set("server_thread_key",void 0),d[31].set("device_context",d[30]),d[31].set("source",a[6]),d[32]=new c.Map(),d[32].set("restore_context",d[23]),d[32].set("success",d[31]),d[33]=d[32].get("restore_context"),d[32],d[34]=d[33].get("act_thread_id"),d[33],d[35]=c.toJSON(d[32]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[34]].join(""),c.i64.cast([0,50031]),d[35],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[36]=a[0],a})}]):c.i64.gt(a[1],c.i64.cast([0,0]))?c.sequence([function(e){return c.i64.eq(d[13],c.i64.cast([0,3]))?d[22]=c.i64.cast([0,4]):d[22]=c.i64.cast([0,0]),a[7]===!0?d[23]=!0:d[23]=!1,d[24]=new c.Map(),d[24].set("act_thread_id",a[0]),d[24].set("request_id",a[4]),d[24].set("tam_thread_subtype",d[22]),d[24].set("source",a[6]),c.nativeOperation(b("LSBase64Encode.nop"),d[18]).then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[19]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[27]=new c.Map(),d[27].set("ocmf_client_state_blob",d[25]==null?"":d[25]),d[27].set("mailbox_root_key",d[26]==null?"":d[26]),d[28]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[40]=(d[28].push(a.epochId),d[28])})},function(a){return d[38]="Queried locally available epochs. Count: ",d[29]=c.i64.of_int32(d[28].length),d[39]=c.i64.to_string(d[29]),d[30]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[30],d[38],d[30],d[39]].join("")),c.resolve()},function(e){return d[31]=new c.Map(),d[31].set("device_id",d[17]),d[31].set("raw_tokens",d[27]),d[31].set("locally_available_epochs",d[28]),d[32]=new c.Map(),d[32].set("reference_timestamp",a[2]),d[32].set("direction",c.i64.cast([0,1])),d[32].set("server_thread_key",void 0),d[32].set("device_context",d[31]),d[32].set("source",a[6]),d[32].set("include_offset",d[23]),d[33]=new c.Map(),d[33].set("restore_context",d[24]),d[33].set("success",d[32]),d[33].set("queue_name",void 0),d[34]=d[33].get("queue_name"),d[33],d[34]!==void 0?d[35]=d[34]:(d[40]=d[33].get("restore_context"),d[33],d[41]=d[40].get("act_thread_id"),d[40],d[35]=["encrypted_backups_restore",":",d[41]].join("")),d[36]=c.toJSON(d[33]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[35],c.i64.cast([0,50030]),d[36],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[37]=a[0],a})}]):c.sequence([function(e){return c.i64.eq(d[13],c.i64.cast([0,3]))?d[22]=c.i64.cast([0,4]):d[22]=c.i64.cast([0,0]),a[7]===!0?d[23]=!0:d[23]=!1,d[24]=new c.Map(),d[24].set("act_thread_id",a[0]),d[24].set("request_id",a[4]),d[24].set("tam_thread_subtype",d[22]),d[24].set("source",a[6]),c.nativeOperation(b("LSBase64Encode.nop"),d[18]).then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[19]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[27]=new c.Map(),d[27].set("ocmf_client_state_blob",d[25]==null?"":d[25]),d[27].set("mailbox_root_key",d[26]==null?"":d[26]),d[28]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[40]=(d[28].push(a.epochId),d[28])})},function(a){return d[38]="Queried locally available epochs. Count: ",d[29]=c.i64.of_int32(d[28].length),d[39]=c.i64.to_string(d[29]),d[30]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[30],d[38],d[30],d[39]].join("")),c.resolve()},function(e){return d[31]=new c.Map(),d[31].set("device_id",d[17]),d[31].set("raw_tokens",d[27]),d[31].set("locally_available_epochs",d[28]),d[32]=new c.Map(),d[32].set("reference_timestamp",a[2]),d[32].set("direction",c.i64.cast([0,2])),d[32].set("server_thread_key",void 0),d[32].set("device_context",d[31]),d[32].set("source",a[6]),d[32].set("include_offset",d[23]),d[33]=new c.Map(),d[33].set("restore_context",d[24]),d[33].set("success",d[32]),d[33].set("queue_name",void 0),d[34]=d[33].get("queue_name"),d[33],d[34]!==void 0?d[35]=d[34]:(d[40]=d[33].get("restore_context"),d[33],d[41]=d[40].get("act_thread_id"),d[40],d[35]=["encrypted_backups_restore",":",d[41]].join("")),d[36]=c.toJSON(d[33]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[35],c.i64.cast([0,50030]),d[36],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[37]=a[0],a})}]):c.sequence([function(e){return d[6]?(d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,100])),d[24].set("error_message",""),d[24].set("stored_procedure","issueMessageRangeQueryTask"),d[25]=new c.Map(),d[25].set("act_thread_id",a[0]),d[26]=new c.Map(),d[26].set("restore_context",d[25]),d[26].set("failure",d[24]),d[27]=d[26].get("restore_context"),d[26],d[28]=d[27].get("act_thread_id"),d[27],d[29]=c.toJSON(d[26]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[28]].join(""),c.i64.cast([0,50031]),d[29],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[30]=a[0],a})):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?d[24]=void 0:(f=e.item,c.sequence([function(a){return d[40]=f.deviceId,d[39]=f.backupTenancy,d[38]=f.encryptionVersion,d[33]=void 0,c.i64.neq(d[33],void 0)?c.resolve(d[34]=d[33]):c.sequence([function(a){return d[41]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]?d[51]=(d[41].push(c.i64.cast([0,0])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[43]?d[51]=(d[41].push(c.i64.cast([0,2])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[44]?d[51]=(d[41].push(c.i64.cast([0,3])),d[41]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]?d[51]=(d[41].push(c.i64.cast([0,4])),d[41]):0,d[46]=c.createArray(),d[47]=c.i64.of_int32(d[41].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[51]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[41],d[51]).then(function(a){return a=a,d[52]=a[0],d[53]=a[1],a})},function(a){return d[54]=(d[46].push(d[52]),d[46])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[51]=c.createArray(),d[52]=c.i64.of_int32(d[46].length),c.i64.gt(d[52],c.i64.cast([0,0]))?c.loopAsync(d[52],function(a){return d[54]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[46],d[54]).then(function(a){return a=a,d[55]=a[0],d[56]=a[1],a})},function(a){return d[57]=(d[51].push(c.i64.to_string(d[55])),d[51])}])}):c.resolve()},function(a){return d[53]=d[51].join(","),d[48]=d[53]}])},function(a){return d[46].some(function(a){return c.i64.eq(d[38],a)})?d[49]=d[38]:d[49]=void 0,c.i64.neq(d[49],void 0)?d[50]=d[49]:d[50]=void 0,d[34]=d[50]}])},function(a){return c.i64.neq(d[34],void 0)?d[35]=d[34]:d[35]=c.i64.cast([0,0]),c.i64.neq(d[39],void 0)?d[36]=d[39]:d[36]=c.i64.cast([0,1]),c.i64.neq(d[40],void 0)?d[37]=d[40]:d[37]=void 0,d[24]=d[37]}]))})},function(e){return d[26]=new c.Map(),d[26].set("error_code",c.i64.cast([0,100])),d[26].set("error_message",void 0==null?"":void 0),d[26].set("stored_procedure","issueMessageRangeQueryTask"),d[27]=new c.Map(),d[27].set("act_thread_id",a[0]),d[27].set("source",a[6]),d[27].set("restore_operation_type",c.i64.cast([0,2])),d[27].set("request_id",a[4]),d[27].set("device_id",d[24]),d[28]=new c.Map(),d[28].set("restore_context",d[27]),d[28].set("failure",d[26]),d[29]=d[28].get("queue_name"),d[28],d[29]!==void 0?d[30]=d[29]:(d[33]=d[28].get("restore_context"),d[28],d[34]=d[33].get("act_thread_id"),d[33],d[30]=["encrypted_backups_restore",":",d[34]].join("")),d[31]=c.toJSON(d[28]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[30],c.i64.cast([0,50030]),d[31],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[32]=a[0],a})}])},function(e){return d[23]="threak pk not found for jid",d[23]!==void 0?c.sequence([function(e){return d[25]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",d[23]].join(""),function(a){c.logger(a).mustfix(a)}(d[25]),d[24]=c.createArray(),a[4]!==void 0?d[26]=(d[24].push(a[4]),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",d[23],d[24],c.i64.cast([0,3]))},function(e){return c.sequence([function(e){return a[4]!==void 0?c.sequence([function(e){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),d[25],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[28]?d[29]=!0:d[29]=!1,d[29]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[30],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!0:d[27]=!1,d[27]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[28],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(e){return a[4]!==void 0?c.sequence([function(d){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!0:d[27]=!1,d[27]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[28],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!0:d[25]=!1,d[25]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[26],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[6]?d[22]=c.i64.cast([0,5]):d[22]=c.i64.cast([0,2])}])},function(a){return d[14]=!0}]):c.sequence([function(e){return d[6]?(d[22]=new c.Map(),d[22].set("error_code",c.i64.cast([0,1])),d[22].set("error_message",""),d[22].set("stored_procedure","issueMessageRangeQueryTask"),d[23]=new c.Map(),d[23].set("act_thread_id",a[0]),d[24]=new c.Map(),d[24].set("restore_context",d[23]),d[24].set("failure",d[22]),d[25]=d[24].get("restore_context"),d[24],d[26]=d[25].get("act_thread_id"),d[25],d[27]=c.toJSON(d[24]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),["encrypted_backups_restore",":",d[26]].join(""),c.i64.cast([0,50031]),d[27],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[28]=a[0],a})):c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?d[22]=void 0:(f=e.item,c.sequence([function(a){return d[38]=f.deviceId,d[37]=f.backupTenancy,d[36]=f.encryptionVersion,d[31]=void 0,c.i64.neq(d[31],void 0)?c.resolve(d[32]=d[31]):c.sequence([function(a){return d[39]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[40]=a[0],a})},function(a){return d[40]?d[49]=(d[39].push(c.i64.cast([0,0])),d[39]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[41]=a[0],a})},function(a){return d[41]?d[49]=(d[39].push(c.i64.cast([0,2])),d[39]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]?d[49]=(d[39].push(c.i64.cast([0,3])),d[39]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[43]?d[49]=(d[39].push(c.i64.cast([0,4])),d[39]):0,d[44]=c.createArray(),d[45]=c.i64.of_int32(d[39].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(a){return d[49]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[39],d[49]).then(function(a){return a=a,d[50]=a[0],d[51]=a[1],a})},function(a){return d[52]=(d[44].push(d[50]),d[44])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[49]=c.createArray(),d[50]=c.i64.of_int32(d[44].length),c.i64.gt(d[50],c.i64.cast([0,0]))?c.loopAsync(d[50],function(a){return d[52]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[44],d[52]).then(function(a){return a=a,d[53]=a[0],d[54]=a[1],a})},function(a){return d[55]=(d[49].push(c.i64.to_string(d[53])),d[49])}])}):c.resolve()},function(a){return d[51]=d[49].join(","),d[46]=d[51]}])},function(a){return d[44].some(function(a){return c.i64.eq(d[36],a)})?d[47]=d[36]:d[47]=void 0,c.i64.neq(d[47],void 0)?d[48]=d[47]:d[48]=void 0,d[32]=d[48]}])},function(a){return c.i64.neq(d[32],void 0)?d[33]=d[32]:d[33]=c.i64.cast([0,0]),c.i64.neq(d[37],void 0)?d[34]=d[37]:d[34]=c.i64.cast([0,1]),c.i64.neq(d[38],void 0)?d[35]=d[38]:d[35]=void 0,d[22]=d[35]}]))})},function(e){return d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,1])),d[24].set("error_message",void 0==null?"":void 0),d[24].set("stored_procedure","issueMessageRangeQueryTask"),d[25]=new c.Map(),d[25].set("act_thread_id",a[0]),d[25].set("source",a[6]),d[25].set("restore_operation_type",c.i64.cast([0,2])),d[25].set("request_id",a[4]),d[25].set("device_id",d[22]),d[26]=new c.Map(),d[26].set("restore_context",d[25]),d[26].set("failure",d[24]),d[27]=d[26].get("queue_name"),d[26],d[27]!==void 0?d[28]=d[27]:(d[31]=d[26].get("restore_context"),d[26],d[32]=d[31].get("act_thread_id"),d[31],d[28]=["encrypted_backups_restore",":",d[32]].join("")),d[29]=c.toJSON(d[26]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),d[28],c.i64.cast([0,50030]),d[29],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[30]=a[0],a})}])},function(e){return d[21]="backup not found",d[21]!==void 0?c.sequence([function(e){return d[23]=["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",d[21]].join(""),function(a){c.logger(a).mustfix(a)}(d[23]),d[22]=c.createArray(),a[4]!==void 0?d[24]=(d[22].push(a[4]),d[22]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",d[21],d[22],c.i64.cast([0,3]))},function(e){return c.sequence([function(e){return a[4]!==void 0?c.sequence([function(e){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),d[23],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!0:d[27]=!1,d[27]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[28],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!0:d[25]=!1,d[25]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[26],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(e){return a[4]!==void 0?c.sequence([function(d){return a[4]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[4],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!0:d[25]=!1,d[25]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[26],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[4]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[4]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[22]?d[23]=!0:d[23]=!1,d[23]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[24],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[6]?d[20]=c.i64.cast([0,5]):d[20]=c.i64.cast([0,2]),d[14]=!1}])},function(a){return d[1]=d[14]}]))})},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[9]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure] ",d[5],d[7],d[5],d[8],d[5],d[9]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueMessageRangeQueryTaskStoredProcedure";e.exports=a}),null);
__d("LSIssueMessageRangeQueryTaskStoredProcedure",["LSIssueMessageRangeQueryTask","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSIssueMessageRangeQueryTask")(b.threadId,b.numMessages,b.startSortKey,b.isPointQuery,b.traceId,b.newerNumMessages,b.source,b.includeOffset,a)}g["default"]=a}),98);
__d("MAWEncryptedBackupsDYIProcessEchoMessages",["EchoMessage","EncryptedBackupsDYIMessageProcessingUtils","EncryptedBackupsDYISingleton","MAWFrontendMediaUtils","MAWHandleEchoMediaMsgsRestoreV2","MebWAMediaDownloader","WAHashUtils","WAMediaUtils","WAStanzaUtils","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media message is missing media data"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Explicitly dropping "," message type"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unsupported message content subtype for placeholder: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bump message is not supported in DYI"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Encountered message edits: ","\n. Edit count: ","\n. Original message content: ",""],["Encountered message edits: ","\\n. Edit count: ","\\n. Original message content: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Dropping tombstoned message"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing Echo document. Dropping the message: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot convert Echo message to DYI format. Dropping the message"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing "," echo messages for thread ",""]);p=function(){return a};return a}function a(a,b,c){var e=d("EncryptedBackupsDYISingleton").getSingleton(),f=e.getLogger();void f.LOG(p(),c.length,a);c.forEach(function(c){try{var g=q(a,b,c);if(g==null){void f.WARN(o());return}e.setMessagesByThreadKey(a,d("WAStanzaUtils").toStanzaId(c.messageId),g);return}catch(a){void f.ERROR(n(),a);return}})}function q(a,b,e){var f,g=d("EncryptedBackupsDYISingleton").getSingleton(),h=g.getLogger();if(e.isTombstoned!=null&&e.isTombstoned===!0){void h.LOG(m());return}f=d("EncryptedBackupsDYIMessageProcessingUtils").buildBaseDyiMessage((f=e.from)==null?void 0:f.localKey,e.sortOrderMs);(e.editCount>0||e.editHistory.length>0)&&void h.LOG(l(),JSON.stringify(e.editHistory,null,2),e.editCount,e.text);e.reactions!=null&&e.reactions.length>0&&(f.reactions=e.reactions.map(function(a){var b=a.displayName;a=a.localKey;return{actor:(a=g.getContactNameForContactId(a))!=null?a:"unknown",reaction:(a=b)!=null?a:"unknown"}}));var n=c("qex")._("172")||!1;switch(e.contentType){case d("EchoMessage").EchoMessageContentType.TEXT:if(n&&e.xContentType===d("EchoMessage").EchoXMessageContentType.BUMP){void h.WARN(k());return void 0}else f.type="text",f.text=e.text||"";break;case d("EchoMessage").EchoMessageContentType.MEDIA:f.type="media";f=r(a,b,e,f);break;case d("EchoMessage").EchoMessageContentType.PLACEHOLDER:e.contentSubtype===d("EchoMessage").EchoMessageContentSubtype.UNSEND&&(f.type="placeholder",f.isUnsent=!0,f.text="User unsent a message");void h.WARN(j(),d("EchoMessage").EchoMessageContentSubtype.getName(e.contentSubtype));return void 0;case d("EchoMessage").EchoMessageContentType.XMA:f.type="link";e.xmaData!=null&&e.xmaData.xmaDefaultCTA!=null?f.text=e.xmaData.xmaDefaultCTA:f.text=e.text||"";break;case d("EchoMessage").EchoMessageContentType.ADMIN_MESSAGE:case d("EchoMessage").EchoMessageContentType.DECRYPTION_FAILURE:case d("EchoMessage").EchoMessageContentType.NULL_STATE:case d("EchoMessage").EchoMessageContentType.UNSUPPORTED_NEEDS_UPDATE:void h.LOG(i(),e.contentType);return void 0}return f}function r(a,b,c,e){var f=d("EncryptedBackupsDYISingleton").getSingleton(),g=f.getLogger();if(c.mediaData==null){void g.WARN(h());return e}g=c.from;var i=c.xOfflineThreadingId,j=c.mediaData,k=j.attachmentObjectId,l=j.backupEntFbid,m=j.directPath,n=j.encryptedHash,o=j.filename,p=j.mediaContentType,q=j.mediaKey,r=j.mediaKeyTimestamp,s=j.plaintextHash;j=j.size;g=(g=g==null?void 0:g.localKey)!=null?g:"0";i=d("WAStanzaUtils").toStanzaId((i=i)!=null?i:"0");p=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(p||"");p=p.serverMediaType;s=d("WAHashUtils").stringToPlaintextHash(d("MAWHandleEchoMediaMsgsRestoreV2").getBase64WithoutPadding(s));e.media.add(s);if(!f.isAttachmentDownloadInProgressForPlaintextHash(s)&&!f.isAttachmentDownloadCompleteForPlaintextHash(s)){f.addPlaintextHashToAttachmentDownloadsInProgress(s);n=d("MAWHandleEchoMediaMsgsRestoreV2").constructMediaEntry(s,(f=n)!=null?f:"",q,m,r,p,o,l,k,null,j);f=d("WAMediaUtils").decodeMediaEntryData(n);void d("EncryptedBackupsDYIMessageProcessingUtils").startMediaDownloadChain(d("MebWAMediaDownloader").MebWADownloadMediaThroughTheBridge,"-8","msgr",f,b,a,g,i,s,c.sortOrderMs)}return e}g.processEBEchoMessagesForDYI=a}),98);
__d("MAWEncryptedBackupsDYIProcessProtobufMessages",["CurrentUser","EncryptedBackupsDYIMessageProcessingUtils","EncryptedBackupsDYISingleton","MAWEBUploadMessageUtils","MAWFrontendMediaUtils","MAWHandleEchoMediaMsgsRestoreV2","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWMsgType","MebWAMediaDownloader","WAHashUtils","WAJids","WAMediaUtils","WAStanzaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Starting DYI media download for attachemnt with hash ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Media message is missing media data"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Explicitly dropping "," message type"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Bump message is not supported in DYI"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] XMA message doesn't have xmaData"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Documents are not supported in DYI"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to calculate sortOrder for protobuf message"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf: ts or messageId or senderId is null"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf: metadata or message type is null"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf. Dropping the message: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error converting protobuf to DYI format. Dropping the message"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["Error converting protobuf to DYI format. Dropping the message"]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["Decoded protobuf is empty"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["Processing "," protobuf messages for thread ",""]);u=function(){return a};return a}function a(a,b,e){var f=d("EncryptedBackupsDYISingleton").getSingleton(),g=f.getLogger();void g.LOG(u(),e.length,b);var h=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());e.forEach(function(c){try{c=d("MAWHandleEchoProtobufsRestoreApi").decodeDecryptedMessageProtobuf(c,h,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0);if(c==null){void g.WARN(t());return}if(c!=null&&c.metadata!=null&&c.metadata.messageId!=null){var e=d("WAStanzaUtils").toStanzaId(c.metadata.messageId);c=v(a,b,c);if(c==null){void g.WARN(s());return}f.setMessagesByThreadKey(a,e,c)}else{void g.WARN(r());return}}catch(a){void g.ERROR(q(),a);return}})}function v(a,b,e){var f,g=d("EncryptedBackupsDYISingleton").getSingleton(),h=g.getLogger(),i=e.metadata,q=e.msgType;if(i==null||q==null){void h.WARN(p());return}q=i.messageId;var r=i.senderId;i=i.timestampMs;if(i==null||typeof i!=="number"||q==null||r==null){void h.WARN(o());return}q=d("WATimeUtils").castMilliSecondsToUnixTime(i);i=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());i=d("MAWHandleEchoProtobufsRestoreApi").createUnstoredDbContentFromProtobufObject(e,d("WAJids").unsafeCoerceToChatJid(b),i,new Map(),void 0);if((i==null?void 0:i.unstoredDbContent.unstoredDbMsg)==null){void h.WARN(n());return}i=d("MAWEBUploadMessageUtils").echoOverrideMessageSortOrder(i.unstoredDbContent.unstoredDbMsg);r=d("EncryptedBackupsDYIMessageProcessingUtils").buildBaseDyiMessage(r,i);f=(f=e.decodedPayload)==null?void 0:f.text;if(e.editMsgData.length>0){var s=q;e.editMsgData.forEach(function(a){var b;if(a.ts>s&&((b=a.editMsgContent.message)==null?void 0:b.text)!=null){s=a.ts;f=(b=a.editMsgContent.message)==null?void 0:b.text}})}e.reactionData.length>0&&(r.reactions=e.reactionData.map(function(a){var b=a.reaction;a=a.senderId;return{actor:(a=g.getContactNameForContactId(a))!=null?a:"unknown",reaction:(a=b.text)!=null?a:"unknown"}}));switch(e.msgType){case d("MAWMsgType").MSG_TYPE.TEXT:r.type="text";r.text=f||"";break;case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.PTT:r.type="media";r.text=f||"";r=w(a,b,e,i,r);break;case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:void h.WARN(m());return;case d("MAWMsgType").MSG_TYPE.XMA:r.type="link";if(e.xmaData==null){void h.WARN(l());return}r.text=((q=e.xmaData)==null?void 0:q.ctas.map(function(a){return a.nativeUrl}).filter(Boolean).join("\n"))||"";break;case d("MAWMsgType").MSG_TYPE.REVOKED:r.type="placeholder";r.isUnsent=!0;r.text="User unsent a message";break;case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:void h.WARN(k());return;default:void h.LOG(j(),e.msgType);return}return r}function w(a,b,c,e,f){var g,j=d("EncryptedBackupsDYISingleton").getSingleton(),k=j.getLogger();if(c.mediaMetadata==null){void k.WARN(i());return f}var l=c.mediaMetadata,m=l.attachmentObjectId,n=l.backupEntFbid,o=l.directPath,p=l.encryptedHash,q=l.filename,r=l.mediaContentType,s=l.mediaKey,t=l.mediaKeyTimestamp,u=l.plaintextHash;l=l.size;g=(g=(g=c.metadata)==null?void 0:g.senderId)!=null?g:"0";c=d("WAStanzaUtils").toStanzaId(c.externalId);u=d("WAHashUtils").stringToPlaintextHash(u);r=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(r||"");r=r.serverMediaType;f.media.add(u);if(!j.isAttachmentDownloadInProgressForPlaintextHash(u)&&!j.isAttachmentDownloadCompleteForPlaintextHash(u)){void k.LOG(h(),d("WAHashUtils").sanitisePlaintextHash(u));j.addPlaintextHashToAttachmentDownloadsInProgress(u);j=d("MAWHandleEchoMediaMsgsRestoreV2").constructMediaEntry(u,(k=p)!=null?k:"",s,o,t,r,q,n,m,null,l);p=d("WAMediaUtils").decodeMediaEntryData(j);void d("EncryptedBackupsDYIMessageProcessingUtils").startMediaDownloadChain(d("MebWAMediaDownloader").MebWADownloadMediaThroughTheBridge,"-8","msgr",p,b,a,g,c,u,e)}return f}g.processEBProtobufMessagesForDYI=a}),98);
__d("MAWEncryptedBackupsDYIHandleMessageRestore",["EncryptedBackupsDYIHandleMessageRestore","I64","LSDatabaseSingleton","LSFactory","LSIntEnum","LSIssueMessageRangeQueryTaskStoredProcedure","LSMEBTaskCreationSource","MAWEBRestoreTrackingUtils","MAWEncryptedBackupsDYIProcessEchoMessages","MAWEncryptedBackupsDYIProcessProtobufMessages","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(h||d("LSIntEnum")).ofNumber(c("LSMEBTaskCreationSource").MSGR_DYI),l=c("justknobx")._("467"),m=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){d("MAWEBRestoreTrackingUtils").markEBRestoreDYI(c("LSMEBTaskCreationSource").MSGR_DYI),yield a.runInTransaction(function(a){return c("LSIssueMessageRangeQueryTaskStoredProcedure")(c("LSFactory")(a),{isPointQuery:!1,newerNumMessages:(i||(i=d("I64"))).zero,numMessages:i.of_int32(l),source:k,startSortKey:b,threadId:e})},"readwrite",void 0,void 0,f.id+":41")});return function(b,c,d){return a.apply(this,arguments)}}();function a(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield (j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton);void d("EncryptedBackupsDYIHandleMessageRestore").handleMessageRangeQueryRestore(f,a,b,c,e,d("MAWEncryptedBackupsDYIProcessEchoMessages").processEBEchoMessagesForDYI,m)});return n.apply(this,arguments)}function e(a,b,c,d){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){var f=(yield (j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton);void d("EncryptedBackupsDYIHandleMessageRestore").handleMessageRangeQueryRestore(f,a,b,c,e,d("MAWEncryptedBackupsDYIProcessProtobufMessages").processEBProtobufMessagesForDYI,m)});return o.apply(this,arguments)}g.taskCreationSource=k;g.MESSENGER_DYI_BATCH_SIZE=l;g.handleMAWEchoMessageRangeQueryRestore=a;g.handleMAWProtobufMessageRangeQueryRestore=e}),98);
__d("MAWRestoreMessagesFromEncryptedBackupsDeferred",["ExecutionEnvironment","LSDatabaseSingleton","LSVec","MAWEncryptedBackupUtils","Promise","WAJobOrchestratorTypes","asyncToGeneratorRuntime","cr:10036","gkx","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=c("requireDeferred")("MAWRestoreMessagesFromEncryptedBackupsNOP").__setRef("MAWRestoreMessagesFromEncryptedBackupsDeferred");function a(a,e,f,g,l,m,n,o,p,q,r,s,t){t===void 0&&(t=d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION);return k.load().then(function(){var k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(k){var u=q!=null?Number(q):void 0;u=c("gkx")("201")?d("MAWEncryptedBackupUtils").getMessageMetadataFromDeanonAPI(e,f.length,u):(j||(j=b("Promise"))).resolve();var v,w;(i||(i=c("ExecutionEnvironment"))).isInWorker&&b("cr:10036")!=null?(yield b("cr:10036").init(),v=(yield b("cr:10036").getLSStorage())):(v=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton),w=(yield u));return v.runInTransaction(function(b){return k.call(b,a,e,f,g,l,m,n,o,p,q,r,w,s,t)},"readwrite").then(function(){return[c("LSVec").ofArray([]),c("LSVec").ofArray([]),!1]})["catch"](function(){return[c("LSVec").ofArray([]),c("LSVec").ofArray([]),!1]})});return function(a){return k.apply(this,arguments)}}())}g.call=a}),98);
__d("LSRestoreEchoBlobs.nop",["CurrentUser","I64","LSIntEnum","LSMEBTaskCreationSource","LSVec","MAWAsyncEBPendingQueryPromise","MAWBridgeSendAndReceive","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsDYIHandleMessageRestore","MAWHandleEBRestoreWithHIM","MAWJidUtils","MAWJids","MAWJobDefinitions","MAWRestoreMessagesFromEncryptedBackupsDeferred","Promise","ReQL","WALogger","WATagsLogger","asyncToGeneratorRuntime","cr:11343","err","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot generate ChatJid from threadKey"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot find thread with serverThreadKey ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["Cannot find MI ACT mapping table entry for threadId ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["LSRestoreEchoBlobs error: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["LSRestoreEchoBlobs error: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["Restoring Messenger DYI batch"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - no messages returned but hasMoreBefore is true"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreEchoBlobs - "," "," ",""]);r=function(){return a};return a}var s=new Map();function t(a,b,c){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(s.has(c))return s.get(c);var e=d("MAWAsyncEBPendingQueryPromise").getJidFromThreadId(c);if(e!=null){s.set(c,e);return e}e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table.index("jid")).getKeyRange((j||(j=d("I64"))).of_string(c))));if(e==null){b.ERROR(m(),c);return null}var f=e.serverThreadKey;e=e.jid;a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(f)));if(a==null){b.ERROR(l(),f);return null}f=d("MAWJidUtils").LSJidtoChatJid(e,a.threadType);if(f!=null){s.set(c,f);return f}else{b.ERROR(k());return null}});return u.apply(this,arguments)}a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,k,l,m,s,u,v,w,x,y){var z;f=c("LSVec").toArray(g).map(d("MAWJobDefinitions").toEncodedEchoMessage);z=d("WATagsLogger").TAGS(["labyrinth_web","echo_restore",(z=w)!=null?z:"no_request_id"]);var A=c("qex")._("2110")===!0,B=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());if(A&&b("cr:11343")!=null){A=(yield t(a,z,v));if(A==null){w!=null&&d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(w,c("err")("Cannot generate ChatJid from threadKey: "+v));return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}A=(yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","convertEchoMessagesToEBProtobufs",{chatJid:A,encodedEchoMessages:f,userJid:B}));yield b("cr:11343")(a,e,v,d("MAWEncryptedBackupUtils").convertJSTypesToLSTypesForRestoreJob(A),k,l,m,s,u,w,x,"",g,y);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}try{if(w!=null){z.LOG(r(),w,v,(e=x)!=null?e:"");d("MAWEBRestoreTrackingUtils").markEBRestoreEcho(y);d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_start",traceId:w,type:"echo"});A=(yield t(a,z,v));if(A==null){d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(w,c("err")("Cannot generate ChatJid from threadKey: "+v));return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}g=d("MAWHandleEBRestoreWithHIM").convertEchoMessages(f,A,B);d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryIfPresent(w,{echoMessages:f,hasMoreAfter:m,hasMoreBefore:k,isPointQuery:u,messages:g.map(function(a){var b;return a.length>0&&((b=a[0].decodedMsg)==null?void 0:(b=b.unstoredDbMsg)==null?void 0:b.sortOrderMs)!=null?a[0].decodedMsg.unstoredDbMsg:null}).filter(Boolean),nextMessageTimestampMsBefore:l,referenceTimestamp:x,requestId:w,restoreType:"echo",threadId:v})}d("MAWEncryptedBackupUtils").logIfDuplicateMessagesFoundInRestore(f,"echo_restore");k===!0&&f.length===0&&z.ERROR(q());e=y!=null&&(i||(i=d("LSIntEnum"))).toNumber(y)===c("LSMEBTaskCreationSource").BULK_QUERY_FOR_SEARCH_RESULT;if(e)return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])]);a=y!=null&&(i||(i=d("LSIntEnum"))).toNumber(y)===c("LSMEBTaskCreationSource").FTS_INDEX_EB_MESSAGES_WEB;if(a){d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(w);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}A=y!=null&&(i||(i=d("LSIntEnum"))).toNumber(y)===c("LSMEBTaskCreationSource").MSGR_DYI;if(A){z.LOG(p());B=f.map(d("MAWHandleEBRestoreWithHIM").safeDecodeEchoMessage).filter(Boolean);void d("MAWEncryptedBackupsDYIHandleMessageRestore").handleMAWEchoMessageRangeQueryRestore(v,B,k,l);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}c("promiseDone")(d("MAWRestoreMessagesFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(v),f,k,l==null?void 0:(j||(j=d("I64"))).to_int32(l),m,s==null?void 0:(j||(j=d("I64"))).to_int32(s),u,w,x,y!=null?(i||(i=d("LSIntEnum"))).unwrapIntEnum(y):-1)["catch"](function(a){d("WALogger").ERROR(o(),a)}));return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}catch(a){d("WALogger").ERROR(n(),a);w!=null&&d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(w,a);return(h||(h=b("Promise"))).resolve([!0,c("LSVec").ofArray([]),c("LSVec").ofArray([])])}});function e(b,c,d,e,f,g,h,i,j,k,l,m,n){return a.apply(this,arguments)}return e}();g["default"]=a}),98);
__d("MAWRestoreProtobufsFromEncryptedBackupsDeferred",["ExecutionEnvironment","I64","LSDatabaseSingleton","WAJobOrchestratorTypes","asyncToGeneratorRuntime","cr:10036","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=c("requireDeferred")("MAWRestoreProtobufsFromEncryptedBackupsNOP").__setRef("MAWRestoreProtobufsFromEncryptedBackupsDeferred");function a(a,e,f,g,l,m,n,o,p,q,r,s,t,u,v){v===void 0&&(v=d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION);return k.load().then(function(){var k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(k){var w;(j||(j=c("ExecutionEnvironment"))).isInWorker&&b("cr:10036")!=null?(yield b("cr:10036").init(),w=(yield b("cr:10036").getLSStorage())):w=(yield (h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton);return w.runInTransaction(function(b){return k.call(b,a,e,f,g,l!=null?(i||(i=d("I64"))).to_float(l):0,m,n!=null?(i||(i=d("I64"))).to_float(n):(i||(i=d("I64"))).to_float((i||(i=d("I64"))).max_int),o,p,q,r,s,t,u,v)},"readwrite")});return function(a){return k.apply(this,arguments)}}())}g.call=a}),98);
__d("LSRestoreProtobufs.nop",["CurrentUser","LSIntEnum","LSMEBTaskCreationSource","LSVec","MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","MAWEBUnstoredDbMsgUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsDYIHandleMessageRestore","MAWJids","MAWJobDefinitions","MAWRestoreProtobufsFromEncryptedBackupsDeferred","Promise","WATagsLogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Restoring Messenger DYI batch"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no messages but hasMoreBefore is true"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - Failed to decode protobufs, with error: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no decoded messages but hasMoreBefore is true"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - ",""]);n=function(){return a};return a}a=function(a,e,f,g,p,q,r,s,t,u,v,w,x,y){a=null;x!=null&&(a=o(x));d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(e=u)!=null?e:"no_request_id"]).LOG(n(),(x=u)!=null?x:"no_request_id");d("MAWEBRestoreTrackingUtils").markEBRestoreProtobuf(y);e=d("MAWEncryptedBackupUtils").convertLSTypesToJSTypesForRestoreJob(g);d("MAWEncryptedBackupUtils").logIfDuplicateMessagesFoundInRestore(e,"protobuf_restore");if(u!=null)try{d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_start",traceId:u,type:"protobuf"});x=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());g=d("MAWEBUnstoredDbMsgUtils").getUnstoredDbMsgFromProtobuf(e,f,void 0,x);if(p===!0&&g.length===0){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(x=u)!=null?x:"no_request_id"]).ERROR(m())}d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryIfPresent(u,{echoMessages:a,hasMoreAfter:r,hasMoreBefore:p,isPointQuery:t,messages:g,nextMessageTimestampMsBefore:q,protobufMessages:e,referenceTimestamp:v,requestId:u,restoreType:"protobuf",threadId:f})}catch(a){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(x=u)!=null?x:"no_request_id"]).ERROR(l(),a.message)}if(p===!0&&e.length===0){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(g=u)!=null?g:"no_request_id"]).ERROR(k())}x=y!=null&&(i||(i=d("LSIntEnum"))).unwrapIntEnum(y)===c("LSMEBTaskCreationSource").FTS_INDEX_EB_MESSAGES_WEB;if(x){d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(u);return(h||(h=b("Promise"))).resolve()}g=y!=null&&(i||(i=d("LSIntEnum"))).unwrapIntEnum(y)===c("LSMEBTaskCreationSource").MSGR_DYI;if(g){d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore",(x=u)!=null?x:"no_request_id"]).LOG(j());void d("MAWEncryptedBackupsDYIHandleMessageRestore").handleMAWProtobufMessageRangeQueryRestore(f,e,p,q);return(h||(h=b("Promise"))).resolve()}c("promiseDone")(d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(f),e,p,q,r,s,t,u,v,w,a,y));return(h||(h=b("Promise"))).resolve()};function o(a){return c("LSVec").toArray(a).map(function(a){return d("MAWJobDefinitions").toEncodedEchoMessage(a)})}g["default"]=a}),98);
__d("MAWBridgeTraceRecordCheckpointHandler",["I64","LSAppendDataTraceAddonStoredProcedure","LSFactory","LSFlushDataTrace.nop"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var e=b.checkPointId,f=b.dataTraceId,g=b.errorMessage,i=b.tags;return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:e,dataTraceId:f,errorMessage:g,syncChannel:(h||(h=d("I64"))).neg_one,tags:i}).then(function(){if(b.shouldFlush)return c("LSFlushDataTrace.nop")(a,0,f)})}g.call=a}),98);
__d("MAWOfflineQueueStatus",["FBLogger","MAWSharedProtocolQueueConst"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map(),i=!1;function j(a,b){h.set(a,b),h.size>5e3&&c("FBLogger")("labyrinth_web").warn("Offline queue status map size (%s) is too large",h.size)}function k(a){return h.get(a)}function a(){h=new Map(),i=!1}function b(){return i}function e(){i=!0}function f(a,b){a=Object.keys(a);a.map(function(a){j(a,b)})}function l(a){return k(a)===d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete}function m(){return Array.from(h.entries()).filter(function(a){a[0];a=a[1];return a!==d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete&&a!==d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Failed}).map(function(a){a=a[0];return a})}g.setOfflineQueueStatus=j;g.getOfflineQueueStatus=k;g.resetOfflineQueueState=a;g.isOfflineQueueComplete=b;g.markOfflineQueueComplete=e;g.markThreadWithOfflineQueueStatus=f;g.isOfflineQueueDoneForThread=l;g.getAllThreadsWithOfflineQueueIncomplete=m}),98);
__d("MAWRestoreMessagesFromEncryptedBackupsNOP",["ExecutionEnvironment","I64","LSDataTraceCheckPoint","LSIntEnum","LSMEBTaskCreationSource","MAWAsyncEBPendingQueryPromise","MAWBridgeTraceRecordCheckpointHandler","MAWBridgeUpdateClientRestoreStatus","MAWChatJid","MAWEBRestoreTrackingUtils","MAWEncryptedBackupsUpdateGlobalRestoreStatus","MAWJobDefinitions","MAWJobManager","MAWMIC","MAWOfflineQueueStatus","MAWTimedJob","MAWUpdateClientRestoreStatusOperationType","Promise","ReQL","WAJobOrchestratorTypes","WALoggerDeferred","WATagsLogger","asyncToGeneratorRuntime","cr:4992","err","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Calling worker job for thread "," StartSortKey: "," messagesCount: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Calling prefetch for thread ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Failed to get thread key for "," when calling restoreMessagesFromEncryptedBackup"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web][","] Received echo documents for thread: "," startSortKey: "," messagesCount: ",""]);o=function(){return a};return a}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){try{c=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(c)));if(c!=null){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages_ranges_v2__generated).getKeyRange(c)));if(a!=null)return a.minMessageId}}catch(a){return(i||(i=b("Promise"))).reject(a)}return});return q.apply(this,arguments)}function r(a,b,c){if(b===0){d("MAWMIC").markEvent("eb_restore_start");c&&d("MAWMIC").markEvent("eb_prefetch_start");return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table)).then(function(a){a.forEach(function(a){a=d("MAWJobDefinitions").toThreadJidPrimaryId((k||(k=d("I64"))).to_string(a.jid));d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").addThreadIdToStatusArray(a,"restore");c&&d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").addThreadIdToStatusArray(a,"ebprefetch")})})}}function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,q,s,u,v,w,x,y,z,A,B){var C;B===void 0&&(B=d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION);d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",(C=w)!=null?C:""]).LOG(o(),(C=w)!=null?C:"",f,x,g.length);C=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(f)));C==null&&void d("WALoggerDeferred").ERROR(n(),f);C=!d("MAWOfflineQueueStatus").isOfflineQueueComplete()&&b("cr:4992")!=null&&x==null&&f!=null;var D=d("MAWEncryptedBackupsUpdateGlobalRestoreStatus").getCurrentGlobalRestoreStatusArrayLength("restore");yield r(a,D,C);try{D=(yield p(a,f));if(C&&b("cr:4992")!=null){d("WATagsLogger").TAGS(["labyrinth_web","eb_prefetch",(C=w)!=null?C:""]).LOG(m(),f);d("MAWEBRestoreTrackingUtils").markEBRestoreFrontloaded(y,w);C={action:d("MAWUpdateClientRestoreStatusOperationType").upsertClientRestoreStatus,threadId:f};yield d("MAWBridgeUpdateClientRestoreStatus").call(a,C);yield b("cr:4992")(a,e,f,g,h,q,s,u,v,w,x,D,y,z,A,B)}else{d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",(C=w)!=null?C:""]).LOG(l(),f,x,g.length);return t(e,f,g,D,h,s,v,w,x,y,z,A,B).then(function(){w!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_end",traceId:w,type:"echo"})})}}catch(e){if(w!=null)return d("MAWBridgeTraceRecordCheckpointHandler").call(a,{checkPointId:(j||(j=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_FOR_FAILURE),dataTraceId:w,errorMessage:e,shouldFlush:!0,syncChannel:-1,tags:void 0}).then(function(){return(i||(i=b("Promise"))).reject(e)})}});return s.apply(this,arguments)}function t(a,e,f,g,j,k,l,m,n,o,p,q,r){var s=(h||(h=c("ExecutionEnvironment"))).isInWorker?d("MAWJobManager").getJobManager():d("MAWTimedJob").TimedUIJobStarters;if(m!=null&&o===c("LSMEBTaskCreationSource").MESSENGER_MESSAGE_LIST_PAGINATION){var t;return s.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreMessagesFromEncryptedBackups(a,e,f,j,k,l,(t=g)!=null?t:void 0,(t=m)!=null?t:void 0,(t=n)!=null?t:void 0,void 0,void 0,o,{priority:r},p,q)).then(function(a){if(a.success===!0)d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryUponReStore(m);else{var b;d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(m,(b=a.payload)!=null?b:c("err")(a.error))}})}if(q===!0&&c("justknobx")._("3060")){return s.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreMessagesFromEncryptedBackups(a,e,f,j,k,l,(t=g)!=null?t:void 0,(r=m)!=null?r:void 0,(t=n)!=null?t:void 0,void 0,void 0,o,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},p,q)).then(function(){return(i||(i=b("Promise"))).resolve()})}return(i||(i=b("Promise"))).resolve(s.fireAndForget(d("MAWJobDefinitions").jobSerializers.restoreMessagesFromEncryptedBackups(a,e,f,j,k,l,(r=g)!=null?r:void 0,(t=m)!=null?t:void 0,(s=n)!=null?s:void 0,void 0,void 0,o,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},p,q)))}g.call=a}),98);
__d("MAWRestoreProtobufsFromEncryptedBackupsNOP",["ExecutionEnvironment","I64","LSDataTraceCheckPoint","LSIntEnum","LSMEBTaskCreationSource","MAWAsyncEBPendingQueryPromise","MAWBridgeTraceRecordCheckpointHandler","MAWChatJid","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWJobDefinitions","MAWJobManager","MAWTimedJob","Promise","Random","ReQL","WAJobOrchestratorTypes","WALoggerDeferred","asyncToGeneratorRuntime","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Failed to get thread key for "," when calling restoreProtobufsFromEncryptedBackups"]);l=function(){return a};return a}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){try{c=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(c)));if(c!=null){a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.messages_ranges_v2__generated).getKeyRange(c)));if(a!=null)return a.minMessageId}}catch(a){return(i||(i=b("Promise"))).reject(a)}return});return n.apply(this,arguments)}function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,p,q){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,n,o,q,r,s,t,u,v,w,x,y){y===void 0&&(y=d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION);try{var z=(yield m(a,f));n=(yield d("MAWChatJid").toThreadKeyMaybeForChatJidInteger(a,(k||(k=d("I64"))).of_string(f)));n==null&&void d("WALoggerDeferred").ERROR(l(),f);q=t!=null?Number(t):void 0;u=c("justknobx")._("2620");n=d("Random").coinflip(u);u=n?d("MAWEncryptedBackupUtils").getMessageMetadataFromDeanonAPI(f,g.length,q):(i||(i=b("Promise"))).resolve();return u.then(function(a){return p(e,f,v,g,z,h,o,r,s,t,w==null?void 0:w,a,x,y).then(function(){s!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_end",traceId:s,type:"protobuf"})})})}catch(e){if(s!=null)return d("MAWBridgeTraceRecordCheckpointHandler").call(a,{checkPointId:(j||(j=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").FLOW_END_FOR_FAILURE),dataTraceId:s,errorMessage:e,shouldFlush:!0,syncChannel:-1,tags:void 0}).then(function(){return(i||(i=b("Promise"))).reject(e)})}return(i||(i=b("Promise"))).resolve()});return o.apply(this,arguments)}function p(a,e,f,g,k,l,m,n,o,p,q,r,s,t){t===void 0&&(t=d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION);var u=(h||(h=c("ExecutionEnvironment"))).isInWorker?d("MAWJobManager").getJobManager():d("MAWTimedJob").TimedUIJobStarters;if(o!=null&&q!=null&&(j||(j=d("LSIntEnum"))).unwrapIntEnum(q)===c("LSMEBTaskCreationSource").MESSENGER_MESSAGE_LIST_PAGINATION){var v;return d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreProtobufsFromEncryptedBackups(f,a,e,g,l,m,n,(v=k)!=null?v:void 0,(v=o)!=null?v:void 0,(v=p)!=null?v:void 0,void 0,{priority:t},q,r,s)).then(function(){d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryUponReStore(o)})}if(s===!0&&c("justknobx")._("3060")){return d("MAWTimedJob").TimedUIJobStarters.waitUntilCompleted(d("MAWJobDefinitions").jobSerializers.restoreProtobufsFromEncryptedBackups(f,a,e,g,l,m,n,(v=k)!=null?v:void 0,(t=o)!=null?t:void 0,(v=p)!=null?v:void 0,void 0,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},q,r,s))}return(i||(i=b("Promise"))).resolve(u.fireAndForget(d("MAWJobDefinitions").jobSerializers.restoreProtobufsFromEncryptedBackups(f,a,e,g,l,m,n,(t=k)!=null?t:void 0,(v=o)!=null?v:void 0,(u=p)!=null?u:void 0,void 0,{priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION},q,r,s)))}g.call=a}),98);
__d("MWRestoreMessagesFromEB",["I64","LSAppendDataTraceAddonStoredProcedure","LSDataTraceCheckPoint","LSDataTraceType","LSEncryptedBackupsBackupTenancy","LSEncryptedBackupsMessagesRangeQueryDirection","LSFactory","LSIntEnum","LSIssueMessageRangeQueryTaskStoredProcedure","LSMEBTaskCreationSource","MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsRestoreMessageOverGraphQL","MAWMainTraceUtils","MWEncryptedBackUpEBNotEnabledError","Promise","WAJids","WATagsLogger","asyncToGeneratorRuntime","err","gkx","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web][","] Issuing message range query for thread: "," startSortKey: "," numMessages: ","} "]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Issuing message range query for chatJid: "," skipped. EB not enabled"]);l=function(){return a};return a}function a(a){var e=a.chatJid,f=a.newerNumMessages,g=a.numMessages,k=a.passedTraceId,n=a.sortOrderMs,o=a.source,p=a.storage;if(!c("gkx")("23914"))return null;var q=k!=null?k:d("MAWMainTraceUtils").createTraceId();c("promiseDone")(d("MAWEncryptedBackupUtils").getBackupTenancy(p.tables).then(function(a){if(a!=null&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION)))return c("qex")._("1776")===!0||c("gkx")("5976")?d("MAWEncryptedBackupsRestoreMessageOverGraphQL").getMessagesFromBackup(e,p,n,(i||(i=d("I64"))).to_float(f)>0?c("LSEncryptedBackupsMessagesRangeQueryDirection").AFTER:c("LSEncryptedBackupsMessagesRangeQueryDirection").BEFORE,q,o):m({chatJid:e,newerNumMessages:f,numMessages:g,passedTraceId:k,sortOrderMs:n,source:o,storage:p,traceId:q});else{d("WATagsLogger").TAGS(["labyrinth_web","eb_restore"]).WARN(l(),e);d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(q,c("err")(d("MWEncryptedBackUpEBNotEnabledError").EB_NOT_ENABLED));return(h||(h=b("Promise"))).resolve()}}));return q}function m(a){var e=a.chatJid,g=a.newerNumMessages,h=a.numMessages,l=a.passedTraceId,m=a.sortOrderMs,n=a.source,o=a.storage,p=a.traceId;return o.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield d("MAWMainTraceUtils").startTraceWithTxn(a,(i||(i=d("I64"))).of_float(Date.now()),p,(j||(j=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_RESTORE));yield c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:j.ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ISSUE_MESSAGE_RANGE_QUERY),dataTraceId:p,syncChannel:i.neg_one});d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",p]).LOG(k(),p,e,i.to_string(m),i.to_string(h));d("MAWEBRestoreTrackingUtils").markEBRestorePaginated(n,l,"LS");return c("LSIssueMessageRangeQueryTaskStoredProcedure")(c("LSFactory")(a),{includeOffset:c("gkx")("5340"),isPointQuery:!1,newerNumMessages:g,numMessages:h,source:j.ofNumber((a=n)!=null?a:c("LSMEBTaskCreationSource").UNKNOWN),startSortKey:i.to_string(m),threadId:d("WAJids").threadIdForChatJid(e),traceId:p})});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":128")}g["default"]=a}),98);
__d("X25519",["$InternalEnum","Promise","WACryptoCurve25519Dependencies","WASignalKeys","WASignalOther","WASignalSignatures"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("$InternalEnum").Mirrored(["Encryption","Signing"]),j=b("$InternalEnum")({PublicKey:0,PrivateKey:1,Signature:2});function k(a,b){if(b===i.Encryption)return[];b=1;switch(a){case j.PublicKey:b=1;break;case j.PrivateKey:b=2;break;case j.Signature:b=3;break}return[255,b]}function l(a,b,c){b=k(b,c);c=b.length;if(c<=0)return a;var d=new Uint8Array(c+a.byteLength);d.set(Array.from(b));d.set(a,c);return d}function m(a,b,c){b=k(b,c).length;return a.slice(b)}function n(a,b){return{privateKey:l(a.privateKey,j.PrivateKey,b),publicKey:l(a.publicKey,j.PublicKey,b)}}function a(a){a=n(d("WASignalKeys").makeKeyPair(),a);return{pk:a.publicKey,sk:a.privateKey}}function o(a,b){if(b===i.Encryption)return 32;switch(a){case j.PublicKey:case j.PrivateKey:return 32;case j.Signature:return 64}}function p(a,b,c){var d=k(b,c),e=d.length;b=o(b,c);c=b!=null?e+b:0;if(a.length!==c)return!1;var f=a.subarray(0,e);b=new Uint8Array(d);return b.length===f.length&&b.every(function(a,b){return a===f[b]})}function q(a,b){if(p(a,j.PublicKey,b))return a;return}function r(a,b){if(p(a,j.PrivateKey,b))return a;return}function c(a,b){var c=q(a.pkBytes,b);a=r(a.skBytes,b);if(c!=null&&a!=null)return{pk:c,sk:a}}function e(a,c){a=m(a,j.PrivateKey,i.Signing);return d("WASignalSignatures").signMsg(d("WASignalKeys").makeKeyPairFrom(d("WASignalOther").ensureSize(a,32)),c).then(function(a){a=l(a,j.Signature,i.Signing);return(h||(h=b("Promise"))).resolve(a)})}function f(a){if(p(a,j.Signature,i.Signing))return a}function s(a,b,c){b=m(b,j.PublicKey,i.Signing);return d("WASignalSignatures").verifyMsgSignalVariant(d("WASignalKeys").serializeIdentity(b),c,d("WASignalOther").ensureSize(m(a,j.Signature,i.Signing),64))}function t(a,c){c=c;a=a;return!p(a,j.PublicKey,i.Encryption)||!p(c,j.PrivateKey,i.Encryption)?(h||(h=b("Promise"))).resolve():d("WACryptoCurve25519Dependencies").calculateAgreement(a,c).then(function(a){return(h||(h=b("Promise"))).resolve(new Uint8Array(a))})}g.KeyPurpose=i;g.generateKeys=a;g.publicKeyFromBytes=q;g.secretKeyFromBytes=r;g.keysFromBytes=c;g.sign=e;g.signatureFromBytes=f;g.verify=s;g.exchangeKeys=t}),98);
__d("PublicKeyCrypto",["Promise","UInt8Array","X25519"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,c){return(h||(h=b("Promise"))).all([a,c]).then(function(a){return(h||(h=b("Promise"))).resolve(a[0]!=null&&a[1]!=null?d("UInt8Array").concatBytes([a[0],a[1]]):void 0)})}function a(a,b,c){return i(d("X25519").exchangeKeys(c,a),d("X25519").exchangeKeys(c,b))}function c(a,b,c){return i(d("X25519").exchangeKeys(c,a),d("X25519").exchangeKeys(b,a))}g.senderDeriveSharedSecret=a;g.receiverDeriveSharedSecret=c}),98);